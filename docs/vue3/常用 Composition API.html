<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-vue3/常用 Composition API">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">常用Composition API | 一杯白开水</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://october-x.github.io/docs/vue3/常用 Composition API"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="frontend, react, javascript, css, react, vue, typescript, docusaurus, blog, personal blog, personal website,html"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="常用Composition API | 一杯白开水"><meta data-rh="true" name="description" content="1.拉开序幕的setup"><meta data-rh="true" property="og:description" content="1.拉开序幕的setup"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://october-x.github.io/docs/vue3/常用 Composition API"><link data-rh="true" rel="alternate" href="https://october-x.github.io/docs/vue3/常用 Composition API" hreflang="en"><link data-rh="true" rel="alternate" href="https://october-x.github.io/docs/vue3/常用 Composition API" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="一杯白开水 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="一杯白开水 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.a269d841.css">
<link rel="preload" href="/assets/js/runtime~main.7ff54316.js" as="script">
<link rel="preload" href="/assets/js/main.479c9106.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">一杯白开水</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Skill</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/html">HTML</a></li><li><a class="dropdown__link" href="/docs/css">CSS</a></li><li><a class="dropdown__link" href="/docs/js">JavaScript</a></li><li><a class="dropdown__link" href="/docs/vue">Vue</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/vue3">Vue3</a></li><li><a class="dropdown__link" href="/docs/ts">TypeSript</a></li><li><a class="dropdown__link" href="/docs/react">React</a></li><li><a class="dropdown__link" href="/docs/nodejs">NodeJS</a></li><li><a class="dropdown__link" href="/docs/webpack">WebPack</a></li></ul></div><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>一杯白开水</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/docs/vue3">Vue3</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/vue3/分析工程结构">Vue3简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/vue3/Composition API的优势">Composition API的优势</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/vue3/常用 Composition API">常用Composition API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/vue3/其他Composition API">其他Composition API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/vue3/新的组件">新的组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/vue3/其他">其他</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/vue3"><span itemprop="name">Vue3</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">常用Composition API</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>常用Composition API</h1><h1>初识setup</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1拉开序幕的setup">1.拉开序幕的setup<a href="#1拉开序幕的setup" class="hash-link" aria-label="Direct link to 1.拉开序幕的setup" title="Direct link to 1.拉开序幕的setup">​</a></h2><ol><li>理解：Vue3.0中一个新的配置项，值为一个函数。</li><li>setup是所有<strong>Composition API（组合式API）</strong>“ 表演的舞台 ”。</li><li>组件中所用到的：数据、方法等等，均要配置在setup中。</li><li>setup函数的两种返回值： <ol><li>若返回一个对象，则对象中的属性、方法, 在模板中均可以直接使用。（重点关注！）</li><li>若返回一个渲染函数：则可以自定义渲染内容。（了解）</li></ol></li><li>注意点： <ol><li>尽量不要与Vue2.x配置混用 <ul><li>Vue2.x配置（data、methos、computed...）中<strong>可以访问到</strong>setup中的属性、方法。</li><li>但在setup中<strong>不能访问到</strong>Vue2.x配置（data、methos、computed...）。</li><li>如果有重名, setup优先。</li></ul></li><li><code>setup</code>不能是一个<code>async</code>函数，因为返回值不再是<code>return</code>的对象, 而是<code>promise</code>, 模板看不到<code>return</code>对象中的属性。（后期也可以返回一个<code>Promise</code>实例，但需要<code>Suspense</code>和异步组件的配合）</li></ol></li></ol><div class="language-vue codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vue codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;!--vue3的组件模版结构可以没有根标签--&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h1&gt;我是app组件&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h1&gt;我叫{{ name }}, {{ age }}岁&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;sayHello&quot;&gt;hello!!&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h3&gt;msg: {{ vue2 }}&lt;/h3&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;p&gt;数据冲突该怎么办？{{ a }}&lt;/p&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;test1&quot;&gt;测试一下在vue2中去读取vue3的配置&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;test2&quot;&gt;测试一下在vue3的setup中去读取vue2的配置&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">// import { h } from &#x27;vue&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">export default {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  name: &#x27;App&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //此处只是测试setup，暂时先不考虑响应式的问题</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //测试使用vue2的内容</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  data(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      vue2: &#x27;still can use vue2 in vue3 code&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      a:1</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  methods:{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //vue2配置方法的方式</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    test1(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      console.log(this.vue2);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      console.log(this.name);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      console.log(this.sayHello);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      this.sayHello();</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  setup(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //表演的舞台</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //准备数据 data</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //这样定义的数据vue是监测不到的，后面会讲到要使用ref</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let name = &#x27;py&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let age = 21;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let a = 300;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //方法 methods</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    function sayHello(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      alert(`My name is ${name}, ${age} ${age === 1  ? &#x27;year&#x27; : &#x27;years&#x27;} old`);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //在vue3的配置里去读取vue2的属性</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    function test2(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      console.log(name);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      console.log(age);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      console.log(sayHello);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      console.log(this.vue2);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      console.log(this.test1);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //返回一个对象</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      name,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      age,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      sayHello,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      test2,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      a</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //返回一个渲染函数</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //这是直接将你在这里渲染的东西替换到template中</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // return () =&gt; h(&#x27;h1&#x27;, &#x27;hello&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">#app {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  font-family: Avenir, Helvetica, Arial, sans-serif;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  -webkit-font-smoothing: antialiased;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  -moz-osx-font-smoothing: grayscale;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  text-align: center;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  color: #2c3e50;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  margin-top: 60px;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2ref函数">2.ref函数<a href="#2ref函数" class="hash-link" aria-label="Direct link to 2.ref函数" title="Direct link to 2.ref函数">​</a></h2><ul><li>作用: 定义一个响应式的数据</li><li>语法: <code>const xxx = ref(initValue)</code> <ul><li>创建一个包含响应式数据的<strong>引用对象（reference对象，简称ref对象）</strong>。</li><li>JS中操作数据： <code>xxx.value</code></li><li>模板中读取数据: 不需要.value，直接：<code>&lt;div&gt;{{xxx}}&lt;/div&gt;</code></li></ul></li><li>备注： <ul><li>接收的数据可以是：基本类型、也可以是对象类型。</li><li>基本类型的数据：响应式依然是靠<code>Object.defineProperty()</code>的<code>get</code>与<code>set</code>完成的。</li><li>对象类型的数据：内部 “ 求助 ” 了Vue3.0中的一个新函数—— <code>reactive</code>函数。</li></ul></li></ul><p><img loading="lazy" src="https://october-x-image-host.oss-cn-hangzhou.aliyuncs.com/markdown-imgsimage-20221206200153952.png" alt="image-20221206200153952" class="img_ev3q">
<code>RefImp</code>就是<code>reference（引用）</code>和<code>implement（实现）</code>。就是<strong>引用实现对象</strong>
<img loading="lazy" src="https://october-x-image-host.oss-cn-hangzhou.aliyuncs.com/markdown-imgsimage-20221206200202252.png" alt="image-20221206200202252" class="img_ev3q"></p><div class="language-vue codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vue codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;!--vue3的组件模版结构可以没有根标签--&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;!--这边不要加上.value，后面解析会自动加上去--&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h1&gt;我是app组件&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h1&gt;我叫{{ name }}, {{ age }}岁&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h3&gt;职位:{{ job.type }}&lt;/h3&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h3&gt;薪水:{{ job.salary }}&lt;/h3&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;changeInfo&quot;&gt;修改人的信息&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">import { ref } from &#x27;vue&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">export default {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  name: &#x27;App&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  setup(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //表演的舞台(setup)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //准备数据 data</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //ref实现响应式(基本类型)也是采用Object.definedProperty()来实现的 getter和setter</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let name = ref(&#x27;py&#x27;); //ref引用对象</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let age = ref(21);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //ref实现响应式(对象类型)也是采用Proxy来实现</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let job = ref({</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      type: &#x27;frontend developer&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      salary: &#x27;30&#x27;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    function changeInfo(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      name.value = &#x27;李四&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      age.value = 42;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      job.value.type = &#x27;UI developer&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      console.log(name, age); //不是响应式的</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //返回一个对象</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      name,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      age,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      job,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      changeInfo</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">#app {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  font-family: Avenir, Helvetica, Arial, sans-serif;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  -webkit-font-smoothing: antialiased;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  -moz-osx-font-smoothing: grayscale;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  text-align: center;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  color: #2c3e50;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  margin-top: 60px;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>以上代码的<code>job.value</code>输出：
<img loading="lazy" src="https://october-x-image-host.oss-cn-hangzhou.aliyuncs.com/markdown-imgsimage-20221206200304477.png" alt="image-20221206200304477" class="img_ev3q">
<strong>小结：</strong>
<code>RefImpl</code>对于<strong>基本数据类型</strong>的数据是使用<code>defineProperty</code>的<code>set</code>，<code>get</code>进行数据劫持。对于<strong>对象类型</strong>的数据是使用es6的<code>proxy</code>。内部 “ 求助 ” 了Vue3.0中的一个新函数—— <code>reactive</code>函数。<code>reactive</code>函数有proxy的相关操作</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3reactive函数">3.reactive函数<a href="#3reactive函数" class="hash-link" aria-label="Direct link to 3.reactive函数" title="Direct link to 3.reactive函数">​</a></h2><ul><li>作用: 定义一个<strong>对象类型</strong>的响应式数据（基本类型不要用它，要用<code>ref</code>函数）</li><li>语法：<code>const 代理对象= reactive(源对象)</code>接收一个对象（或数组），返回一个<strong>代理对象（Proxy的实例对象，简称proxy对象）</strong></li><li>reactive定义的响应式数据是“深层次的”。</li><li>内部基于 ES6 的 Proxy 实现，通过代理对象操作源对象内部数据进行操作。</li></ul><p><img loading="lazy" src="https://october-x-image-host.oss-cn-hangzhou.aliyuncs.com/markdown-imgsimage-20221206200320448.png" alt="image-20221206200320448" class="img_ev3q"></p><div class="language-vue codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vue codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;!--vue3的组件模版结构可以没有根标签--&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h1&gt;我是app组件&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h1&gt;我叫{{ person.name }}, {{ person.age }}岁&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h3&gt;职位:{{ person.type }}&lt;/h3&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h3&gt;薪水:{{ person.salary }}&lt;/h3&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h3&gt;爱好:{{ person.hobbies }}&lt;/h3&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h4&gt;测试的数据c:{{ person.a.b.c }}&lt;/h4&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;changeInfo&quot;&gt;修改人的信息&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">import { reactive } from &#x27;vue&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">export default {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  name: &#x27;App&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  setup(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //表演的舞台(setup)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //准备数据 data</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //ref实现响应式(基本类型)也是采用Object.definedProperty()来实现的 getter和setter</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // let name = ref(&#x27;py&#x27;); //ref引用对象(RefImpl)实例</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // let age = ref(21);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //ref实现响应式(对象类型)也是采用Proxy来实现(proxy) 这里如果就算是用ref也是借助了reactive</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let person = reactive({</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      name: &#x27;py&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      age: 21,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      type: &#x27;frontend developer&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      salary: &#x27;30&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      hobbies: [&#x27;抽烟&#x27;, &#x27;喝酒&#x27;, &#x27;烫头&#x27;],</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      a:{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        b:{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">          c: 666</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    function changeInfo(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      person.name = &#x27;李四&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      person.age = 42;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      // job.value.type = &#x27;xxx&#x27;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      person.type = &#x27;UI developer&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      //测试reactive能否监测深层次变化</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      person.a.b.c = 100;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      person.hobbies[0] = &#x27;play tennis&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      // console.log(name, age); //不是响应式的</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //返回一个对象</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      person,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      changeInfo</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">#app {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  font-family: Avenir, Helvetica, Arial, sans-serif;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  -webkit-font-smoothing: antialiased;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  -moz-osx-font-smoothing: grayscale;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  text-align: center;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  color: #2c3e50;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  margin-top: 60px;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4vue30中的响应式原理">4.Vue3.0中的响应式原理<a href="#4vue30中的响应式原理" class="hash-link" aria-label="Direct link to 4.Vue3.0中的响应式原理" title="Direct link to 4.Vue3.0中的响应式原理">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="vue2x的响应式">vue2.x的响应式<a href="#vue2x的响应式" class="hash-link" aria-label="Direct link to vue2.x的响应式" title="Direct link to vue2.x的响应式">​</a></h3><ul><li>实现原理： <ul><li>对象类型：通过<code>Object.defineProperty()</code>对属性的读取、修改进行拦截（数据劫持）。 </li><li>数组类型：通过重写更新数组的一系列方法来实现拦截。（对数组的变更方法进行了包裹）。 </li></ul></li></ul><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token known-class-name class-name" style="color:rgb(255, 203, 139)">Object</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">defineProperty</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;count&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">get</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">set</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>存在问题： <ul><li>新增属性、删除属性, 界面不会更新。</li><li>直接通过下标修改数组, 界面不会自动更新。</li></ul></li></ul><p><strong>复习一下当时的解决方法：</strong></p><div class="language-vue codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vue codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">import Vue from &#x27;vue&#x27;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">export default {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    data() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            person: {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                name: &#x27;张三&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                age: 18,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">                hobby: [&#x27;学习&#x27;, &#x27;跑步&#x27;]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    methods: {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        addSex() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            this.$set(this.person, &#x27;sex&#x27;, &#x27;男&#x27;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            // Vue.set(this.person,&#x27;sex&#x27;,&#x27;男&#x27;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        deleteName() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            this.$delete(this.person, &#x27;name&#x27;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            //Vue.delete(this.person,&#x27;name&#x27;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        changeRun() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            // this.$set(this.person.hobby,0,&#x27;逛街&#x27;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            //因为重写了数组的一些变更方法，所以使用splice是可以被监测到的</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            this.person.hobby.splice(0, 1, &#x27;逛街&#x27;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/style&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="vue30的响应式">Vue3.0的响应式<a href="#vue30的响应式" class="hash-link" aria-label="Direct link to Vue3.0的响应式" title="Direct link to Vue3.0的响应式">​</a></h3><ul><li>实现原理: <ul><li>通过Proxy（代理）:  拦截对象中任意属性的变化, 包括：属性值的读写、属性的添加、属性的删除等。</li><li>通过Reflect（反射）:  对源对象的属性进行操作。</li><li>MDN文档中描述的Proxy与Reflect： <ul><li>Proxy：<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy</a> </li><li>Reflect：<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect</a> </li></ul></li></ul></li></ul><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 139)">Proxy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 拦截读取属性值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">get</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> prop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 139)">Reflect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> prop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 拦截设置属性值或添加新属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">set</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> prop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 139)">Reflect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> prop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// 拦截删除属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">deleteProperty</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">target</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> prop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 139)">Reflect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">deleteProperty</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> prop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">proxy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;tom&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>模拟：</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token doctype punctuation" style="color:rgb(199, 146, 234);font-style:italic">&lt;!</span><span class="token doctype doctype-tag" style="color:rgb(199, 146, 234);font-style:italic">DOCTYPE</span><span class="token doctype" style="color:rgb(199, 146, 234);font-style:italic"> </span><span class="token doctype name" style="color:rgb(199, 146, 234);font-style:italic">html</span><span class="token doctype punctuation" style="color:rgb(199, 146, 234);font-style:italic">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">html</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">lang</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">en</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">head</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">meta</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">charset</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">UTF-8</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">title</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">v3响应式</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">title</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">head</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">body</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text/javascript</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript keyword" style="color:rgb(127, 219, 202)">let</span><span class="token script language-javascript"> person </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">        </span><span class="token script language-javascript literal-property property" style="color:rgb(128, 203, 196)">name</span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&#x27;张三&#x27;</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">        </span><span class="token script language-javascript literal-property property" style="color:rgb(128, 203, 196)">age</span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:rgb(247, 140, 108)">18</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//#region //可以用来折叠</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//模拟vue2中的响应式</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// let p = {};</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// Object.defineProperty(p, &#x27;name&#x27;, {</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     get(){</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         //有人读取name时调用</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         return person.name;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     },</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     set(value){</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         //有人修改name时调用</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         console.log(&#x27;name changed, must change the page&#x27;);</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         person.name = value;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     }</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// })</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// Object.defineProperty(p, &#x27;age&#x27;, {</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     configurable: true,//可配置，但是vue2是无法捕获到配置被修改的，比如删除</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     get(){</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         //get age</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         return person.age;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     },</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     set(value){</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         //set age</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         console.log(&#x27;age changed, must change the page&#x27;);</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         person.age = value;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     }</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// })</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//#endregion</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//vue3的响应式</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript keyword" style="color:rgb(127, 219, 202)">const</span><span class="token script language-javascript"> p </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:rgb(127, 219, 202)">new</span><span class="token script language-javascript"> </span><span class="token script language-javascript class-name" style="color:rgb(255, 203, 139)">Proxy</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">person</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">        </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//读取</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">        </span><span class="token script language-javascript function" style="color:rgb(130, 170, 255)">get</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">target</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"> propName</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">          </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//person ==&gt; target</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">          </span><span class="token script language-javascript console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&#x27;读取&#x27;</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">          </span><span class="token script language-javascript keyword control-flow" style="color:rgb(127, 219, 202)">return</span><span class="token script language-javascript"> </span><span class="token script language-javascript known-class-name class-name" style="color:rgb(255, 203, 139)">Reflect</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(130, 170, 255)">get</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">target</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript">propName</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">        </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">        </span><span class="token script language-javascript function" style="color:rgb(130, 170, 255)">set</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">target</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"> propName</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"> value</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">          </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// 修改和增加属性都调用</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">          </span><span class="token script language-javascript console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&#x27;修改&#x27;</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">          </span><span class="token script language-javascript known-class-name class-name" style="color:rgb(255, 203, 139)">Reflect</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(130, 170, 255)">set</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">target</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"> propName</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"> value</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">        </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">        </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//删除</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">        </span><span class="token script language-javascript function" style="color:rgb(130, 170, 255)">deleteProperty</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript parameter">target</span><span class="token script language-javascript parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript parameter"> propName</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">          </span><span class="token script language-javascript console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token script language-javascript template-string string" style="color:rgb(173, 219, 103)">删除</span><span class="token script language-javascript template-string template-punctuation string" style="color:rgb(173, 219, 103)">`</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">          </span><span class="token script language-javascript keyword control-flow" style="color:rgb(127, 219, 202)">return</span><span class="token script language-javascript"> </span><span class="token script language-javascript known-class-name class-name" style="color:rgb(255, 203, 139)">Reflect</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(130, 170, 255)">deleteProperty</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">target</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"> propName</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">        </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// let obj = {</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     a:1,</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     b:2</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// }</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// const x1 = Reflect.defineProperty(obj, &#x27;c&#x27;,{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     get(){</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         return 3;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     }</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// });</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// console.log(x1); //true 成</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// const x2 = Reflect.defineProperty(obj, &#x27;c&#x27;,{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     get(){</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//         return 4;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     }</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// });</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// if(x2){</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">//     console.log(x2); //false 否</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// }</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">      </span><span class="token script language-javascript comment" style="color:rgb(99, 119, 119);font-style:italic">// Reflect.get(obj,&#x27;a&#x27;);</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token script language-javascript">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">body</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">html</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5reactive对比ref">5.reactive对比ref<a href="#5reactive对比ref" class="hash-link" aria-label="Direct link to 5.reactive对比ref" title="Direct link to 5.reactive对比ref">​</a></h2><ul><li>从定义数据角度对比： <ul><li>ref用来定义：<strong>基本类型数据</strong>。</li><li>reactive用来定义：<strong>对象（或数组）类型数据</strong>。</li><li>备注：ref也可以用来定义<strong>对象（或数组）类型数据</strong>, 它内部会自动通过<code>reactive</code>转为<strong>代理对象</strong>。</li></ul></li><li>从原理角度对比： <ul><li>ref通过<code>Object.defineProperty()</code>的<code>get</code>与<code>set</code>来实现响应式（数据劫持）。</li><li>reactive通过使用<strong>Proxy</strong>来实现响应式（数据劫持）, 并通过<strong>Reflect</strong>操作<strong>源对象</strong>内部的数据。</li></ul></li><li>从使用角度对比： <ul><li>ref定义的数据：操作数据<strong>需要</strong><code>.value</code>，读取数据时模板中直接读取<strong>不需要</strong><code>.value</code>。</li><li>reactive定义的数据：操作数据与读取数据：<strong>均不需要</strong><code>.value</code>。</li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6setup的两个注意点">6.setup的两个注意点<a href="#6setup的两个注意点" class="hash-link" aria-label="Direct link to 6.setup的两个注意点" title="Direct link to 6.setup的两个注意点">​</a></h2><ul><li>setup执行的时机 <ul><li>在beforeCreate之前执行一次，this是undefined。</li></ul></li><li>setup的参数 <ul><li>props：值为对象，包含：组件外部传递过来，且组件内部声明接收了的属性。</li><li>context：上下文对象 <ul><li>attrs: 值为对象，包含：组件外部传递过来，但没有在props配置中声明的属性, 相当于 <code>this.$attrs</code>。</li><li>slots: 收到的插槽内容, 相当于 <code>this.$slots</code>。</li><li>emit: 分发自定义事件的函数, 相当于 <code>this.$emit</code>。</li></ul></li></ul></li></ul><div class="language-vue codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vue codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;!--vue3的组件模版结构可以没有根标签--&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h1&gt;我是app组件&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h1&gt;我叫{{ person.name }}, {{ person.age }}岁&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;test&quot;&gt;测试触发一次demo的自定义事件&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">import { reactive } from &#x27;vue&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">export default {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  name: &#x27;Demo&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  beforeCreate() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(&#x27;----@bc&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  props: [&#x27;msg&#x27;, &#x27;school&#x27;],</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  emits:[&#x27;hello&#x27;],//这个配置不写的话，会出现警告，但是不影响使用。</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  setup(props, context){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // console.log(&#x27;----setup&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // console.log(this); ///undefined</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(props); //props: 外部给组件丢的参数 =&gt; 响应式(Proxy实例)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //表演的舞台(setup)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //准备数据 data</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //ref实现响应式(基本类型)也是采用Object.definedProperty()来实现的 getter和setter</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // let name = ref(&#x27;py&#x27;); //ref引用对象(RefImpl)实例</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // let age = ref(21);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //ref实现响应式(对象类型)也是采用Proxy来实现(proxy) 这里如果就算是用ref也是借助了reactive</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let person = reactive({</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      name: &#x27;py&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      age: 21,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // console.log(context, context.attrs);//相当于vue2中的$attrs</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // console.log(context,context.slots);//插槽</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // console.log(context,context.emit);//触发自定义事件</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //返回一个对象</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      person,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      test(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        context.emit(&#x27;hello&#x27;, 666); //触发自定义事件</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="7计算属性与监视">7.计算属性与监视<a href="#7计算属性与监视" class="hash-link" aria-label="Direct link to 7.计算属性与监视" title="Direct link to 7.计算属性与监视">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1computed函数">1.computed函数<a href="#1computed函数" class="hash-link" aria-label="Direct link to 1.computed函数" title="Direct link to 1.computed函数">​</a></h3><ul><li>与Vue2.x中computed配置功能一致 </li><li>写法 </li></ul><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword module" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports">computed</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;vue&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">setup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token spread operator" style="color:rgb(127, 219, 202)">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//计算属性——简写</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">let</span><span class="token plain"> fullName </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">computed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">firstName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;-&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">lastName</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//计算属性——完整</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">let</span><span class="token plain"> fullName </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">computed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            </span><span class="token keyword control-flow" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">firstName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;-&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">lastName</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">set</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> nameArr </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">split</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;-&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">firstName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> nameArr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">lastName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> nameArr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-vue codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vue codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h1&gt;一个人的信息&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  姓:&lt;input type=&quot;text&quot; v-model=&quot;person.firstName&quot;/&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;br/&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  名:&lt;input type=&quot;text&quot; v-model=&quot;person.lastName&quot;/&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;p&gt;姓名:{{ person.fullName }}&lt;/p&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;br/&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  修改全名:&lt;input type=&quot;text&quot; v-model=&quot;person.fullName&quot;/&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">import { reactive, computed } from &#x27;vue&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">export default {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  name: &#x27;Demo&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //vue2的写法</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // computed:{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //   fullName(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //     //vue2看得到vue3 注意</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //     return this.person.firstName + &#x27;-&#x27; + this.person.lastName;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //   }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  setup(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let person = reactive({</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      firstName: &#x27;pan&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      lastName: &#x27;yue&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      age: 21,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //计算属性(简写，没有考虑计算属性被修改的情况)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // person.fullName = computed(() =&gt; {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //   return person.firstName + &#x27;-&#x27; + person.lastName;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // })</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //计算属性(完整写法，既考虑了读也考虑了改)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    person.fullName = computed({</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      get(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        return person.firstName + &#x27;-&#x27; + person.lastName</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      set(name){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        let [ fn, ln ] = name.split(&#x27;-&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        //响应式</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        person.firstName = fn;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        person.lastName = ln;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //返回一个对象</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      person,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2watch函数">2.watch函数<a href="#2watch函数" class="hash-link" aria-label="Direct link to 2.watch函数" title="Direct link to 2.watch函数">​</a></h3><ul><li>与Vue2.x中watch配置功能一致 </li><li>两个小“坑”： <ul><li>监视reactive定义的响应式数据时：oldValue无法正确获取、强制开启了深度监视（deep配置失效）。</li><li>监视reactive定义的响应式数据中某个属性时：deep配置有效。</li></ul></li></ul><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//情况一：监视ref定义的响应式数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">watch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sum</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">newValue</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;sum变化了&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">newValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token literal-property property" style="color:rgb(128, 203, 196)">immediate</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//情况二：监视多个ref定义的响应式数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">watch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">sum</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">newValue</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;sum或msg变化了&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">newValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/* 情况三：监视reactive定义的响应式数据</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">            若watch监视的是reactive定义的响应式数据，则无法正确获得oldValue！！</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">            若watch监视的是reactive定义的响应式数据，则强制开启了深度监视 </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">watch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">newValue</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;person变化了&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">newValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token literal-property property" style="color:rgb(128, 203, 196)">immediate</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token literal-property property" style="color:rgb(128, 203, 196)">deep</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//此处的deep配置不再奏效</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//情况四：监视reactive定义的响应式数据中的某个属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">watch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain">person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">job</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">newValue</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;person的job变化了&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">newValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token literal-property property" style="color:rgb(128, 203, 196)">immediate</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token literal-property property" style="color:rgb(128, 203, 196)">deep</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//情况五：监视reactive定义的响应式数据中的某些属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">watch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain">person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">job</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain">person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">newValue</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;person的job变化了&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">newValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token literal-property property" style="color:rgb(128, 203, 196)">immediate</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token literal-property property" style="color:rgb(128, 203, 196)">deep</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//特殊情况</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">watch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain">person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">job</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">newValue</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;person的job变化了&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">newValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">oldValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token literal-property property" style="color:rgb(128, 203, 196)">deep</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//此处由于监视的是reactive素定义的对象中的某个属性，所以deep配置有效</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">template</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">h1</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">当前求和为</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> sum </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">h1</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">button @click</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;sum++&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">点我加一</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">hr</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">h2</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">当前的信息为</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> msg </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">h2</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">button @click</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;msg += &#x27;!&#x27;&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">修改信息</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">hr</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">h2</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">姓名</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">h2</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">h2</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">年龄</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">age</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">h2</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">h2</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">薪资</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">job</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">j1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">salary</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token constant" style="color:rgb(130, 170, 255)">K</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">h2</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">button @click</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;person.name = person.name + &#x27;~&#x27;&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">修改姓名</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">button @click</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;person.age++&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">增长年龄</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">button @click</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;person.job.j1.salary++&quot;</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">增长薪资</span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">button</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">template</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword module" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> ref</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> reactive</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> watch </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;vue&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword module" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(127, 219, 202)">default</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token literal-property property" style="color:rgb(128, 203, 196)">name</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Demo&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//vue2中的watch写法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// watch:{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   //简单写法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   // sum(nv,ov){</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   //   console.log(&#x27;sum的值发生变化了&#x27;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   //   console.log(`newValue:${nv}, oldValue:${ov}`);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   // }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   //完整写法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   sum:{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//     deep: true, //深度监视</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//     immediate: true, //一开始就监视一下</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//     handler(nv,ov){</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//         console.log(&#x27;sum的值发生变化了&#x27;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//         console.log(`newValue:${nv}, oldValue:${ov}`);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//     }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// },</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">setup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">let</span><span class="token plain"> sum </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">let</span><span class="token plain"> msg </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ref</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;你好&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">let</span><span class="token plain"> person </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">reactive</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token literal-property property" style="color:rgb(128, 203, 196)">name</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;张三&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token literal-property property" style="color:rgb(128, 203, 196)">age</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">18</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token literal-property property" style="color:rgb(128, 203, 196)">job</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token literal-property property" style="color:rgb(128, 203, 196)">j1</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">          </span><span class="token literal-property property" style="color:rgb(128, 203, 196)">salary</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//情况一: 监视ref所定义的响应式数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// watch(sum, (nv, ov) =&gt; {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   //这里我并不需要this，所以剪头函数，普通函数我可以乱粥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   console.log(&#x27;sum的值发生变化了&#x27;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   console.log(`newValue:${nv}, oldValue:${ov}`);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// }, {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   //监视的配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   immediate: true //一上来就更新</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// });</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//情况二:监视ref所定义的多个响应式数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// watch([sum, msg], (nv, ov) =&gt; {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   //此时nv和ov都是被监视属性值的数组</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   // console.log(Array.isArray(ov)); //true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   console.log(&#x27;sum的值或者msg的值发生变化了&#x27;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   console.log(`newValue:${nv}, oldValue:${ov}`);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// },{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   immediate: true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// });</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">/**</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">     * 情况三:监视reactive所定义的一个响应式数据</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">     * 坑:1.此处无法获取正确的ov(oldValue)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">     *    2.强制开启了深度监视</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// watch(person, (nv, ov) =&gt; {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   console.log(&#x27;person变化了&#x27;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   console.log(nv, ov);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// }, {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   deep: false //此处的deep配置是无效的</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// });</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//情况四：监视reactive所定义的响应式中的某一个属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// watch(() =&gt; person.age, (nv, ov) =&gt; {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   console.log(&#x27;person的age变了&#x27;, nv, ov);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// })</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//情况五:监视reactive所定义的响应式中的某些属性:并不只是一个</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// watch([() =&gt; person.age, () =&gt; person.name], (nv, ov) =&gt; {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   //此时nv和ov都是数组</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   console.log(&#x27;person的age或name发生改变了&#x27;,nv, ov);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// });</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//特殊情况</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// watch(() =&gt; person.job, (nv, ov) =&gt; {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   //这里依然无法拿到正确的ov，因为依然监视的是对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   console.log(&#x27;person的job信息发生改变了&#x27;,nv, ov);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// }, {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   //这里必须要加deep:true注意</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//   deep: true //此处因为监视的是reactive所定义的响应式对象的一个属性(这个属性的值它依然是一个对象)，所以deep配置有效</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">// })</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//返回一个对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      sum</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      msg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      person</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">script</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">style</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token operator" style="color:rgb(127, 219, 202)">/</span><span class="token plain">style</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="关于value的问题">关于value的问题<a href="#关于value的问题" class="hash-link" aria-label="Direct link to 关于value的问题" title="Direct link to 关于value的问题">​</a></h5><div class="language-vue codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vue codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;h1&gt;当前求和为:{{ sum }}&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;button @click=&quot;sum++&quot;&gt;点我加一&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;hr/&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;h2&gt;当前的信息为:{{ msg }}&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;button @click=&quot;msg += &#x27;!&#x27;&quot;&gt;修改信息&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;hr/&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;h2&gt;姓名:{{ person.name }}&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;h2&gt;年龄:{{ person.age }}&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;h2&gt;薪资:{{ person.job.j1.salary }}K&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;person.name = person.name + &#x27;~&#x27;&quot;&gt;修改姓名&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;person.age++&quot;&gt;增长年龄&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;person.job.j1.salary++&quot;&gt;增长薪资&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">import {ref, watch} from &#x27;vue&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">export default {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  name: &#x27;Demo&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  setup(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let sum = ref(0);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let msg = ref(&#x27;你好&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let person = ref({</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      name: &#x27;张三&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      age: 18,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      job:{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        j1:{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">          salary: 20</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //监测的不是一个值，而是一个保存值的结构(不能写成sum.value) 不能监视一个具体的值注意</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    watch(sum, (nv, ov) =&gt; {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">       console.log(nv, ov);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(person);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //person是RefImpl</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //开启深度监视不会存在问题</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // watch(person, (nv, ov) =&gt; {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //   console.log(nv, ov);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // },{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //   deep: true</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //这里如果不是person.value则会出现问题 因为person是一个RefImpl(默认没开启深度监视)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //但是person.value是一个借助了proxy生成的reactive响应式对象 所以这里可以解决问题</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //使用person.value监视就不是ref的，而是reactive定义的</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // watch(person.value, (nv, ov) =&gt; {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //   console.log(nv, ov);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(sum);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(msg);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(person);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //返回一个对象</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      sum,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      msg,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      person</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3watcheffect函数">3.watchEffect函数<a href="#3watcheffect函数" class="hash-link" aria-label="Direct link to 3.watchEffect函数" title="Direct link to 3.watchEffect函数">​</a></h3><ul><li>watch的套路是：既要指明监视的属性，也要指明监视的回调。 </li><li>watchEffect的套路是：不用指明监视哪个属性，<strong>监视的回调中用到哪个属性，那就监视哪个属性。</strong> </li><li>watchEffect有点像computed： <ul><li>但computed注重的计算出来的值（回调函数的返回值），所以必须要写返回值。</li><li>而watchEffect更注重的是过程（回调函数的函数体），所以不用写返回值。</li></ul></li></ul><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//watchEffect所指定的回调中用到的数据只要发生变化，则直接重新执行回调。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//一上来就会执行回调</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">watchEffect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> x1 </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> sum</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> x2 </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">age</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;watchEffect配置的回调执行了&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> res </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">watchEffect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token spread operator" style="color:rgb(127, 219, 202)">...</span><span class="token plain">详细代码</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">res</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//这样可以停止监听。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="8生命周期">8.生命周期<a href="#8生命周期" class="hash-link" aria-label="Direct link to 8.生命周期" title="Direct link to 8.生命周期">​</a></h2><p><strong>vue2.x的生命周期（左）</strong>
<img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/png/26296167/1661957096740-2859e4de-84a6-46cc-9570-2f4dbd49ba4e.png#clientId=u90633ae4-96d4-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=699&amp;id=u9c52b516&amp;name=image.png&amp;originHeight=3039&amp;originWidth=1200&amp;originalType=url&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=223114&amp;status=done&amp;style=none&amp;taskId=u2661f342-45c7-4c71-885e-1b78841cf34&amp;title=&amp;width=276" alt="image.png" class="img_ev3q"><img loading="lazy" src="https://v3.cn.vuejs.org/images/lifecycle.svg#clientId=u90633ae4-96d4-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=701&amp;id=Oxw0Y&amp;originHeight=1388&amp;originWidth=840&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;taskId=uf856fc32-7b42-4223-98f2-fd6c9dacf6d&amp;title=&amp;width=424" class="img_ev3q"></p><p>1</p><ul><li>Vue3.0中可以继续使用Vue2.x中的生命周期钩子，但有有两个被更名： <ul><li><code>beforeDestroy</code>改名为 <code>beforeUnmount</code></li><li><code>destroyed</code>改名为 <code>unmounted</code></li></ul></li><li>Vue3.0也提供了 Composition API 形式的生命周期钩子，与Vue2.x中钩子对应关系如下： <ul><li><code>beforeCreate</code>===&gt;<code>setup()</code></li><li><code>created</code>=======&gt;<code>setup()</code></li><li><code>beforeMount</code> ===&gt;<code>onBeforeMount</code></li><li><code>mounted</code>=======&gt;<code>onMounted</code></li><li><code>beforeUpdate</code>===&gt;<code>onBeforeUpdate</code></li><li><code>updated</code> =======&gt;<code>onUpdated</code></li><li><code>beforeUnmount</code> ==&gt;<code>onBeforeUnmount</code></li><li><code>unmounted</code> =====&gt;<code>onUnmounted</code></li></ul></li></ul><div class="language-vue codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vue codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;h1&gt;当前求和为:{{ sum }}&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;button @click=&quot;sum++&quot;&gt;点我加一&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;hr/&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">import { ref, onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted } from &#x27;vue&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">export default {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  name: &#x27;Demo&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  setup(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let sum = ref(0);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //通过组合式api的形式去使用生命周期钩子</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    ///setup()相当于beforeCreate()和created()</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    onBeforeMount(() =&gt; {  console.log(&#x27;----beforeMount----&#x27;); });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    onMounted(() =&gt; {  console.log(&#x27;-----mounted-----&#x27;); });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    onBeforeUpdate(() =&gt; {  console.log(&#x27;-----beforeUpdate-----&#x27;) });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    onUpdated(() =&gt; { console.log(&#x27;-----updated-----&#x27;); });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    onBeforeUnmount(() =&gt; { console.log(&#x27;-----beforeUnmount----&#x27;); });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    onUnmounted(() =&gt; { console.log(&#x27;-----unmounted----&#x27;); })</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(&#x27;-----setup----&#x27;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //返回一个对象</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      sum,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //使用配置项的形式使用生命周期钩子</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // beforeCreate() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //   console.log(&#x27;----beforeCreate!!----&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // created() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //   console.log(&#x27;----created!!----&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // beforeMount() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //   console.log(&#x27;----beforeMount----&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // mounted() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //   console.log(&#x27;-----mounted-----&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // beforeUpdate() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //   console.log(&#x27;-----beforeUpdate-----&#x27;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // updated() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //   console.log(&#x27;-----updated-----&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // beforeUnmount() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //   console.log(&#x27;-----beforeUnmount----&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // unmounted() {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  //   console.log(&#x27;-----unmounted----&#x27;);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  // }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="9自定义hook函数">9.自定义hook函数<a href="#9自定义hook函数" class="hash-link" aria-label="Direct link to 9.自定义hook函数" title="Direct link to 9.自定义hook函数">​</a></h2><ul><li>什么是hook？—— 本质是一个函数，把setup函数中使用的Composition API进行了封装。 </li><li>类似于vue2.x中的mixin。 </li><li>自定义hook的优势: 复用代码, 让setup中的逻辑更清楚易懂。 </li></ul><p><code>/hooks/usePoint.js</code></p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">///得到鼠标点的api</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword module" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> reactive</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> onMounted</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> onBeforeUnmount </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;vue&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword module" style="color:rgb(127, 219, 202)">export</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(127, 219, 202)">default</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">usePoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//响应式数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">let</span><span class="token plain"> point </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">reactive</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token literal-property property" style="color:rgb(128, 203, 196)">x</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token literal-property property" style="color:rgb(128, 203, 196)">y</span><span class="token operator" style="color:rgb(127, 219, 202)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//方法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">savePoint</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token parameter">event</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token console class-name" style="color:rgb(255, 203, 139)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">pageX</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">pageY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        point</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">x</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">pageX</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        point</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">y</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">pageY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//生命周期</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">onMounted</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token dom variable" style="color:rgb(214, 222, 235)">window</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">addEventListener</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;click&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> savePoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">onBeforeUnmount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(127, 219, 202)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">//在卸载之前取消事件的监听</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token dom variable" style="color:rgb(214, 222, 235)">window</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">removeEventListener</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;click&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> savePoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> point</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>/components/Demo.vue</code></p><div class="language-vue codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vue codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;h1&gt;当前求和为:{{ sum }}&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;button @click=&quot;sum++&quot;&gt;点我加一&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;hr/&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">   &lt;h2&gt;当前点击时鼠标的坐标为x:{{ point.x }}, y:{{ point.y }}&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">import {ref} from &#x27;vue&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">import usePoint from &quot;../hooks/usePoint&quot;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">export default {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  name: &#x27;Demo&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  setup(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let sum = ref(0);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //复用自定义hooks</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    const point = usePoint();</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //返回一个对象</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      sum,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      point</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      //或者...usePoint()</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="10toref">10.toRef<a href="#10toref" class="hash-link" aria-label="Direct link to 10.toRef" title="Direct link to 10.toRef">​</a></h2><ul><li>作用：创建一个 ref 对象，其value值指向另一个对象中的某个属性。</li><li>语法：<code>const name = toRef(person,&#x27;name&#x27;)</code> </li><li>应用:   <strong>要将响应式对象中的某个属性单独提供给外部使用时</strong>。 </li><li>扩展：<code>toRefs</code> 与<code>toRef</code>功能一致，但可以批量创建多个 ref 对象，语法：<code>toRefs(person)</code> </li></ul><div class="language-vue codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vue codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h4&gt;{{ person }}&lt;/h4&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h2&gt;姓名:{{ name }}&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h2&gt;年龄:{{ age }}&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;h2&gt;薪资:{{ salary }}K&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;name = name + &#x27;~&#x27;&quot;&gt;修改姓名&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;age++&quot;&gt;增长年龄&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  &lt;button @click=&quot;salary++&quot;&gt;增长薪资&lt;/button&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/template&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">import { ref, reactive, toRef, toRefs} from &#x27;vue&#x27;;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">export default {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  name: &#x27;Demo&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  setup(){</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    let person = reactive({</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      name: &#x27;张三&#x27;,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      age: 18,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      job:{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        j1:{</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">          salary: 20</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //ref类型的值在模板里使用是不需要.value来取的</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    const name1 = person.name //注意输出字符串，并不是响应式的数据</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(&#x27;@@@@@&#x27;, name1);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    const name2 = toRef(person,name); //RefImpl 这里的name2与person.name是完全一模一样的(你改这里的name2与你改person.name是一码事),且数据还是响应式的</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(&#x27;####&#x27;, name2);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    const x = toRefs(person);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    console.log(x);</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //返回一个对象(toRef是引用 name就是person.name且为响应式)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //toRef处理一个，而toRefs处理一群</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //大白话:toRef(s)就是方便我们把响应式数据(ref,reactive)展开丢出去，方便在模版中应用</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      person,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      // name: toRef(person, &quot;name&quot;),</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      // age: toRef(person, &quot;age&quot;),</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      // salary: toRef(person.job.j1, &quot;salary&quot;)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      ...toRefs(person),</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      salary: toRef(person.job.j1, &#x27;salary&#x27;)  //toRef可以与toRefs连用,更加方便</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //注意千万不能这样写</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //一旦这样写就与元数据分离了,改name不会引起person.name的变化(因为ref把name值包装成了一个refImpl对象)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // return {</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //   person,</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //   name: ref(person.name),</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //   age: ref(person.age),</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    //   salary: ref(person.job.j1.salary)</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    // };</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">}</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/script&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">&lt;/style&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11torefs">11.toRefs<a href="#11torefs" class="hash-link" aria-label="Direct link to 11.toRefs" title="Direct link to 11.toRefs">​</a></h2><p>就是我们使用的时候不用再去...了，可以直接丢给外层，输入对象的属性名就行了。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/vue3/3.常用 Composition API.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/vue3/Composition API的优势"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Composition API的优势</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/vue3/其他Composition API"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">其他Composition API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1拉开序幕的setup" class="table-of-contents__link toc-highlight">1.拉开序幕的setup</a></li><li><a href="#2ref函数" class="table-of-contents__link toc-highlight">2.ref函数</a></li><li><a href="#3reactive函数" class="table-of-contents__link toc-highlight">3.reactive函数</a></li><li><a href="#4vue30中的响应式原理" class="table-of-contents__link toc-highlight">4.Vue3.0中的响应式原理</a><ul><li><a href="#vue2x的响应式" class="table-of-contents__link toc-highlight">vue2.x的响应式</a></li><li><a href="#vue30的响应式" class="table-of-contents__link toc-highlight">Vue3.0的响应式</a></li></ul></li><li><a href="#5reactive对比ref" class="table-of-contents__link toc-highlight">5.reactive对比ref</a></li><li><a href="#6setup的两个注意点" class="table-of-contents__link toc-highlight">6.setup的两个注意点</a></li><li><a href="#7计算属性与监视" class="table-of-contents__link toc-highlight">7.计算属性与监视</a><ul><li><a href="#1computed函数" class="table-of-contents__link toc-highlight">1.computed函数</a></li><li><a href="#2watch函数" class="table-of-contents__link toc-highlight">2.watch函数</a></li><li><a href="#3watcheffect函数" class="table-of-contents__link toc-highlight">3.watchEffect函数</a></li></ul></li><li><a href="#8生命周期" class="table-of-contents__link toc-highlight">8.生命周期</a></li><li><a href="#9自定义hook函数" class="table-of-contents__link toc-highlight">9.自定义hook函数</a></li><li><a href="#10toref" class="table-of-contents__link toc-highlight">10.toRef</a></li><li><a href="#11torefs" class="table-of-contents__link toc-highlight">11.toRefs</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.7ff54316.js"></script>
<script src="/assets/js/main.479c9106.js"></script>
</body>
</html>