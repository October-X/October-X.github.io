"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6374],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>g});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var o=a.createContext({}),s=function(e){var n=a.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=s(e.components);return a.createElement(o.Provider,{value:n},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,l=e.originalType,o=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),d=s(t),m=r,g=d["".concat(o,".").concat(m)]||d[m]||c[m]||l;return t?a.createElement(g,i(i({ref:n},u),{},{components:t})):a.createElement(g,i({ref:n},u))}));function g(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=t.length,i=new Array(l);i[0]=m;var p={};for(var o in n)hasOwnProperty.call(n,o)&&(p[o]=n[o]);p.originalType=e,p[d]="string"==typeof e?e:r,i[1]=p;for(var s=2;s<l;s++)i[s]=t[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},2159:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>p,toc:()=>s});var a=t(7462),r=(t(7294),t(3905));const l={},i="1. SpringCloud",p={unversionedId:"Java/\u6846\u67b6\u6269\u5c55/SpringCloud",id:"Java/\u6846\u67b6\u6269\u5c55/SpringCloud",title:"1. SpringCloud",description:"\u4ecb\u7ecd\uff1a\u8bfe\u7a0b\u4ecb\u7ecd",source:"@site/docs/Java/8.\u6846\u67b6\u6269\u5c55/1. SpringCloud.md",sourceDirName:"Java/8.\u6846\u67b6\u6269\u5c55",slug:"/Java/\u6846\u67b6\u6269\u5c55/SpringCloud",permalink:"/docs/Java/\u6846\u67b6\u6269\u5c55/SpringCloud",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Java/8.\u6846\u67b6\u6269\u5c55/1. SpringCloud.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"Java",previous:{title:"3.4 kafka\u9ad8\u7ea7",permalink:"/docs/Java/\u4e2d\u95f4\u4ef6/3.4 kafka\u9ad8\u7ea7"},next:{title:"2. SpringCloud Alibaba",permalink:"/docs/Java/\u6846\u67b6\u6269\u5c55/SpringCloud Alibaba"}},o={},s=[{value:"\u4ecb\u7ecd\uff1a\u8bfe\u7a0b\u4ecb\u7ecd",id:"\u4ecb\u7ecd\u8bfe\u7a0b\u4ecb\u7ecd",level:2},{value:"1\u3001\u524d\u7f6e",id:"1\u524d\u7f6e",level:3},{value:"2\u3001\u7279\u70b9",id:"2\u7279\u70b9",level:3},{value:"3\u3001\u5982\u4f55\u5b66\u4e60",id:"3\u5982\u4f55\u5b66\u4e60",level:3},{value:"4\u3001\u9762\u5411\u4eba\u5458",id:"4\u9762\u5411\u4eba\u5458",level:3},{value:"5\u3001\u5fc3\u6001",id:"5\u5fc3\u6001",level:3},{value:"6\u3001\u83b7\u53d6\u8d44\u6599",id:"6\u83b7\u53d6\u8d44\u6599",level:3},{value:"\u7b2c\u4e00\u7ae0 SpringCloud\u7b80\u4ecb",id:"\u7b2c\u4e00\u7ae0-springcloud\u7b80\u4ecb",level:2},{value:"\u4e00\u3001 \u8f6f\u4ef6\u67b6\u6784\u6f14\u8fdb",id:"\u4e00-\u8f6f\u4ef6\u67b6\u6784\u6f14\u8fdb",level:3},{value:"\u4e8c\u3001\u5fae\u670d\u52a1\u67b6\u6784",id:"\u4e8c\u5fae\u670d\u52a1\u67b6\u6784",level:3},{value:"1\u3001 \u5fae\u670d\u52a1\u7406\u5ff5",id:"1-\u5fae\u670d\u52a1\u7406\u5ff5",level:4},{value:"2\u3001 \u73b0\u5728\u5927\u578b\u4e92\u8054\u7f51\u516c\u53f8\uff0c\u90fd\u5728\u4f7f\u7528\u5fae\u670d\u52a1\u67b6\u6784\uff1a",id:"2-\u73b0\u5728\u5927\u578b\u4e92\u8054\u7f51\u516c\u53f8\u90fd\u5728\u4f7f\u7528\u5fae\u670d\u52a1\u67b6\u6784",level:4},{value:"3\u3001 springcloud\u7ec4\u4ef6\uff1a",id:"3-springcloud\u7ec4\u4ef6",level:4},{value:"\u7b2c\u4e8c\u7ae0 \u8d70\u8fdbspringcloud",id:"\u7b2c\u4e8c\u7ae0-\u8d70\u8fdbspringcloud",level:2},{value:"\u4e00\u3001\u4e86\u89e3springcloud",id:"\u4e00\u4e86\u89e3springcloud",level:3},{value:"\u4e8c\u3001 cloud\u4e0eboot\u7248\u672c\u5bf9\u5e94\u5173\u7cfb",id:"\u4e8c-cloud\u4e0eboot\u7248\u672c\u5bf9\u5e94\u5173\u7cfb",level:3},{value:"\u4e09\u3001 dubbo\u5bf9\u6bd4",id:"\u4e09-dubbo\u5bf9\u6bd4",level:3},{value:"\u7b2c\u4e09\u7ae0 \u505c\u66f4/\u5347\u7ea7/\u66ff\u6362",id:"\u7b2c\u4e09\u7ae0-\u505c\u66f4\u5347\u7ea7\u66ff\u6362",level:2},{value:"\u7b2c\u56db\u7ae0 \u5fae\u670d\u52a1\u67b6\u6784\u7f16\u7801\u6784\u5efa",id:"\u7b2c\u56db\u7ae0-\u5fae\u670d\u52a1\u67b6\u6784\u7f16\u7801\u6784\u5efa",level:2},{value:"\u4e00\u3001 \u642d\u5efa Provider \u548c Consumer \u670d\u52a1",id:"\u4e00-\u642d\u5efa-provider-\u548c-consumer-\u670d\u52a1",level:3},{value:"1\u3001\u7236\u5de5\u7a0b spring-cloud-parent",id:"1\u7236\u5de5\u7a0b-spring-cloud-parent",level:4},{value:"2\u3001\u63d0\u4f9b\u8005 eureka-provider",id:"2\u63d0\u4f9b\u8005-eureka-provider",level:4},{value:"3\u3001\u6d88\u8d39\u8005 eureka-consumer",id:"3\u6d88\u8d39\u8005-eureka-consumer",level:4},{value:"\u4e8c\u3001\u4f7f\u7528 RestTemplate \u5b8c\u6210\u8fdc\u7a0b\u8c03\u7528",id:"\u4e8c\u4f7f\u7528-resttemplate-\u5b8c\u6210\u8fdc\u7a0b\u8c03\u7528",level:3},{value:"\u7b2c\u4e94\u7ae0 Eureka\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0",id:"\u7b2c\u4e94\u7ae0-eureka\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0",level:2},{value:"\u4e00\u3001Eureka",id:"\u4e00eureka",level:3},{value:"\u4e8c\u3001 \u642d\u5efa Eureka Server \u670d\u52a1",id:"\u4e8c-\u642d\u5efa-eureka-server-\u670d\u52a1",level:3},{value:"\u4e09\u3001 \u6539\u9020 Provider \u548c Consumer \u79f0\u4e3a Eureka Client",id:"\u4e09-\u6539\u9020-provider-\u548c-consumer-\u79f0\u4e3a-eureka-client",level:3},{value:"\u56db\u3001 Consumer \u670d\u52a1 \u901a\u8fc7\u4ece Eureka Server \u4e2d\u6293\u53d6 Provider \u5730\u5740\uff0c\u5b8c\u6210\u8fdc\u7a0b\u8c03\u7528",id:"\u56db-consumer-\u670d\u52a1-\u901a\u8fc7\u4ece-eureka-server-\u4e2d\u6293\u53d6-provider-\u5730\u5740\u5b8c\u6210\u8fdc\u7a0b\u8c03\u7528",level:3},{value:"\u4e94\u3001 Euraka\u914d\u7f6e\u8be6\u89e3",id:"\u4e94-euraka\u914d\u7f6e\u8be6\u89e3",level:3},{value:"1\u3001\u5b9e\u4f8b\u4fe1\u606f\u914d\u7f6e",id:"1\u5b9e\u4f8b\u4fe1\u606f\u914d\u7f6e",level:4},{value:"2\u3001\u5ba2\u6237\u7aef\u7279\u6027\u914d\u7f6e",id:"2\u5ba2\u6237\u7aef\u7279\u6027\u914d\u7f6e",level:4},{value:"3\u3001\u6ce8\u518c\u4e2d\u5fc3\u7aef\u914d\u7f6e",id:"3\u6ce8\u518c\u4e2d\u5fc3\u7aef\u914d\u7f6e",level:4},{value:"4\u3001\u4eea\u8868\u76d8\u914d\u7f6e",id:"4\u4eea\u8868\u76d8\u914d\u7f6e",level:4},{value:"\u516d\u3001\u9ad8\u53ef\u7528",id:"\u516d\u9ad8\u53ef\u7528",level:3},{value:"\u7b2c\u516d\u7ae0 Zookeeper\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0",id:"\u7b2c\u516d\u7ae0-zookeeper\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0",level:2},{value:"\u7b2c\u4e03\u7ae0 Consul\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0",id:"\u7b2c\u4e03\u7ae0-consul\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0",level:2},{value:"\u4e00\u3001 \u662f\u4ec0\u4e48\uff1a",id:"\u4e00-\u662f\u4ec0\u4e48",level:3},{value:"\u4e8c\u3001 \u600e\u4e48\u7528\uff1a",id:"\u4e8c-\u600e\u4e48\u7528",level:3},{value:"1\u3001 \u51c6\u5907",id:"1-\u51c6\u5907",level:4},{value:"2\u3001 \u642d\u5efa consul-provider",id:"2-\u642d\u5efa-consul-provider",level:4},{value:"3\u3001\u642d\u5efa consul-consumer",id:"3\u642d\u5efa-consul-consumer",level:4},{value:"\u4e09\u3001 \u4e09\u4e2a\u6ce8\u518c\u4e2d\u5fc3\u7684\u5f02\u540c",id:"\u4e09-\u4e09\u4e2a\u6ce8\u518c\u4e2d\u5fc3\u7684\u5f02\u540c",level:3},{value:"\u7b2c\u516b\u7ae0 Ribbon\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u8c03\u7528",id:"\u7b2c\u516b\u7ae0-ribbon\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u8c03\u7528",level:2},{value:"\u4e00\u3001\u662f\u4ec0\u4e48",id:"\u4e00\u662f\u4ec0\u4e48",level:3},{value:"1\u3001\u670d\u52a1\u7aef\u8d1f\u8f7d\u5747\u8861",id:"1\u670d\u52a1\u7aef\u8d1f\u8f7d\u5747\u8861",level:4},{value:"2\u3001\u5ba2\u6237\u7aef\u8d1f\u8f7d\u5747\u8861",id:"2\u5ba2\u6237\u7aef\u8d1f\u8f7d\u5747\u8861",level:4},{value:"\u4e8c\u3001\u5982\u4f55\u4f7f\u7528",id:"\u4e8c\u5982\u4f55\u4f7f\u7528",level:3},{value:"\u4e09\u3001ribbon \u8d1f\u8f7d\u5747\u8861\u7b56\u7565",id:"\u4e09ribbon-\u8d1f\u8f7d\u5747\u8861\u7b56\u7565",level:3},{value:"\u56db\u3001 \u8bbe\u7f6eribbon \u8d1f\u8f7d\u5747\u8861\u7b56\u7565",id:"\u56db-\u8bbe\u7f6eribbon-\u8d1f\u8f7d\u5747\u8861\u7b56\u7565",level:3},{value:"1\u3001\u4ee3\u7801",id:"1\u4ee3\u7801",level:4},{value:"2\u3001\u914d\u7f6e",id:"2\u914d\u7f6e",level:4},{value:"\u7b2c\u4e5d\u7ae0\u3001OpenFeign\u670d\u52a1\u63a5\u53e3\u8c03\u7528",id:"\u7b2c\u4e5d\u7ae0openfeign\u670d\u52a1\u63a5\u53e3\u8c03\u7528",level:2},{value:"\u4e00\u3001\u6982\u8ff0",id:"\u4e00\u6982\u8ff0",level:3},{value:"\u4e8c\u3001\u5feb\u901f\u5165\u95e8",id:"\u4e8c\u5feb\u901f\u5165\u95e8",level:3},{value:"\u4e09\u3001\u5176\u4ed6\u8bbe\u7f6e",id:"\u4e09\u5176\u4ed6\u8bbe\u7f6e",level:3},{value:"1\u3001\u8d85\u65f6\u8bbe\u7f6e",id:"1\u8d85\u65f6\u8bbe\u7f6e",level:4},{value:"2\u3001\u65e5\u5fd7\u8bb0\u5f55",id:"2\u65e5\u5fd7\u8bb0\u5f55",level:4},{value:"image-20220408182551922",id:"image-20220408182551922",level:2},{value:"\u7b2c\u5341\u7ae0 Hystrix\u65ad\u8def\u5668 \uff08\u8c6a\u732a\uff09-\u4fdd\u9669\u4e1d",id:"\u7b2c\u5341\u7ae0-hystrix\u65ad\u8def\u5668-\u8c6a\u732a-\u4fdd\u9669\u4e1d",level:2},{value:"\u4e00\u3001\u6982\u8ff0",id:"\u4e00\u6982\u8ff0-1",level:3},{value:"\u4e8c\u3001\u670d\u52a1\u964d\u7ea7",id:"\u4e8c\u670d\u52a1\u964d\u7ea7",level:3},{value:"\u4e09\u3001\u7194\u65ad",id:"\u4e09\u7194\u65ad",level:3},{value:"\u56db\u3001\u7194\u65ad\u76d1\u63a7**-\u8fd0\u7ef4",id:"\u56db\u7194\u65ad\u76d1\u63a7-\u8fd0\u7ef4",level:3},{value:"1\u3001\u642d\u5efa\u76d1\u63a7\u6a21\u5757",id:"1\u642d\u5efa\u76d1\u63a7\u6a21\u5757",level:4},{value:"2\u3001\u4fee\u6539\u88ab\u76d1\u63a7\u6a21\u5757",id:"2\u4fee\u6539\u88ab\u76d1\u63a7\u6a21\u5757",level:4},{value:"3\u3001\u542f\u52a8\u6d4b\u8bd5",id:"3\u542f\u52a8\u6d4b\u8bd5",level:4},{value:"\u7b2c\u5341\u4e00\u7ae0\u3001zuul\u8def\u7531\u7f51\u5173",id:"\u7b2c\u5341\u4e00\u7ae0zuul\u8def\u7531\u7f51\u5173",level:2},{value:"\u7b2c\u5341\u4e8c\u7ae0 Gateway\u65b0\u4e00\u4ee3\u7f51\u5173",id:"\u7b2c\u5341\u4e8c\u7ae0-gateway\u65b0\u4e00\u4ee3\u7f51\u5173",level:2},{value:"\u4e00\u3001 <strong>\u6982\u8ff0</strong>",id:"\u4e00-\u6982\u8ff0",level:3},{value:"\u4e8c\u3001 <strong>\u5feb\u901f\u5165\u95e8</strong>",id:"\u4e8c-\u5feb\u901f\u5165\u95e8",level:3},{value:"\u4e09\u3001 <strong>\u9759\u6001\u8def\u7531</strong>",id:"\u4e09-\u9759\u6001\u8def\u7531",level:3},{value:"\u56db\u3001<strong>\u52a8\u6001\u8def\u7531</strong>",id:"\u56db\u52a8\u6001\u8def\u7531",level:3},{value:"1\u3001\u5f15\u5165eureka-client\u914d\u7f6e",id:"1\u5f15\u5165eureka-client\u914d\u7f6e",level:4},{value:"2\u3001\u4fee\u6539uri\u5c5e\u6027\uff1auri: lb://\u670d\u52a1\u540d\u79f0",id:"2\u4fee\u6539uri\u5c5e\u6027uri-lb\u670d\u52a1\u540d\u79f0",level:4},{value:"\u4e94\u3001\u5fae\u670d\u52a1\u540d\u79f0\u914d\u7f6e**",id:"\u4e94\u5fae\u670d\u52a1\u540d\u79f0\u914d\u7f6e",level:3},{value:"\u516d\u3001\u8fc7\u6ee4\u5668",id:"\u516d\u8fc7\u6ee4\u5668",level:3},{value:"\u81ea\u5b9a\u4e49\u8fc7\u6ee4\u5668",id:"\u81ea\u5b9a\u4e49\u8fc7\u6ee4\u5668",level:4},{value:"\u7b2c\u5341\u4e09\u7ae0 \u5206\u5e03\u5f0f\u914d\u7f6e\u4e2d\u5fc3",id:"\u7b2c\u5341\u4e09\u7ae0-\u5206\u5e03\u5f0f\u914d\u7f6e\u4e2d\u5fc3",level:2},{value:"\u4e00\u3001Config \u6982\u8ff0",id:"\u4e00config-\u6982\u8ff0",level:3},{value:"\u4e8c\u3001Config \u5feb\u901f\u5165\u95e8",id:"\u4e8cconfig-\u5feb\u901f\u5165\u95e8",level:3},{value:"\u4e09\u3001Config \u96c6\u6210Eureka",id:"\u4e09config-\u96c6\u6210eureka",level:3},{value:"\u7b2c\u5341\u56db\u7ae0 SpringCloud Bus\u6d88\u606f\u603b\u7ebf",id:"\u7b2c\u5341\u56db\u7ae0-springcloud-bus\u6d88\u606f\u603b\u7ebf",level:2},{value:"\u4e00\u3001Bus \u6982\u8ff0",id:"\u4e00bus-\u6982\u8ff0",level:3},{value:"\u4e8c\u3001RabbitMQ \u56de\u987e",id:"\u4e8crabbitmq-\u56de\u987e",level:3},{value:"\u4e09\u3001Bus \u5feb\u901f\u5165\u95e8-\u8fd0\u7ef4",id:"\u4e09bus-\u5feb\u901f\u5165\u95e8-\u8fd0\u7ef4",level:3},{value:"\u7b2c\u5341\u4e94\u7ae0 SpringCloud Stream\u6d88\u606f\u9a71\u52a8",id:"\u7b2c\u5341\u4e94\u7ae0-springcloud-stream\u6d88\u606f\u9a71\u52a8",level:2},{value:"\u4e00\u3001Stream \u6982\u8ff0",id:"\u4e00stream-\u6982\u8ff0",level:3},{value:"\u4e8c\u3001Stream \u6d88\u606f\u751f\u4ea7\u8005",id:"\u4e8cstream-\u6d88\u606f\u751f\u4ea7\u8005",level:3},{value:"\u4e09\u3001Stream \u6d88\u606f\u6d88\u8d39\u8005",id:"\u4e09stream-\u6d88\u606f\u6d88\u8d39\u8005",level:3},{value:"\u7b2c\u5341\u516d\u7ae0 SpringCloud Sleuth\u5206\u5e03\u5f0f\u8bf7\u6c42\u94fe\u8def\u8ffd\u8e2a",id:"\u7b2c\u5341\u516d\u7ae0-springcloud-sleuth\u5206\u5e03\u5f0f\u8bf7\u6c42\u94fe\u8def\u8ffd\u8e2a",level:2},{value:"\u4e00\u3001\u6982\u8ff0",id:"\u4e00\u6982\u8ff0-2",level:3},{value:"\u4e8c\u3001\u5feb\u901f\u5165\u95e8",id:"\u4e8c\u5feb\u901f\u5165\u95e8-1",level:3}],u={toc:s};function d(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"1-springcloud"},"1. SpringCloud"),(0,r.kt)("h2",{id:"\u4ecb\u7ecd\u8bfe\u7a0b\u4ecb\u7ecd"},"\u4ecb\u7ecd\uff1a\u8bfe\u7a0b\u4ecb\u7ecd"),(0,r.kt)("h3",{id:"1\u524d\u7f6e"},"1\u3001\u524d\u7f6e"),(0,r.kt)("p",null," javaSE,javaEE,SSM,Boot"),(0,r.kt)("p",null," \u4e3a\u4ec0\u4e48\uff1a\u4e00\u7ebf\u57ce\u5e02\uff0c\u4e0a\u4e86\u89c4\u6a21\u5927\u5382\u3001\u4e2d\u5382\uff0c\u90fd\u9700\u8981cloud\u3002"),(0,r.kt)("p",null," cloud,\u85aa\u8d44\u9ad8"),(0,r.kt)("h3",{id:"2\u7279\u70b9"},"2\u3001\u7279\u70b9"),(0,r.kt)("p",null," \u5404\u5927\u673a\u6784\u89c6\u9891\u6559\u7a0b\u3001\u7f51\u7edc\u6587\u7ae0\u3001spring\u5b98\u7f51\u4ee5\u53ca\u672c\u4eba8\u5e74\u7684java\u5f00\u53d1\u7ecf\u9a8c\u3002"),(0,r.kt)("p",null," \u8ddf\u7740\u672c\u8bfe\u7a0b\uff0c\u5199\u5c31\u53ef\u4ee5\u4e86\u3002"),(0,r.kt)("p",null," \u5165\u95e8\u8bfe\u7a0b\uff0c\u4f1a\u7528cloud\u3002"),(0,r.kt)("h3",{id:"3\u5982\u4f55\u5b66\u4e60"},"3\u3001\u5982\u4f55\u5b66\u4e60"),(0,r.kt)("p",null," \u4fdd\u59c6\u7ea7\u6559\u7a0b\u3002"),(0,r.kt)("p",null," \u4ee3\u7801\u548c\u8bfe\u7a0b\u56fe\u7247\u7c98\u8d34md\u683c\u5f0f\u7684\u6587\u6863\u4e0a\u9762\u3002"),(0,r.kt)("p",null," \u500d\u901f\u64ad\u653e\u3002\u5173\u95ed\u5f39\u5e55\u3002"),(0,r.kt)("p",null," \u5b66\u5b8c\u4e00\u4e2a\u77e5\u8bc6\u70b9\uff0c\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u5f39\u5e55\u3001\u8bc4\u8bba\u3001\u7c89\u4e1d\u7fa4\u5927\u5bb6\u8ba8\u8bba\u3002"),(0,r.kt)("h3",{id:"4\u9762\u5411\u4eba\u5458"},"4\u3001\u9762\u5411\u4eba\u5458"),(0,r.kt)("p",null," \u5927\u5b66\u751f\u670b\u53cb\uff1a\u5927\u5b66\u5f53\u4e2d\uff0c\u79d1\u73ed\u975e\u79d1\u73ed\uff0c\u6bd5\u4e1a\u627e\u4e00\u4efdjava\u5de5\u4f5c\uff0c\u6ca1\u95ee\u9898\u3002"),(0,r.kt)("p",null," \u5de5\u4f5c1-3\u5e74\u670b\u53cb\uff1a\u81ea\u5df1\u884c\u4e1a\u53c8\u7d2f\u85aa\u8d44\u53c8\u4f4e\u30024-6\u4e2a\u6708\uff0c\u575a\u6301\u4e0b\u6765\uff0c\u8f6c\u884c\u627e\u5230java\u5f00\u53d1\u804c\u4f4d\u6ca1\u95ee\u9898\u3002"),(0,r.kt)("h3",{id:"5\u5fc3\u6001"},"5\u3001\u5fc3\u6001"),(0,r.kt)("p",null," \u592a\u7b80\u5355\u4e86\u3001\u592a\u96be\u3002 \u6211\u4e0d\u662fRMB,\u505a\u4e0d\u523014\u4ebf\u4eba\u90fd\u559c\u6b22\u3002 \u53f3\u4e0a\u89d2\u6709\u4e2aX,\u70b9\u51fb\u4e00\u4e0b\u9000\u51fa\u53ef\u4ee5\u4e86\u3002"),(0,r.kt)("p",null," \u4e0d\u8981\u5403\u9971\u4e86\u9a82\u53a8\u5b50\u3001\u5ff5\u5b8c\u7ecf\u6253\u548c\u5c1a\u3001\u8fc7\u6cb3\u62c6\u6865\u3002"),(0,r.kt)("p",null," Talk is cheap ,show me the code \u3002 \u575a\u6301\u300230\u5c0f\u7ed3\u3002\u90fd\u770b\u5b8c\uff0c\u77e5\u8bc6\u5c31\u662f\u4f60\u7684\u4e86\u3002"),(0,r.kt)("p",null," \u6b22\u8fce\u5927\u5bb6\uff0c\u4e00\u952e\u4e09\u8fde\u3002"),(0,r.kt)("h3",{id:"6\u83b7\u53d6\u8d44\u6599"},"6\u3001\u83b7\u53d6\u8d44\u6599"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://www.ydlclass.com/"},"www.ydlclass.comopen in new window")," \u6587\u6863\u533a\uff0c\u514d\u8d39\u4e0b\u8f7d\u5373\u53ef\u3002"),(0,r.kt)("p",null,"\u6211",(0,r.kt)("strong",{parentName:"p"},"itlils"),"\u548c\u6960\u54e5",(0,r.kt)("strong",{parentName:"p"},"itnanls")," java\u5b66\u4e60\u6574\u5957\u8def\u5f84\uff0c\u5217\u51fa\u6765\u3002 ",(0,r.kt)("strong",{parentName:"p"},"\u6559\u7a0b\u90fd\u7531\u6211\u548c\u6960\u54e5\u4eb2\u81ea\u5f55\u5236"),"\u3002 \u514d\u8d39\u81ea\u5b66java\u6210\u529f\u3002"),(0,r.kt)("p",null,"\u6848\u4f8b\uff1a\u514d\u8d39\u81ea\u5b66\uff0cjava\u5de5\u4f5c\uff0c\u5e94\u5c4a\u751f\uff0c\u4e00\u7ebf\uff0c10k\u3002"),(0,r.kt)("p",null,"\u968f\u65f6\u4e00\u5bf9\u4e00\u89e3\u51b3\u95ee\u9898\uff0c\u89c4\u5212\uff0c\u7b80\u5386\u4fee\u6539\u3002\u52a0\u5165\u6211\u4eec\u4f1a\u5458\u3002"),(0,r.kt)("h2",{id:"\u7b2c\u4e00\u7ae0-springcloud\u7b80\u4ecb"},"\u7b2c\u4e00\u7ae0 SpringCloud\u7b80\u4ecb"),(0,r.kt)("h3",{id:"\u4e00-\u8f6f\u4ef6\u67b6\u6784\u6f14\u8fdb"},"\u4e00\u3001 \u8f6f\u4ef6\u67b6\u6784\u6f14\u8fdb"),(0,r.kt)("p",null,"\u5355\u4f53\u67b6\u6784"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220328172416767-61fb5e07.png",alt:"image-20220328172416767"}),"image-20220328172416767"),(0,r.kt)("p",null,"\u5782\u76f4\u67b6\u6784"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220328172721883-2d51c59e.png",alt:"image-20220328172721883"}),"image-20220328172721883"),(0,r.kt)("p",null,"\u5206\u5e03\u5f0f\u67b6\u6784"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220328173112642-b0ee1ce2.png",alt:"image-20220328173112642"}),"image-20220328173112642"),(0,r.kt)("p",null,"SOA\u67b6\u6784"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220328174118241-23f135ec.png",alt:"image-20220328174118241"}),"image-20220328174118241"),(0,r.kt)("p",null,"\u5fae\u670d\u52a1\u67b6\u6784"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220328174633493-6d3e8f1b.png",alt:"image-20220328174633493"}),"image-20220328174633493"),(0,r.kt)("h3",{id:"\u4e8c\u5fae\u670d\u52a1\u67b6\u6784"},"\u4e8c\u3001\u5fae\u670d\u52a1\u67b6\u6784"),(0,r.kt)("h4",{id:"1-\u5fae\u670d\u52a1\u7406\u5ff5"},"1\u3001 \u5fae\u670d\u52a1\u7406\u5ff5"),(0,r.kt)("p",null,'\u2460"\u5fae\u670d\u52a1\u201d\u4e00\u8bcd\u6e90 \u4e8e Martin Fowler\u7684\u540d\u4e3a Microservices\u7684\u535a\u6587,\u53ef\u4ee5\u5728\u4ed6\u7684\u5b98\u65b9\u535a\u5ba2\u4e0a\u627e\u5230',(0,r.kt)("a",{parentName:"p",href:"http://martinfowler.com/articles/microservices.html"},"http://martinfowler.com/articles/microservices.htmlopen in new window")),(0,r.kt)("p",null,"\u2461\u5fae\u670d\u52a1\u662f\u7cfb\u7edf\u67b6\u6784\u4e0a\u7684\u4e00\u79cd\u8bbe\u8ba1\u98ce\u683c,\u5b83\u7684\u4e3b\u65e8\u662f\u5c06\u4e00\u4e2a\u539f\u672c\u72ec\u7acb\u7684\u7cfb\u7edf\u62c6\u5206\u6210\u591a\u4e2a\u5c0f\u578b\u670d\u52a1,\u8fd9\u4e9b\u5c0f\u578b\u670d\u52a1\u90fd\u5728\u5404\u81ea\u72ec\u7acb\u7684\u8fdb\u7a0b\u4e2d\u8fd0\u884c,\u670d\u52a1\u4e4b\u95f4\u4e00\u822c\u901a\u8fc7 HTTP \u7684 RESTfuL API \u8fdb\u884c\u901a\u4fe1\u534f\u4f5c\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"restfull \u98ce\u683c"),"\uff1a\u6570\u636e\u7684\u589e\u5220\u6539\u67e5\uff0c\u4f7f\u7528http\u7684\u4e0d\u540c\u65b9\u5f0f\u3002\u6570\u636e\u4f20\u8f93\u7528json\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-http"},"    \u67e5\u8be2   GET ip:port/user/1\n\n    \u65b0\u589e   POST ip:port/user    json{username:itlils,age:18}\n\n    \u4fee\u6539   PUT ip:port/user/1  json{username:itlils,age:19}\n\n    \u5220\u9664  DELETE ip:port/user/1\n")),(0,r.kt)("p",null,"\u2462\u7531\u4e8e\u6709\u4e86\u8f7b\u91cf\u7ea7\u7684\u901a\u4fe1\u534f\u4f5c\u57fa\u7840,\u6240\u4ee5\u8fd9\u4e9b\u5fae\u670d\u52a1\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u8bed\u8a00\u6765\u7f16\u5199\u3002\u5927\u5382\uff0c\u5404\u79cd\u8bed\u8a00\u6df7\u7528\u3002"),(0,r.kt)("p",null,"cloud\u5b98\u7f51: ",(0,r.kt)("a",{parentName:"p",href:"https://spring.io/"},"https://spring.io/open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220329154419410-35fc4235.png",alt:"image-20220329154419410"}),"image-20220329154419410"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220329152020956-6168854b.png",alt:"image-20220329152020956"}),"image-20220329152020956"),(0,r.kt)("h4",{id:"2-\u73b0\u5728\u5927\u578b\u4e92\u8054\u7f51\u516c\u53f8\u90fd\u5728\u4f7f\u7528\u5fae\u670d\u52a1\u67b6\u6784"},"2\u3001 \u73b0\u5728\u5927\u578b\u4e92\u8054\u7f51\u516c\u53f8\uff0c\u90fd\u5728\u4f7f\u7528\u5fae\u670d\u52a1\u67b6\u6784\uff1a"),(0,r.kt)("p",null,"\u4eac\u4e1c\u7684\u4fc3\u9500\u8282\u67b6\u6784\uff1a618"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220329152531517-e9aa4638.png",alt:"image-20220329152531517"}),"image-20220329152531517"),(0,r.kt)("p",null,"\u963f\u91cc\u7684\u67b6\u6784\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220329152552588-ea1b80bc.png",alt:"image-20220329152552588"}),"image-20220329152552588"),(0,r.kt)("p",null,"\u4eac\u4e1c\u7269\u6d41\u7684\u67b6\u6784\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220329152611053-1bdac904.png",alt:"image-20220329152611053"}),"image-20220329152611053"),(0,r.kt)("h4",{id:"3-springcloud\u7ec4\u4ef6"},"3\u3001 springcloud\u7ec4\u4ef6\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220329152758773-9e65bcd2.png",alt:"image-20220329152758773"}),"image-20220329152758773"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220329153147800-c1b6698c.png",alt:"image-20220329153147800"}),"image-20220329153147800"),(0,r.kt)("h2",{id:"\u7b2c\u4e8c\u7ae0-\u8d70\u8fdbspringcloud"},"\u7b2c\u4e8c\u7ae0 \u8d70\u8fdbspringcloud"),(0,r.kt)("h3",{id:"\u4e00\u4e86\u89e3springcloud"},"\u4e00\u3001\u4e86\u89e3springcloud"),(0,r.kt)("p",null,"\u2460Spring Cloud \u662f",(0,r.kt)("strong",{parentName:"p"},"\u4e00\u7cfb\u5217\u6846\u67b6"),"\u7684\u6709\u5e8f\u96c6\u5408\u3002"),(0,r.kt)("p",null,"\u2461Spring Cloud \u5e76\u6ca1\u6709\u91cd\u590d\u5236\u9020\u8f6e\u5b50\uff0c\u5b83\u53ea\u662f\u5c06\u76ee\u524d\u5404\u5bb6\u516c\u53f8\u5f00\u53d1\u7684\u6bd4\u8f83\u6210\u719f\u3001\u7ecf\u5f97\u8d77\u5b9e\u9645\u8003\u9a8c\u7684\u670d\u52a1\u6846\u67b6\u7ec4\u5408\u8d77\u6765\u3002"),(0,r.kt)("p",null,"netflix eureka 1.1,alibaba 2.2"),(0,r.kt)("p",null,"\u2462\u901a\u8fc7 ",(0,r.kt)("strong",{parentName:"p"},"Spring Boot")," \u98ce\u683c\u8fdb\u884c\u518d\u5c01\u88c5,\u5c4f\u853d\u6389\u4e86\u590d\u6742\u7684\u914d\u7f6e\u548c\u5b9e\u73b0\u539f\u7406\uff0c\u6700\u7ec8\u7ed9\u5f00\u53d1\u8005\u7559\u51fa\u4e86\u4e00\u5957\u7b80\u5355\u6613\u61c2\u3001\u6613\u90e8\u7f72\u548c\u6613\u7ef4\u62a4\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u5f00\u53d1\u5de5\u5177\u5305\u3002"),(0,r.kt)("p",null,"\u2463\u5b83\u5229\u7528Spring Boot\u7684\u5f00\u53d1\u4fbf\u5229\u6027\u5de7\u5999\u5730\u7b80\u5316\u4e86\u5206\u5e03\u5f0f\u7cfb\u7edf\u57fa\u7840\u8bbe\u65bd\u7684\u5f00\u53d1\uff0c\u5982\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u3001\u914d\u7f6e\u4e2d\u5fc3\u3001\u6d88\u606f\u603b\u7ebf\u3001\u8d1f\u8f7d\u5747\u8861\u3001 \u65ad\u8def\u5668\u3001\u6570\u636e\u76d1\u63a7\u7b49\uff0c\u90fd\u53ef\u4ee5\u7528Spring Boot\u7684\u5f00\u53d1\u98ce\u683c\u505a\u5230\u4e00\u952e\u542f\u52a8\u548c\u90e8\u7f72\u3002"),(0,r.kt)("p",null,"\u2464Spring Cloud\u9879\u76ee\u5b98\u65b9\u7f51\u5740\uff1a",(0,r.kt)("a",{parentName:"p",href:"https://spring.io/projects/spring-cloud"},"https://spring.io/projects/spring-cloudopen in new window")),(0,r.kt)("p",null,"\u2465Spring Cloud \u7248\u672c\u547d\u540d\u65b9\u5f0f\u91c7\u7528\u4e86",(0,r.kt)("strong",{parentName:"p"},"\u4f26\u6566\u5730\u94c1\u7ad9\u7684\u540d\u79f0"),"\uff0c\u540c\u65f6\u6839\u636e\u5b57\u6bcd\u8868\u7684\u987a\u5e8f\u6765\u5bf9\u5e94\u7248\u672c\u65f6\u95f4\u987a\u5e8f\uff0c\u6bd4\u5982\uff1a\u6700\u65e9\u7684Release\u7248\u672c\uff1aAngel\uff0c\u7b2c\u4e8c\u4e2aRelease\u7248\u672c\uff1aBrixton\uff0c\u7136\u540e\u662fCamden\u3001Dalston\u3001Edgware\uff0cFinchley\uff0cGreenwich\uff0cHoxton\u3002"),(0,r.kt)("p",null,"\u76ee\u524d\u6700\u65b0\u7684\u662f2021.0.1\u7248\u672c\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220329161144299-73a4c7f1.png",alt:"image-20220329161144299"}),"image-20220329161144299"),(0,r.kt)("h3",{id:"\u4e8c-cloud\u4e0eboot\u7248\u672c\u5bf9\u5e94\u5173\u7cfb"},"\u4e8c\u3001 cloud\u4e0eboot\u7248\u672c\u5bf9\u5e94\u5173\u7cfb"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220329164540295-576a76f5.png",alt:"image-20220329164540295"}),"image-20220329164540295"),(0,r.kt)("h3",{id:"\u4e09-dubbo\u5bf9\u6bd4"},"\u4e09\u3001 dubbo\u5bf9\u6bd4"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220329161102849-d44ade71.png",alt:"image-20220329161102849"}),"image-20220329161102849"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u76f8\u540c\u70b9"),"\uff1aSpring Cloud \u4e0e Dubbo \u90fd\u662f\u5b9e\u73b0\u5fae\u670d\u52a1\u6709\u6548\u7684\u5de5\u5177\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4e0d\u540c\u70b9"),"\uff1a"),(0,r.kt)("p",null,"1Dubbo \u53ea\u662f\u5b9e\u73b0\u4e86\u670d\u52a1\u6cbb\u7406\uff0c\u800c Spring Cloud \u5b50\u9879\u76ee\u5206\u522b\u8986\u76d6\u4e86\u5fae\u670d\u52a1\u67b6\u6784\u4e0b\u7684\u4f17\u591a\u90e8\u4ef6\u3002"),(0,r.kt)("p",null,"2Dubbo \u4f7f\u7528 RPC \u901a\u8baf\u534f\u8bae\uff0cSpring Cloud \u4f7f\u7528 RESTful \u5b8c\u6210\u901a\u4fe1\uff0cDubbo \u6548\u7387\u7565\u9ad8\u4e8e Spring Cloud\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5c0f\u7ed3")),(0,r.kt)("p",null,"\u2022 \u5fae\u670d\u52a1\u5c31\u662f\u5c06\u9879\u76ee\u7684\u5404\u4e2a\u6a21\u5757\u62c6\u5206\u4e3a\u53ef\u72ec\u7acb\u8fd0\u884c\u3001\u90e8\u7f72\u3001\u6d4b\u8bd5\u7684\u67b6\u6784\u8bbe\u8ba1\u98ce\u683c\u3002"),(0,r.kt)("p",null,"\u2022 Spring \u516c\u53f8\u5c06\u5176\u4ed6\u516c\u53f8\u4e2d\u5fae\u670d\u52a1\u67b6\u6784\u5e38\u7528\u7684\u7ec4\u4ef6\u6574\u5408\u8d77\u6765\uff0c\u5e76\u4f7f\u7528 SpringBoot \u7b80\u5316\u5176\u5f00\u53d1\u3001\u914d\u7f6e\u3002\u79f0\u4e3a Spring Cloud\u3002"),(0,r.kt)("p",null,"\u2022 Spring Cloud \u4e0e Dubbo\u90fd\u662f\u5b9e\u73b0\u5fae\u670d\u52a1\u6709\u6548\u7684\u5de5\u5177\u3002Dubbo \u6027\u80fd\u66f4\u597d\uff0c\u800c Spring Cloud \u529f\u80fd\u66f4\u5168\u9762\u3002Dubbo \u5df2\u7ecf\u878d\u5165\u5230spingcloudAlibaba\u8fd9\u4e00\u5957"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u672c\u8bfe\u7a0b\u6280\u672f\u7279\u70b9"),"\uff1a \u4e24\u5957springcloud."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"5\u5e74\u524d\u7684\u9879\u76ee\u3002springcloud netflix(eureka config hystrix) hoxton\u3002\u4f1a\u8bb2\u5230\u3002")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u65b0\u9879\u76ee springcloud alibaba(nacos sentinel)\u3002\u4e5f\u4f1a\u8bb2\u5230\u3002"))),(0,r.kt)("h2",{id:"\u7b2c\u4e09\u7ae0-\u505c\u66f4\u5347\u7ea7\u66ff\u6362"},"\u7b2c\u4e09\u7ae0 \u505c\u66f4/\u5347\u7ea7/\u66ff\u6362"),(0,r.kt)("p",null,"\u7ea2\u8272\u4e0d\u7ef4\u62a4\u3002"),(0,r.kt)("p",null,"\u7eff\u8272\u662falibaba\u4e00\u5957\uff0c\u63a8\u8350\u4f7f\u7528\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220329171255668-cddd16e1.png",alt:"image-20220329171255668"}),"image-20220329171255668"),(0,r.kt)("h2",{id:"\u7b2c\u56db\u7ae0-\u5fae\u670d\u52a1\u67b6\u6784\u7f16\u7801\u6784\u5efa"},"\u7b2c\u56db\u7ae0 \u5fae\u670d\u52a1\u67b6\u6784\u7f16\u7801\u6784\u5efa"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220404103923982-85c56e15.png",alt:"image-20220404103923982"}),"image-20220404103923982"),(0,r.kt)("h3",{id:"\u4e00-\u642d\u5efa-provider-\u548c-consumer-\u670d\u52a1"},"\u4e00\u3001 \u642d\u5efa Provider \u548c Consumer \u670d\u52a1"),(0,r.kt)("h4",{id:"1\u7236\u5de5\u7a0b-spring-cloud-parent"},"1\u3001\u7236\u5de5\u7a0b spring-cloud-parent"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220404103149867-f3234ca1.png",alt:"image-20220404103149867"}),"image-20220404103149867"),(0,r.kt)("p",null,"\u4f7f\u7528utf-8\u7f16\u7801"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220404103334670-9bfcbddd.png",alt:"image-20220404103334670"}),"image-20220404103334670"),(0,r.kt)("p",null,"maven\u8bbe\u7f6e"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220404103417399-f4982f5b.png",alt:"image-20220404103417399"}),"image-20220404103417399"),(0,r.kt)("p",null,"pom.xml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.ydlclass</groupId>\n    <artifactId>spring-cloud-parent</artifactId>\n    <version>1.0.0</version>\n\n    \x3c!--spring boot \u73af\u5883 --\x3e\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.2.11.RELEASE</version>\n        <relativePath/>\n    </parent>\n\n    <properties>\n        <maven.compiler.source>8</maven.compiler.source>\n        <maven.compiler.target>8</maven.compiler.target>\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>\n    </properties>\n    \n</project>\n')),(0,r.kt)("h4",{id:"2\u63d0\u4f9b\u8005-eureka-provider"},"2\u3001\u63d0\u4f9b\u8005 eureka-provider"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220330164728077-62e821de.png",alt:"image-20220330164728077"}),"image-20220330164728077"),(0,r.kt)("p",null,"\u642d\u5efaspringboot\u5de5\u7a0b\uff1a\u6b65\u9aa4\u628a\u5927\u8c61\u88c5\u51b0\u7bb1\u6709\u51e0\u6b65\uff1f \u5de5\u4f5c\u4e2d\u522b\u95ee\u540c\u4e8b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"1 pom \u5bfc\u5305\n2 \u914d\u7f6e\u6587\u4ef6\n3 \u4e3b\u542f\u52a8\u7c7b\n")),(0,r.kt)("p",null,"pom.xml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <artifactId>spring-cloud-parent</artifactId>\n        <groupId>com.ydlclass</groupId>\n        <version>1.0.0</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>eureka-provider</artifactId>\n\n    <properties>\n        <maven.compiler.source>8</maven.compiler.source>\n        <maven.compiler.target>8</maven.compiler.target>\n    </properties>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n    </dependencies>\n\n</project>\n')),(0,r.kt)("p",null,"application.yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"server:\n  port: 8000\n")),(0,r.kt)("p",null,"\u4e3b\u542f\u52a8\u7c7b ProviderApp"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.provider;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@SpringBootApplication\npublic class ProviderApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(ProviderApplication.class,args);\n    }\n}\n")),(0,r.kt)("p",null,"Goods"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.provider.domain;\n\nimport java.io.Serializable;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\npublic class Goods implements Serializable {\n    private int id;//\u5546\u54c1id\n    private String title;//\u5546\u54c1\u540d\n    private double price;//\u4ef7\u683c\n    private int count;//\u5e93\u5b58\n\n    public Goods(int id, String title, double price, int count) {\n        this.id = id;\n        this.title = title;\n        this.price = price;\n        this.count = count;\n    }\n\n    @Override\n    public String toString() {\n        return "Goods{" +\n                "id=" + id +\n                ", title=\'" + title + \'\\\'\' +\n                ", price=" + price +\n                ", count=" + count +\n                \'}\';\n    }\n\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public String getTitle() {\n        return title;\n    }\n\n    public void setTitle(String title) {\n        this.title = title;\n    }\n\n    public double getPrice() {\n        return price;\n    }\n\n    public void setPrice(double price) {\n        this.price = price;\n    }\n\n    public int getCount() {\n        return count;\n    }\n\n    public void setCount(int count) {\n        this.count = count;\n    }\n}\n')),(0,r.kt)("p",null,"GoodsController"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.provider.controller;\n\nimport com.ydlclass.provider.domain.Goods;\nimport com.ydlclass.provider.service.GoodsService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@RestController\n@RequestMapping("/goods")\npublic class GoodsController {\n    @Autowired\n    GoodsService goodsService;\n\n    @GetMapping("findById/{id}")\n    public Goods findById(@PathVariable("id") int id){\n        Goods goods = goodsService.findById(id);\n        return goods;\n    }\n}\n')),(0,r.kt)("p",null,"GoodsService"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.provider.service;\n\nimport com.ydlclass.provider.dao.GoodsDao;\nimport com.ydlclass.provider.domain.Goods;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@Service\npublic class GoodsService {\n    @Autowired\n    GoodsDao goodsDao;\n\n    public Goods findById(int id){\n        Goods goods = goodsDao.findById(id);\n        return goods;\n    }\n}\n")),(0,r.kt)("p",null,"GoodsDao"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.provider.dao;\n\nimport com.ydlclass.provider.domain.Goods;\nimport org.springframework.stereotype.Repository;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@Repository\npublic class GoodsDao {\n    public Goods findById(int id){\n        //\u67e5\u6570\u636e\u5e93\n        return new Goods(id,"\u624b\u673a",2000,100);\n    }\n}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\uff1a")),(0,r.kt)("p",null,"\u8bbf\u95ee\uff1a",(0,r.kt)("a",{parentName:"p",href:"http://localhost:8000/goods/findById/1"},"http://localhost:8000/goods/findById/1open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220330170647529-2bf7e1c4.png",alt:"image-20220330170647529"}),"image-20220330170647529"),(0,r.kt)("h4",{id:"3\u6d88\u8d39\u8005-eureka-consumer"},"3\u3001\u6d88\u8d39\u8005 eureka-consumer"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220404111105516-f67f7a56.png",alt:"image-20220404111105516"}),"image-20220404111105516"),(0,r.kt)("p",null,"pom.xml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <artifactId>spring-cloud-parent</artifactId>\n        <groupId>com.ydlclass</groupId>\n        <version>1.0-SNAPSHOT</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>eureka-consumer</artifactId>\n\n\n    <dependencies>\n\n        \x3c!--spring boot web--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n    </dependencies>\n</project>\n')),(0,r.kt)("p",null,"Goods"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.consumer.domain;\n\n/**\n * \u5546\u54c1\u5b9e\u4f53\u7c7b\n */\npublic class Goods {\n\n    private int id;\n    private String title;//\u5546\u54c1\u6807\u9898\n    private double price;//\u5546\u54c1\u4ef7\u683c\n    private int count;//\u5546\u54c1\u5e93\u5b58\n\n    public Goods() {\n    }\n\n    public Goods(int id, String title, double price, int count) {\n        this.id = id;\n        this.title = title;\n        this.price = price;\n        this.count = count;\n    }\n\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public String getTitle() {\n        return title;\n    }\n\n    public void setTitle(String title) {\n        this.title = title;\n    }\n\n    public double getPrice() {\n        return price;\n    }\n\n    public void setPrice(double price) {\n        this.price = price;\n    }\n\n    public int getCount() {\n        return count;\n    }\n\n    public void setCount(int count) {\n        this.count = count;\n    }\n}\n")),(0,r.kt)("p",null,"OrderController"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.consumer.controller;\n\nimport com.ydlclass.consumer.domain.Goods;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@RestController\n@RequestMapping("/order")\npublic class OrderController {\n\n    @GetMapping("/add/{id}")\n    public Goods add(@PathVariable("id") Integer id){\n        //\u4e1a\u52a1\u903b\u8f91\n        //1\u67e5\u8be2\u5546\u54c1\n        //2\u51cf\u5e93\u5b58\n        //3\u652f\u4ed8\n        //4\u7269\u6d41\n\n        return new Goods();\n    }\n}\n')),(0,r.kt)("p",null,"application.yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 9000\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\uff1a")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://localhost:9000/order/add/2"},"http://localhost:9000/order/add/2open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220404112103333-e5ed7fec.png",alt:"image-20220404112103333"}),"image-20220404112103333"),(0,r.kt)("h3",{id:"\u4e8c\u4f7f\u7528-resttemplate-\u5b8c\u6210\u8fdc\u7a0b\u8c03\u7528"},"\u4e8c\u3001\u4f7f\u7528 RestTemplate \u5b8c\u6210\u8fdc\u7a0b\u8c03\u7528"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Spring\u63d0\u4f9b\u7684\u4e00\u79cd\u7b80\u5355\u4fbf\u6377\u7684\u6a21\u677f\u7c7b\uff0c\u7528\u4e8e\u5728 java \u4ee3\u7801\u91cc\u8bbf\u95ee restful \u670d\u52a1\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5176\u529f\u80fd\u4e0e HttpClient \u7c7b\u4f3c\uff0c\u4f46\u662f RestTemplate \u5b9e\u73b0\u66f4\u4f18\u96c5\uff0c\u4f7f\u7528\u66f4\u65b9\u4fbf\u3002")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"consumer\u5de5\u7a0b\u4e2d")),(0,r.kt)("p",null,"RestTemplateConfig"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.consumer.config;\n\n\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.web.client.RestTemplate;\n\n@Configuration\npublic class RestTemplateConfig {\n\n\n    @Bean\n    public RestTemplate restTemplate(){\n        return new RestTemplate();\n    }\n}\n")),(0,r.kt)("p",null,"OrderController"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.consumer.controller;\n\n\nimport com.ydlclass.consumer.domain.Goods;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\nimport org.springframework.web.client.RestTemplate;\n\n/**\n * \u670d\u52a1\u7684\u8c03\u7528\u65b9\n */\n\n@RestController\n@RequestMapping("/order")\npublic class OrderController {\n\n    @Autowired\n    private RestTemplate restTemplate;\n\n    @GetMapping("/goods/{id}")\n    public Goods findGoodsById(@PathVariable("id") int id){\n        System.out.println("findGoodsById..."+id);\n\n\n        /*\n            //\u8fdc\u7a0b\u8c03\u7528Goods\u670d\u52a1\u4e2d\u7684findOne\u63a5\u53e3\n            \u4f7f\u7528RestTemplate\n            1. \u5b9a\u4e49Bean  restTemplate\n            2. \u6ce8\u5165Bean\n            3. \u8c03\u7528\u65b9\u6cd5\n         */\n\n        String url = "http://localhost:8000/goods/findOne/"+id;\n        // 3. \u8c03\u7528\u65b9\u6cd5\n        Goods goods = restTemplate.getForObject(url, Goods.class);\n\n\n        return goods;\n    }\n}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\uff1a")),(0,r.kt)("h2",{id:"\u7b2c\u4e94\u7ae0-eureka\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0"},"\u7b2c\u4e94\u7ae0 Eureka\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0"),(0,r.kt)("h3",{id:"\u4e00eureka"},"\u4e00\u3001Eureka"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6982\u5ff5\uff1a")),(0,r.kt)("p",null,"\u2022 Eureka \u662f Netflix \u516c\u53f8\u5f00\u6e90\u7684\u4e00\u4e2a\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0\u7684\u7ec4\u4ef6 \u3002"),(0,r.kt)("p",null,"\u2022 Eureka \u548c\u5176\u4ed6 Netflix \u516c\u53f8\u7684\u670d\u52a1\u7ec4\u4ef6\uff08\u4f8b\u5982\u8d1f\u8f7d\u5747\u8861\u3001\u7194\u65ad\u5668\u3001\u7f51\u5173\u7b49\uff09 \u4e00\u8d77\uff0c\u88ab Spring Cloud \u793e\u533a\u6574\u5408\u4e3aSpring-Cloud-Netflix \u6a21\u5757\u3002"),(0,r.kt)("p",null,"\u2022 Eureka \u5305\u542b\u4e24\u4e2a\u7ec4\u4ef6\uff1aEureka Server (\u6ce8\u518c\u4e2d\u5fc3) \u548c Eureka Client (\u670d\u52a1\u63d0\u4f9b\u8005\u3001\u670d\u52a1\u6d88\u8d39\u8005)\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u64cd\u4f5c\uff1a")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200606113829765-1648628667299-b0fb85d7.png",alt:"image-20200606113829765"}),"image-20200606113829765"),(0,r.kt)("h3",{id:"\u4e8c-\u642d\u5efa-eureka-server-\u670d\u52a1"},"\u4e8c\u3001 \u642d\u5efa Eureka Server \u670d\u52a1"),(0,r.kt)("p",null,"\uff081\uff09\u521b\u5efa eureka-server \u6a21\u5757"),(0,r.kt)("p",null,"\uff082\uff09 \u5f15\u5165 SpringCloud \u548c euraka-server \u76f8\u5173\u4f9d\u8d56"),(0,r.kt)("p",null,"\uff083\uff09\u5b8c\u6210 Eureka Server \u76f8\u5173\u914d\u7f6e"),(0,r.kt)("p",null,"\uff084\uff09\u542f\u52a8\u8be5\u6a21\u5757"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7236\u5de5\u7a0b pom")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.ydlclass</groupId>\n    <artifactId>spring-cloud-parent</artifactId>\n    <packaging>pom</packaging>\n    <version>1.0-SNAPSHOT</version>\n    <modules>\n        <module>eureka-provider</module>\n        <module>eureka-consumer</module>\n        <module>eureka-server</module>\n    </modules>\n\n\n    \x3c!--spring boot \u73af\u5883 --\x3e\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.1.0.RELEASE</version>\n        <relativePath/>\n    </parent>\n\n\n    <properties>\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>\n        <java.version>1.8</java.version>\n        \x3c!--spring cloud \u7248\u672c--\x3e\n        <spring-cloud.version>Greenwich.RELEASE</spring-cloud.version>\n    </properties>\n\n    \x3c!--\u5f15\u5165Spring Cloud \u4f9d\u8d56--\x3e\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>org.springframework.cloud</groupId>\n                <artifactId>spring-cloud-dependencies</artifactId>\n                <version>${spring-cloud.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n\n</project>\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"eureka-server\u5de5\u7a0b")),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <artifactId>spring-cloud-parent</artifactId>\n        <groupId>com.ydlclass</groupId>\n        <version>1.0-SNAPSHOT</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>eureka-server</artifactId>\n\n\n\n    <dependencies>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n        \x3c!-- eureka-server --\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-eureka-server</artifactId>\n        </dependency>\n    </dependencies>\n\n\n</project>\n')),(0,r.kt)("p",null,"EurekaApp"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.eureka;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;\n\n@SpringBootApplication\n// \u542f\u7528EurekaServer\n@EnableEurekaServer\npublic class EurekaApp {\n\n    public static void main(String[] args) {\n        SpringApplication.run(EurekaApp.class,args);\n    }\n}\n")),(0,r.kt)("p",null,"application.yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 8761\n\n# eureka \u914d\u7f6e\n# eureka \u4e00\u5171\u67094\u90e8\u5206 \u914d\u7f6e\n# 1. dashboard:eureka\u7684web\u63a7\u5236\u53f0\u914d\u7f6e\n# 2. server:eureka\u7684\u670d\u52a1\u7aef\u914d\u7f6e\n# 3. client:eureka\u7684\u5ba2\u6237\u7aef\u914d\u7f6e\n# 4. instance:eureka\u7684\u5b9e\u4f8b\u914d\u7f6e\n\n\neureka:\n  instance:\n    hostname: localhost # \u4e3b\u673a\u540d\n  client:\n    service-url:\n      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka # eureka\u670d\u52a1\u7aef\u5730\u5740\uff0c\u5c06\u6765\u5ba2\u6237\u7aef\u4f7f\u7528\u8be5\u5730\u5740\u548ceureka\u8fdb\u884c\u901a\u4fe1\n\n    register-with-eureka: false # \u662f\u5426\u5c06\u81ea\u5df1\u7684\u8def\u5f84 \u6ce8\u518c\u5230eureka\u4e0a\u3002eureka server \u4e0d\u9700\u8981\u7684\uff0ceureka provider client \u9700\u8981\n    fetch-registry: false # \u662f\u5426\u9700\u8981\u4eceeureka\u4e2d\u6293\u53d6\u8def\u5f84\u3002eureka server \u4e0d\u9700\u8981\u7684\uff0ceureka consumer client \u9700\u8981\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5\uff1a ")," \u8bbf\u95ee localhost:8761"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200611013357920-c3a39136.png",alt:"image-20200611013357920"}),"image-20200611013357920"),(0,r.kt)("h3",{id:"\u4e09-\u6539\u9020-provider-\u548c-consumer-\u79f0\u4e3a-eureka-client"},"\u4e09\u3001 \u6539\u9020 Provider \u548c Consumer \u79f0\u4e3a Eureka Client"),(0,r.kt)("p",null,"\u2460 \u5f15 eureka-client \u76f8\u5173\u4f9d\u8d56"),(0,r.kt)("p",null,"\u2461 \u5b8c\u6210 eureka client \u76f8\u5173\u914d\u7f6e"),(0,r.kt)("p",null,"\u2462 \u542f\u52a8 \u6d4b\u8bd5"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Provider\u5de5\u7a0b")),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"        \x3c!-- eureka-client --\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n        </dependency>\n")),(0,r.kt)("p",null,"ProviderApp"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@EnableEurekaClient\n")),(0,r.kt)("p",null,"application.yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 8001\n\n\neureka:\n  instance:\n    hostname: localhost # \u4e3b\u673a\u540d\n  client:\n    service-url:\n      defaultZone: http://localhost:8761/eureka # eureka\u670d\u52a1\u7aef\u5730\u5740\uff0c\u5c06\u6765\u5ba2\u6237\u7aef\u4f7f\u7528\u8be5\u5730\u5740\u548ceureka\u8fdb\u884c\u901a\u4fe1\nspring:\n  application:\n    name: eureka-provider # \u8bbe\u7f6e\u5f53\u524d\u5e94\u7528\u7684\u540d\u79f0\u3002\u5c06\u6765\u4f1a\u5728eureka\u4e2dApplication\u663e\u793a\u3002\u5c06\u6765\u9700\u8981\u4f7f\u7528\u8be5\u540d\u79f0\u6765\u83b7\u53d6\u8def\u5f84\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Consumer")),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"        \x3c!-- eureka-client --\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n        </dependency>\n")),(0,r.kt)("p",null,"ConsumerApp"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.consumer;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.client.discovery.EnableDiscoveryClient;\nimport org.springframework.cloud.netflix.eureka.EnableEurekaClient;\n\n@EnableDiscoveryClient // \u6fc0\u6d3bDiscoveryClient\n@EnableEurekaClient\n@SpringBootApplication\npublic class ConsumerApp {\n\n\n    public static void main(String[] args) {\n        SpringApplication.run(ConsumerApp.class,args);\n    }\n}\n")),(0,r.kt)("p",null,"application.yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 9000\n\neureka:\n  instance:\n    hostname: localhost # \u4e3b\u673a\u540d\n  client:\n    service-url:\n      defaultZone: http://localhost:8761/eureka # eureka\u670d\u52a1\u7aef\u5730\u5740\uff0c\u5c06\u6765\u5ba2\u6237\u7aef\u4f7f\u7528\u8be5\u5730\u5740\u548ceureka\u8fdb\u884c\u901a\u4fe1\nspring:\n  application:\n    name: eureka-consumer # \u8bbe\u7f6e\u5f53\u524d\u5e94\u7528\u7684\u540d\u79f0\u3002\u5c06\u6765\u4f1a\u5728eureka\u4e2dApplication\u663e\u793a\u3002\u5c06\u6765\u9700\u8981\u4f7f\u7528\u8be5\u540d\u79f0\u6765\u83b7\u53d6\u8def\u5f84\n")),(0,r.kt)("h3",{id:"\u56db-consumer-\u670d\u52a1-\u901a\u8fc7\u4ece-eureka-server-\u4e2d\u6293\u53d6-provider-\u5730\u5740\u5b8c\u6210\u8fdc\u7a0b\u8c03\u7528"},"\u56db\u3001 Consumer \u670d\u52a1 \u901a\u8fc7\u4ece Eureka Server \u4e2d\u6293\u53d6 Provider \u5730\u5740\uff0c\u5b8c\u6210\u8fdc\u7a0b\u8c03\u7528"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Consumer")),(0,r.kt)("p",null,"OrderController"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.consumer.controller;\n\nimport com.ydlclass.consumer.domain.Goods;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.cloud.client.ServiceInstance;\nimport org.springframework.cloud.client.discovery.DiscoveryClient;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\nimport org.springframework.web.client.RestTemplate;\n\nimport java.util.List;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@RestController\n@RequestMapping("/order")\npublic class OrderController {\n    @Autowired\n    RestTemplate restTemplate;\n\n    @Autowired\n    private DiscoveryClient discoveryClient;\n\n    @GetMapping("/add/{id}")\n    public Goods add(@PathVariable("id") Integer id){\n        //\u4e1a\u52a1\u903b\u8f91\n        //1\u67e5\u8be2\u5546\u54c1\n        //2\u51cf\u5e93\u5b58\n        //3\u652f\u4ed8\n        //4\u7269\u6d41\n        //\u76f4\u63a5\u8c03\u7528\n        //String url="http://localhost:8000/goods/findById/"+id;\n        //Goods goods = restTemplate.getForObject(url, Goods.class);\n\n        //\u670d\u52a1\u53d1\u73b0\n        List<ServiceInstance> instances = discoveryClient.getInstances("EUREKA-PROVIDER");\n        if(instances==null||instances.size()<=0){\n            return null;\n        }\n        //\u901a\u8fc7\u67d0\u4e2a\u7b56\u7565\u62ff\u5230\u4e00\u4e2a\u5b9e\u4f8b\n        ServiceInstance serviceInstance = instances.get(0);\n        String host = serviceInstance.getHost();\n        int port = serviceInstance.getPort();\n        System.out.println(host);\n        System.out.println(port);\n\n        String url="http://"+host+":"+port+"/goods/findById/"+id;\n        Goods goods = restTemplate.getForObject(url, Goods.class);\n\n        return goods;\n    }\n}\n')),(0,r.kt)("h3",{id:"\u4e94-euraka\u914d\u7f6e\u8be6\u89e3"},"\u4e94\u3001 Euraka\u914d\u7f6e\u8be6\u89e3"),(0,r.kt)("p",null,"Eureka\u5305\u542b\u56db\u4e2a\u90e8\u5206\u7684\u914d\u7f6e"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"instance\uff1a\u5f53\u524dEureka Instance\u5b9e\u4f8b\u4fe1\u606f\u914d\u7f6e"),(0,r.kt)("li",{parentName:"ul"},"client\uff1aEureka Client\u5ba2\u6237\u7aef\u7279\u6027\u914d\u7f6e"),(0,r.kt)("li",{parentName:"ul"},"server\uff1aEureka Server\u6ce8\u518c\u4e2d\u5fc3\u7279\u6027\u914d\u7f6e"),(0,r.kt)("li",{parentName:"ul"},"dashboard\uff1aEureka Server\u6ce8\u518c\u4e2d\u5fc3\u4eea\u8868\u76d8\u914d\u7f6e")),(0,r.kt)("h4",{id:"1\u5b9e\u4f8b\u4fe1\u606f\u914d\u7f6e"},"1\u3001\u5b9e\u4f8b\u4fe1\u606f\u914d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"eureka:\n    instance:\n        hostname: localhost # \u4e3b\u673a\u540d\n        prefer-ip-address: # \u662f\u5426\u5c06\u81ea\u5df1\u7684ip\u6ce8\u518c\u5230eureka\u4e2d\uff0c\u9ed8\u8ba4false \u6ce8\u518c \u4e3b\u673a\u540d\n        ip-address: # \u8bbe\u7f6e\u5f53\u524d\u5b9e\u4f8bip\n        instance-id: # \u4fee\u6539instance-id\u663e\u793a\n        lease-renewal-interval-in-seconds: 30 # \u6bcf\u4e00\u6b21eureka client \u5411 eureka server\u53d1\u9001\u5fc3\u8df3\u7684\u65f6\u95f4\u95f4\u9694\n        lease-expiration-duration-in-seconds: 90 # \u5982\u679c90\u79d2\u5185eureka server\u6ca1\u6709\u6536\u5230eureka client\u7684\u5fc3\u8df3\u5305\uff0c\u5219\u5254\u9664\u8be5\u670d\u52a1\n")),(0,r.kt)("p",null,"Eureka Instance\u7684\u914d\u7f6e\u4fe1\u606f\u5168\u90e8\u4fdd\u5b58\u5728org.springframework.cloud.netflix.eureka.EurekaInstanceConfigBean\u914d\u7f6e\u7c7b\u91cc\uff0c\u5b9e\u9645\u4e0a\u5b83\u662fcom.netflix.appinfo.EurekaInstanceConfig\u7684\u5b9e\u73b0\u7c7b\uff0c\u66ff\u4ee3\u4e86netflix\u7684com.netflix.appinfo.CloudInstanceConfig\u7684\u9ed8\u8ba4\u5b9e\u73b0\u3002"),(0,r.kt)("p",null,"Eureka Instance\u7684\u914d\u7f6e\u4fe1\u606f\u5168\u90e8\u4ee5eureka.instance.xxx\u7684\u683c\u5f0f\u914d\u7f6e\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u914d\u7f6e\u5217\u8868")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"appname = unknown")),(0,r.kt)("p",null,"\u5e94\u7528\u540d\uff0c\u9996\u5148\u83b7\u53d6spring.application.name\u7684\u503c\uff0c\u5982\u679c\u53d6\u503c\u4e3a\u7a7a\uff0c\u5219\u53d6\u9ed8\u8ba4unknown\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"appGroupName = null")),(0,r.kt)("p",null,"\u5e94\u7528\u7ec4\u540d"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"instanceEnabledOnit = false")),(0,r.kt)("p",null,"\u5b9e\u4f8b\u6ce8\u518c\u5230Eureka\u4e0a\u662f\uff0c\u662f\u5426\u7acb\u523b\u5f00\u542f\u901a\u8baf\u3002\u6709\u65f6\u5019\u5e94\u7528\u5728\u51c6\u5907\u597d\u670d\u52a1\u4e4b\u524d\u9700\u8981\u4e00\u4e9b\u9884\u5904\u7406\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"nonSecurePort = 80")),(0,r.kt)("p",null,"\u975e\u5b89\u5168\u7684\u7aef\u53e3"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"securePort = 443")),(0,r.kt)("p",null,"\u5b89\u5168\u7aef\u53e3"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"nonSecurePortEnabled = true")),(0,r.kt)("p",null,"\u662f\u5426\u5f00\u542f\u975e\u5b89\u5168\u7aef\u53e3\u901a\u8baf"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"securePortEnabled = false")),(0,r.kt)("p",null,"\u662f\u5426\u5f00\u542f\u5b89\u5168\u7aef\u53e3\u901a\u8baf"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"leaseRenewalIntervalInSeconds = 30")),(0,r.kt)("p",null,"\u5b9e\u4f8b\u7eed\u7ea6\u95f4\u9694\u65f6\u95f4"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"leaseExpirationDurationInSeconds = 90")),(0,r.kt)("p",null,"\u5b9e\u4f8b\u8d85\u65f6\u65f6\u95f4\uff0c\u8868\u793a\u6700\u5927leaseExpirationDurationInSeconds\u79d2\u540e\u6ca1\u6709\u7eed\u7ea6\uff0cServer\u5c31\u8ba4\u4e3a\u4ed6\u4e0d\u53ef\u7528\u4e86\uff0c\u968f\u4e4b\u5c31\u4f1a\u5c06\u5176\u5254\u9664\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"virtualHostName = unknown")),(0,r.kt)("p",null,"\u865a\u62df\u4e3b\u673a\u540d\uff0c\u9996\u5148\u83b7\u53d6spring.application.name\u7684\u503c\uff0c\u5982\u679c\u53d6\u503c\u4e3a\u7a7a\uff0c\u5219\u53d6\u9ed8\u8ba4unknown\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"instanceId")),(0,r.kt)("p",null,"\u6ce8\u518c\u5230eureka\u4e0a\u7684\u552f\u4e00\u5b9e\u4f8bID\uff0c\u4e0d\u80fd\u4e0e\u76f8\u540cappname\u7684\u5176\u4ed6\u5b9e\u4f8b\u91cd\u590d\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"secureVirtualHostName = unknown")),(0,r.kt)("p",null,"\u5b89\u5168\u865a\u62df\u4e3b\u673a\u540d\uff0c\u9996\u5148\u83b7\u53d6spring.application.name\u7684\u503c\uff0c\u5982\u679c\u53d6\u503c\u4e3a\u7a7a\uff0c\u5219\u53d6\u9ed8\u8ba4unknown\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"metadataMap = new HashMap();")),(0,r.kt)("p",null,"\u5b9e\u4f8b\u5143\u6570\u636e\uff0c\u53ef\u4ee5\u4f9b\u5176\u4ed6\u5b9e\u4f8b\u4f7f\u7528\u3002\u6bd4\u5982spring-boot-admin\u5728\u76d1\u63a7\u65f6\uff0c\u83b7\u53d6\u5b9e\u4f8b\u7684\u4e0a\u4e0b\u6587\u548c\u7aef\u53e3\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"dataCenterInfo = new MyDataCenterInfo(DataCenterInfo.Name.MyOwn);")),(0,r.kt)("p",null,"\u5b9e\u4f8b\u90e8\u7f72\u7684\u6570\u636e\u4e2d\u5fc3\u3002\u5982AWS\u3001MyOwn\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"ipAddress=null")),(0,r.kt)("p",null,"\u5b9e\u4f8b\u7684IP\u5730\u5740"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'statusPageUrlPath = "/actuator/info"')),(0,r.kt)("p",null,"\u5b9e\u4f8b\u72b6\u6001\u9875\u76f8\u5bf9url"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"statusPageUrl = null")),(0,r.kt)("p",null,"\u5b9e\u4f8b\u72b6\u6001\u9875\u7edd\u5bf9URL"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'homePageUrlPath = "/"')),(0,r.kt)("p",null,"\u5b9e\u4f8b\u4e3b\u9875\u76f8\u5bf9URL"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"homePageUrl = null")),(0,r.kt)("p",null,"\u5b9e\u4f8b\u4e3b\u9875\u7edd\u5bf9URL"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'healthCheckUrlUrlPath = "/actuator/health"')),(0,r.kt)("p",null,"\u5b9e\u4f8b\u5065\u5eb7\u68c0\u67e5\u76f8\u5bf9URL"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"healthCheckUrl = null")),(0,r.kt)("p",null,"\u5b9e\u4f8b\u5065\u5eb7\u68c0\u67e5\u7edd\u5bf9URL"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"secureHealthCheckUrl = null")),(0,r.kt)("p",null,"\u5b9e\u4f8b\u5b89\u5168\u7684\u5065\u5eb7\u68c0\u67e5\u7edd\u5bf9URL"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'namespace = "eureka"')),(0,r.kt)("p",null,"\u914d\u7f6e\u5c5e\u6027\u7684\u547d\u540d\u7a7a\u95f4\uff08Spring Cloud\u4e2d\u88ab\u5ffd\u7565\uff09"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"hostname = null")),(0,r.kt)("p",null,"\u4e3b\u673a\u540d,\u4e0d\u914d\u7f6e\u7684\u65f6\u5019\u8bb2\u6839\u636e\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e3b\u673a\u540d\u6765\u83b7\u53d6"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"preferIpAddress = false")),(0,r.kt)("p",null,"\u662f\u5426\u4f18\u5148\u4f7f\u7528IP\u5730\u5740\u4f5c\u4e3a\u4e3b\u673a\u540d\u7684\u6807\u8bc6"),(0,r.kt)("h4",{id:"2\u5ba2\u6237\u7aef\u7279\u6027\u914d\u7f6e"},"2\u3001\u5ba2\u6237\u7aef\u7279\u6027\u914d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"eureka:\n    client:\n        service-url:\n             # eureka\u670d\u52a1\u7aef\u5730\u5740\uff0c\u5c06\u6765\u5ba2\u6237\u7aef\u4f7f\u7528\u8be5\u5730\u5740\u548ceureka\u8fdb\u884c\u901a\u4fe1\n            defaultZone: \n        register-with-eureka: # \u662f\u5426\u5c06\u81ea\u5df1\u7684\u8def\u5f84 \u6ce8\u518c\u5230eureka\u4e0a\u3002\n        fetch-registry: # \u662f\u5426\u9700\u8981\u4eceeureka\u4e2d\u6293\u53d6\u6570\u636e\u3002\n")),(0,r.kt)("p",null,"Eureka Client\u5ba2\u6237\u7aef\u7279\u6027\u914d\u7f6e\u662f\u5bf9\u4f5c\u4e3aEureka\u5ba2\u6237\u7aef\u7684\u7279\u6027\u914d\u7f6e\uff0c\u5305\u62ecEureka\u6ce8\u518c\u4e2d\u5fc3\uff0c\u672c\u8eab\u4e5f\u662f\u4e00\u4e2aEureka Client\u3002"),(0,r.kt)("p",null,"Eureka Client\u7279\u6027\u914d\u7f6e\u5168\u90e8\u5728org.springframework.cloud.netflix.eureka.EurekaClientConfigBean\u4e2d\uff0c\u5b9e\u9645\u4e0a\u5b83\u662fcom.netflix.discovery.EurekaClientConfig\u7684\u5b9e\u73b0\u7c7b\uff0c\u66ff\u4ee3\u4e86netxflix\u7684\u9ed8\u8ba4\u5b9e\u73b0\u3002"),(0,r.kt)("p",null,"Eureka Client\u5ba2\u6237\u7aef\u7279\u6027\u914d\u7f6e\u5168\u90e8\u4ee5eureka.client.xxx\u7684\u683c\u5f0f\u914d\u7f6e\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u914d\u7f6e\u5217\u8868")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"enabled=true")),(0,r.kt)("p",null,"\u662f\u5426\u542f\u7528Eureka client\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"registryFetchIntervalSeconds=30")),(0,r.kt)("p",null,"\u5b9a\u65f6\u4eceEureka Server\u62c9\u53d6\u670d\u52a1\u6ce8\u518c\u4fe1\u606f\u7684\u95f4\u9694\u65f6\u95f4"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"instanceInfoReplicationIntervalSeconds=30")),(0,r.kt)("p",null,"\u5b9a\u65f6\u5c06\u5b9e\u4f8b\u4fe1\u606f\uff08\u5982\u679c\u53d8\u5316\u4e86\uff09\u590d\u5236\u5230Eureka Server\u7684\u95f4\u9694\u65f6\u95f4\u3002\uff08InstanceInfoReplicator\u7ebf\u7a0b\uff09"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"initialInstanceInfoReplicationIntervalSeconds=40")),(0,r.kt)("p",null,"\u9996\u6b21\u5c06\u5b9e\u4f8b\u4fe1\u606f\u590d\u5236\u5230Eureka Server\u7684\u5ef6\u8fdf\u65f6\u95f4\u3002\uff08InstanceInfoReplicator\u7ebf\u7a0b\uff09"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"eurekaServiceUrlPollIntervalSeconds=300")),(0,r.kt)("p",null,"\u62c9\u53d6Eureka Server\u5730\u5740\u7684\u95f4\u9694\u65f6\u95f4\uff08Eureka Server\u6709\u53ef\u80fd\u589e\u51cf\uff09"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"proxyPort=null")),(0,r.kt)("p",null,"Eureka Server\u7684\u4ee3\u7406\u7aef\u53e3"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"proxyHost=null")),(0,r.kt)("p",null,"Eureka Server\u7684\u4ee3\u7406\u4e3b\u673a\u540d"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"proxyUserName=null")),(0,r.kt)("p",null,"Eureka Server\u7684\u4ee3\u7406\u7528\u6237\u540d"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"proxyPassword=null")),(0,r.kt)("p",null,"Eureka Server\u7684\u4ee3\u7406\u5bc6\u7801"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"eurekaServerReadTimeoutSeconds=8")),(0,r.kt)("p",null,"\u4eceEureka Server\u8bfb\u53d6\u4fe1\u606f\u7684\u8d85\u65f6\u65f6\u95f4"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"eurekaServerConnectTimeoutSeconds=5")),(0,r.kt)("p",null,"\u8fde\u63a5Eureka Server\u7684\u8d85\u65f6\u65f6\u95f4"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"backupRegistryImpl=null")),(0,r.kt)("p",null,"Eureka Client\u7b2c\u4e00\u6b21\u542f\u52a8\u65f6\u83b7\u53d6\u670d\u52a1\u6ce8\u518c\u4fe1\u606f\u7684\u8c03\u7528\u7684\u56de\u6eaf\u5b9e\u73b0\u3002Eureka Client\u542f\u52a8\u65f6\u9996\u6b21\u4f1a\u68c0\u67e5\u6709\u6ca1\u6709BackupRegistry\u7684\u5b9e\u73b0\u7c7b\uff0c\u5982\u679c\u6709\u5b9e\u73b0\u7c7b\uff0c\u5219\u4f18\u5148\u4ece\u8fd9\u4e2a\u5b9e\u73b0\u7c7b\u91cc\u83b7\u53d6\u670d\u52a1\u6ce8\u518c\u4fe1\u606f\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"eurekaServerTotalConnections=200")),(0,r.kt)("p",null,"Eureka client\u8fde\u63a5Eureka Server\u7684\u94fe\u63a5\u603b\u6570"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"eurekaServerTotalConnectionsPerHost=50")),(0,r.kt)("p",null,"Eureka client\u8fde\u63a5\u5355\u53f0Eureka Server\u7684\u94fe\u63a5\u603b\u6570"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"eurekaServerURLContext=null")),(0,r.kt)("p",null,"\u5f53Eureka server\u7684\u5217\u8868\u5728DNS\u4e2d\u65f6\uff0cEureka Server\u7684\u4e0a\u4e0b\u6587\u8def\u5f84\u3002\u5982",(0,r.kt)("a",{parentName:"p",href:"http://xxxx/eureka%E3%80%82"},"http://xxxx/eureka\u3002open in new window")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"eurekaServerPort=null")),(0,r.kt)("p",null,"\u5f53Eureka server\u7684\u5217\u8868\u5728DNS\u4e2d\u65f6\uff0cEureka Server\u7684\u7aef\u53e3\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"eurekaServerDNSName=null")),(0,r.kt)("p",null,"\u5f53Eureka server\u7684\u5217\u8868\u5728DNS\u4e2d\u65f6\uff0c\u4e14\u8981\u901a\u8fc7DNSName\u83b7\u53d6Eureka Server\u5217\u8868\u65f6\uff0cDNS\u540d\u5b57\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'region="us-east-1"')),(0,r.kt)("p",null,"\u5b9e\u4f8b\u6240\u5c5e\u533a\u57df\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"eurekaConnectionIdleTimeoutSeconds = 30")),(0,r.kt)("p",null,"Eureka Client\u548cEureka Server\u4e4b\u95f4\u7684Http\u8fde\u63a5\u7684\u7a7a\u95f2\u8d85\u65f6\u65f6\u95f4\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"heartbeatExecutorThreadPoolSize=2")),(0,r.kt)("p",null,"\u5fc3\u8df3\uff08\u7eed\u7ea6\uff09\u6267\u884c\u5668\u7ebf\u7a0b\u6c60\u5927\u5c0f\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"heartbeatExecutorExponentialBackOffBound=10")),(0,r.kt)("p",null,"\u5fc3\u8df3\u6267\u884c\u5668\u5728\u7eed\u7ea6\u8fc7\u7a0b\u4e2d\u8d85\u65f6\u540e\u7684\u518d\u6b21\u6267\u884c\u7eed\u7ea6\u7684\u6700\u5927\u5ef6\u8fdf\u500d\u6570\u3002\u9ed8\u8ba4\u6700\u5927\u5ef6\u8fdf\u65f6\u95f4=10 * eureka.instance.leaseRenewalIntervalInSeconds"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"cacheRefreshExecutorThreadPoolSize=2")),(0,r.kt)("p",null,"cacheRefreshExecutord\u7684\u7ebf\u7a0b\u6c60\u5927\u5c0f\uff08\u83b7\u53d6\u6ce8\u518c\u4fe1\u606f\uff09"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"cacheRefreshExecutorExponentialBackOffBound=10")),(0,r.kt)("p",null,"cacheRefreshExecutord\u7684\u518d\u6b21\u6267\u884c\u7684\u6700\u5927\u5ef6\u8fdf\u500d\u6570\u3002\u9ed8\u8ba4\u6700\u5927\u5ef6\u8fdf\u65f6\u95f4=10 *eureka.client.registryFetchIntervalSeconds"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"serviceUrl= new HashMap();serviceUrl.put(DEFAULT_ZONE, DEFAULT_URL);")),(0,r.kt)("p",null,"Eureka Server\u7684\u5206\u533a\u5730\u5740\u3002\u9ed8\u8ba4\u6dfb\u52a0\u4e86\u4e00\u4e2adefualtZone\u3002\u4e5f\u5c31\u662f\u6700\u5e38\u7528\u7684\u914d\u7f6eeureka.client.service-url.defaultZone=xxx"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"registerWithEureka=true")),(0,r.kt)("p",null,"\u662f\u5426\u6ce8\u518c\u5230Eureka Server\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"preferSameZoneEureka=true")),(0,r.kt)("p",null,"\u662f\u5426\u4f7f\u7528\u76f8\u540cZone\u4e0b\u7684Eureka server\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"logDeltaDiff=false")),(0,r.kt)("p",null,"\u662f\u5426\u8bb0\u5f55Eureka Server\u548cEureka Client\u4e4b\u95f4\u6ce8\u518c\u4fe1\u606f\u7684\u5dee\u5f02"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"disableDelta=false")),(0,r.kt)("p",null,"\u662f\u5426\u5f00\u542f\u589e\u91cf\u540c\u6b65\u6ce8\u518c\u4fe1\u606f\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"fetchRemoteRegionsRegistry=null")),(0,r.kt)("p",null,"\u83b7\u53d6\u6ce8\u518c\u670d\u52a1\u7684\u8fdc\u7a0b\u5730\u533a\uff0c\u4ee5\u9017\u53f7\u9694\u5f00\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"availabilityZones=new HashMap()")),(0,r.kt)("p",null,"\u53ef\u7528\u5206\u533a\u5217\u8868\u3002\u7528\u9017\u53f7\u9694\u5f00\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"filterOnlyUpInstances = true")),(0,r.kt)("p",null,"\u662f\u5426\u53ea\u62c9\u53d6UP\u72b6\u6001\u7684\u5b9e\u4f8b\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"fetchRegistry=true")),(0,r.kt)("p",null,"\u662f\u5426\u62c9\u53d6\u6ce8\u518c\u4fe1\u606f\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"shouldUnregisterOnShutdown = true")),(0,r.kt)("p",null,"\u662f\u5426\u5728\u505c\u6b62\u670d\u52a1\u7684\u65f6\u5019\u5411Eureka Server\u53d1\u8d77Cancel\u6307\u4ee4\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"shouldEnforceRegistrationAtInit = false")),(0,r.kt)("p",null,"\u662f\u5426\u5728\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u6ce8\u518c\u670d\u52a1\u3002"),(0,r.kt)("h4",{id:"3\u6ce8\u518c\u4e2d\u5fc3\u7aef\u914d\u7f6e"},"3\u3001\u6ce8\u518c\u4e2d\u5fc3\u7aef\u914d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"eureka:\n    server: #\u662f\u5426\u5f00\u542f\u81ea\u6211\u4fdd\u62a4\u673a\u5236\uff0c\u9ed8\u8ba4true\n        enable-self-preservation: \n        eviction-interval-timer-in-ms: 120 2\u6708#\u6e05\u7406\u95f4\u9694\uff08\u5355\u4f4d\u6beb\u79d2\uff0c\u9ed8\u8ba4\u662f60*1000\uff09\n    instance:\n        lease-renewal-interval-in-seconds: 30 # \u6bcf\u4e00\u6b21eureka client \u5411 eureka server\u53d1\u9001\u5fc3\u8df3\u7684\u65f6\u95f4\u95f4\u9694\n        lease-expiration-duration-in-seconds: 90 # \u5982\u679c90\u79d2\u5185eureka server\u6ca1\u6709\u6536\u5230eureka client\u7684\u5fc3\u8df3\u5305\uff0c\u5219\u5254\u9664\u8be5\u670d\u52a1        \n")),(0,r.kt)("p",null,"Eureka Server\u6ce8\u518c\u4e2d\u5fc3\u7aef\u7684\u914d\u7f6e\u662f\u5bf9\u6ce8\u518c\u4e2d\u5fc3\u7684\u7279\u6027\u914d\u7f6e\u3002Eureka Server\u7684\u914d\u7f6e\u5168\u90e8\u5728org.springframework.cloud.netflix.eureka.server.EurekaServerConfigBean\u91cc\uff0c\u5b9e\u9645\u4e0a\u5b83\u662fcom.netflix.eureka.EurekaServerConfig\u7684\u5b9e\u73b0\u7c7b\uff0c\u66ff\u4ee3\u4e86netflix\u7684\u9ed8\u8ba4\u5b9e\u73b0\u3002"),(0,r.kt)("p",null,"Eureka Server\u7684\u914d\u7f6e\u5168\u90e8\u4ee5eureka.server.xxx\u7684\u683c\u5f0f\u8fdb\u884c\u914d\u7f6e\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u914d\u7f6e\u5217\u8868")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"enableSelfPreservation=true")),(0,r.kt)("p",null,"\u662f\u5426\u5f00\u542f\u81ea\u6211\u4fdd\u62a4"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"renewalPercentThreshold = 0.85")),(0,r.kt)("p",null,"\u81ea\u6211\u4fdd\u62a4\u7eed\u7ea6\u767e\u5206\u6bd4\u9600\u503c\u56e0\u5b50\u3002\u5982\u679c\u5b9e\u9645\u7eed\u7ea6\u6570\u5c0f\u4e8e\u7eed\u7ea6\u6570\u9600\u503c\uff0c\u5219\u5f00\u542f\u81ea\u6211\u4fdd\u62a4"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"renewalThresholdUpdateIntervalMs = 15 ",(0,r.kt)("em",{parentName:"li"}," 60 ")," 1000")),(0,r.kt)("p",null,"\u7eed\u7ea6\u6570\u9600\u503c\u66f4\u65b0\u9891\u7387\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"peerEurekaNodesUpdateIntervalMs = 10 ",(0,r.kt)("em",{parentName:"li"}," 60 ")," 1000")),(0,r.kt)("p",null,"Eureka Server\u8282\u70b9\u66f4\u65b0\u9891\u7387\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"enableReplicatedRequestCompression = false")),(0,r.kt)("p",null,"\u662f\u5426\u542f\u7528\u590d\u5236\u8bf7\u6c42\u538b\u7f29\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"waitTimeInMsWhenSyncEmpty=5 ",(0,r.kt)("em",{parentName:"li"}," 60 ")," 1000")),(0,r.kt)("p",null,"\u5f53\u4ece\u5176\u4ed6\u8282\u70b9\u540c\u6b65\u5b9e\u4f8b\u4fe1\u606f\u4e3a\u7a7a\u65f6\u7b49\u5f85\u7684\u65f6\u95f4\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"peerNodeConnectTimeoutMs=200")),(0,r.kt)("p",null,"\u8282\u70b9\u95f4\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"peerNodeReadTimeoutMs=200")),(0,r.kt)("p",null,"\u8282\u70b9\u95f4\u8bfb\u53d6\u4fe1\u606f\u7684\u8d85\u65f6\u65f6\u95f4\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"peerNodeTotalConnections=1000")),(0,r.kt)("p",null,"\u8282\u70b9\u95f4\u8fde\u63a5\u603b\u6570\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"peerNodeTotalConnectionsPerHost = 500;")),(0,r.kt)("p",null,"\u5355\u4e2a\u8282\u70b9\u95f4\u8fde\u63a5\u603b\u6570\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"peerNodeConnectionIdleTimeoutSeconds = 30;")),(0,r.kt)("p",null,"\u8282\u70b9\u95f4\u8fde\u63a5\u7a7a\u95f2\u8d85\u65f6\u65f6\u95f4\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"retentionTimeInMSInDeltaQueue = 3 * MINUTES;")),(0,r.kt)("p",null,"\u589e\u91cf\u961f\u5217\u7684\u7f13\u5b58\u65f6\u95f4\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"deltaRetentionTimerIntervalInMs = 30 * 1000;")),(0,r.kt)("p",null,"\u6e05\u7406\u589e\u91cf\u961f\u5217\u4e2d\u8fc7\u671f\u7684\u9891\u7387\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"evictionIntervalTimerInMs = 60 * 1000;")),(0,r.kt)("p",null,"\u5254\u9664\u4efb\u52a1\u9891\u7387\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"responseCacheAutoExpirationInSeconds = 180;")),(0,r.kt)("p",null,"\u6ce8\u518c\u5217\u8868\u7f13\u5b58\u8d85\u65f6\u65f6\u95f4\uff08\u5f53\u6ce8\u518c\u5217\u8868\u6ca1\u6709\u53d8\u5316\u65f6\uff09"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"responseCacheUpdateIntervalMs = 30 * 1000;")),(0,r.kt)("p",null,"\u6ce8\u518c\u5217\u8868\u7f13\u5b58\u66f4\u65b0\u9891\u7387\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"useReadOnlyResponseCache = true;")),(0,r.kt)("p",null,"\u662f\u5426\u5f00\u542f\u6ce8\u518c\u5217\u8868\u7684\u4e8c\u7ea7\u7f13\u5b58\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"disableDelta=false\u3002")),(0,r.kt)("p",null,"\u662f\u5426\u4e3aclient\u63d0\u4f9b\u589e\u91cf\u4fe1\u606f\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"maxThreadsForStatusReplication = 1;")),(0,r.kt)("p",null,"\u72b6\u6001\u540c\u6b65\u7684\u6700\u5927\u7ebf\u7a0b\u6570\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"maxElementsInStatusReplicationPool = 10000;")),(0,r.kt)("p",null,"\u72b6\u6001\u540c\u6b65\u961f\u5217\u7684\u6700\u5927\u5bb9\u91cf\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"syncWhenTimestampDiffers = true;")),(0,r.kt)("p",null,"\u5f53\u65f6\u95f4\u5dee\u5f02\u65f6\u662f\u5426\u540c\u6b65\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"registrySyncRetries = 0;")),(0,r.kt)("p",null,"\u6ce8\u518c\u4fe1\u606f\u540c\u6b65\u91cd\u8bd5\u6b21\u6570\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"registrySyncRetryWaitMs = 30 * 1000;")),(0,r.kt)("p",null,"\u6ce8\u518c\u4fe1\u606f\u540c\u6b65\u91cd\u8bd5\u671f\u95f4\u7684\u65f6\u95f4\u95f4\u9694\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"maxElementsInPeerReplicationPool = 10000;")),(0,r.kt)("p",null,"\u8282\u70b9\u95f4\u540c\u6b65\u4e8b\u4ef6\u7684\u6700\u5927\u5bb9\u91cf\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"minThreadsForPeerReplication = 5;")),(0,r.kt)("p",null,"\u8282\u70b9\u95f4\u540c\u6b65\u7684\u6700\u5c0f\u7ebf\u7a0b\u6570\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"maxThreadsForPeerReplication = 20;")),(0,r.kt)("p",null,"\u8282\u70b9\u95f4\u540c\u6b65\u7684\u6700\u5927\u7ebf\u7a0b\u6570\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"maxTimeForReplication = 30000;")),(0,r.kt)("p",null,"\u8282\u70b9\u95f4\u540c\u6b65\u7684\u6700\u5927\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u6beb\u79d2\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"disableDeltaForRemoteRegions = false\uff1b")),(0,r.kt)("p",null,"\u662f\u5426\u542f\u7528\u8fdc\u7a0b\u533a\u57df\u589e\u91cf\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"remoteRegionConnectTimeoutMs = 1000;")),(0,r.kt)("p",null,"\u8fdc\u7a0b\u533a\u57df\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"remoteRegionReadTimeoutMs = 1000;")),(0,r.kt)("p",null,"\u8fdc\u7a0b\u533a\u57df\u8bfb\u53d6\u8d85\u65f6\u65f6\u95f4\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"remoteRegionTotalConnections = 1000;")),(0,r.kt)("p",null,"\u8fdc\u7a0b\u533a\u57df\u6700\u5927\u8fde\u63a5\u6570"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"remoteRegionTotalConnectionsPerHost = 500;")),(0,r.kt)("p",null,"\u8fdc\u7a0b\u533a\u57df\u5355\u673a\u8fde\u63a5\u6570"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"remoteRegionConnectionIdleTimeoutSeconds = 30;")),(0,r.kt)("p",null,"\u8fdc\u7a0b\u533a\u57df\u8fde\u63a5\u7a7a\u95f2\u8d85\u65f6\u65f6\u95f4\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"remoteRegionRegistryFetchInterval = 30;")),(0,r.kt)("p",null,"\u8fdc\u7a0b\u533a\u57df\u6ce8\u518c\u4fe1\u606f\u62c9\u53d6\u9891\u7387\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"remoteRegionFetchThreadPoolSize = 20;")),(0,r.kt)("p",null,"\u8fdc\u7a0b\u533a\u57df\u6ce8\u518c\u4fe1\u606f\u7ebf\u7a0b\u6570\u3002"),(0,r.kt)("h4",{id:"4\u4eea\u8868\u76d8\u914d\u7f6e"},"4\u3001\u4eea\u8868\u76d8\u914d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"eureka:\n    dashboard:\n        enabled: true # \u662f\u5426\u542f\u7528eureka web\u63a7\u5236\u53f0\n        path: / # \u8bbe\u7f6eeureka web\u63a7\u5236\u53f0\u9ed8\u8ba4\u8bbf\u95ee\u8def\u5f84\n")),(0,r.kt)("p",null,"\u6ce8\u518c\u4e2d\u5fc3\u4eea\u8868\u76d8\u7684\u914d\u7f6e\u4e3b\u8981\u662f\u63a7\u5236\u6ce8\u518c\u4e2d\u5fc3\u7684\u53ef\u89c6\u5316\u5c55\u793a\u3002\u4ee5eureka.dashboard.xxx\u7684\u683c\u5f0f\u914d\u7f6e\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'path="/"')),(0,r.kt)("p",null,"\u4eea\u8868\u76d8\u8bbf\u95ee\u8def\u5f84"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"enabled=true")),(0,r.kt)("p",null,"\u662f\u5426\u542f\u7528\u4eea\u8868\u76d8"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6539\u9020 provider")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 8001\n\n\neureka:\n  instance:\n    hostname: localhost # \u4e3b\u673a\u540d\n    prefer-ip-address: true # \u5c06\u5f53\u524d\u5b9e\u4f8b\u7684ip\u6ce8\u518c\u5230eureka server \u4e2d\u3002\u9ed8\u8ba4\u662ffalse \u6ce8\u518c\u4e3b\u673a\u540d\n    ip-address: 127.0.0.1 # \u8bbe\u7f6e\u5f53\u524d\u5b9e\u4f8b\u7684ip\n    instance-id: ${eureka.instance.ip-address}:${spring.application.name}:${server.port} # \u8bbe\u7f6eweb\u63a7\u5236\u53f0\u663e\u793a\u7684 \u5b9e\u4f8bid\n    lease-renewal-interval-in-seconds: 3 # \u6bcf\u96943 \u79d2\u53d1\u4e00\u6b21\u5fc3\u8df3\u5305\n    lease-expiration-duration-in-seconds: 9 # \u5982\u679c9\u79d2\u6ca1\u6709\u53d1\u5fc3\u8df3\u5305\uff0c\u670d\u52a1\u5668\u5440\uff0c\u4f60\u628a\u6211\u5e72\u6389\u5427~\n  client:\n    service-url:\n      defaultZone: http://localhost:8761/eureka # eureka\u670d\u52a1\u7aef\u5730\u5740\uff0c\u5c06\u6765\u5ba2\u6237\u7aef\u4f7f\u7528\u8be5\u5730\u5740\u548ceureka\u8fdb\u884c\u901a\u4fe1\nspring:\n  application:\n    name: eureka-provider # \u8bbe\u7f6e\u5f53\u524d\u5e94\u7528\u7684\u540d\u79f0\u3002\u5c06\u6765\u4f1a\u5728eureka\u4e2dApplication\u663e\u793a\u3002\u5c06\u6765\u9700\u8981\u4f7f\u7528\u8be5\u540d\u79f0\u6765\u83b7\u53d6\u8def\u5f84\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"consumer")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 9000\n\n\neureka:\n  instance:\n    hostname: localhost # \u4e3b\u673a\u540d\n  client:\n    service-url:\n      defaultZone: http://localhost:8761/eureka # eureka\u670d\u52a1\u7aef\u5730\u5740\uff0c\u5c06\u6765\u5ba2\u6237\u7aef\u4f7f\u7528\u8be5\u5730\u5740\u548ceureka\u8fdb\u884c\u901a\u4fe1\nspring:\n  application:\n    name: eureka-consumer # \u8bbe\u7f6e\u5f53\u524d\u5e94\u7528\u7684\u540d\u79f0\u3002\u5c06\u6765\u4f1a\u5728eureka\u4e2dApplication\u663e\u793a\u3002\u5c06\u6765\u9700\u8981\u4f7f\u7528\u8be5\u540d\u79f0\u6765\u83b7\u53d6\u8def\u5f84\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"server")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 8761\n\n# eureka \u914d\u7f6e\n# eureka \u4e00\u5171\u67094\u90e8\u5206 \u914d\u7f6e\n# 1. dashboard:eureka\u7684web\u63a7\u5236\u53f0\u914d\u7f6e\n# 2. server:eureka\u7684\u670d\u52a1\u7aef\u914d\u7f6e\n# 3. client:eureka\u7684\u5ba2\u6237\u7aef\u914d\u7f6e\n# 4. instance:eureka\u7684\u5b9e\u4f8b\u914d\u7f6e\n\n\neureka:\n  instance:\n    hostname: localhost # \u4e3b\u673a\u540d\n  client:\n    service-url:\n      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka # eureka\u670d\u52a1\u7aef\u5730\u5740\uff0c\u5c06\u6765\u5ba2\u6237\u7aef\u4f7f\u7528\u8be5\u5730\u5740\u548ceureka\u8fdb\u884c\u901a\u4fe1\n    register-with-eureka: false # \u662f\u5426\u5c06\u81ea\u5df1\u7684\u8def\u5f84 \u6ce8\u518c\u5230eureka\u4e0a\u3002eureka server \u4e0d\u9700\u8981\u7684\uff0ceureka provider client \u9700\u8981\n    fetch-registry: false # \u662f\u5426\u9700\u8981\u4eceeureka\u4e2d\u6293\u53d6\u8def\u5f84\u3002eureka server \u4e0d\u9700\u8981\u7684\uff0ceureka consumer client \u9700\u8981\n  server:\n    enable-self-preservation: false # \u5173\u95ed\u81ea\u6211\u4fdd\u62a4\u673a\u5236\n    eviction-interval-timer-in-ms: 3000 # \u68c0\u67e5\u670d\u52a1\u7684\u65f6\u95f4\u95f4\u9694\n")),(0,r.kt)("h3",{id:"\u516d\u9ad8\u53ef\u7528"},"\u516d\u3001\u9ad8\u53ef\u7528"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220406114821846-5d110f1f.png",alt:"image-20220406114821846"}),"image-20220406114821846"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u51c6\u5907\u4e24\u4e2aEureka Server"),(0,r.kt)("li",{parentName:"ol"},"\u5206\u522b\u8fdb\u884c\u914d\u7f6e\uff0c",(0,r.kt)("strong",{parentName:"li"},"\u76f8\u4e92\u6ce8\u518c")),(0,r.kt)("li",{parentName:"ol"},"Eureka Client \u5206\u522b\u6ce8\u518c\u5230\u8fd9\u4e24\u4e2a Eureka Server\u4e2d")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u521b\u5efaeureka-server1")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 8761\n\n\neureka:\n  instance:\n    hostname: eureka-server1 # \u4e3b\u673a\u540d\n  client:\n    service-url:\n      defaultZone: http://eureka-server2:8762/eureka\n    register-with-eureka: true # \u662f\u5426\u5c06\u81ea\u5df1\u7684\u8def\u5f84 \u6ce8\u518c\u5230eureka\u4e0a\u3002eureka server \u4e0d\u9700\u8981\u7684\uff0ceureka provider client \u9700\u8981\n    fetch-registry: true # \u662f\u5426\u9700\u8981\u4eceeureka\u4e2d\u6293\u53d6\u8def\u5f84\u3002eureka server \u4e0d\u9700\u8981\u7684\uff0ceureka consumer client \u9700\u8981\n\n\nspring:\n  application:\n    name: eureka-server-ha\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u521b\u5efaeureka-server2")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 8762\n\n\neureka:\n  instance:\n    hostname: eureka-server2 # \u4e3b\u673a\u540d\n  client:\n    service-url:\n      defaultZone: http://eureka-server1:8761/eureka\n\n    register-with-eureka: true # \u662f\u5426\u5c06\u81ea\u5df1\u7684\u8def\u5f84 \u6ce8\u518c\u5230eureka\u4e0a\u3002eureka server \u4e0d\u9700\u8981\u7684\uff0ceureka provider client \u9700\u8981\n    fetch-registry: true # \u662f\u5426\u9700\u8981\u4eceeureka\u4e2d\u6293\u53d6\u8def\u5f84\u3002eureka server \u4e0d\u9700\u8981\u7684\uff0ceureka consumer client \u9700\u8981\nspring:\n  application:\n    name: eureka-server-ha\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4fee\u6539"),"\uff1aC:\\Windows\\System32\\drivers\\etc\\hosts"),(0,r.kt)("p",null,"127.0.0.1 eureka-server1 127.0.0.1 eureka-server2"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220406144138369-3a3af0a9.png",alt:"image-20220406144138369"}),"image-20220406144138369"),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,r.kt)("p",null,"provider"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 8001\n\n\neureka:\n  instance:\n    hostname: localhost # \u4e3b\u673a\u540d\n    prefer-ip-address: true # \u5c06\u5f53\u524d\u5b9e\u4f8b\u7684ip\u6ce8\u518c\u5230eureka server \u4e2d\u3002\u9ed8\u8ba4\u662ffalse \u6ce8\u518c\u4e3b\u673a\u540d\n    ip-address: 127.0.0.1 # \u8bbe\u7f6e\u5f53\u524d\u5b9e\u4f8b\u7684ip\n    instance-id: ${eureka.instance.ip-address}:${spring.application.name}:${server.port} # \u8bbe\u7f6eweb\u63a7\u5236\u53f0\u663e\u793a\u7684 \u5b9e\u4f8bid\n    lease-renewal-interval-in-seconds: 3 # \u6bcf\u96943 \u79d2\u53d1\u4e00\u6b21\u5fc3\u8df3\u5305\n    lease-expiration-duration-in-seconds: 9 # \u5982\u679c9\u79d2\u6ca1\u6709\u53d1\u5fc3\u8df3\u5305\uff0c\u670d\u52a1\u5668\u5440\uff0c\u4f60\u628a\u6211\u5e72\u6389\u5427~\n  client:\n    service-url:\n      defaultZone: http://eureka-server1:8761/eureka,http://eureka-server2:8762/eureka # eureka\u670d\u52a1\u7aef\u5730\u5740\uff0c\u5c06\u6765\u5ba2\u6237\u7aef\u4f7f\u7528\u8be5\u5730\u5740\u548ceureka\u8fdb\u884c\u901a\u4fe1\nspring:\n  application:\n    name: eureka-provider # \u8bbe\u7f6e\u5f53\u524d\u5e94\u7528\u7684\u540d\u79f0\u3002\u5c06\u6765\u4f1a\u5728eureka\u4e2dApplication\u663e\u793a\u3002\u5c06\u6765\u9700\u8981\u4f7f\u7528\u8be5\u540d\u79f0\u6765\u83b7\u53d6\u8def\u5f84\n")),(0,r.kt)("p",null,"consumer"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 9000\n\n\neureka:\n  instance:\n    hostname: localhost # \u4e3b\u673a\u540d\n  client:\n    service-url:\n      defaultZone:  http://eureka-server1:8761/eureka,http://eureka-server2:8762/eureka  # eureka\u670d\u52a1\u7aef\u5730\u5740\uff0c\u5c06\u6765\u5ba2\u6237\u7aef\u4f7f\u7528\u8be5\u5730\u5740\u548ceureka\u8fdb\u884c\u901a\u4fe1\nspring:\n  application:\n    name: eureka-consumer # \u8bbe\u7f6e\u5f53\u524d\u5e94\u7528\u7684\u540d\u79f0\u3002\u5c06\u6765\u4f1a\u5728eureka\u4e2dApplication\u663e\u793a\u3002\u5c06\u6765\u9700\u8981\u4f7f\u7528\u8be5\u540d\u79f0\u6765\u83b7\u53d6\u8def\u5f84\n")),(0,r.kt)("p",null,"\u8bbf\u95ee\uff1a",(0,r.kt)("a",{parentName:"p",href:"http://localhost:9000/order/add/4"},"http://localhost:9000/order/add/4open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220406144153992-acdf6713.png",alt:"image-20220406144153992"}),"image-20220406144153992"),(0,r.kt)("p",null,"\u9ad8\u53ef\u7528\u6d4b\u8bd5\uff1a\u505c\u6389\u4e00\u4e2aeureka,\u4f9d\u7136\u53ef\u4ee5\u8bbf\u95eeconsumer\u3002"),(0,r.kt)("p",null,"eureka\u4e0d\u66f4\u65b0\u4e86\uff0c\u6240\u4ee5\u6dd8\u6c70\u4e86\u3002"),(0,r.kt)("h2",{id:"\u7b2c\u516d\u7ae0-zookeeper\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0"},"\u7b2c\u516d\u7ae0 Zookeeper\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220406194741473-cc3720e9.png",alt:"image-20220406194741473"}),"image-20220406194741473"),(0,r.kt)("p",null,"\u6709\u7684\u8001\u9879\u76ee\u4ee5\u524d\u662fdubbo\uff0c\u5347\u7ea7\u5230\u5fae\u670d\u52a1\uff0c\u4f7f\u7528zookeeper\u505a\u6ce8\u518c\u4e2d\u5fc3\u3002"),(0,r.kt)("p",null,"zookeeper\u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u534f\u8c03\u5de5\u5177\uff0c\u53ef\u4ee5\u5b9e\u73b0\u6ce8\u518c\u4e2d\u5fc3\u529f\u80fd\u3002dubbo,\u5927\u6570\u636e\u7ec4\u4ef6hadoop,hive,kafka\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5b9e\u8d28"),"\uff1a\u6ce8\u518c\u4e2d\u5fc3\u6362\u6210zk"),(0,r.kt)("p",null,"1\u4e0b\u8f7d\uff1a",(0,r.kt)("a",{parentName:"p",href:"https://zookeeper.apache.org/"},"https://zookeeper.apache.org/open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220406152809933-e8b336fb.png",alt:"image-20220406152809933"}),"image-20220406152809933"),(0,r.kt)("p",null,"zoo.cfg"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'# The number of milliseconds of each tick\ntickTime=2000\n# The number of ticks that the initial \n# synchronization phase can take\ninitLimit=10\n# The number of ticks that can pass between \n# sending a request and getting an acknowledgement\nsyncLimit=5\n# the directory where the snapshot is stored.\n# do not use /tmp for storage, /tmp here is just \n# example sakes.\ndataDir=F:/apache-zookeeper-3.5.6-bin/data\n# the port at which the clients will connect\nclientPort=2181\n# the maximum number of client connections.\n# increase this if you need to handle more clients\n#maxClientCnxns=60\n#\n# Be sure to read the maintenance section of the \n# administrator guide before turning on autopurge.\n#\n# http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance\n#\n# The number of snapshots to retain in dataDir\n#autopurge.snapRetainCount=3\n# Purge task interval in hours\n# Set to "0" to disable auto purge feature\n#autopurge.purgeInterval=1\n')),(0,r.kt)("p",null,"\u542f\u52a8 bin\u76ee\u5f55\u4e0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"zkServer.cmd\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220406153622431-66776d12.png",alt:"image-20220406153622431"}),"image-20220406153622431"),(0,r.kt)("p",null,"2zookeeper-provider"),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"<artifactId>zookeeper-provider</artifactId>\n\n<dependencies>\n    \x3c!--springcloud \u6574\u5408 zookeeper \u7ec4\u4ef6--\x3e\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        \x3c!--zk\u53d1\u73b0--\x3e\n        <artifactId>spring-cloud-starter-zookeeper-discovery</artifactId>\n        <exclusions>\n            <exclusion>\n                <groupId>org.apache.zookeeper</groupId>\n                <artifactId>zookeeper</artifactId>\n            </exclusion>\n        </exclusions>\n    </dependency>\n    <dependency>\n        <groupId>org.apache.zookeeper</groupId>\n        <artifactId>zookeeper</artifactId>\n        <version>3.4.9</version>\n        <exclusions>\n            <exclusion>\n                <groupId>org.slf4j</groupId>\n                <artifactId>slf4j-log4j12</artifactId>\n            </exclusion>\n        </exclusions>\n    </dependency>\n\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n\n</dependencies>\n")),(0,r.kt)("p",null,"yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"server:\n  port: 8004\n\nspring:\n  application:\n    name: zookeeper-provider\n  cloud:\n    zookeeper:\n      connect-string: 127.0.0.1:2181 # zk\u5730\u5740\n")),(0,r.kt)("p",null,"\u4e3b\u542f\u52a8\u7c7b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"package com.ydlclass.zk;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.client.discovery.EnableDiscoveryClient;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@SpringBootApplication\n@EnableDiscoveryClient //\u5f00\u542f\u53d1\u73b0\u5ba2\u6237\u7aef\npublic class ProviderApp {\n    public static void main(String[] args) {\n        SpringApplication.run(ProviderApp.class,args);\n    }\n}\n")),(0,r.kt)("p",null,"\u4e1a\u52a1\u903b\u8f91\u4ee3\u7801\u76f4\u63a5\u590d\u5236\u7c98\u8d34\u8fc7\u6765"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220406172259585-d9bdd516.png",alt:"image-20220406172259585"}),"image-20220406172259585"),(0,r.kt)("p",null,"3zookeeper-consumer"),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"   <artifactId>zookeeper-consumer</artifactId>\n\n    <properties>\n        <maven.compiler.source>8</maven.compiler.source>\n        <maven.compiler.target>8</maven.compiler.target>\n    </properties>\n\n    <dependencies>\n        \x3c!--springcloud \u6574\u5408 zookeeper \u7ec4\u4ef6--\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            \x3c!--zk\u53d1\u73b0--\x3e\n            <artifactId>spring-cloud-starter-zookeeper-discovery</artifactId>\n            <exclusions>\n                <exclusion>\n                    <groupId>org.apache.zookeeper</groupId>\n                    <artifactId>zookeeper</artifactId>\n                </exclusion>\n            </exclusions>\n        </dependency>\n        <dependency>\n            <groupId>org.apache.zookeeper</groupId>\n            <artifactId>zookeeper</artifactId>\n            <version>3.5.6</version>\n            <exclusions>\n                <exclusion>\n                    <groupId>org.slf4j</groupId>\n                    <artifactId>slf4j-log4j12</artifactId>\n                </exclusion>\n            </exclusions>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n    </dependencies>\n")),(0,r.kt)("p",null,"yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"server:\n  port: 8005\n\nspring:\n  application:\n    name: zookeeper-consumer\n  cloud:\n    zookeeper:\n      connect-string: 127.0.0.1:2181 # zk\u5730\u5740\n")),(0,r.kt)("p",null,"\u542f\u52a8\u7c7b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"package com.ydlclass.zk;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.client.discovery.EnableDiscoveryClient;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@SpringBootApplication\n@EnableDiscoveryClient\npublic class ConsumerApp {\n    public static void main(String[] args) {\n        SpringApplication.run(ConsumerApp.class,args);\n    }\n}\n")),(0,r.kt)("p",null,"\u4e1a\u52a1\u903b\u8f91\u4ee3\u7801\u76f4\u63a5\u590d\u5236\u7c98\u8d34\u8fc7\u6765"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220406185656845-d3703bb1.png",alt:"image-20220406185656845"}),"image-20220406185656845"),(0,r.kt)("p",null,"controller\u53ea\u6539\u4e00\u4e2a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'List<ServiceInstance> instances = discoveryClient.getInstances("zookeeper-provider");\n')),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a",(0,r.kt)("a",{parentName:"p",href:"http://localhost:8005/order/add/5"},"http://localhost:8005/order/add/5open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220407144912417-fd30484b.png",alt:"image-20220407144912417"}),"image-20220407144912417"),(0,r.kt)("h2",{id:"\u7b2c\u4e03\u7ae0-consul\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0"},"\u7b2c\u4e03\u7ae0 Consul\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220407161804433-7424151c.png",alt:"image-20220407161804433"}),"image-20220407161804433"),(0,r.kt)("h3",{id:"\u4e00-\u662f\u4ec0\u4e48"},"\u4e00\u3001 \u662f\u4ec0\u4e48\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Consul \u662f\u7531 HashiCorp \u57fa\u4e8e GoLanguage \u8bed\u8a00\u5f00\u53d1\u7684\uff0c\u652f\u6301\u591a\u6570\u636e\u4e2d\u5fc3\uff0c\u5206\u5e03\u5f0f\u9ad8\u53ef\u7528\u7684\u670d\u52a1\u53d1\u5e03\u548c\u6ce8\u518c\u670d\u52a1\u8f6f\u4ef6\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u7528\u4e8e\u5b9e\u73b0\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u670d\u52a1\u53d1\u73b0\u4e0e\u914d\u7f6e\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528\u8d77\u6765\u4e5f\u8f83 \u4e3a\u7b80\u5355\u3002\u5177\u6709\u5929\u7136\u53ef\u79fb\u690d\u6027(\u652f\u6301Linux\u3001windows\u548cMac OS X)\uff1b\u5b89\u88c5\u5305\u4ec5\u5305\u542b\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u65b9\u4fbf\u90e8\u7f72 \u3002"),(0,r.kt)("li",{parentName:"ul"},"Consul\u5b98\u7f51\uff1a",(0,r.kt)("a",{parentName:"li",href:"https://www.consul.io/"},"https://www.consul.io/open in new window")," Consul\u4e2d\u6587\u6587\u6863\uff1a",(0,r.kt)("a",{parentName:"li",href:"https://www.springcloud.cc/spring-cloud-consul.html"},"https://www.springcloud.cc/spring-cloud-consul.htmlopen in new window"))),(0,r.kt)("h3",{id:"\u4e8c-\u600e\u4e48\u7528"},"\u4e8c\u3001 \u600e\u4e48\u7528\uff1a"),(0,r.kt)("h4",{id:"1-\u51c6\u5907"},"1\u3001 \u51c6\u5907"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220407161630689-ac7c0b2d.png",alt:"image-20220407161630689"}),"image-20220407161630689"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"consul.exe agent -dev\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220407161746354-b746e58c.png",alt:"image-20220407161746354"}),"image-20220407161746354"),(0,r.kt)("h4",{id:"2-\u642d\u5efa-consul-provider"},"2\u3001 \u642d\u5efa consul-provider"),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"    <dependencies>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-consul-discovery</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n    </dependencies>\n")),(0,r.kt)("p",null,"yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"server:\n  port: 8006\n\nspring:\n  application:\n    name: consul-provider\n  cloud:\n    consul:\n      host: 127.0.0.1\n      port: 8500\n      discovery:\n        service-name: ${spring.application.name}\n")),(0,r.kt)("p",null,"\u542f\u52a8\u7c7b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"package com.ydlclass.consul;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.client.discovery.EnableDiscoveryClient;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@SpringBootApplication\n@EnableDiscoveryClient\npublic class ProviderApp {\n    public static void main(String[] args) {\n        SpringApplication.run(ProviderApp.class,args);\n    }\n}\n")),(0,r.kt)("p",null,"\u4e1a\u52a1\u903b\u8f91\u590d\u5236"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220407163424691-9008997e.png",alt:"image-20220407163424691"}),"image-20220407163424691"),(0,r.kt)("p",null,"\u542f\u52a8"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220407162423209-689703ea.png",alt:"image-20220407162423209"}),"image-20220407162423209"),(0,r.kt)("h4",{id:"3\u642d\u5efa-consul-consumer"},"3\u3001\u642d\u5efa consul-consumer"),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"<dependencies>\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-consul-discovery</artifactId>\n    </dependency>\n\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-web</artifactId>\n    </dependency>\n</dependencies>\n")),(0,r.kt)("p",null,"yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 8007\n\nspring:\n  application:\n    name: consul-consumer\n  cloud:\n    consul:\n      host: 127.0.0.1\n      port: 8500\n      discovery:\n        service-name: ${spring.application.name}\n")),(0,r.kt)("p",null,"\u542f\u52a8\u7c7b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.consul;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.client.discovery.EnableDiscoveryClient;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@SpringBootApplication\n@EnableDiscoveryClient\npublic class ConsumerApp {\n    public static void main(String[] args) {\n        SpringApplication.run(ConsumerApp.class,args);\n    }\n}\n")),(0,r.kt)("p",null,"\u4e1a\u52a1\u903b\u8f91\u590d\u5236"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220407164001822-47a4a47b.png",alt:"image-20220407164001822"}),"image-20220407164001822"),(0,r.kt)("p",null,"controller\u53ea\u6539\u4e00\u53e5\u8bdd"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'List<ServiceInstance> instances = discoveryClient.getInstances("consul-provider");\n')),(0,r.kt)("p",null,"\u542f\u52a8"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220407164133404-c379b922.png",alt:"image-20220407164133404"}),"image-20220407164133404"),(0,r.kt)("p",null,"\u6700\u7ec8\u6d4b\u8bd5\u8c03\u7528\u6210\u529f\u5373\u53ef\uff1a",(0,r.kt)("a",{parentName:"p",href:"http://localhost:8007/order/add/9"},"http://localhost:8007/order/add/9open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAY4AAAC6CAMAAACORlpBAAAAflBMVEX///8jIyMxMTE6OjotLS0aGhomJiggISQRERENDQ0zMzNAQEAAAAAfHx8HBweKjYf//twaAdRGREULdQDN//7c3NyRAcyKck1siJB+SS4gOns/ISQ8b5O4urueoqZmaGkgIU3D7v+XISRBtOMgNmVERI/yyotiNiTTnSQgIawFNpvTAAALc0lEQVR42u1dC0OjOhMlXsJjvyJulY9WW1DXte7//4N3ZsIjPAttVfb2HFoIZEhrTk5mEig6AbAgOP8DFgTnB7AgODfAguC4wIIAOkDHMXieUv5VwnG9pS2ef71wvKXB90HHYqD8K6dDLWm5cjZ8Ry0KPuj4euwzD3RMpsNNktHa9PLcG869iRPHSbIb5WUDp2eOkx0nw8vjLIvz63Ltjh+p1uImTqI7R61F5XHuDmXmjsFdvieq+ywyJ0kc0kcnJ7L5WGdZTsiytUXI48t7NPSX/Lp7HcsuON7EcfxERjveqnL7FjOy1BWTbU8TeN5su0XvUlf12RQJLumRyt3OoCNqwyM2vGgMyiU++k08YiNbR9E6Y0r6LPTeSVxiPOsWa/293jrb3HDiZpOtG3QM/SGBoaM3T1OeJNQudr1N6utd/ORv0qdySx/ouVSJbPJIhzpQJrNDUa+Nqkt6iw/uY3w4nQ7WRqSjcbA+VF+G6zjUkbHFfoAO0oaST8m6BdRfy81iWmcZreLsfHVQnoTQVE/ap1qS5ktVVW6Ltn5jNn3Rdp86qCA1pg4qiQujlVaT6dCNRREbSkfHlkj46B6PudVTQu9FHR0D7qk8zveSwtIutG7OeXZT0uFleXVYmr9+oaI/fJOget7R7rsfGjpeOF3b6F9kcuCdu1eqGuo+lPeYPhkGNiltlX4muVRtnVu2ohX3Yb73Fv/O2DqO15Qrh9PyKFez8jmPTy9t6gSXREpUfrRLnyarQzcgfkOPUlHzEXUzE2ctR6WvcrpnZxXZbpsPra2vtbFc+Caucv68vBMld69Uyx/Kf0le9e7jMTn4O6p6ouNPwlvnw6tsdg8fZMKdlY64Y3pLqbM6cDeiuP5pSw7L9DEkDtOkb8iVpFTZZPMYp6ye1Hc38TZ6i7ceN3w5yhV/oKjGJXY4q7IpEtQxpj/oTeUXspuoDl2/gsSxkOgO8jguX7R081kRTGfBWguKWapNnayZbX0towhRBymlUsfby3tAtUyF/7o7/EpYIs++Fpoq30ErLTaKbchpPItyJHSLHjN2re6buHNWB7Vbd5dajmDDTFBzjqJNSo74wLXpcd1vPbajpq7kaNXoI2aotKmMTUlsSgzFp6qjSUfQpSM3RAgfedRDhx5Dsrfp2CdT6PDzTFu+g1t64FNVv0qCyPjzwL2VNnR44l8oHYoN5b1r8R1PHLxR29Xc7KlhR0YdB81bZRyBafLaM70Xtex6T3qemMlMf8hZFDexRqRbSysbv0pISUpx5Jan3ml0BAG7jqDcCQbrNdTcWXUO0+lrOYlWah+3zqfdyKajfb71tWKmQxd0bGxX/rxPXk2stL87SERFHRQdZwX8KdRR23jsPD44j7sXbtrUp8dbVkVEnZSogzsrcQSKQ680MrVJNZmKimSPOqmD+BiPQjA5y0RgRf9l2ZjE1pRE0YqnNH/qVDoCqqVAVlxdQcSBVbGjdZ1ZrcwrylkbQWeJuQMyZhn5hkbhciLRUewxMc2irdAlz36IOoiiH7UrF99hqtaoQ5moKSpU88Z0NGwiUg/RI51VGTxRZd1IRLU5uFVkRRypqGjXpuvh1s86MHuP2Zaqlccl0gNpLksZt0CGurQpjMl3FJ2f4oIOM9Rhar6qM4pQydvaVdxaSUK0EfQsFOiaBA1A/gkahRf5tWW7fDuSzDZlZ7XJPNt3iCsPSRKB8dcftH765bwXkVXThrIL5XyIR+AGzi6da42aL1e8y9uirati0MH+mIckogNyIFvuk7aKXYLeiedREoGJEZW3VZUNJVSREAltfW+GOEQdDG3eVCs8DNTlAV3mlSvTkkkbutoJamMdyDAw0DwMzFvZpSYqdbTKb/RW6yw2w8C4NQzUJAUKWz8073FUK2vioRx3sI1f2kjmM28o0JWeR0bhKtpl1OPzlnt+6aRcauzc0MWDcET7FIk6mCOKXTlY4kAgDUQdigMx0hMbkowqmzIhJXGQG5swbDIdZa3r8tYr1od1oMUIg4Mq614t++zbcpLEyS0i6lMdp52yim4Oy8tJEvvrythEy0JbIpACq4g6a8+nP+JJP0WFjS5tuLfnpIR71JmrcrYtkkkyxVcfOUyKVOHIZaZGyaUXtoqKHa/oeMQy0hI3meLlC9U2vHVNFGx2/cifR0ejXglestej98rledg6pUaoeQpxH0ftDF2QUKNTrm5OIW6ybJMf+f6RtT4GqT8zj+YLF3ae6k5CGdbqU+ujyheF9BRvTWdFJ8xPOz21HQbjbAS34UhmGIYj+fuajaybG/lfgJFp/NbVSNVbozK5ptT4dz3xuqZz24fV7ThWo3mrE8+kzC/hY8kT7L3DimhwwGHG2tVkyaDF8Pnlup4csU+9djpuw56l92C1hLdHl7B495waNspof2xw3YQ44UxUdWmqtteirvmek2/DmpYeXDcfTljXz5RXo9aP2YydXhLSfQVQx7LQHBGCDqDROor3JKtgqn0vHDrxpCUIP3Uxq0BWgxbFq3z354Y9pbSygrAccHU+pDha7TTHZ0GzjM7Xn/13Owv9kVwYtKqq36JFSCM3tGy6pbSywv7PCe3v0OWq0WLsEka/+dhvA/HzyEX9VPMfYEFwAAAAAAAAAAAAAAAAAOAvxd12/fsB1bAYNkDGkuh4BR3fgKRCi44UdHwnH1DHoumA7/hWPhx0VguiA33VkuhAoLsoPhDoLoqPLh3wHd9HB4aBSx+VQx3L4uMVU4gAAAAA8NdijyoAHQAAdQAXx1peX3ce1AE2/mviWDFmnHf3/58/f2JuZq46prBheFg19o+z8cBvEPAJaNHhrI6eIVSAj8+JrEbpWK9BxycooHAOpY+wtzYdXScCOi6vjpX15lV7W9Kxmt5ZsTcHHaf3RxekQyKrPdRxsu+wu6QL0CEAHWd56wvTAd9xljqGOqtVi44JrlyoEDbWGLufE8v2RFaOvJr7x+hwKkcOOk6MrCb7hLmzMMBJ4w6w8VeMygEA6gAAqAMAAKgDaOO+tYU6jo3TZg3Vjtnf2zV/z6jpsHabdsAns3FvV31FR62S62Rj9n1WnamS1TniAB1niqNFR3smaxYbdbLQSk3HlbIxPbIaUsWJE4v3NXrVAVyWjinXlWyhgI4Z6rDu62nsN27oOY+Oe9Bxgjr6t6ddnrKdulmgju+g474J0HFpdaxOuVx43wq4oI5LquPkCZJWZAWBTKJj1aJh9P6qma58gI4ru+9nxoxudcf0qm//3Miqnj1pHsatDV+F+146nOZUFtTxhXwMkgNxAFeuDgCAOgAA6gCAK1PHpe9dAM4B2FiUOoaqd2g2fZwOeTKMPBymekZMNwHMb+wDdEx4NEyVqB690ExAHV+GBh0DnEADn6KrNej4LHWUv042P1Ne2be7zbreYXzHg/2MmG4CmMJHccWvdVWw+O3/vEfDPNTPiOkmoI4JdFhVbx3pPBxjugMpnxFz10kA59Mx406SukcaSUAdZ6tjIhNNf96fACb6jiYdw75jMLIyVV49I6abuOKnxkxXR/fGkdX8yMoaelduu5vALMukzuoLpwKgjvG+agU2AKgDAACoAwCgDgCAOq4CuJVkSeoAG/9tcZRz6N2ZQ+Ai//vJsW7zOWZv31XVmlcHTsFqxtFhdeAGkgtFVlPpGLqIBDouIopVeUNP63JT9Y8kpvzPJ9BxGXUM/tuU+uLsrBsX7nB71WU8RpOO+taFqd6jqHqo4yzf0Xp+VYeO1Tw6ynutQMeZEhlSx7x/wNW6aR10nOE7Vr2+w5n2TJJCCRh3XCCwqod8zciqupX6GB3F720eMCq/0LgDAKAOAIA6AAAAAAD4S3G3Xf/GcHhRhIAP0AEM0PEKOpZERwo6oA4A6oA8AERWEAcA3wF1AFDHFTlyTCECAAAAAAAAAAAAwGfgX2ekYuNyalvhAAAAAElFTkSuQmCC",alt:"image-20220407164211124"}),"image-20220407164211124"),(0,r.kt)("h3",{id:"\u4e09-\u4e09\u4e2a\u6ce8\u518c\u4e2d\u5fc3\u7684\u5f02\u540c"},"\u4e09\u3001 \u4e09\u4e2a\u6ce8\u518c\u4e2d\u5fc3\u7684\u5f02\u540c"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u7ec4\u4ef6"),(0,r.kt)("th",{parentName:"tr",align:null},"\u8bed\u8a00"),(0,r.kt)("th",{parentName:"tr",align:null},"cap"),(0,r.kt)("th",{parentName:"tr",align:null},"\u5065\u5eb7\u68c0\u67e5"),(0,r.kt)("th",{parentName:"tr",align:null},"\u66b4\u9732\u63a5\u53e3"),(0,r.kt)("th",{parentName:"tr",align:null},"cloud\u96c6\u6210"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"eureka"),(0,r.kt)("td",{parentName:"tr",align:null},"java"),(0,r.kt)("td",{parentName:"tr",align:null},"ap"),(0,r.kt)("td",{parentName:"tr",align:null},"\u652f\u6301"),(0,r.kt)("td",{parentName:"tr",align:null},"http"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5df2\u7ecf\u96c6\u6210")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"zookeeper"),(0,r.kt)("td",{parentName:"tr",align:null},"java"),(0,r.kt)("td",{parentName:"tr",align:null},"cp"),(0,r.kt)("td",{parentName:"tr",align:null},"\u652f\u6301"),(0,r.kt)("td",{parentName:"tr",align:null},"tcp"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5df2\u7ecf\u96c6\u6210")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"consul"),(0,r.kt)("td",{parentName:"tr",align:null},"go"),(0,r.kt)("td",{parentName:"tr",align:null},"cp"),(0,r.kt)("td",{parentName:"tr",align:null},"\u652f\u6301"),(0,r.kt)("td",{parentName:"tr",align:null},"http"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5df2\u7ecf\u96c6\u6210")))),(0,r.kt)("p",null,"cap"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"c:consustency \u5f3a\u4e00\u81f4\u6027"),(0,r.kt)("li",{parentName:"ul"},"a:avalibility \u53ef\u7528\u6027"),(0,r.kt)("li",{parentName:"ul"},"p:partition tolerance \u5206\u533a\u5bb9\u5fcd\u6027")),(0,r.kt)("h2",{id:"\u7b2c\u516b\u7ae0-ribbon\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u8c03\u7528"},"\u7b2c\u516b\u7ae0 Ribbon\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u8c03\u7528"),(0,r.kt)("h3",{id:"\u4e00\u662f\u4ec0\u4e48"},"\u4e00\u3001\u662f\u4ec0\u4e48"),(0,r.kt)("p",null,"Netflix\u516c\u53f8\u63a8\u51fa\u7684http\u548cTCP\u7684\u5ba2\u6237\u7aef\u8d1f\u8f7d\u5747\u8861\u5de5\u5177\u3002"),(0,r.kt)("p",null,"ribbon:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u7b80\u5316\u8fdc\u7a0b\u8c03\u7528\u4ee3\u7801"),(0,r.kt)("li",{parentName:"ul"},"\u5185\u7f6e\u5f88\u591a\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5")),(0,r.kt)("h4",{id:"1\u670d\u52a1\u7aef\u8d1f\u8f7d\u5747\u8861"},"1\u3001\u670d\u52a1\u7aef\u8d1f\u8f7d\u5747\u8861"),(0,r.kt)("p",null,"\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u5728\u670d\u52a1\u7aef\uff0c\u670d\u52a1\u7aef\u7ef4\u62a4\u670d\u52a1\u5217\u8868\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220407173053676-2349faf0.png",alt:"image-20220407173053676"}),"image-20220407173053676"),(0,r.kt)("h4",{id:"2\u5ba2\u6237\u7aef\u8d1f\u8f7d\u5747\u8861"},"2\u3001\u5ba2\u6237\u7aef\u8d1f\u8f7d\u5747\u8861"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u5728\u5ba2\u6237\u7aef"),(0,r.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aef\u7ef4\u62a4\u670d\u52a1\u5217\u8868")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220407173409352-2bb522c4.png",alt:"image-20220407173409352"}),"image-20220407173409352"),(0,r.kt)("h3",{id:"\u4e8c\u5982\u4f55\u4f7f\u7528"},"\u4e8c\u3001\u5982\u4f55\u4f7f\u7528"),(0,r.kt)("p",null,"1.\u65b0\u7248\u7684eureka\u4f9d\u8d56\u4ee5\u53ca\u96c6\u6210\u4e86Ribbon\u4f9d\u8d56\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e0d\u5f15\u7528"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"  \x3c!--Ribbon\u7684\u4f9d\u8d56--\x3e\n  <dependency>\n      <groupId>org.springframework.cloud</groupId>\n      <artifactId>spring-cloud-starter-netflix-ribbon</artifactId>\n </dependency>\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408112040713-49705355.png",alt:"image-20220408112040713"}),"image-20220408112040713"),(0,r.kt)("p",null,"2.\u58f0\u660erestTemplate\u65f6@LoadBalanced"),(0,r.kt)("p",null,"3.restTemplate\u8bf7\u6c42\u8fdc\u7a0b\u670d\u52a1\u65f6\uff0cip\u7aef\u53e3\u66ff\u6362\u4e3a\u670d\u52a1\u540d"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'String url="http://EUREKA-PROVIDER/goods/findById/"+id;\nGoods goods = restTemplate.getForObject(url, Goods.class);\n')),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,r.kt)("p",null,"1.\u542f\u52a82\u4e2aprovider"),(0,r.kt)("p",null,"controller"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'goods.setTitle(goods.getTitle()+"|\u7aef\u53e3\u53f7\uff1a"+port);\n')),(0,r.kt)("p",null,"idea\u8bbe\u7f6e \u80fd\u542f\u52a8\u4e24\u4efd provider"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408112658153-df840762.png",alt:"image-20220408112658153"}),"image-20220408112658153"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408112814966-37a23e92.png",alt:"image-20220408112814966"}),"image-20220408112814966"),(0,r.kt)("p",null,"2.\u591a\u6b21\u8bbf\u95eeconsumer"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408113212684-cc4cce36.png",alt:"image-20220408113212684"}),"image-20220408113212684"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408113134662-3d63cf60.png",alt:"image-20220408113134662"}),"image-20220408113134662"),(0,r.kt)("p",null,"\u591a\u6b21\u5237\u65b0\uff0c\u53d1\u73b0\uff1aribbon\u5ba2\u6237\u7aef\uff0c\u9ed8\u8ba4\u4f7f\u7528\u8f6e\u8be2\u7b97\u6cd5\uff0c\u7ecf\u884c\u8d1f\u8f7d\u5747\u8861\u8c03\u7528\u3002"),(0,r.kt)("h3",{id:"\u4e09ribbon-\u8d1f\u8f7d\u5747\u8861\u7b56\u7565"},"\u4e09\u3001ribbon \u8d1f\u8f7d\u5747\u8861\u7b56\u7565"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"th"},"\u5185\u7f6e\u8d1f\u8f7d\u5747\u8861\u89c4\u5219\u7c7b")),(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"th"},"\u89c4\u5219\u63cf\u8ff0")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RoundRobinRule"),(0,r.kt)("td",{parentName:"tr",align:null},"\u7b80\u5355\u8f6e\u8be2\u670d\u52a1\u5217\u8868\u6765\u9009\u62e9\u670d\u52a1\u5668\u3002\u5b83\u662fRibbon\u9ed8\u8ba4\u7684\u8d1f\u8f7d\u5747\u8861\u89c4\u5219\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"AvailabilityFilteringRule"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5bf9\u4ee5\u4e0b\u4e24\u79cd\u670d\u52a1\u5668\u8fdb\u884c\u5ffd\u7565\uff1a\uff081\uff09\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fd9\u53f0\u670d\u52a1\u5668\u5982\u679c3\u6b21\u8fde\u63a5\u5931\u8d25\uff0c\u8fd9\u53f0\u670d\u52a1\u5668\u5c31\u4f1a\u88ab\u8bbe\u7f6e\u4e3a\u201c\u77ed\u8def\u201d\u72b6\u6001\u3002\u77ed\u8def\u72b6\u6001\u5c06\u6301\u7eed30\u79d2\uff0c\u5982\u679c\u518d\u6b21\u8fde\u63a5\u5931\u8d25\uff0c\u77ed\u8def\u7684\u6301\u7eed\u65f6\u95f4\u5c31\u4f1a\u51e0\u4f55\u7ea7\u5730\u589e\u52a0\u3002\u6ce8\u610f\uff1a\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u914d\u7f6eloadbalancer.",(0,r.kt)("inlineCode",{parentName:"td"},"<clientName>"),".connectionFailureCountThreshold\u6765\u4fee\u6539\u8fde\u63a5\u5931\u8d25\u591a\u5c11\u6b21\u4e4b\u540e\u88ab\u8bbe\u7f6e\u4e3a\u77ed\u8def\u72b6\u6001\u3002\u9ed8\u8ba4\u662f3\u6b21\u3002\uff082\uff09\u5e76\u53d1\u6570\u8fc7\u9ad8\u7684\u670d\u52a1\u5668\u3002\u5982\u679c\u4e00\u4e2a\u670d\u52a1\u5668\u7684\u5e76\u53d1\u8fde\u63a5\u6570\u8fc7\u9ad8\uff0c\u914d\u7f6e\u4e86AvailabilityFilteringRule\u89c4\u5219\u7684\u5ba2\u6237\u7aef\u4e5f\u4f1a\u5c06\u5176\u5ffd\u7565\u3002\u5e76\u53d1\u8fde\u63a5\u6570\u7684\u4e0a\u7ebf\uff0c\u53ef\u4ee5\u7531\u5ba2\u6237\u7aef\u7684",(0,r.kt)("inlineCode",{parentName:"td"},"<clientName>"),".",(0,r.kt)("inlineCode",{parentName:"td"},"<clientConfigNameSpace>"),".ActiveConnectionsLimit\u5c5e\u6027\u8fdb\u884c\u914d\u7f6e\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"WeightedResponseTimeRule"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4e3a\u6bcf\u4e00\u4e2a\u670d\u52a1\u5668\u8d4b\u4e88\u4e00\u4e2a\u6743\u91cd\u503c\u3002\u670d\u52a1\u5668\u54cd\u5e94\u65f6\u95f4\u8d8a\u957f\uff0c\u8fd9\u4e2a\u670d\u52a1\u5668\u7684\u6743\u91cd\u5c31\u8d8a\u5c0f\u3002\u8fd9\u4e2a\u89c4\u5219\u4f1a\u968f\u673a\u9009\u62e9\u670d\u52a1\u5668\uff0c\u8fd9\u4e2a\u6743\u91cd\u503c\u4f1a\u5f71\u54cd\u670d\u52a1\u5668\u7684\u9009\u62e9\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ZoneAvoidanceRule"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4ee5\u533a\u57df\u53ef\u7528\u7684\u670d\u52a1\u5668\u4e3a\u57fa\u7840\u8fdb\u884c\u670d\u52a1\u5668\u7684\u9009\u62e9\u3002\u4f7f\u7528Zone\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u5206\u7c7b\uff0c\u8fd9\u4e2aZone\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u673a\u623f\u3001\u4e00\u4e2a\u673a\u67b6\u7b49\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"BestAvailableRule"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5ffd\u7565\u54ea\u4e9b\u77ed\u8def\u7684\u670d\u52a1\u5668\uff0c\u5e76\u9009\u62e9\u5e76\u53d1\u6570\u8f83\u4f4e\u7684\u670d\u52a1\u5668\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"RandomRule"),(0,r.kt)("td",{parentName:"tr",align:null},"\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u53ef\u7528\u7684\u670d\u52a1\u5668\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Retry"),(0,r.kt)("td",{parentName:"tr",align:null},"\u91cd\u8bd5\u673a\u5236\u7684\u9009\u62e9\u903b\u8f91")))),(0,r.kt)("h3",{id:"\u56db-\u8bbe\u7f6eribbon-\u8d1f\u8f7d\u5747\u8861\u7b56\u7565"},"\u56db\u3001 \u8bbe\u7f6eribbon \u8d1f\u8f7d\u5747\u8861\u7b56\u7565"),(0,r.kt)("h4",{id:"1\u4ee3\u7801"},"1\u3001\u4ee3\u7801"),(0,r.kt)("p",null,"consumer\u5de5\u7a0b"),(0,r.kt)("p",null,"1.MyRule \u8fd4\u56de\u60f3\u8981\u7684\u89c4\u5219\u5373\u53ef"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.consumer.config;\n\nimport com.netflix.loadbalancer.IRule;\nimport com.netflix.loadbalancer.RandomRule;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n/**\n * creste by ydlclass.itcast\n */\n@Configuration\npublic class MyRule {\n    @Bean\n    public IRule rule(){\n        return new RandomRule();\n    }\n}\n")),(0,r.kt)("p",null,"2.\u542f\u52a8\u7c7b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@RibbonClient(name ="EUREKA-PROVIDER",configuration = MyRule.class)\n')),(0,r.kt)("p",null,"\u603b\u7ed3\uff1a"),(0,r.kt)("p",null,"1.irule\u7684\u5177\u4f53\u5b9e\u73b0\u7c7b\uff0c\u770b\u5230\u4ed6\u5e26\u7684\u51e0\u4e2a\u7b56\u7565\u7684\u5199\u6cd5\u3002"),(0,r.kt)("p",null,"2.\u4eff\u7167\u7b56\u7565\u7684\u5199\u6cd5\uff0c\u81ea\u5df1\u5199\u7b56\u7565\u3002"),(0,r.kt)("p",null,"3.\u8c03\u7528\u4e0d\u540c\u7684\u5176\u4ed6\u5fae\u670d\u52a1\u65f6\uff0c\u53ef\u4ee5\u91c7\u7528\u4e0d\u540c\u7684\u7b56\u7565\u3002"),(0,r.kt)("h4",{id:"2\u914d\u7f6e"},"2\u3001\u914d\u7f6e"),(0,r.kt)("p",null,"consumer\u5de5\u7a0b"),(0,r.kt)("p",null,"application.yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"EUREKA-PROVIDER: #\u8fdc\u7a0b\u670d\u52a1\u540d\n  ribbon:\n    NFLoadBalancerRuleClassName: com.netflix.loadbalancer.RandomRule #\u7b56\u7565\n")),(0,r.kt)("p",null,"\u4f5c\u7528\uff1a\u65b9\u4fbf\u8fd0\u7ef4\u4fee\u6539\uff0c\u91cd\u542f\u3002\u968f\u65f6\u5207\u6362\u7b56\u7565\u3002"),(0,r.kt)("h2",{id:"\u7b2c\u4e5d\u7ae0openfeign\u670d\u52a1\u63a5\u53e3\u8c03\u7528"},"\u7b2c\u4e5d\u7ae0\u3001OpenFeign\u670d\u52a1\u63a5\u53e3\u8c03\u7528"),(0,r.kt)("h3",{id:"\u4e00\u6982\u8ff0"},"\u4e00\u3001\u6982\u8ff0"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Feign \u662f\u4e00\u4e2a\u58f0\u660e\u5f0f\u7684 REST \u5ba2\u6237\u7aef\uff0c\u5b83\u7528\u4e86",(0,r.kt)("strong",{parentName:"li"},"\u57fa\u4e8e\u63a5\u53e3\u7684\u6ce8\u89e3\u65b9\u5f0f"),"\uff0c\u5f88\u65b9\u4fbf\u5b9e\u73b0\u5ba2\u6237\u7aef\u50cf\u8c03\u7528\u672c\u5730\u63a5\u53e3\u65b9\u6cd5\u4e00\u6837\uff0c\u8fdb\u884c\u8fdc\u7a0b\u8c03\u7528\u3002"),(0,r.kt)("li",{parentName:"ul"},"Feign \u6700\u521d\u7531 Netflix \u516c\u53f8\u63d0\u4f9b\uff0c\u4f46\u4e0d\u652f\u6301SpringMVC\u6ce8\u89e3\uff0c\u540e\u7531 SpringCloud \u5bf9\u5176\u5c01\u88c5\uff0c\u652f\u6301\u4e86SpringMVC\u6ce8\u89e3\uff0c\u8ba9\u4f7f\u7528\u8005\u66f4\u6613\u4e8e\u63a5\u53d7\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/#spring-cloud-openfeign"},"https://cloud.spring.io/spring-cloud-static/Hoxton.SR1/reference/htmlsingle/#spring-cloud-openfeignopen in new window"))),(0,r.kt)("h3",{id:"\u4e8c\u5feb\u901f\u5165\u95e8"},"\u4e8c\u3001\u5feb\u901f\u5165\u95e8"),(0,r.kt)("p",null,"a.\u5728\u6d88\u8d39\u7aef\u5f15\u5165 open-feign \u4f9d\u8d56\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-openfeign</artifactId>\n</dependency>\n")),(0,r.kt)("p",null,"b.\u7f16\u5199Feign\u8c03\u7528\u63a5\u53e3\u3002",(0,r.kt)("strong",{parentName:"p"},"\u590d\u5236\u7c98\u8d34\u88ab\u8c03\u65b9\u7684conreoller\u65b9\u6cd5,\u52a0\u4e0a\u7c7b\u8def\u5f84\u3002")),(0,r.kt)("p",null,"GoodsFeignClient\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.consumer.feign;\n\nimport com.ydlclass.consumer.domain.Goods;\nimport org.springframework.cloud.openfeign.FeignClient;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@FeignClient("EUREKA-PROVIDER")\npublic interface GoodsFeign {\n    @GetMapping("/goods/findById/{id}")\n    public Goods findById(@PathVariable("id") Integer id);\n}\n')),(0,r.kt)("p",null,"c.\u5728\u542f\u52a8\u7c7b \u6dfb\u52a0 @EnableFeignClients \u6ce8\u89e3\uff0c\u5f00\u542fFeign\u529f\u80fd"),(0,r.kt)("p",null,"d.\u6d4b\u8bd5\u8c03\u7528"),(0,r.kt)("p",null,"OrderController"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.consumer.controller;\n\nimport com.ydlclass.consumer.domain.Goods;\nimport com.ydlclass.consumer.feign.GoodsFeign;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.cloud.client.ServiceInstance;\nimport org.springframework.cloud.client.discovery.DiscoveryClient;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\nimport org.springframework.web.client.RestTemplate;\n\nimport java.util.List;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@RestController\n@RequestMapping("/order")\npublic class OrderController {\n    @Autowired\n    RestTemplate restTemplate;\n\n    @Autowired\n    private DiscoveryClient discoveryClient;\n\n    @Autowired\n    GoodsFeign goodsFeign;\n\n    @GetMapping("/add/{id}")\n    public Goods add(@PathVariable("id") Integer id){\n        //\u4e1a\u52a1\u903b\u8f91\n        //1\u67e5\u8be2\u5546\u54c1\n        //2\u51cf\u5e93\u5b58\n        //3\u652f\u4ed8\n        //4\u7269\u6d41\n        //\u76f4\u63a5\u8c03\u7528\n        //String url="http://localhost:8000/goods/findById/"+id;\n        //Goods goods = restTemplate.getForObject(url, Goods.class);\n\n//        //1\u670d\u52a1\u53d1\u73b0\n//        List<ServiceInstance> instances = discoveryClient.getInstances("EUREKA-PROVIDER");\n//        if(instances==null||instances.size()<=0){\n//            return null;\n//        }\n//        //2\u901a\u8fc7\u67d0\u4e2a\u7b56\u7565\u62ff\u5230\u4e00\u4e2a\u5b9e\u4f8b \u7b97\u6cd5\n//        ServiceInstance serviceInstance = instances.get(0);\n//        String host = serviceInstance.getHost();\n//        int port = serviceInstance.getPort();\n//        System.out.println(host);\n//        System.out.println(port);\n//\n//        String url="http://"+host+":"+port+"/goods/findById/"+id;\n//        Goods goods = restTemplate.getForObject(url, Goods.class);\n\n        //ribbon\n//        String url="http://EUREKA-PROVIDER/goods/findById/"+id;\n//        Goods goods = restTemplate.getForObject(url, Goods.class);\n\n        //feign\u8c03\u7528\n        Goods goods = goodsFeign.findById(id);\n\n        return goods;\n    }\n}\n')),(0,r.kt)("h3",{id:"\u4e09\u5176\u4ed6\u8bbe\u7f6e"},"\u4e09\u3001\u5176\u4ed6\u8bbe\u7f6e"),(0,r.kt)("h4",{id:"1\u8d85\u65f6\u8bbe\u7f6e"},"1\u3001\u8d85\u65f6\u8bbe\u7f6e"),(0,r.kt)("p",null,"\u2022 Feign \u5e95\u5c42\u4f9d\u8d56\u4e8e Ribbon \u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u548c\u8fdc\u7a0b\u8c03\u7528"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408171431530-17dcc892.png",alt:"image-20220408171431530"}),"image-20220408171431530"),(0,r.kt)("p",null,"\u2022 Ribbon\u9ed8\u8ba41\u79d2\u8d85\u65f6\u3002"),(0,r.kt)("p",null,"\u2022 \u8d85\u65f6\u914d\u7f6e\uff1a yml\u4e2d"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"# \u8bbe\u7f6eRibbon\u7684\u8d85\u65f6\u65f6\u95f4\nribbon:\n  ConnectTimeout: 1000 # \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u9ed8\u8ba41s\n  ReadTimeout: 3000 # \u903b\u8f91\u5904\u7406\u7684\u8d85\u65f6\u65f6\u95f4 \u9ed8\u8ba41s\n")),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,r.kt)("p",null,"1.\u8fde\u63a5\u8d85\u65f6\uff0cprovider\u90fd\u505c\u6389"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408172036937-989a933a.png",alt:"image-20220408172036937"}),"image-20220408172036937"),(0,r.kt)("p",null,"2.\u903b\u8f91\u5904\u7406\u7684\u8d85\u65f6\u65f6\u95f4"),(0,r.kt)("p",null,"provider"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'    @GetMapping("/findById/{id}")\n    public Goods findById(@PathVariable("id") Integer id){\n        Goods goods = goodsService.findById(id);\n        goods.setTitle(goods.getTitle()+"|\u7aef\u53e3\u53f7\uff1a"+port);\n        \n        //\u6a21\u62df\u4e1a\u52a1\u903b\u8f91\u6bd4\u8f83\u7e41\u5fd9\n        try {\n            Thread.sleep(5000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        return goods;\n    }\n')),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408172302166-9b28bb4d.png",alt:"image-20220408172302166"}),"image-20220408172302166"),(0,r.kt)("h4",{id:"2\u65e5\u5fd7\u8bb0\u5f55"},"2\u3001\u65e5\u5fd7\u8bb0\u5f55"),(0,r.kt)("p",null,"1.Feign \u53ea\u80fd\u8bb0\u5f55 debug \u7ea7\u522b\u7684\u65e5\u5fd7\u4fe1\u606f\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"# \u8bbe\u7f6e\u5f53\u524d\u7684\u65e5\u5fd7\u7ea7\u522b debug\uff0cfeign\u53ea\u652f\u6301\u8bb0\u5f55debug\u7ea7\u522b\u7684\u65e5\u5fd7\nlogging:\n  level:\n    com.ydlclass: debug\n")),(0,r.kt)("p",null,"\u2022 \u5b9a\u4e49Feign\u65e5\u5fd7\u7ea7\u522bBean"),(0,r.kt)("p",null,"FeignLogConfig"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.consumer.config;\n\nimport feign.Logger;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration\npublic class FeignLogConfig {\n\n\n    /*\n        NONE,\u4e0d\u8bb0\u5f55\n        BASIC,\u8bb0\u5f55\u57fa\u672c\u7684\u8bf7\u6c42\u884c\uff0c\u54cd\u5e94\u72b6\u6001\u7801\u6570\u636e\n        HEADERS,\u8bb0\u5f55\u57fa\u672c\u7684\u8bf7\u6c42\u884c\uff0c\u54cd\u5e94\u72b6\u6001\u7801\u6570\u636e\uff0c\u8bb0\u5f55\u54cd\u5e94\u5934\u4fe1\u606f\n        FULL;\u8bb0\u5f55\u5b8c\u6210\u7684\u8bf7\u6c42 \u54cd\u5e94\u6570\u636e\n\n\n     */\n\n    @Bean\n    public Logger.Level level(){\n        return Logger.Level.FULL;\n    }\n}\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u542f\u7528\u8be5Bean\uff1a")),(0,r.kt)("p",null,"GoodsFeignClient"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'@FeignClient(value = "FEIGN-PROVIDER",configuration = FeignLogConfig.class)\n')),(0,r.kt)("h2",{id:"image-20220408182551922"},(0,r.kt)("img",{parentName:"h2",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408182551922-f2ea6561.png",alt:"image-20220408182551922"})),(0,r.kt)("p",null,"\u8bbe\u7f6e\u4e3aheaders"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408182713438-68ea41ae.png",alt:"image-20220408182713438"}),"image-20220408182713438"),(0,r.kt)("h2",{id:"\u7b2c\u5341\u7ae0-hystrix\u65ad\u8def\u5668-\u8c6a\u732a-\u4fdd\u9669\u4e1d"},"\u7b2c\u5341\u7ae0 Hystrix\u65ad\u8def\u5668 \uff08\u8c6a\u732a\uff09-\u4fdd\u9669\u4e1d"),(0,r.kt)("h3",{id:"\u4e00\u6982\u8ff0-1"},"\u4e00\u3001\u6982\u8ff0"),(0,r.kt)("p",null,"\u91cd\u70b9\uff1a\u80fd\u8ba9\u670d\u52a1\u7684\u8c03\u7528\u65b9\uff0c\u591f\u5feb\u7684\u77e5\u9053\u88ab\u8c03\u65b9\u6302\u4e86\uff01\u4e0d\u81f3\u4e8e\u8bf4\u8ba9\u7528\u6237\u5728\u7b49\u5f85\u3002"),(0,r.kt)("p",null,"Hystix \u662f Netflix \u5f00\u6e90\u7684\u4e00\u4e2a\u5ef6\u8fdf\u548c\u5bb9\u9519\u5e93\uff0c\u7528\u4e8e\u9694\u79bb\u8bbf\u95ee\u8fdc\u7a0b\u670d\u52a1\u3001\u7b2c\u4e09\u65b9\u5e93\uff0c\u9632\u6b62\u51fa\u73b0\u7ea7\u8054\u5931\u8d25\uff08\u96ea\u5d29\uff09\u3002"),(0,r.kt)("p",null,"\u96ea\u5d29\uff1a\u4e00\u4e2a\u670d\u52a1\u5931\u8d25\uff0c\u5bfc\u81f4\u6574\u6761\u94fe\u8def\u7684\u670d\u52a1\u90fd\u5931\u8d25\u7684\u60c5\u5f62\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411101214886-e1894fb1.png",alt:"image-20220411101214886"}),"image-20220411101214886"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411104119551-5dbb216d.png",alt:"image-20220411104119551"}),"image-20220411104119551"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411101248131-23fdbc68.png",alt:"image-20220411101248131"}),"image-20220411101248131"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411101310179-039fb050.png",alt:"image-20220411101310179"}),"image-20220411101310179"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Hystix \u4e3b\u8981\u529f\u80fd")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411101741096-ad89764b.png",alt:"image-20220411101741096"}),"image-20220411101741096"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9694\u79bb")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u7ebf\u7a0b\u6c60\u9694\u79bb"),(0,r.kt)("p",{parentName:"li"},"\u6ca1\u6709hystrix,a\u91cd\u8bd5100\u6b21\uff0c\u624d\u77e5\u9053c\u6302\u4e86\uff01"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411102317061-a569d3eb.png",alt:"image-20220411102317061"}),"image-20220411102317061"),(0,r.kt)("p",{parentName:"li"},"\u4f7f\u7528\u4e86hystrix,\u66f4\u7ec6\u5206\u7ebf\u7a0b\u6c60\uff0c\u53ea\u9700\u8981\u91cd\u8bd540\u6b21\uff0c\u8ba9a\u66f4\u5feb\u7684\u77e5\u9053c\u6302\u4e86"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411102720425-31875f98.png",alt:"image-20220411102720425"}),"image-20220411102720425")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u4fe1\u53f7\u91cf\u9694\u79bb"),(0,r.kt)("p",{parentName:"li"},"\u6ca1\u6709hystrix,a\u4e00\u4e2a\u5e26\u7740\u8ba4\u8bc1\u4fe1\u606f\u7684\u7ebf\u7a0b\uff0c\u91cd\u8bd5100\u6b21\uff0c\u624d\u77e5\u9053c\u6302\u4e86\uff01"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411103036778-e2674a15.png",alt:"image-20220411103036778"}),"image-20220411103036778"),(0,r.kt)("p",{parentName:"li"},"\u4f7f\u7528\u4e86hystrix,\u66f4\u7ec6\u5206\u7ebf\u7a0b\u6c60\uff0c\u4e00\u4e2a\u5e26\u7740\u8ba4\u8bc1\u4fe1\u606f\u7684\u7ebf\u7a0b,\u53ea\u9700\u8981\u91cd\u8bd540\u6b21\uff0c\u8ba9a\u66f4\u5feb\u7684\u77e5\u9053c\u6302\u4e86"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411103152275-926f5142.png",alt:"image-20220411103152275"}),"image-20220411103152275"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u964d\u7ea7"),"\uff1a"),(0,r.kt)("p",null,"\u670d\u52a1\u63d0\u4f9b\u65b9\u964d\u7ea7(\u5f02\u5e38\uff0c\u8d85\u65f6)"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411104951728-51506d7b.png",alt:"image-20220411104951728"}),"image-20220411104951728"),(0,r.kt)("p",null,"\u6d88\u8d39\u65b9\u964d\u7ea7"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411112946547-e3d81fb6.png",alt:"image-20220411112946547"}),"image-20220411112946547"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7194\u65ad")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u9650\u6d41")),(0,r.kt)("p",null," \u662f\u6709\u9650\u6d41\uff0c\u4f46\u662f\uff0c\u9879\u76ee\u4e00\u822c\u4e0d\u7528\u3002nginx\u6216\u8005\u7f51\u5173\u9650\u6d41\u3002"),(0,r.kt)("h3",{id:"\u4e8c\u670d\u52a1\u964d\u7ea7"},"\u4e8c\u3001\u670d\u52a1\u964d\u7ea7"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u670d\u52a1\u63d0\u4f9b\u65b9")),(0,r.kt)("p",null,"a\u3001\u5728\u670d\u52a1\u63d0\u4f9b\u65b9\uff0c\u5f15\u5165 hystrix \u4f9d\u8d56"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"        \x3c!-- hystrix --\x3e\n         <dependency>\n             <groupId>org.springframework.cloud</groupId>\n             <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>\n         </dependency>\n")),(0,r.kt)("p",null,"b\u3001\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'/** \u5b9a\u4e49\u964d\u7ea7\u65b9\u6cd5   \u8fd4\u56de\u7279\u6b8a\u5bf9\u8c61\n     *  1\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u8981\u548c\u539f\u65b9\u6cd5\u4e00\u81f4\n     *  2\u65b9\u6cd5\u53c2\u6570\u548c\u539f\u65b9\u6cd5\u4e00\u6837\n     */\n    public Goods findById_fallback(Integer id){\n        Goods goods=new Goods();\n        goods.setGoodId(-1);\n        goods.setTitle("provider\u63d0\u4f9b\u65b9\u964d\u7ea7\uff01");\n        goods.setPrice(-9.9);\n        goods.setStock(-10);\n\n        return goods;\n    }\n')),(0,r.kt)("p",null,"c\u3001\u4f7f\u7528 @HystrixCommand \u6ce8\u89e3\u914d\u7f6e\u964d\u7ea7\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@GetMapping("/findById/{id}")\n    @HystrixCommand(fallbackMethod = "findById_fallback",commandProperties = {\n            //\u8bbe\u7f6eHystrix\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba41s\n            @HystrixProperty(name="execution.isolation.thread.timeoutInMilliseconds",value = "3000")\n    })\n    public Goods findById(@PathVariable("id") Integer id){\n        Goods goods = goodsService.findById(id);\n        goods.setTitle(goods.getTitle()+"|\u7aef\u53e3\u53f7\uff1a"+port);\n\n        //\u6a21\u62df\u51fa\u5f02\u5e38\n//        int a=1/0;\n\n        //\u6a21\u62df\u4e1a\u52a1\u903b\u8f91\u6bd4\u8f83\u7e41\u5fd9\n        try {\n            Thread.sleep(5000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        return goods;\n    }\n')),(0,r.kt)("p",null,"d\u3001\u5728\u542f\u52a8\u7c7b\u4e0a\u5f00\u542fHystrix\u529f\u80fd\uff1a@EnableCircuitBreaker"),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a",(0,r.kt)("a",{parentName:"p",href:"http://localhost:9000/order/add/10"},"http://localhost:9000/order/add/10open in new window")),(0,r.kt)("p",null,"1.\u51fa\u9519\uff0c\u670d\u52a1\u65b9\u964d\u7ea7\u4e86"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411110206538-c3351b31.png",alt:"image-20220411110206538"}),"image-20220411110206538"),(0,r.kt)("p",null,"2.3000\u8d85\u65f6\uff0c\u670d\u52a1\u65b9\u964d\u7ea7\u4e86"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411111020806-407514d5.png",alt:"image-20220411111020806"}),"image-20220411111020806"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u670d\u52a1\u6d88\u8d39\u65b9")),(0,r.kt)("p",null,"a\u3001feign \u7ec4\u4ef6\u5df2\u7ecf\u96c6\u6210\u4e86 hystrix \u7ec4\u4ef6\u3002"),(0,r.kt)("p",null,"b\u3001"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411113035040-f3c891d5.png",alt:"image-20220411113035040"}),"image-20220411113035040"),(0,r.kt)("p",null,"c\u3001\u5b9a\u4e49feign \u8c03\u7528\u63a5\u53e3\u5b9e\u73b0\u7c7b\uff0c\u590d\u5199\u65b9\u6cd5\uff0c\u5373 \u964d\u7ea7\u65b9\u6cd5"),(0,r.kt)("p",null,"GoodsFeignClientFallback"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.consumer.feign;\n\nimport com.ydlclass.consumer.domain.Goods;\nimport org.springframework.stereotype.Component;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@Component\npublic class GoodsFeignCallback implements GoodsFeign{\n    @Override\n    public Goods findById(Integer id) {\n        Goods goods=new Goods();\n        goods.setGoodId(-2);\n        goods.setTitle("\u8c03\u7528\u65b9\u964d\u7ea7\u4e86\uff01");\n        goods.setPrice(-5.5);\n        goods.setStock(-5);\n        return goods;\n    }\n}\n')),(0,r.kt)("p",null,"d\u3001\u5728 @FeignClient \u6ce8\u89e3\u4e2d\u4f7f\u7528 fallback \u5c5e\u6027\u8bbe\u7f6e\u964d\u7ea7\u5904\u7406\u7c7b\u3002"),(0,r.kt)("p",null,"GoodsFeignClient"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.consumer.feign;\n\nimport com.ydlclass.consumer.config.FeignLogConfig;\nimport com.ydlclass.consumer.domain.Goods;\nimport org.springframework.cloud.openfeign.FeignClient;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@FeignClient(value = "EUREKA-PROVIDER",configuration = FeignLogConfig.class,fallback = GoodsFeignCallback.class)\npublic interface GoodsFeign {\n    @GetMapping("/goods/findById/{id}")\n    public Goods findById(@PathVariable("id") Integer id);\n}\n')),(0,r.kt)("p",null,"e\u3001\u914d\u7f6e\u5f00\u542f"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"# \u5f00\u542ffeign\u5bf9hystrix\u7684\u652f\u6301\nfeign:\n  hystrix:\n    enabled: true\n")),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a\u505c\u6389provider"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://localhost:9000/order/add/10"},"http://localhost:9000/order/add/10open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411113635280-1081b217.png",alt:"image-20220411113635280"}),"image-20220411113635280"),(0,r.kt)("h3",{id:"\u4e09\u7194\u65ad"},"\u4e09\u3001\u7194\u65ad"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411114750082-1a48c986.png",alt:"image-20220411114750082"}),"image-20220411114750082"),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,r.kt)("p",null,"provider"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.proviver.controller;\n\nimport com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;\nimport com.netflix.hystrix.contrib.javanica.annotation.HystrixProperty;\nimport com.ydlclass.proviver.domain.Goods;\nimport com.ydlclass.proviver.service.GoodsService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@RestController\n@RequestMapping("/goods")\npublic class GoodsController {\n    @Autowired\n    GoodsService goodsService;\n    @Value("${server.port}")\n    int port;\n\n    @GetMapping("/findById/{id}")\n    @HystrixCommand(fallbackMethod = "findById_fallback",commandProperties = {\n            //\u8bbe\u7f6eHystrix\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba41s\n            @HystrixProperty(name="execution.isolation.thread.timeoutInMilliseconds",value = "3000")\n    })\n    public Goods findById(@PathVariable("id") Integer id){\n        Goods goods = goodsService.findById(id);\n        goods.setTitle(goods.getTitle()+"|\u7aef\u53e3\u53f7\uff1a"+port);\n\n        if(id==1){\n            //\u6a21\u62df\u51fa\u5f02\u5e38\n            int a=1/0;\n        }\n\n        //\u6a21\u62df\u51fa\u5f02\u5e38\n//        int a=1/0;\n\n        //\u6a21\u62df\u4e1a\u52a1\u903b\u8f91\u6bd4\u8f83\u7e41\u5fd9\n//        try {\n//            Thread.sleep(5000);\n//        } catch (InterruptedException e) {\n//            e.printStackTrace();\n//        }\n        return goods;\n    }\n\n    /** \u5b9a\u4e49\u964d\u7ea7\u65b9\u6cd5   \u8fd4\u56de\u7279\u6b8a\u5bf9\u8c61\n     *  1\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u8981\u548c\u539f\u65b9\u6cd5\u4e00\u81f4\n     *  2\u65b9\u6cd5\u53c2\u6570\u548c\u539f\u65b9\u6cd5\u4e00\u6837\n     */\n    public Goods findById_fallback(Integer id){\n        Goods goods=new Goods();\n        goods.setGoodId(-1);\n        goods.setTitle("provider\u63d0\u4f9b\u65b9\u964d\u7ea7\uff01");\n        goods.setPrice(-9.9);\n        goods.setStock(-10);\n\n        return goods;\n    }\n}\n')),(0,r.kt)("p",null,"\u8bbf\u95ee\u4e24\u4e2a\u63a5\u53e3"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"http://localhost:9000/order/add/10"},"http://localhost:9000/order/add/10open in new window"))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411115310796-faba6ed0.png",alt:"image-20220411115310796"}),"image-20220411115310796"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u591a\u6b21\u8bbf\u95ee ",(0,r.kt)("a",{parentName:"li",href:"http://localhost:9000/order/add/1"},"http://localhost:9000/order/add/1open in new window"))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411115332277-ce2b6c94.png",alt:"image-20220411115332277"}),"image-20220411115332277"),(0,r.kt)("p",null,"3.\u5bfc\u81f410\u4e5f\u4e0d\u80fd\u8bbf\u95ee\u4e86"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411115128870-15162f17.png",alt:"image-20220411115128870"}),"image-20220411115128870"),(0,r.kt)("p",null,"4.\u518d\u8fc7\u4e00\u4f1a\u513f\uff0c\u534a\u5f00\u72b6\u6001"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://localhost:9000/order/add/10"},"http://localhost:9000/order/add/10open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411115423173-573f7494.png",alt:"image-20220411115423173"}),"image-20220411115423173"),(0,r.kt)("p",null,"Hyst rix \u7194\u65ad\u673a\u5236\uff0c\u7528\u4e8e\u76d1\u63a7\u5fae\u670d\u52a1\u8c03\u7528\u60c5\u51b5\uff0c\u5f53\u5931\u8d25\u7684\u60c5\u51b5\u8fbe\u5230\u9884\u5b9a\u7684\u9608\u503c\uff085\u79d2\u5931\u8d2520\u6b21\uff09\uff0c\u4f1a\u6253\u5f00\u65ad\u8def\u5668\uff0c\u62d2\u7edd\u6240\u6709\u8bf7\u6c42\uff0c\u76f4\u5230\u670d\u52a1\u6062\u590d\u6b63\u5e38\u4e3a\u6b62\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"circuitBreaker.sleepWindowInMilliseconds\uff1a\u76d1\u63a7\u65f6\u95f4\ncircuitBreaker.requestVolumeThreshold\uff1a\u5931\u8d25\u6b21\u6570\ncircuitBreaker.errorThresholdPercentage\uff1a\u5931\u8d25\u7387\n")),(0,r.kt)("p",null,"\u63d0\u4f9b\u8005controller\u4e2d"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'    @HystrixCommand(fallbackMethod = "findOne_fallback",commandProperties = {\n            //\u8bbe\u7f6eHystrix\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba41s\n            @HystrixProperty(name="execution.isolation.thread.timeoutInMilliseconds",value = "3000"),\n            //\u76d1\u63a7\u65f6\u95f4 \u9ed8\u8ba45000 \u6beb\u79d2\n            @HystrixProperty(name="circuitBreaker.sleepWindowInMilliseconds",value = "5000"),\n            //\u5931\u8d25\u6b21\u6570\u3002\u9ed8\u8ba420\u6b21\n            @HystrixProperty(name="circuitBreaker.requestVolumeThreshold",value = "20"),\n            //\u5931\u8d25\u7387 \u9ed8\u8ba450%\n            @HystrixProperty(name="circuitBreaker.errorThresholdPercentage",value = "50")\n\n    })\n')),(0,r.kt)("h3",{id:"\u56db\u7194\u65ad\u76d1\u63a7-\u8fd0\u7ef4"},"\u56db\u3001\u7194\u65ad\u76d1\u63a7**-\u8fd0\u7ef4"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200612072519498-077b0382.png",alt:"image-20200612072519498"}),"image-20200612072519498"),(0,r.kt)("p",null,"Hystrix \u63d0\u4f9b\u4e86 Hystrix-dashboard \u529f\u80fd\uff0c\u7528\u4e8e\u5b9e\u65f6\u76d1\u63a7\u5fae\u670d\u52a1\u8fd0\u884c\u72b6\u6001\u3002"),(0,r.kt)("p",null,"\u4f46\u662fHystrix-dashboard\u53ea\u80fd\u76d1\u63a7\u4e00\u4e2a\u5fae\u670d\u52a1\u3002"),(0,r.kt)("p",null,"Netflix \u8fd8\u63d0\u4f9b\u4e86 Turbine \uff0c\u8fdb\u884c\u805a\u5408\u76d1\u63a7\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200612072621556-5e1b0aa0.png",alt:"image-20200612072621556"}),"image-20200612072621556"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Turbine\u805a\u5408\u76d1\u63a7")),(0,r.kt)("h4",{id:"1\u642d\u5efa\u76d1\u63a7\u6a21\u5757"},"1\u3001\u642d\u5efa\u76d1\u63a7\u6a21\u5757"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"a\u3001 \u521b\u5efa\u76d1\u63a7\u6a21\u5757")),(0,r.kt)("p",null,"\u521b\u5efahystrix-monitor\u6a21\u5757\uff0c\u4f7f\u7528Turbine\u805a\u5408\u76d1\u63a7\u591a\u4e2aHystrix dashboard\u529f\u80fd,"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"b\u3001\u5f15\u5165Turbine\u805a\u5408\u76d1\u63a7\u8d77\u6b65\u4f9d\u8d56")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <artifactId>spring-cloud-parent</artifactId>\n        <groupId>com.ydlclass</groupId>\n        <version>1.0.0</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>hystrix-monitor</artifactId>\n\n    <properties>\n        <maven.compiler.source>8</maven.compiler.source>\n        <maven.compiler.target>8</maven.compiler.target>\n    </properties>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-hystrix-dashboard</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-turbine</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n        </dependency>\n\n\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <scope>test</scope>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n        </plugins>\n    </build>\n\n</project>\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"d\u3001\u4fee\u6539application.yml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'spring:\n  application:\n    name: hystrix-monitor\nserver:\n  port: 8769\nturbine:\n  combine-host-port: true\n  # \u914d\u7f6e\u9700\u8981\u76d1\u63a7\u7684\u670d\u52a1\u540d\u79f0\u5217\u8868\n  app-config: EUREKA-PROVIDER,EUREKA-CONSUMER\n  cluster-name-expression: "\'default\'"\n  aggregator:\n    cluster-config: default\n  #instanceUrlSuffix: /actuator/hystrix.stream\neureka:\n  client:\n    serviceUrl:\n      defaultZone: http://localhost:8761/eureka/\nhystrix:\n  dashboard:\n    proxy-stream-allow-list: "*"\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"e\u3001\u521b\u5efa\u542f\u52a8\u7c7b")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.monitor;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.netflix.eureka.EnableEurekaClient;\nimport org.springframework.cloud.netflix.hystrix.dashboard.EnableHystrixDashboard;\nimport org.springframework.cloud.netflix.turbine.EnableTurbine;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@SpringBootApplication\n@EnableEurekaClient\n@EnableTurbine //\u5f00\u542fTurbine \u5f88\u805a\u5408\u76d1\u63a7\u529f\u80fd\n@EnableHystrixDashboard //\u5f00\u542fHystrix\u4eea\u8868\u76d8\u76d1\u63a7\u529f\u80fd\npublic class HystrixMonitorApp {\n    public static void main(String[] args) {\n        SpringApplication.run(HystrixMonitorApp.class,args);\n    }\n}\n")),(0,r.kt)("h4",{id:"2\u4fee\u6539\u88ab\u76d1\u63a7\u6a21\u5757"},"2\u3001\u4fee\u6539\u88ab\u76d1\u63a7\u6a21\u5757"),(0,r.kt)("p",null,"\u9700\u8981\u5206\u522b\u4fee\u6539 hystrix-provider \u548c hystrix-consumer \u6a21\u5757\uff1a"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"a\u3001\u5bfc\u5165\u4f9d\u8d56\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-hystrix-dashboard</artifactId>\n        </dependency>\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"b\u3001\u914d\u7f6eBean")),(0,r.kt)("p",null,"\u6b64\u5904\u4e3a\u4e86\u65b9\u4fbf\uff0c\u5c06\u5176\u914d\u7f6e\u5728\u542f\u52a8\u7c7b\u4e2d\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'    @Bean\n    public ServletRegistrationBean getServlet() {\n        HystrixMetricsStreamServlet streamServlet = new HystrixMetricsStreamServlet();\n        ServletRegistrationBean registrationBean = new ServletRegistrationBean(streamServlet);\n        registrationBean.setLoadOnStartup(1);\n        registrationBean.addUrlMappings("/actuator/hystrix.stream");\n        registrationBean.setName("HystrixMetricsStreamServlet");\n        return registrationBean;\n    }\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"c\u3001\u542f\u52a8\u7c7b\u4e0a\u6dfb\u52a0\u6ce8\u89e3@EnableHystrixDashboard")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@EnableDiscoveryClient\n@EnableEurekaClient\n@SpringBootApplication\n@EnableFeignClients \n@EnableHystrixDashboard // \u5f00\u542fHystrix\u4eea\u8868\u76d8\u76d1\u63a7\u529f\u80fd\npublic class ConsumerApp {\n\n\n    public static void main(String[] args) {\n        SpringApplication.run(ConsumerApp.class,args);\n    }\n    @Bean\n    public ServletRegistrationBean getServlet() {\n        HystrixMetricsStreamServlet streamServlet = new HystrixMetricsStreamServlet();\n        ServletRegistrationBean registrationBean = new ServletRegistrationBean(streamServlet);\n        registrationBean.setLoadOnStartup(1);\n        registrationBean.addUrlMappings("/actuator/hystrix.stream");\n        registrationBean.setName("HystrixMetricsStreamServlet");\n        return registrationBean;\n    }\n}\n')),(0,r.kt)("h4",{id:"3\u542f\u52a8\u6d4b\u8bd5"},"3\u3001\u542f\u52a8\u6d4b\u8bd5"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"a\u3001\u542f\u52a8\u670d\u52a1\uff1a")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"eureka-server"),(0,r.kt)("li",{parentName:"ul"},"hystrix-provider"),(0,r.kt)("li",{parentName:"ul"},"hystrix-consumer"),(0,r.kt)("li",{parentName:"ul"},"hystrix-monitor")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"b\u3001\u8bbf\u95ee\uff1a")),(0,r.kt)("p",null,"\u5728\u6d4f\u89c8\u5668\u8bbf\u95ee",(0,r.kt)("a",{parentName:"p",href:"http://localhost:8769/hystrix/"},"http://localhost:8769/hystrix/open in new window")," \u8fdb\u5165Hystrix Dashboard\u754c\u9762"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1585421193757-41f28cbc.png",alt:"1585421193757"}),"1585421193757"),(0,r.kt)("p",null,"\u754c\u9762\u4e2d\u8f93\u5165\u76d1\u63a7\u7684Url\u5730\u5740 ",(0,r.kt)("a",{parentName:"p",href:"http://localhost:8769/turbine.stream%EF%BC%8C%E7%9B%91%E6%8E%A7%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%942000%E6%AF%AB%E7%A7%92%E5%92%8Ctitle%EF%BC%8C%E5%A6%82%E4%B8%8B%E5%9B%BE"},"http://localhost:8769/turbine.stream\uff0c\u76d1\u63a7\u65f6\u95f4\u95f4\u96942000\u6beb\u79d2\u548ctitle\uff0c\u5982\u4e0b\u56feopen in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411154048113-1c256874.png",alt:"image-20220411154048113"}),"image-20220411154048113"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5b9e\u5fc3\u5706\uff1a\u5b83\u6709\u989c\u8272\u548c\u5927\u5c0f\u4e4b\u5206\uff0c\u5206\u522b\u4ee3\u8868\u5b9e\u4f8b\u7684\u76d1\u63a7\u7a0b\u5ea6\u548c\u6d41\u91cf\u5927\u5c0f\u3002\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u5b83\u7684\u5065\u5eb7\u5ea6\u4ece\u7eff\u8272\u3001\u9ec4\u8272\u3001\u6a59\u8272\u3001\u7ea2\u8272\u9012\u51cf\u3002\u901a\u8fc7\u8be5\u5b9e\u5fc3\u5706\u7684\u5c55\u793a\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u5927\u91cf\u7684\u5b9e\u4f8b\u4e2d\u5feb\u901f\u7684\u53d1\u73b0\u6545\u969c\u5b9e\u4f8b\u548c\u9ad8\u538b\u529b\u5b9e\u4f8b\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u66f2\u7ebf\uff1a\u7528\u6765\u8bb0\u5f55 2 \u5206\u949f\u5185\u6d41\u91cf\u7684\u76f8\u5bf9\u53d8\u5316\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u89c2\u5bdf\u5230\u6d41\u91cf\u7684\u4e0a\u5347\u548c\u4e0b\u964d\u8d8b\u52bf\u3002")),(0,r.kt)("p",null,"1-"),(0,r.kt)("h2",{id:"\u7b2c\u5341\u4e00\u7ae0zuul\u8def\u7531\u7f51\u5173"},"\u7b2c\u5341\u4e00\u7ae0\u3001zuul\u8def\u7531\u7f51\u5173"),(0,r.kt)("p",null,"zuul\u6838\u5fc3\u4eba\u5458\u8d70\u4e86\u4e24\u4e2a\uff0czuul2\u7684\u7814\u53d1\u8fc7\u4e45\uff0cspring\u516c\u53f8\u7b49\u4e0d\u53ca\uff0c\u81ea\u5df1\u7814\u53d1\u7684Gateway\u7f51\u5173\u3002"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/Netflix/zuul/wiki"},"https://github.com/Netflix/zuul/wikiopen in new window")),(0,r.kt)("h2",{id:"\u7b2c\u5341\u4e8c\u7ae0-gateway\u65b0\u4e00\u4ee3\u7f51\u5173"},"\u7b2c\u5341\u4e8c\u7ae0 Gateway\u65b0\u4e00\u4ee3\u7f51\u5173"),(0,r.kt)("p",null,"\u529f\u80fd\uff1a\u8def\u7531+\u8fc7\u6ee4"),(0,r.kt)("h3",{id:"\u4e00-\u6982\u8ff0"},"\u4e00\u3001 ",(0,r.kt)("strong",{parentName:"h3"},"\u6982\u8ff0")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/"},"https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.2.1.RELEASE/reference/html/open in new window")),(0,r.kt)("p",null,"\u4e0d\u4f7f\u7528"),(0,r.kt)("p",null,"\u5b58\u5728\u7684\u95ee\u9898\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"\u89e3\u51b3\u7f3a\u70b9\uff1a1\u5ba2\u6237\u7aef\u9700\u8981\u8bb0\u5f55\u4e0d\u540c\u5fae\u670d\u52a1\u5730\u5740\uff0c\u589e\u52a0\u5ba2\u6237\u7aef\u7684\u590d\u6742\u6027\n2\u6bcf\u4e2a\u540e\u53f0\u5fae\u670d\u52a1\u90fd\u9700\u8981\u8ba4\u8bc1\n3http \u53d1\u8bf7\u6c42\uff0c\u6d89\u53ca\u5230\u8de8\u57df\n4\u540e\u53f0\u65b0\u589e\u5fae\u670d\u52a1\uff0c\u4e0d\u80fd\u52a8\u6001\u77e5\u9053\u5730\u5740\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411172117753-e3893d54.png",alt:"image-20220411172117753"}),"image-20220411172117753"),(0,r.kt)("p",null,"\u4f7f\u7528\u4e86\u7f51\u5173\u7684\u8bdd\uff1a"),(0,r.kt)("p",null,"\u2022 \u7f51\u5173\u65e8\u5728\u4e3a\u5fae\u670d\u52a1\u67b6\u6784\u63d0\u4f9b\u4e00\u79cd\u7b80\u5355\u800c\u6709\u6548\u7684\u7edf\u4e00\u7684API\u8def\u7531\u7ba1\u7406\u65b9\u5f0f\u3002"),(0,r.kt)("p",null,"\u2022 \u5728\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\uff0c\u4e0d\u540c\u7684\u5fae\u670d\u52a1\u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u7f51\u7edc\u5730\u5740\uff0c\u5404\u4e2a\u5fae\u670d\u52a1\u4e4b\u95f4\u901a\u8fc7\u4e92\u76f8\u8c03\u7528\u5b8c\u6210\u7528\u6237\u8bf7\u6c42\uff0c\u5ba2\u6237\u7aef\u53ef\u80fd\u901a\u8fc7\u8c03\u7528N\u4e2a\u5fae\u670d\u52a1\u7684\u63a5\u53e3\u5b8c\u6210\u4e00\u4e2a\u7528\u6237\u8bf7\u6c42\u3002"),(0,r.kt)("p",null,"\u2022 \u7f51\u5173\u5c31\u662f\u7cfb\u7edf\u7684\u5165\u53e3\uff0c\u5c01\u88c5\u4e86\u5e94\u7528\u7a0b\u5e8f\u7684\u5185\u90e8\u7ed3\u6784\uff0c\u4e3a\u5ba2\u6237\u7aef\u63d0\u4f9b\u7edf\u4e00\u670d\u52a1\uff0c\u4e00\u4e9b\u4e0e\u4e1a\u52a1\u672c\u8eab\u529f\u80fd\u65e0\u5173\u7684\u516c\u5171\u903b\u8f91\u53ef\u4ee5\u5728\u8fd9\u91cc\u5b9e\u73b0\uff0c\u8bf8\u5982\u8ba4\u8bc1\u3001\u9274\u6743\u3001\u76d1\u63a7\u3001\u7f13\u5b58\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u6d41\u91cf\u7ba1\u63a7\u3001\u8def\u7531\u8f6c\u53d1\u7b49"),(0,r.kt)("p",null,"\u2022 \u5728\u76ee\u524d\u7684\u7f51\u5173\u89e3\u51b3\u65b9\u6848\u91cc\uff0c\u6709Nginx+ Lua\u3001Netflix Zuul/zuul2 \u3001Spring Cloud Gateway\u7b49\u7b49"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411172632761-c415bd79.png",alt:"image-20220411172632761"}),"image-20220411172632761"),(0,r.kt)("h3",{id:"\u4e8c-\u5feb\u901f\u5165\u95e8"},"\u4e8c\u3001 ",(0,r.kt)("strong",{parentName:"h3"},"\u5feb\u901f\u5165\u95e8")),(0,r.kt)("p",null,"\uff081\uff09\u642d\u5efa\u7f51\u5173\u6a21\u5757 api-gateway-server"),(0,r.kt)("p",null,"\uff082\uff09\u5f15\u5165\u4f9d\u8d56\uff1astarter-gateway"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <artifactId>gateway-parent</artifactId>\n        <groupId>com.ydlclass</groupId>\n        <version>1.0-SNAPSHOT</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>api-gateway-server</artifactId>\n\n\n    <dependencies>\n        \x3c!--\u5f15\u5165gateway \u7f51\u5173--\x3e\n\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-gateway</artifactId>\n        </dependency>\n\n        \x3c!-- eureka-client --\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n        </dependency>\n    </dependencies>\n\n</project>\n')),(0,r.kt)("p",null,"\uff083\uff09\u7f16\u5199\u542f\u52a8\u7c7b"),(0,r.kt)("p",null,"ApiGatewayApp"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.gateway;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.netflix.eureka.EnableEurekaClient;\n\n@SpringBootApplication\n@EnableEurekaClient\npublic class ApiGatewayApp {\n\n    public static void main(String[] args) {\n        SpringApplication.run(ApiGatewayApp.class,args);\n    }\n\n}\n")),(0,r.kt)("p",null,"\uff084\uff09\u7f16\u5199\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"server:\n  port: 80\n\nspring:\n  application:\n    name: api-gateway-server\n\n  cloud:\n    # \u7f51\u5173\u914d\u7f6e\n    gateway:\n      # \u8def\u7531\u914d\u7f6e\uff1a\u8f6c\u53d1\u89c4\u5219\n      routes: #\u96c6\u5408\u3002\n      # id: \u552f\u4e00\u6807\u8bc6\u3002\u9ed8\u8ba4\u662f\u4e00\u4e2aUUID\n      # uri: \u8f6c\u53d1\u8def\u5f84\n      # predicates: \u6761\u4ef6,\u7528\u4e8e\u8bf7\u6c42\u7f51\u5173\u8def\u5f84\u7684\u5339\u914d\u89c4\u5219\n      # filters\uff1a\u914d\u7f6e\u5c40\u90e8\u8fc7\u6ee4\u5668\u7684\n\n      - id: eureka-provider\n        # \u9759\u6001\u8def\u7531\n        # uri: http://localhost:8001/\n        # \u52a8\u6001\u8def\u7531\n        uri: lb://GATEWAY-PROVIDER\n        predicates:\n        - Path=/goods/**\n        filters:\n        - AddRequestParameter=username,zhangsan\n\n      - id: eureka-consumer\n        # uri: http://localhost:9000\n        uri: lb://GATEWAY-CONSUMER\n        predicates:\n        - Path=/order/**\n        # \u5fae\u670d\u52a1\u540d\u79f0\u914d\u7f6e\n      discovery:\n        locator:\n          enabled: true # \u8bbe\u7f6e\u4e3atrue \u8bf7\u6c42\u8def\u5f84\u524d\u53ef\u4ee5\u6dfb\u52a0\u5fae\u670d\u52a1\u540d\u79f0\n          lower-case-service-id: true # \u5141\u8bb8\u4e3a\u5c0f\u5199\n\n\neureka:\n  client:\n    service-url:\n      defaultZone: http://localhost:8761/eureka\n")),(0,r.kt)("p",null,"\uff085\uff09\u542f\u52a8\u6d4b\u8bd5"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://localhost/goods/findById/2"},"http://localhost/goods/findById/2open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411174704253-4e93d626.png",alt:"image-20220411174704253"}),"image-20220411174704253"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411174649892-b2b39013.png",alt:"image-20220411174649892"}),"image-20220411174649892"),(0,r.kt)("h3",{id:"\u4e09-\u9759\u6001\u8def\u7531"},"\u4e09\u3001 ",(0,r.kt)("strong",{parentName:"h3"},"\u9759\u6001\u8def\u7531")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"uri: http://localhost:8000/\n")),(0,r.kt)("h3",{id:"\u56db\u52a8\u6001\u8def\u7531"},"\u56db\u3001",(0,r.kt)("strong",{parentName:"h3"},"\u52a8\u6001\u8def\u7531")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411180512597-da56cec1.png",alt:"image-20220411180512597"}),"image-20220411180512597"),(0,r.kt)("h4",{id:"1\u5f15\u5165eureka-client\u914d\u7f6e"},"1\u3001\u5f15\u5165eureka-client\u914d\u7f6e"),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n        </dependency>\n")),(0,r.kt)("p",null,"yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"eureka:\n  client:\n    service-url:\n      defaultZone: http://localhost:8761/eureka\n")),(0,r.kt)("h4",{id:"2\u4fee\u6539uri\u5c5e\u6027uri-lb\u670d\u52a1\u540d\u79f0"},"2\u3001\u4fee\u6539uri\u5c5e\u6027\uff1auri: lb://\u670d\u52a1\u540d\u79f0"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"uri: lb://eureka-provider\n")),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://localhost/goods/findById/2"},"http://localhost/goods/findById/2open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411180644761-e575ff25.png",alt:"image-20220411180644761"}),"image-20220411180644761"),(0,r.kt)("h3",{id:"\u4e94\u5fae\u670d\u52a1\u540d\u79f0\u914d\u7f6e"},"\u4e94\u3001\u5fae\u670d\u52a1\u540d\u79f0\u914d\u7f6e**"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"spring:\n  cloud:\n    # \u7f51\u5173\u914d\u7f6e\n    gateway:   \n    # \u5fae\u670d\u52a1\u540d\u79f0\u914d\u7f6e\n      discovery:\n        locator:\n          enabled: true # \u8bbe\u7f6e\u4e3atrue \u8bf7\u6c42\u8def\u5f84\u524d\u53ef\u4ee5\u6dfb\u52a0\u5fae\u670d\u52a1\u540d\u79f0\n          lower-case-service-id: true # \u5141\u8bb8\u4e3a\u5c0f\u5199\n")),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a",(0,r.kt)("a",{parentName:"p",href:"http://localhost/eureka-provider/goods/findById/2"},"http://localhost/eureka-provider/goods/findById/2open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411180853933-7e0bf46f.png",alt:"image-20220411180853933"}),"image-20220411180853933"),(0,r.kt)("h3",{id:"\u516d\u8fc7\u6ee4\u5668"},"\u516d\u3001\u8fc7\u6ee4\u5668"),(0,r.kt)("p",null,"\uff081\uff09\u4e24\u4e2a\u7ef4\u5ea6\uff1a"),(0,r.kt)("p",null,"\u5185\u7f6e\u8fc7\u6ee4\u5668 \u81ea\u5b9a\u4e49\u8fc7\u6ee4\u5668"),(0,r.kt)("p",null,"\u5c40\u90e8\u8fc7\u6ee4\u5668 \u5168\u5c40\u8fc7\u6ee4\u5668"),(0,r.kt)("p",null,"\uff082\uff09\u8fc7\u6ee4\u5668\u79cd\u7c7b\uff1a"),(0,r.kt)("p",null,"\u5185\u7f6e\u5c40\u90e8\u8fc7\u6ee4\u5668"),(0,r.kt)("p",null,"\u5185\u7f6e\u5168\u5c40\u8fc7\u6ee4\u5668"),(0,r.kt)("p",null,"\u81ea\u5b9a\u4e49\u5c40\u90e8\u8fc7\u6ee4\u5668"),(0,r.kt)("p",null,"\u81ea\u5b9a\u4e49\u5168\u5c40\u8fc7\u6ee4\u5668"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200612075159655-4dd53e5a.png",alt:"image-20200612075159655"}),"image-20200612075159655"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Gateway \u652f\u6301\u8fc7\u6ee4\u5668\u529f\u80fd\uff0c\u5bf9\u8bf7\u6c42\u6216\u54cd\u5e94\u8fdb\u884c\u62e6\u622a\uff0c\u5b8c\u6210\u4e00\u4e9b\u901a\u7528\u64cd\u4f5c\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Gateway \u63d0\u4f9b\u4e24\u79cd\u8fc7\u6ee4\u5668\u65b9\u5f0f\uff1a\u201cpre\u201d\u548c\u201cpost\u201d"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```text\npre \u8fc7\u6ee4\u5668\uff0c\u5728\u8f6c\u53d1\u4e4b\u524d\u6267\u884c\uff0c\u53ef\u4ee5\u505a\u53c2\u6570\u6821\u9a8c\u3001\u6743\u9650\u6821\u9a8c\u3001\u6d41\u91cf\u76d1\u63a7\u3001\u65e5\u5fd7\u8f93\u51fa\u3001\u534f\u8bae\u8f6c\u6362\u7b49\u3002\npost \u8fc7\u6ee4\u5668\uff0c\u5728\u54cd\u5e94\u4e4b\u524d\u6267\u884c\uff0c\u53ef\u4ee5\u505a\u54cd\u5e94\u5185\u5bb9\u3001\u54cd\u5e94\u5934\u7684\u4fee\u6539\uff0c\u65e5\u5fd7\u7684\u8f93\u51fa\uff0c\u6d41\u91cf\u76d1\u63a7\u7b49\u3002\n```\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Gateway \u8fd8\u63d0\u4f9b\u4e86\u4e24\u79cd\u7c7b\u578b\u8fc7\u6ee4\u5668")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```text\nGatewayFilter\uff1a\u5c40\u90e8\u8fc7\u6ee4\u5668\uff0c\u9488\u5bf9\u5355\u4e2a\u8def\u7531\nGlobalFilter \uff1a\u5168\u5c40\u8fc7\u6ee4\u5668\uff0c\u9488\u5bf9\u6240\u6709\u8def\u7531\n```\n")),(0,r.kt)("p",null,"\u5185\u7f6e\u8fc7\u6ee4\u5668 \u5c40\u90e8\u8fc7\u6ee4\u5668\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"- id: gateway-provider\n     #uri: http://localhost:8001/\n     uri: lb://GATEWAY-PROVIDER\n     predicates:\n     - Path=/goods/**\n        filters:\n            - AddResponseHeader=foo, bar\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411182635931-65d3b487.png",alt:"image-20220411182635931"}),"image-20220411182635931"),(0,r.kt)("p",null,"\u5185\u7f6e\u8fc7\u6ee4\u5668 \u5168\u5c40\u8fc7\u6ee4\u5668\uff1a route\u540c\u7ea7"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"      default-filters:\n        - AddResponseHeader=yld,itlils\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411182831552-1af37136.png",alt:"image-20220411182831552"}),"image-20220411182831552"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411182910608-586ba685.png",alt:"image-20220411182910608"}),"image-20220411182910608"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u62d3\u5c55\uff1a")),(0,r.kt)("p",null,"\u5185\u7f6e\u7684\u8fc7\u6ee4\u5668\u5de5\u5382"),(0,r.kt)("p",null,"\u8fd9\u91cc\u7b80\u5355\u5c06Spring Cloud Gateway\u5185\u7f6e\u7684\u6240\u6709\u8fc7\u6ee4\u5668\u5de5\u5382\u6574\u7406\u6210\u4e86\u4e00\u5f20\u8868\u683c\u3002\u5982\u4e0b\uff1a"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"\u8fc7\u6ee4\u5668\u5de5\u5382"),(0,r.kt)("th",{parentName:"tr",align:"left"},"\u4f5c\u7528"),(0,r.kt)("th",{parentName:"tr",align:"left"},"\u53c2\u6570"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"AddRequestHeader"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3a\u539f\u59cb\u8bf7\u6c42\u6dfb\u52a0Header"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Header\u7684\u540d\u79f0\u53ca\u503c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"AddRequestParameter"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3a\u539f\u59cb\u8bf7\u6c42\u6dfb\u52a0\u8bf7\u6c42\u53c2\u6570"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u53c2\u6570\u540d\u79f0\u53ca\u503c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"AddResponseHeader"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3a\u539f\u59cb\u54cd\u5e94\u6dfb\u52a0Header"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Header\u7684\u540d\u79f0\u53ca\u503c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"DedupeResponseHeader"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u5254\u9664\u54cd\u5e94\u5934\u4e2d\u91cd\u590d\u7684\u503c"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u9700\u8981\u53bb\u91cd\u7684Header\u540d\u79f0\u53ca\u53bb\u91cd\u7b56\u7565")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Hystrix"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3a\u8def\u7531\u5f15\u5165Hystrix\u7684\u65ad\u8def\u5668\u4fdd\u62a4"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"HystrixCommand"),"\u7684\u540d\u79f0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"FallbackHeaders"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3afallbackUri\u7684\u8bf7\u6c42\u5934\u4e2d\u6dfb\u52a0\u5177\u4f53\u7684\u5f02\u5e38\u4fe1\u606f"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Header\u7684\u540d\u79f0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"PrefixPath"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3a\u539f\u59cb\u8bf7\u6c42\u8def\u5f84\u6dfb\u52a0\u524d\u7f00"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u524d\u7f00\u8def\u5f84")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"PreserveHostHeader"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3a\u8bf7\u6c42\u6dfb\u52a0\u4e00\u4e2apreserveHostHeader=true\u7684\u5c5e\u6027\uff0c\u8def\u7531\u8fc7\u6ee4\u5668\u4f1a\u68c0\u67e5\u8be5\u5c5e\u6027\u4ee5\u51b3\u5b9a\u662f\u5426\u8981\u53d1\u9001\u539f\u59cb\u7684Host"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u65e0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"RequestRateLimiter"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u7528\u4e8e\u5bf9\u8bf7\u6c42\u9650\u6d41\uff0c\u9650\u6d41\u7b97\u6cd5\u4e3a\u4ee4\u724c\u6876"),(0,r.kt)("td",{parentName:"tr",align:"left"},"keyResolver\u3001rateLimiter\u3001statusCode\u3001denyEmptyKey\u3001emptyKeyStatus")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"RedirectTo"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u5c06\u539f\u59cb\u8bf7\u6c42\u91cd\u5b9a\u5411\u5230\u6307\u5b9a\u7684URL"),(0,r.kt)("td",{parentName:"tr",align:"left"},"http\u72b6\u6001\u7801\u53ca\u91cd\u5b9a\u5411\u7684url")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"RemoveHopByHopHeadersFilter"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3a\u539f\u59cb\u8bf7\u6c42\u5220\u9664IETF\u7ec4\u7ec7\u89c4\u5b9a\u7684\u4e00\u7cfb\u5217Header"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u9ed8\u8ba4\u5c31\u4f1a\u542f\u7528\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6307\u5b9a\u4ec5\u5220\u9664\u54ea\u4e9bHeader")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"RemoveRequestHeader"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3a\u539f\u59cb\u8bf7\u6c42\u5220\u9664\u67d0\u4e2aHeader"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Header\u540d\u79f0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"RemoveResponseHeader"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3a\u539f\u59cb\u54cd\u5e94\u5220\u9664\u67d0\u4e2aHeader"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Header\u540d\u79f0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"RewritePath"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u91cd\u5199\u539f\u59cb\u7684\u8bf7\u6c42\u8def\u5f84"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u539f\u59cb\u8def\u5f84\u6b63\u5219\u8868\u8fbe\u5f0f\u4ee5\u53ca\u91cd\u5199\u540e\u8def\u5f84\u7684\u6b63\u5219\u8868\u8fbe\u5f0f")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"RewriteResponseHeader"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u91cd\u5199\u539f\u59cb\u54cd\u5e94\u4e2d\u7684\u67d0\u4e2aHeader"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Header\u540d\u79f0\uff0c\u503c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u91cd\u5199\u540e\u7684\u503c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"SaveSession"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u5728\u8f6c\u53d1\u8bf7\u6c42\u4e4b\u524d\uff0c\u5f3a\u5236\u6267\u884c",(0,r.kt)("inlineCode",{parentName:"td"},"WebSession::save"),"\u64cd\u4f5c"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u65e0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"secureHeaders"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3a\u539f\u59cb\u54cd\u5e94\u6dfb\u52a0\u4e00\u7cfb\u5217\u8d77\u5b89\u5168\u4f5c\u7528\u7684\u54cd\u5e94\u5934"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u65e0\uff0c\u652f\u6301\u4fee\u6539\u8fd9\u4e9b\u5b89\u5168\u54cd\u5e94\u5934\u7684\u503c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"SetPath"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4fee\u6539\u539f\u59cb\u7684\u8bf7\u6c42\u8def\u5f84"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4fee\u6539\u540e\u7684\u8def\u5f84")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"SetResponseHeader"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4fee\u6539\u539f\u59cb\u54cd\u5e94\u4e2d\u67d0\u4e2aHeader\u7684\u503c"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Header\u540d\u79f0\uff0c\u4fee\u6539\u540e\u7684\u503c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"SetStatus"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4fee\u6539\u539f\u59cb\u54cd\u5e94\u7684\u72b6\u6001\u7801"),(0,r.kt)("td",{parentName:"tr",align:"left"},"HTTP \u72b6\u6001\u7801\uff0c\u53ef\u4ee5\u662f\u6570\u5b57\uff0c\u4e5f\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"StripPrefix"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u7528\u4e8e\u622a\u65ad\u539f\u59cb\u8bf7\u6c42\u7684\u8def\u5f84"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4f7f\u7528\u6570\u5b57\u8868\u793a\u8981\u622a\u65ad\u7684\u8def\u5f84\u7684\u6570\u91cf")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Retry"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u9488\u5bf9\u4e0d\u540c\u7684\u54cd\u5e94\u8fdb\u884c\u91cd\u8bd5"),(0,r.kt)("td",{parentName:"tr",align:"left"},"retries\u3001statuses\u3001methods\u3001series")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"RequestSize"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u8bbe\u7f6e\u5141\u8bb8\u63a5\u6536\u6700\u5927\u8bf7\u6c42\u5305\u7684\u5927\u5c0f\u3002\u5982\u679c\u8bf7\u6c42\u5305\u5927\u5c0f\u8d85\u8fc7\u8bbe\u7f6e\u7684\u503c\uff0c\u5219\u8fd4\u56de ",(0,r.kt)("inlineCode",{parentName:"td"},"413 Payload Too Large")),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u8bf7\u6c42\u5305\u5927\u5c0f\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\uff0c\u9ed8\u8ba4\u503c\u4e3a5M")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"ModifyRequestBody"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u5728\u8f6c\u53d1\u8bf7\u6c42\u4e4b\u524d\u4fee\u6539\u539f\u59cb\u8bf7\u6c42\u4f53\u5185\u5bb9"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4fee\u6539\u540e\u7684\u8bf7\u6c42\u4f53\u5185\u5bb9")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"ModifyResponseBody"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4fee\u6539\u539f\u59cb\u54cd\u5e94\u4f53\u7684\u5185\u5bb9"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4fee\u6539\u540e\u7684\u54cd\u5e94\u4f53\u5185\u5bb9")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Default"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u4e3a\u6240\u6709\u8def\u7531\u6dfb\u52a0\u8fc7\u6ee4\u5668"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u8fc7\u6ee4\u5668\u5de5\u5382\u540d\u79f0\u53ca\u503c")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Tips\uff1a"),"\u6bcf\u4e2a\u8fc7\u6ee4\u5668\u5de5\u5382\u90fd\u5bf9\u5e94\u4e00\u4e2a\u5b9e\u73b0\u7c7b\uff0c\u5e76\u4e14\u8fd9\u4e9b\u7c7b\u7684\u540d\u79f0\u5fc5\u987b\u4ee5",(0,r.kt)("inlineCode",{parentName:"p"},"GatewayFilterFactory"),"\u7ed3\u5c3e\uff0c\u8fd9\u662fSpring Cloud Gateway\u7684\u4e00\u4e2a\u7ea6\u5b9a\uff0c\u4f8b\u5982",(0,r.kt)("inlineCode",{parentName:"p"},"AddRequestHeader"),"\u5bf9\u5e94\u7684\u5b9e\u73b0\u7c7b\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"AddRequestHeaderGatewayFilterFactory"),"\u3002"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"1\u3001AddRequestHeader GatewayFilter Factory"),(0,r.kt)("p",null,"\u4e3a\u539f\u59cb\u8bf7\u6c42\u6dfb\u52a0Header\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: add_request_header_route\n        uri: https://example.org\n        filters:\n        - AddRequestHeader=X-Request-Foo, Bar\n")),(0,r.kt)("p",null,"\u4e3a\u539f\u59cb\u8bf7\u6c42\u6dfb\u52a0\u540d\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"X-Request-Foo")," \uff0c\u503c\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"Bar")," \u7684\u8bf7\u6c42\u5934"),(0,r.kt)("p",null,"2\u3001AddRequestParameter GatewayFilter Factory"),(0,r.kt)("p",null,"\u4e3a\u539f\u59cb\u8bf7\u6c42\u6dfb\u52a0\u8bf7\u6c42\u53c2\u6570\u53ca\u503c\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: add_request_parameter_route\n        uri: https://example.org\n        filters:\n        - AddRequestParameter=foo, bar\n")),(0,r.kt)("p",null,"\u4e3a\u539f\u59cb\u8bf7\u6c42\u6dfb\u52a0\u540d\u4e3afoo\uff0c\u503c\u4e3abar\u7684\u53c2\u6570\uff0c\u5373\uff1a",(0,r.kt)("inlineCode",{parentName:"p"},"foo=bar")),(0,r.kt)("p",null,"3\u3001AddResponseHeader GatewayFilter Factory"),(0,r.kt)("p",null,"\u4e3a\u539f\u59cb\u54cd\u5e94\u6dfb\u52a0Header\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: add_response_header_route\n        uri: https://example.org\n        filters:\n        - AddResponseHeader=X-Response-Foo, Bar\n")),(0,r.kt)("p",null,"\u4e3a\u539f\u59cb\u54cd\u5e94\u6dfb\u52a0\u540d\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"X-Request-Foo")," \uff0c\u503c\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"Bar")," \u7684\u54cd\u5e94\u5934"),(0,r.kt)("p",null,"4\u3001DedupeResponseHeader GatewayFilter Factory"),(0,r.kt)("p",null,"DedupeResponseHeader\u53ef\u4ee5\u6839\u636e\u914d\u7f6e\u7684Header\u540d\u79f0\u53ca\u53bb\u91cd\u7b56\u7565\u5254\u9664\u54cd\u5e94\u5934\u4e2d\u91cd\u590d\u7684\u503c\uff0c\u8fd9\u662fSpring Cloud Greenwich SR2\u63d0\u4f9b\u7684\u65b0\u7279\u6027\uff0c\u4f4e\u4e8e\u8fd9\u4e2a\u7248\u672c\u65e0\u6cd5\u4f7f\u7528\u3002"),(0,r.kt)("p",null,"\u6211\u4eec\u5728Gateway\u4ee5\u53ca\u5fae\u670d\u52a1\u4e0a\u90fd\u8bbe\u7f6e\u4e86CORS\uff08\u89e3\u51b3\u8de8\u57df\uff09Header\u7684\u8bdd\uff0c\u5982\u679c\u4e0d\u505a\u4efb\u4f55\u914d\u7f6e\uff0c\u90a3\u4e48\u8bf7\u6c42 -> \u7f51\u5173 -> \u5fae\u670d\u52a1\uff0c\u83b7\u5f97\u7684CORS Header\u7684\u503c\uff0c\u5c31\u5c06\u4f1a\u662f\u8fd9\u6837\u7684\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"Access-Control-Allow-Credentials: true, true\nAccess-Control-Allow-Origin: https://musk.mars, https://musk.mars\n")),(0,r.kt)("p",null,"\u53ef\u4ee5\u770b\u5230\u8fd9\u4e24\u4e2aHeader\u7684\u503c\u90fd\u91cd\u590d\u4e86\uff0c\u82e5\u60f3\u628a\u8fd9\u4e24\u4e2aHeader\u7684\u503c\u53bb\u91cd\u7684\u8bdd\uff0c\u5c31\u9700\u8981\u4f7f\u7528\u5230DedupeResponseHeader\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: dedupe_response_header_route\n        uri: https://example.org\n        filters:\n        # \u82e5\u9700\u8981\u53bb\u91cd\u7684Header\u6709\u591a\u4e2a\uff0c\u4f7f\u7528\u7a7a\u683c\u5206\u9694\n        - DedupeResponseHeader=Access-Control-Allow-Credentials Access-Control-Allow-Origin\n")),(0,r.kt)("p",null,"\u53bb\u91cd\u7b56\u7565\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"RETAIN_FIRST\uff1a\u9ed8\u8ba4\u503c\uff0c\u4fdd\u7559\u7b2c\u4e00\u4e2a\u503c"),(0,r.kt)("li",{parentName:"ul"},"RETAIN_LAST\uff1a\u4fdd\u7559\u6700\u540e\u4e00\u4e2a\u503c"),(0,r.kt)("li",{parentName:"ul"},"RETAIN_UNIQUE\uff1a\u4fdd\u7559\u6240\u6709\u552f\u4e00\u503c\uff0c\u4ee5\u5b83\u4eec\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u987a\u5e8f\u4fdd\u7559")),(0,r.kt)("p",null,"\u82e5\u60f3\u5bf9\u8be5\u8fc7\u6ee4\u5668\u5de5\u5382\u6709\u4e2a\u6bd4\u8f83\u5168\u9762\u7684\u4e86\u89e3\u7684\u8bdd\uff0c\u5efa\u8bae\u9605\u8bfb\u8be5\u8fc7\u6ee4\u5668\u5de5\u5382\u7684\u6e90\u7801\uff0c\u56e0\u4e3a\u6e90\u7801\u91cc\u6709\u8be6\u7ec6\u7684\u6ce8\u91ca\u53ca\u793a\u4f8b\uff0c\u6bd4\u5b98\u65b9\u6587\u6863\u5199\u5f97\u8fd8\u597d\uff1a",(0,r.kt)("inlineCode",{parentName:"p"},"org.springframework.cloud.gateway.filter.factory.DedupeResponseHeaderGatewayFilterFactory")),(0,r.kt)("p",null,"5\u3001Hystrix GatewayFilter Factory"),(0,r.kt)("p",null,"\u4e3a\u8def\u7531\u5f15\u5165Hystrix\u7684\u65ad\u8def\u5668\u4fdd\u62a4\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: hystrix_route\n        uri: https://example.org\n        filters:\n        - Hystrix=myCommandName\n")),(0,r.kt)("p",null,"Hystrix\u662fSpring Cloud\u7b2c\u4e00\u4ee3\u5bb9\u9519\u7ec4\u4ef6\uff0c\u4e0d\u8fc7\u5df2\u7ecf\u8fdb\u5165\u7ef4\u62a4\u6a21\u5f0f\uff0c\u672a\u6765Hystrix\u4f1a\u88abSpring Cloud\u79fb\u9664\u6389\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662fAlibaba Sentinel/Resilience4J\u3002\u6240\u4ee5\u672c\u6587\u4e0d\u505a\u8be6\u7ec6\u4ecb\u7ecd\u4e86\uff0c\u611f\u5174\u8da3\u7684\u8bdd\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://cloud.spring.io/spring-cloud-static/Greenwich.SR2/single/spring-cloud.html#hystrix"},"Hystrix GatewayFilter Factoryopen in new window"))),(0,r.kt)("p",null,"6\u3001FallbackHeaders GatewayFilter Factory"),(0,r.kt)("p",null,"\u540c\u6837\u662f\u5bf9Hystrix\u7684\u652f\u6301\uff0c\u4e0a\u4e00\u5c0f\u8282\u6240\u4ecb\u7ecd\u7684\u8fc7\u6ee4\u5668\u5de5\u5382\u652f\u6301\u4e00\u4e2a\u914d\u7f6e\u53c2\u6570\uff1a",(0,r.kt)("inlineCode",{parentName:"p"},"fallbackUri"),"\uff0c\u8be5\u914d\u7f6e\u7528\u4e8e\u5f53\u53d1\u751f\u5f02\u5e38\u65f6\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230\u4e00\u4e2a\u7279\u5b9a\u7684uri\u4e0a\u3002\u800c",(0,r.kt)("inlineCode",{parentName:"p"},"FallbackHeaders"),"\u8fd9\u4e2a\u8fc7\u6ee4\u5de5\u5382\u53ef\u4ee5\u5728\u8f6c\u53d1\u8bf7\u6c42\u5230\u8be5uri\u65f6\u6dfb\u52a0\u4e00\u4e2aHeader\uff0c\u8fd9\u4e2aHeader\u7684\u503c\u4e3a\u5177\u4f53\u7684\u5f02\u5e38\u4fe1\u606f\u3002\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: ingredients\n        uri: lb://ingredients\n        predicates:\n        - Path=//ingredients/**\n        filters:\n        - name: Hystrix\n          args:\n            name: fetchIngredients\n            fallbackUri: forward:/fallback\n      - id: ingredients-fallback\n        uri: http://localhost:9994\n        predicates:\n        - Path=/fallback\n        filters:\n        - name: FallbackHeaders\n          args:\n            executionExceptionTypeHeaderName: Test-Header\n")),(0,r.kt)("p",null,"\u8fd9\u91cc\u4e5f\u4e0d\u505a\u8be6\u7ec6\u4ecb\u7ecd\u4e86\uff0c\u611f\u5174\u8da3\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://cloud.spring.io/spring-cloud-static/Greenwich.SR2/single/spring-cloud.html#fallback-headers"},"FallbackHeaders GatewayFilter Factoryopen in new window"))),(0,r.kt)("p",null,"7\u3001PrefixPath GatewayFilter Factory"),(0,r.kt)("p",null,"\u4e3a\u539f\u59cb\u7684\u8bf7\u6c42\u8def\u5f84\u6dfb\u52a0\u4e00\u4e2a\u524d\u7f00\u8def\u5f84\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: prefixpath_route\n        uri: https://example.org\n        filters:\n        - PrefixPath=/mypath\n")),(0,r.kt)("p",null,"\u8be5\u914d\u7f6e\u4f7f\u8bbf\u95ee",(0,r.kt)("inlineCode",{parentName:"p"},"${GATEWAY_URL}/hello")," \u4f1a\u8f6c\u53d1\u5230",(0,r.kt)("inlineCode",{parentName:"p"},"https://example.org/mypath/hello")),(0,r.kt)("p",null,"8\u3001PreserveHostHeader GatewayFilter Factory"),(0,r.kt)("p",null,"\u4e3a\u8bf7\u6c42\u6dfb\u52a0\u4e00\u4e2apreserveHostHeader=true\u7684\u5c5e\u6027\uff0c\u8def\u7531\u8fc7\u6ee4\u5668\u4f1a\u68c0\u67e5\u8be5\u5c5e\u6027\u4ee5\u51b3\u5b9a\u662f\u5426\u8981\u53d1\u9001\u539f\u59cb\u7684Host Header\u3002\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: preserve_host_route\n        uri: https://example.org\n        filters:\n        - PreserveHostHeader\n")),(0,r.kt)("p",null,"\u5982\u679c\u4e0d\u8bbe\u7f6e\uff0c\u90a3\u4e48\u540d\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"Host")," \u7684Header\u5c06\u7531Http Client\u63a7\u5236"),(0,r.kt)("p",null,"9\u3001RequestRateLimiter GatewayFilter Factory"),(0,r.kt)("p",null,"\u7528\u4e8e\u5bf9\u8bf7\u6c42\u8fdb\u884c\u9650\u6d41\uff0c\u9650\u6d41\u7b97\u6cd5\u4e3a\u4ee4\u724c\u6876\u3002\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: requestratelimiter_route\n        uri: https://example.org\n        filters:\n        - name: RequestRateLimiter\n          args:\n            redis-rate-limiter.replenishRate: 10\n            redis-rate-limiter.burstCapacity: 20\n")),(0,r.kt)("p",null,"\u7531\u4e8e\u53e6\u4e00\u7bc7\u6587\u7ae0\u4e2d\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\u5982\u4f55\u4f7f\u7528\u8be5\u8fc7\u6ee4\u5668\u5de5\u5382\u5b9e\u73b0\u7f51\u5173\u9650\u6d41\uff0c\u6240\u4ee5\u8fd9\u91cc\u5c31\u4e0d\u518d\u8d58\u8ff0\u4e86\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://blog.51cto.com/zero01/2430532"},"Spring Cloud Gateway - \u6269\u5c55open in new window"))),(0,r.kt)("p",null,"\u6216\u8005\u53c2\u8003\u5b98\u65b9\u6587\u6863\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://cloud.spring.io/spring-cloud-static/Greenwich.SR2/single/spring-cloud.html#_requestratelimiter_gatewayfilter_factory"},"RequestRateLimiter GatewayFilter Factoryopen in new window"))),(0,r.kt)("p",null,"10\u3001RedirectTo GatewayFilter Factory"),(0,r.kt)("p",null,"\u5c06\u539f\u59cb\u8bf7\u6c42\u91cd\u5b9a\u5411\u5230\u6307\u5b9a\u7684Url\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: redirect_route\n        uri: https://example.org\n        filters:\n        - RedirectTo=302, https://acme.org\n")),(0,r.kt)("p",null,"\u8be5\u914d\u7f6e\u4f7f\u8bbf\u95ee ",(0,r.kt)("inlineCode",{parentName:"p"},"${GATEWAY_URL}/hello")," \u4f1a\u88ab\u91cd\u5b9a\u5411\u5230 ",(0,r.kt)("inlineCode",{parentName:"p"},"https://acme.org/hello")," \uff0c\u5e76\u4e14\u643a\u5e26\u4e00\u4e2a ",(0,r.kt)("inlineCode",{parentName:"p"},"Location:http://acme.org")," \u7684Header\uff0c\u800c\u8fd4\u56de\u5ba2\u6237\u7aef\u7684HTTP\u72b6\u6001\u7801\u4e3a302"),(0,r.kt)("p",null,"\u6ce8\u610f\u4e8b\u9879\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"HTTP\u72b6\u6001\u7801\u5e94\u4e3a3xx\uff0c\u4f8b\u5982301"),(0,r.kt)("li",{parentName:"ul"},"URL\u5fc5\u987b\u662f\u5408\u6cd5\u7684URL\uff0c\u8be5URL\u4f1a\u4f5c\u4e3a",(0,r.kt)("inlineCode",{parentName:"li"},"Location")," Header\u7684\u503c")),(0,r.kt)("p",null,"11\u3001RemoveHopByHopHeadersFilter GatewayFilter Factory"),(0,r.kt)("p",null,"\u4e3a\u539f\u59cb\u8bf7\u6c42\u5220\u9664",(0,r.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/draft-ietf-httpbis-p1-messaging-14#section-7.1.3"},"IETFopen in new window"),"\u7ec4\u7ec7\u89c4\u5b9a\u7684\u4e00\u7cfb\u5217Header\uff0c\u9ed8\u8ba4\u5220\u9664\u7684Header\u5982\u4e0b\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Connection"),(0,r.kt)("li",{parentName:"ul"},"Keep-Alive"),(0,r.kt)("li",{parentName:"ul"},"Proxy-Authenticate"),(0,r.kt)("li",{parentName:"ul"},"Proxy-Authorization"),(0,r.kt)("li",{parentName:"ul"},"TE"),(0,r.kt)("li",{parentName:"ul"},"Trailer"),(0,r.kt)("li",{parentName:"ul"},"Transfer-Encoding"),(0,r.kt)("li",{parentName:"ul"},"Upgrade")),(0,r.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u53bb\u6307\u5b9a\u4ec5\u5220\u9664\u54ea\u4e9bHeader\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      filter:\n        remove-hop-by-hop:\n          # \u591a\u4e2aHeader\u4f7f\u7528\u9017\u53f7\uff08,\uff09\u5206\u9694\n          headers: Connection,Keep-Alive\n")),(0,r.kt)("p",null,"12\u3001RemoveRequestHeader GatewayFilter Factory"),(0,r.kt)("p",null,"\u4e3a\u539f\u59cb\u8bf7\u6c42\u5220\u9664\u67d0\u4e2aHeader\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: removerequestheader_route\n        uri: https://example.org\n        filters:\n        - RemoveRequestHeader=X-Request-Foo\n")),(0,r.kt)("p",null,"\u5220\u9664\u539f\u59cb\u8bf7\u6c42\u4e2d\u540d\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"X-Request-Foo")," \u7684\u8bf7\u6c42\u5934"),(0,r.kt)("p",null,"13\u3001RemoveResponseHeader GatewayFilter Factory"),(0,r.kt)("p",null,"\u4e3a\u539f\u59cb\u54cd\u5e94\u5220\u9664\u67d0\u4e2aHeader\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: removeresponseheader_route\n        uri: https://example.org\n        filters:\n        - RemoveResponseHeader=X-Response-Foo\n")),(0,r.kt)("p",null,"\u5220\u9664\u539f\u59cb\u54cd\u5e94\u4e2d\u540d\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"X-Request-Foo")," \u7684\u54cd\u5e94\u5934"),(0,r.kt)("p",null,"14\u3001RewritePath GatewayFilter Factory"),(0,r.kt)("p",null,"\u901a\u8fc7\u6b63\u5219\u8868\u8fbe\u5f0f\u91cd\u5199\u539f\u59cb\u7684\u8bf7\u6c42\u8def\u5f84\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: rewritepath_route\n        uri: https://example.org\n        predicates:\n        - Path=/foo/**\n        filters:\n        # \u53c2\u65701\u4e3a\u539f\u59cb\u8def\u5f84\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u53c2\u65702\u4e3a\u91cd\u5199\u540e\u8def\u5f84\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\n        - RewritePath=/foo/(?<segment>.*), /$\\{segment}\n")),(0,r.kt)("p",null,"\u8be5\u914d\u7f6e\u4f7f\u5f97\u8bbf\u95ee ",(0,r.kt)("inlineCode",{parentName:"p"},"/foo/bar")," \u65f6\uff0c\u4f1a\u5c06\u8def\u5f84\u91cd\u5199\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"/bar")," \u518d\u8fdb\u884c\u8f6c\u53d1\uff0c\u4e5f\u5c31\u662f\u4f1a\u8f6c\u53d1\u5230 ",(0,r.kt)("inlineCode",{parentName:"p"},"https://example.org/bar"),"\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a\u7531\u4e8eYAML\u8bed\u6cd5\uff0c\u9700\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"$\\")," \u66ff\u6362 ",(0,r.kt)("inlineCode",{parentName:"p"},"$")),(0,r.kt)("p",null,"15\u3001RewriteResponseHeader GatewayFilter Factory"),(0,r.kt)("p",null,"\u91cd\u5199\u539f\u59cb\u54cd\u5e94\u4e2d\u7684\u67d0\u4e2aHeader\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: rewriteresponseheader_route\n        uri: https://example.org\n        filters:\n        # \u53c2\u65701\u4e3aHeader\u540d\u79f0\uff0c\u53c2\u65702\u4e3a\u503c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u53c2\u65703\u4e3a\u91cd\u5199\u540e\u7684\u503c\n        - RewriteResponseHeader=X-Response-Foo, password=[^&]+, password=***\n")),(0,r.kt)("p",null,"\u8be5\u914d\u7f6e\u7684\u610f\u4e49\u5728\u4e8e\uff1a\u5982\u679c\u54cd\u5e94\u5934\u4e2d ",(0,r.kt)("inlineCode",{parentName:"p"},"X-Response-Foo")," \u7684\u503c\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"/42?user=ford&password=omg!what&flag=true"),"\uff0c\u90a3\u4e48\u5c31\u4f1a\u88ab\u6309\u7167\u914d\u7f6e\u7684\u503c\u91cd\u5199\u6210",(0,r.kt)("inlineCode",{parentName:"p"},"/42?user=ford&password=***&flag=true"),"\uff0c\u4e5f\u5c31\u662f\u628a\u5176\u4e2d\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"password=omg!what"),"\u91cd\u5199\u6210\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"password=***")),(0,r.kt)("p",null,"16\u3001SaveSession GatewayFilter Factory"),(0,r.kt)("p",null,"\u5728\u8f6c\u53d1\u8bf7\u6c42\u4e4b\u524d\uff0c\u5f3a\u5236\u6267\u884c",(0,r.kt)("inlineCode",{parentName:"p"},"WebSession::save"),"\u64cd\u4f5c\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: save_session\n        uri: https://example.org\n        predicates:\n        - Path=/foo/**\n        filters:\n        - SaveSession\n")),(0,r.kt)("p",null,"\u4e3b\u8981\u7528\u5728\u90a3\u79cd\u50cf Spring Session \u5ef6\u8fdf\u6570\u636e\u5b58\u50a8\uff08\u6570\u636e\u4e0d\u662f\u7acb\u523b\u6301\u4e45\u5316\uff09\u7684\uff0c\u5e76\u5e0c\u671b\u5728\u8bf7\u6c42\u8f6c\u53d1\u524d\u786e\u4fddsession\u72b6\u6001\u4fdd\u5b58\u60c5\u51b5\u3002\u5982\u679c\u4f60\u5c06Spring Secutiry\u4e8eSpring Session\u96c6\u6210\u4f7f\u7528\uff0c\u5e76\u60f3\u786e\u4fdd\u5b89\u5168\u4fe1\u606f\u90fd\u4f20\u5230\u4e0b\u6e38\u673a\u5668\uff0c\u4f60\u5c31\u9700\u8981\u914d\u7f6e\u8fd9\u4e2afilter\u3002"),(0,r.kt)("p",null,"17\u3001secureHeaders GatewayFilter Factory"),(0,r.kt)("p",null,"secureHeaders\u8fc7\u6ee4\u5668\u5de5\u5382\u4e3b\u8981\u662f\u53c2\u8003\u4e86",(0,r.kt)("a",{parentName:"p",href:"https://blog.appcanary.com/2017/http-security-headers.html"},"\u8fd9\u7bc7\u535a\u5ba2open in new window"),"\u4e2d\u7684\u5efa\u8bae\uff0c\u4e3a\u539f\u59cb\u54cd\u5e94\u6dfb\u52a0\u4e86\u4e00\u7cfb\u5217\u8d77\u5b89\u5168\u4f5c\u7528\u7684\u54cd\u5e94\u5934\u3002\u9ed8\u8ba4\u4f1a\u6dfb\u52a0\u5982\u4e0bHeaders\uff08\u5305\u62ec\u503c\uff09\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"X-Xss-Protection:1; mode=block")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Strict-Transport-Security:max-age=631138519")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"X-Frame-Options:DENY")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"X-Content-Type-Options:nosniff")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Referrer-Policy:no-referrer")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Content-Security-Policy:default-src 'self' https:; font-src 'self' https: data:; img-src 'self' https: data:; object-src 'none'; script-src https:; style-src 'self' https: 'unsafe-inline'")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"X-Download-Options:noopen")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"X-Permitted-Cross-Domain-Policies:none"))),(0,r.kt)("p",null,"\u5982\u679c\u4f60\u60f3\u4fee\u6539\u8fd9\u4e9bHeader\u7684\u503c\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u4f7f\u7528\u8fd9\u4e9bHeaders\u5bf9\u5e94\u7684\u540e\u7f00\uff0c\u5982\u4e0b\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"xss-protection-header")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"strict-transport-security")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"frame-options")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"content-type-options")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"referrer-policy")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"content-security-policy")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"download-options")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"permitted-cross-domain-policies"))),(0,r.kt)("p",null,"\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      filter:\n        secure-headers:\n          # \u4fee\u6539 X-Xss-Protection \u7684\u503c\u4e3a 2; mode=unblock\n          xss-protection-header: 2; mode=unblock\n")),(0,r.kt)("p",null,"\u5982\u679c\u60f3\u7981\u7528\u67d0\u4e9bHeader\uff0c\u53ef\u4f7f\u7528\u5982\u4e0b\u914d\u7f6e\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      filter:\n        secure-headers:\n          # \u591a\u4e2a\u4f7f\u7528\u9017\u53f7\uff08,\uff09\u5206\u9694\n          disable: frame-options,download-options\n")),(0,r.kt)("p",null,"18\u3001SetPath GatewayFilter Factory"),(0,r.kt)("p",null,"\u4fee\u6539\u539f\u59cb\u7684\u8bf7\u6c42\u8def\u5f84\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: setpath_route\n        uri: https://example.org\n        predicates:\n        - Path=/foo/{segment}\n        filters:\n        - SetPath=/{segment}\n")),(0,r.kt)("p",null,"\u8be5\u914d\u7f6e\u4f7f\u8bbf\u95ee ",(0,r.kt)("inlineCode",{parentName:"p"},"${GATEWAY_URL}/foo/bar")," \u65f6\u4f1a\u8f6c\u53d1\u5230 ",(0,r.kt)("inlineCode",{parentName:"p"},"https://example.org/bar")," \uff0c\u4e5f\u5c31\u662f\u539f\u672c\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"/foo/bar"),"\u88ab\u4fee\u6539\u4e3a\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"/bar")),(0,r.kt)("p",null,"19\u3001SetResponseHeader GatewayFilter Factory"),(0,r.kt)("p",null,"\u4fee\u6539\u539f\u59cb\u54cd\u5e94\u4e2d\u67d0\u4e2aHeader\u7684\u503c\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: setresponseheader_route\n        uri: https://example.org\n        filters:\n        - SetResponseHeader=X-Response-Foo, Bar\n")),(0,r.kt)("p",null,"\u5c06\u539f\u59cb\u54cd\u5e94\u4e2d ",(0,r.kt)("inlineCode",{parentName:"p"},"X-Response-Foo")," \u7684\u503c\u4fee\u6539\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"Bar")),(0,r.kt)("p",null,"20\u3001SetStatus GatewayFilter Factory"),(0,r.kt)("p",null,"\u4fee\u6539\u539f\u59cb\u54cd\u5e94\u7684\u72b6\u6001\u7801\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: setstatusstring_route\n        uri: https://example.org\n        filters:\n        # \u5b57\u7b26\u4e32\u5f62\u5f0f\n        - SetStatus=BAD_REQUEST\n      - id: setstatusint_route\n        uri: https://example.org\n        filters:\n        # \u6570\u5b57\u5f62\u5f0f\n        - SetStatus=401\n")),(0,r.kt)("p",null,"SetStatusd\u7684\u503c\u53ef\u4ee5\u662f\u6570\u5b57\uff0c\u4e5f\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\u3002\u4f46\u4e00\u5b9a\u8981\u662fSpring ",(0,r.kt)("inlineCode",{parentName:"p"},"HttpStatus")," \u679a\u4e3e\u7c7b\u4e2d\u7684\u503c\u3002\u4e0a\u9762\u8fd9\u4e24\u79cd\u914d\u7f6e\u90fd\u53ef\u4ee5\u8fd4\u56de401\u8fd9\u4e2aHTTP\u72b6\u6001\u7801\u3002"),(0,r.kt)("p",null,"21\u3001StripPrefix GatewayFilter Factory"),(0,r.kt)("p",null,"\u7528\u4e8e\u622a\u65ad\u539f\u59cb\u8bf7\u6c42\u7684\u8def\u5f84\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: nameRoot\n        uri: http://nameservice\n        predicates:\n        - Path=/name/**\n        filters:\n        # \u6570\u5b57\u8868\u793a\u8981\u622a\u65ad\u7684\u8def\u5f84\u7684\u6570\u91cf\n        - StripPrefix=2\n")),(0,r.kt)("p",null,"\u5982\u4e0a\u914d\u7f6e\uff0c\u5982\u679c\u8bf7\u6c42\u7684\u8def\u5f84\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"/name/bar/foo")," \uff0c\u90a3\u4e48\u5219\u4f1a\u622a\u65ad\u6210",(0,r.kt)("inlineCode",{parentName:"p"},"/foo"),"\u540e\u8fdb\u884c\u8f6c\u53d1 \uff0c\u4e5f\u5c31\u662f\u4f1a\u622a\u65ad2\u4e2a\u8def\u5f84\u3002"),(0,r.kt)("p",null,"22\u3001Retry GatewayFilter Factory"),(0,r.kt)("p",null,"\u9488\u5bf9\u4e0d\u540c\u7684\u54cd\u5e94\u8fdb\u884c\u91cd\u8bd5\uff0c\u4f8b\u5982\u53ef\u4ee5\u9488\u5bf9HTTP\u72b6\u6001\u7801\u8fdb\u884c\u91cd\u8bd5\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: retry_test\n        uri: http://localhost:8080/flakey\n        predicates:\n        - Host=*.retry.com\n        filters:\n        - name: Retry\n          args:\n            retries: 3\n            statuses: BAD_GATEWAY\n")),(0,r.kt)("p",null,"\u53ef\u914d\u7f6e\u5982\u4e0b\u53c2\u6570\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"retries"),"\uff1a\u91cd\u8bd5\u6b21\u6570"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"statuses"),"\uff1a\u9700\u8981\u91cd\u8bd5\u7684\u72b6\u6001\u7801\uff0c\u53d6\u503c\u5728 ",(0,r.kt)("inlineCode",{parentName:"li"},"org.springframework.http.HttpStatus")," \u4e2d"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"methods"),"\uff1a\u9700\u8981\u91cd\u8bd5\u7684\u8bf7\u6c42\u65b9\u6cd5\uff0c\u53d6\u503c\u5728 ",(0,r.kt)("inlineCode",{parentName:"li"},"org.springframework.http.HttpMethod")," \u4e2d"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"series"),"\uff1aHTTP\u72b6\u6001\u7801\u5e8f\u5217\uff0c\u53d6\u503c\u5728 ",(0,r.kt)("inlineCode",{parentName:"li"},"org.springframework.http.HttpStatus.Series")," \u4e2d")),(0,r.kt)("p",null,"23\u3001RequestSize GatewayFilter Factory"),(0,r.kt)("p",null,"\u8bbe\u7f6e\u5141\u8bb8\u63a5\u6536\u6700\u5927\u8bf7\u6c42\u5305\u7684\u5927\u5c0f\uff0c\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      routes:\n      - id: request_size_route\n      uri: http://localhost:8080/upload\n      predicates:\n      - Path=/upload\n      filters:\n      - name: RequestSize\n        args:\n          # \u5355\u4f4d\u4e3a\u5b57\u8282\n          maxSize: 5000000\n")),(0,r.kt)("p",null,"\u5982\u679c\u8bf7\u6c42\u5305\u5927\u5c0f\u8d85\u8fc7\u8bbe\u7f6e\u7684\u503c\uff0c\u5219\u4f1a\u8fd4\u56de ",(0,r.kt)("inlineCode",{parentName:"p"},"413 Payload Too Large"),"\u4ee5\u53ca\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"errorMessage")),(0,r.kt)("p",null,"24\u3001Modify Request Body GatewayFilter Factory"),(0,r.kt)("p",null,"\u5728\u8f6c\u53d1\u8bf7\u6c42\u4e4b\u524d\u4fee\u6539\u539f\u59cb\u8bf7\u6c42\u4f53\u5185\u5bb9\uff0c\u8be5\u8fc7\u6ee4\u5668\u5de5\u5382\u53ea\u80fd\u901a\u8fc7\u4ee3\u7801\u914d\u7f6e\uff0c\u4e0d\u652f\u6301\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u3002\u4ee3\u7801\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Bean\npublic RouteLocator routes(RouteLocatorBuilder builder) {\n    return builder.routes()\n        .route("rewrite_request_obj", r -> r.host("*.rewriterequestobj.org")\n            .filters(f -> f.prefixPath("/httpbin")\n                .modifyRequestBody(String.class, Hello.class, MediaType.APPLICATION_JSON_VALUE,\n                    (exchange, s) -> return Mono.just(new Hello(s.toUpperCase())))).uri(uri))\n        .build();\n}\n \nstatic class Hello {\n    String message;\n \n    public Hello() { }\n \n    public Hello(String message) {\n        this.message = message;\n    }\n \n    public String getMessage() {\n        return message;\n    }\n \n    public void setMessage(String message) {\n        this.message = message;\n    }\n}\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Tips\uff1a\u8be5\u8fc7\u6ee4\u5668\u5de5\u5382\u5904\u4e8e ",(0,r.kt)("strong",{parentName:"p"},"BETA")," \u72b6\u6001\uff0c\u672a\u6765API\u53ef\u80fd\u4f1a\u53d8\u5316\uff0c\u751f\u4ea7\u73af\u5883\u8bf7\u614e\u7528")),(0,r.kt)("p",null,"25\u3001Modify Response Body GatewayFilter Factory"),(0,r.kt)("p",null,"\u53ef\u7528\u4e8e\u4fee\u6539\u539f\u59cb\u54cd\u5e94\u4f53\u7684\u5185\u5bb9\uff0c\u8be5\u8fc7\u6ee4\u5668\u5de5\u5382\u540c\u6837\u53ea\u80fd\u901a\u8fc7\u4ee3\u7801\u914d\u7f6e\uff0c\u4e0d\u652f\u6301\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u3002\u4ee3\u7801\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Bean\npublic RouteLocator routes(RouteLocatorBuilder builder) {\n    return builder.routes()\n        .route("rewrite_response_upper", r -> r.host("*.rewriteresponseupper.org")\n            .filters(f -> f.prefixPath("/httpbin")\n                .modifyResponseBody(String.class, String.class,\n                    (exchange, s) -> Mono.just(s.toUpperCase()))).uri(uri)\n        .build();\n}\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Tips\uff1a\u8be5\u8fc7\u6ee4\u5668\u5de5\u5382\u5904\u4e8e ",(0,r.kt)("strong",{parentName:"p"},"BETA")," \u72b6\u6001\uff0c\u672a\u6765API\u53ef\u80fd\u4f1a\u53d8\u5316\uff0c\u751f\u4ea7\u73af\u5883\u8bf7\u614e\u7528")),(0,r.kt)("p",null,"26\u3001Default Filters"),(0,r.kt)("p",null,"Default Filters\u7528\u4e8e\u4e3a\u6240\u6709\u8def\u7531\u6dfb\u52a0\u8fc7\u6ee4\u5668\u5de5\u5382\uff0c\u4e5f\u5c31\u662f\u8bf4\u901a\u8fc7Default Filter\u6240\u914d\u7f6e\u7684\u8fc7\u6ee4\u5668\u5de5\u5382\u4f1a\u4f5c\u7528\u5230\u6240\u6709\u7684\u8def\u7531\u4e0a\u3002\u914d\u7f6e\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  cloud:\n    gateway:\n      default-filters:\n      - AddResponseHeader=X-Response-Default-Foo, Default-Bar\n      - PrefixPath=/httpbin\n")),(0,r.kt)("hr",null),(0,r.kt)("p",null,"\u5b98\u65b9\u6587\u6863\uff1a",(0,r.kt)("a",{parentName:"p",href:"https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.1.0.RELEASE/single/spring-cloud-gateway.html#_gatewayfilter_factories"},"https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.1.0.RELEASE/single/spring-cloud-gateway.html#_gatewayfilter_factoriesopen in new window")),(0,r.kt)("h4",{id:"\u81ea\u5b9a\u4e49\u8fc7\u6ee4\u5668"},"\u81ea\u5b9a\u4e49\u8fc7\u6ee4\u5668"),(0,r.kt)("p",null,"1\u3001\u81ea\u5b9a\u4e49 \u5c40\u90e8\u8fc7\u6ee4\u5668"),(0,r.kt)("p",null,"\u9ebb\u70e6\uff0c\u5f88\u5c11\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'//\n// Source code recreated from a .class file by IntelliJ IDEA\n// (powered by FernFlower decompiler)\n//\n\npackage org.springframework.cloud.gateway.filter.factory;\n\nimport java.util.Arrays;\nimport java.util.List;\nimport org.springframework.cloud.gateway.filter.GatewayFilter;\nimport org.springframework.cloud.gateway.filter.GatewayFilterChain;\nimport org.springframework.cloud.gateway.support.GatewayToStringStyler;\nimport org.springframework.cloud.gateway.support.ServerWebExchangeUtils;\nimport org.springframework.http.server.reactive.ServerHttpRequest;\nimport org.springframework.util.StringUtils;\nimport org.springframework.web.server.ServerWebExchange;\nimport reactor.core.publisher.Mono;\n\npublic class StripPrefixGatewayFilterFactory extends AbstractGatewayFilterFactory<StripPrefixGatewayFilterFactory.Config> {\n    public static final String PARTS_KEY = "parts";\n\n    public StripPrefixGatewayFilterFactory() {\n        super(StripPrefixGatewayFilterFactory.Config.class);\n    }\n\n    public List<String> shortcutFieldOrder() {\n        return Arrays.asList("parts");\n    }\n\n    public GatewayFilter apply(StripPrefixGatewayFilterFactory.Config config) {\n        return new GatewayFilter() {\n            public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n                ServerHttpRequest request = exchange.getRequest();\n                ServerWebExchangeUtils.addOriginalRequestUrl(exchange, request.getURI());\n                String path = request.getURI().getRawPath();\n                String[] originalParts = StringUtils.tokenizeToStringArray(path, "/");\n                StringBuilder newPath = new StringBuilder("/");\n\n                for(int i = 0; i < originalParts.length; ++i) {\n                    if (i >= config.getParts()) {\n                        if (newPath.length() > 1) {\n                            newPath.append(\'/\');\n                        }\n\n                        newPath.append(originalParts[i]);\n                    }\n                }\n\n                if (newPath.length() > 1 && path.endsWith("/")) {\n                    newPath.append(\'/\');\n                }\n\n                ServerHttpRequest newRequest = request.mutate().path(newPath.toString()).build();\n                exchange.getAttributes().put(ServerWebExchangeUtils.GATEWAY_REQUEST_URL_ATTR, newRequest.getURI());\n                return chain.filter(exchange.mutate().request(newRequest).build());\n            }\n\n            public String toString() {\n                return GatewayToStringStyler.filterToStringCreator(StripPrefixGatewayFilterFactory.this).append("parts", config.getParts()).toString();\n            }\n        };\n    }\n\n    public static class Config {\n        private int parts;\n\n        public Config() {\n        }\n\n        public int getParts() {\n            return this.parts;\n        }\n\n        public void setParts(int parts) {\n            this.parts = parts;\n        }\n    }\n}\n')),(0,r.kt)("p",null,"2\u3001\u81ea\u5b9a\u4e49 \u5168\u5c40\u8fc7\u6ee4\u5668"),(0,r.kt)("p",null,"\u9700\u6c42\uff1a1\u9ed1\u5ba2ip\uff0c\u76f4\u63a5\u7ed9\u4f60\u62d2\u63a5\u6389\u3002"),(0,r.kt)("p",null," 2\u67d0\u4e9b\u8bf7\u6c42\u8def\u5f84 \u5982\u201cgoods/findById\u201d,\u5371\u9669\u64cd\u4f5c\uff0c\u8bb0\u5f55\u65e5\u5fd7\u3002"),(0,r.kt)("p",null,"\u81ea\u5b9a\u4e49\u5168\u5c40\u8fc7\u6ee4\u5668\u6b65\u9aa4\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"1. \u5b9a\u4e49\u7c7b\u5b9e\u73b0 GlobalFilter \u548c Ordered\u63a5\u53e3\n2. \u590d\u5199\u65b9\u6cd5\n3. \u5b8c\u6210\u903b\u8f91\u5904\u7406\n")),(0,r.kt)("p",null,"IpFilter"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.gateway.filter;\n\nimport org.springframework.cloud.gateway.filter.GatewayFilterChain;\nimport org.springframework.cloud.gateway.filter.GlobalFilter;\nimport org.springframework.core.Ordered;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.server.reactive.ServerHttpRequest;\nimport org.springframework.http.server.reactive.ServerHttpResponse;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.server.ServerWebExchange;\nimport reactor.core.publisher.Mono;\n\nimport java.net.InetAddress;\nimport java.net.InetSocketAddress;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@Component\npublic class IpFilter implements GlobalFilter, Ordered {\n\n    //\u5199\u4e1a\u52a1\u903b\u8f91\n    @Override\n    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n        //1\u9ed1\u5ba2ip\uff0c\u76f4\u63a5\u7ed9\u4f60\u62d2\u63a5\u6389\u3002\n\n        //\u62ff\u5230\u8bf7\u6c42\u548c\u54cd\u5e94\uff0c\u4e3a\u6240\u6b32\u4e3a\n        ServerHttpRequest request = exchange.getRequest();\n        ServerHttpResponse response = exchange.getResponse();\n\n        InetSocketAddress remoteAddress = request.getRemoteAddress();\n        String hostName = remoteAddress.getHostName();\n        System.out.println(hostName);\n        InetAddress address = remoteAddress.getAddress();\n        String hostAddress = address.getHostAddress();\n        System.out.println(hostAddress);\n        String hostName1 = address.getHostName();\n        System.out.println(hostName1);\n\n        if (hostAddress.equals("192.168.31.11")) {\n            //\u62d2\u7edd\n            response.setStatusCode(HttpStatus.UNAUTHORIZED);\n            return response.setComplete();\n        }\n\n        //\u8d70\u5b8c\u4e86\uff0c\u8be5\u5230\u4e0b\u4e00\u4e2a\u8fc7\u6ee4\u5668\u4e86\n        return chain.filter(exchange);\n    }\n\n    //\u8fd4\u56de\u6570\u503c\uff0c\u8d8a\u5c0f\u8d8a\u5148\u6267\u884c\n    @Override\n    public int getOrder() {\n        return 0;\n    }\n}\n')),(0,r.kt)("p",null,"UrlFilter"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'package com.ydlclass.gateway.filter;\n\nimport org.springframework.cloud.gateway.filter.GatewayFilterChain;\nimport org.springframework.cloud.gateway.filter.GlobalFilter;\nimport org.springframework.core.Ordered;\nimport org.springframework.http.server.reactive.ServerHttpRequest;\nimport org.springframework.http.server.reactive.ServerHttpResponse;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.server.ServerWebExchange;\nimport reactor.core.publisher.Mono;\n\nimport java.net.URI;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@Component\npublic class UrlFilter implements GlobalFilter, Ordered {\n    @Override\n    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n        //\u67d0\u4e9b\u8bf7\u6c42\u8def\u5f84 \u5982\u201cgoods/findById\u201d,\u5371\u9669\u64cd\u4f5c\uff0c\u8bb0\u5f55\u65e5\u5fd7\u3002\n\n        //\u62ff\u5230\u8bf7\u6c42\u548c\u54cd\u5e94\uff0c\u4e3a\u6240\u6b32\u4e3a\n        ServerHttpRequest request = exchange.getRequest();\n        ServerHttpResponse response = exchange.getResponse();\n\n        URI uri = request.getURI();\n        String path = uri.getPath();\n        System.out.println(path);\n\n        if(path.contains("goods/findById")){\n            //\u6253\u65e5\u5fd7\n            System.out.println("path\u5f88\u5371\u9669\uff01");\n        }\n\n        return chain.filter(exchange);\n    }\n\n    @Override\n    public int getOrder() {\n        return 1;\n    }\n}\n')),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,r.kt)("p",null,"1\u3001ipfilter"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411191527069-40d06e6f.png",alt:"image-20220411191527069"}),"image-20220411191527069"),(0,r.kt)("p",null,"\u628a\u81ea\u5df1\u7684ip\u8bbe\u7f6e\u4e3a\u62d2\u7edd\u8bbf\u95ee\u7684\u8bdd"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411191641610-d8bde2dd.png",alt:"image-20220411191641610"}),"image-20220411191641610"),(0,r.kt)("p",null,"2\u3001"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411192132436-09d8d5e2.png",alt:"image-20220411192132436"}),"image-20220411192132436"),(0,r.kt)("h2",{id:"\u7b2c\u5341\u4e09\u7ae0-\u5206\u5e03\u5f0f\u914d\u7f6e\u4e2d\u5fc3"},"\u7b2c\u5341\u4e09\u7ae0 \u5206\u5e03\u5f0f\u914d\u7f6e\u4e2d\u5fc3"),(0,r.kt)("p",null,"13-16\u7ec4\u4ef6\uff0c\u8d85\u5927\u578b\u516c\u53f8\u624d\u4f1a\u7528\u5230"),(0,r.kt)("p",null,"\u56fd\u5185BATJ,\u6216\u8005\u56fd\u5916FLAG:facebook linkedin amazon google"),(0,r.kt)("p",null,"\u5904\u7406\u5927\u89c4\u6a21\u5fae\u670d\u52a1\u7684\u6280\u672f\u3002"),(0,r.kt)("h3",{id:"\u4e00config-\u6982\u8ff0"},"\u4e00\u3001Config \u6982\u8ff0"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418081959807-439382b4.png",alt:"image-20220418081959807"}),"image-20220418081959807"),(0,r.kt)("p",null,"Spring Cloud Config \u89e3\u51b3\u4e86\u5728\u5206\u5e03\u5f0f\u573a\u666f\u4e0b\u591a\u73af\u5883\u914d\u7f6e\u6587\u4ef6\u7684\u7ba1\u7406\u548c\u7ef4\u62a4\u3002"),(0,r.kt)("p",null,"\u597d\u5904\uff1a"),(0,r.kt)("p",null,"\u2022 \u96c6\u4e2d\u7ba1\u7406\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("p",null,"\u2022 \u4e0d\u540c\u73af\u5883\u4e0d\u540c\u914d\u7f6e\uff0c\u52a8\u6001\u5316\u7684\u914d\u7f6e\u66f4\u65b0"),(0,r.kt)("p",null,"\u2022 \u914d\u7f6e\u4fe1\u606f\u6539\u53d8\u65f6\uff0c\u4e0d\u9700\u8981\u91cd\u542f\u5373\u53ef\u66f4\u65b0\u914d\u7f6e\u4fe1\u606f\u5230\u670d\u52a1"),(0,r.kt)("h3",{id:"\u4e8cconfig-\u5feb\u901f\u5165\u95e8"},"\u4e8c\u3001Config \u5feb\u901f\u5165\u95e8"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418082533367-271fa629.png",alt:"image-20220418082533367"}),"image-20220418082533367"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"config-server\uff1a")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u4f7f\u7528gitee\u521b\u5efa\u8fdc\u7a0b\u4ed3\u5e93\uff0c\u4e0a\u4f20\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("p",{parentName:"li"},"config-dev.yml")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u642d\u5efa config-server \u6a21\u5757"),(0,r.kt)("p",{parentName:"li"},"ConfigServerApp"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```java\npackage com.ydlclass.config;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.config.server.EnableConfigServer;\n\n@SpringBootApplication\n@EnableConfigServer // \u542f\u7528config server\u529f\u80fd\npublic class ConfigServerApp {\n\n    public static void main(String[] args) {\n        SpringApplication.run(ConfigServerApp.class,args);\n    }\n}\n```\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5bfc\u5165 config-server \u4f9d\u8d56"),(0,r.kt)("p",{parentName:"li"},"pom"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```xml\n        \x3c!-- config-server --\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-config-server</artifactId>\n        </dependency>\n```\n")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u7f16\u5199\u914d\u7f6e\uff0c\u8bbe\u7f6e gitee \u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740"),(0,r.kt)("p",{parentName:"li"},"application.yml"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```yaml\nserver:\n  port: 9527\n\nspring:\n  application:\n    name: config-server\n  # spring cloud config\n  cloud:\n    config:\n      server:\n        # git \u7684 \u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740\n        git:\n          uri: https://gitee.com/ydlclass_cch/ydlclass-configs.git\n      label: master # \u5206\u652f\u914d\u7f6e\n```\n")),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u6d4b\u8bd5\u8bbf\u95ee\u8fdc\u7a0b\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"http://localhost:9527/master/provider-dev.yml"},"http://localhost:9527/master/provider-dev.ymlopen in new window")))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418083733698-508dfd18.png",alt:"image-20220418083733698"}),"image-20220418083733698"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"config-client\uff1a")," provider"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5bfc\u5165 starter-config \u4f9d\u8d56")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```xml\n        \x3c!--config client --\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-config</artifactId>\n        </dependency>\n```\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u914d\u7f6econfig server \u5730\u5740\uff0c\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u540d\u79f0\u7b49\u4fe1\u606f"),(0,r.kt)("p",{parentName:"li"},"bootstrap.yml"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```yaml\n# \u914d\u7f6econfig-server\u5730\u5740\n# \u914d\u7f6e\u83b7\u5f97\u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0\u7b49\u4fe1\u606f\nspring:\n  cloud:\n    config:\n      # \u914d\u7f6econfig-server\u5730\u5740\n      uri: http://localhost:9527\n      # \u914d\u7f6e\u83b7\u5f97\u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0\u7b49\u4fe1\u606f\n      name: provider # \u6587\u4ef6\u540d\n      profile: dev # profile\u6307\u5b9a\uff0c  config-dev.yml\n      label: master # \u5206\u652f\n```\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u83b7\u53d6\u914d\u7f6e\u503c"),(0,r.kt)("p",{parentName:"li"},"GoodsController"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```java\n    @Value("${ydlclass}")\n    private String ydlclass;\n    \n    goods.setTitle(goods.getTitle()+"|\u7aef\u53e3\u53f7\uff1a"+port+"|ydlclass"+ydlclass);\n```\n')),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u542f\u52a8\u6d4b\u8bd5"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"http://localhost:8000/goods/findById/9"},"http://localhost:8000/goods/findById/9open in new window")))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418084608302-978afefa.png",alt:"image-20220418084608302"}),"image-20220418084608302"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Config \u5ba2\u6237\u7aef\u5237\u65b0")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418085057098-ae365b9f.png",alt:"image-20220418085057098"}),"image-20220418085057098"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5728 config \u5ba2\u6237\u7aef\u5f15\u5165 actuator \u4f9d\u8d56")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```xml\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n```\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u83b7\u53d6\u914d\u7f6e\u4fe1\u606f\u7c7b\u4e0a\uff0c\u6dfb\u52a0 @RefreshScope \u6ce8\u89e3"),(0,r.kt)("p",{parentName:"li"},"GoodsController"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```java\n@RefreshScope // \u5f00\u542f\u5237\u65b0\u529f\u80fd\n```\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u6dfb\u52a0\u914d\u7f6e"),(0,r.kt)("p",{parentName:"li"},"bootstrap.yml"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"management:\n  endpoints:\n    web:\n      exposure:\n        include: '*'\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u4f7f\u7528curl\u5de5\u5177\u53d1\u9001post\u8bf7\u6c42"),(0,r.kt)("p",{parentName:"li"},"curl -X POST ",(0,r.kt)("a",{parentName:"p",href:"http://localhost:8000/actuator/refresh"},"http://localhost:8000/actuator/refreshopen in new window")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418085907801-edb89cde.png",alt:"image-20220418085907801"}),"image-20220418085907801"))),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a \u503c\u5df2\u7ecf\u53d8\u4e86"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418085930400-9adcb0c7.png",alt:"image-20220418085930400"}),"image-20220418085930400"),(0,r.kt)("h3",{id:"\u4e09config-\u96c6\u6210eureka"},"\u4e09\u3001Config \u96c6\u6210Eureka"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418090254336-8b4469ba.png",alt:"image-20220418090254336"}),"image-20220418090254336"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"config-client\u914d\u7f6e\uff1a")),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"        \x3c!-- eureka-client --\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n        </dependency>\n")),(0,r.kt)("p",null,"ProviderApp"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@EnableEurekaClient\n")),(0,r.kt)("p",null,"bootstrap.yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"# \u914d\u7f6econfig-server\u5730\u5740\n# \u914d\u7f6e\u83b7\u5f97\u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0\u7b49\u4fe1\u606f\nspring:\n  cloud:\n    config:\n      # \u914d\u7f6econfig-server\u5730\u5740\n      #uri: http://localhost:9527\n      # \u914d\u7f6e\u83b7\u5f97\u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0\u7b49\u4fe1\u606f\n      name: config # \u6587\u4ef6\u540d\n      profile: dev # profile\u6307\u5b9a\uff0c  config-dev.yml\n      label: master # \u5206\u652f\n      discovery:\n        enabled: true\n        service-id: CONFIG-SERVER\n\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: '*'\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"config-server\u914d\u7f6e:")),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"    \x3c!-- eureka-client --\x3e\n    <dependency>\n        <groupId>org.springframework.cloud</groupId>\n        <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n    </dependency>\n")),(0,r.kt)("p",null,"ConfigServerApp"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@EnableEurekaClient\n")),(0,r.kt)("p",null,"application.yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"eureka:\n   client:\n    service-url:\n      defaultZone: http://localhost:8761/eureka\n")),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418093808497-b6035ff7.png",alt:"image-20220418093808497"}),"image-20220418093808497"),(0,r.kt)("h2",{id:"\u7b2c\u5341\u56db\u7ae0-springcloud-bus\u6d88\u606f\u603b\u7ebf"},"\u7b2c\u5341\u56db\u7ae0 SpringCloud Bus\u6d88\u606f\u603b\u7ebf"),(0,r.kt)("p",null,"\u8fdc\u7a0b\u7684\u914d\u7f6e\u6587\u4ef6\u66f4\u65b0\u4e86\uff0c\u8fd0\u7ef4\u53ea\u9700\u8981\u53d1\u4e00\u4e2a\u8bf7\u6c42\uff0c\u6240\u6709\u7528\u5230\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u7684\u51e0\u767e\u4e2a\u5e94\u7528\u66f4\u65b0\u4e86\u3002"),(0,r.kt)("h3",{id:"\u4e00bus-\u6982\u8ff0"},"\u4e00\u3001Bus \u6982\u8ff0"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418094548555-e5074738.png",alt:"image-20220418094548555"}),"image-20220418094548555"),(0,r.kt)("p",null,"Spring Cloud Bus \u662f\u7528\u8f7b\u91cf\u7684\u6d88\u606f\u4e2d\u95f4\u4ef6\u5c06\u5206\u5e03\u5f0f\u7684\u8282\u70b9\u8fde\u63a5\u8d77\u6765\uff0c\u53ef\u4ee5\u7528\u4e8e\u5e7f\u64ad\u914d\u7f6e\u6587\u4ef6\u7684\u66f4\u6539\u6216\u8005\u670d\u52a1\u7684\u76d1\u63a7\u7ba1\u7406\u3002\u5173\u952e\u7684\u601d\u60f3\u5c31\u662f\uff0c\u6d88\u606f\u603b\u7ebf\u53ef\u4ee5\u4e3a\u5fae\u670d\u52a1\u505a\u76d1\u63a7\uff0c\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u76f8\u901a\u4fe1\u3002"),(0,r.kt)("p",null,"Spring Cloud Bus \u53ef\u9009\u7684\u6d88\u606f\u4e2d\u95f4\u4ef6\u5305\u62ec RabbitMQ \u548c Kafka \u3002"),(0,r.kt)("h3",{id:"\u4e8crabbitmq-\u56de\u987e"},"\u4e8c\u3001RabbitMQ \u56de\u987e"),(0,r.kt)("p",null,"message queue"),(0,r.kt)("p",null,"\u5f02\u6b65\u3001\u89e3\u8026\u3001\u524a\u5cf0\u586b\u8c37"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200613074044506-2b1f2272.png",alt:"image-20200613074044506"}),"image-20200613074044506"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200613074052830-5aedea61.png",alt:"image-20200613074052830"}),"image-20200613074052830"),(0,r.kt)("p",null,"RabbitMQ \u63d0\u4f9b\u4e86 6 \u79cd\u5de5\u4f5c\u6a21\u5f0f\uff1a\u7b80\u5355\u6a21\u5f0f\u3001work queues\u3001Publish/Subscribe \u53d1\u5e03\u4e0e\u8ba2\u9605\u6a21\u5f0f\u3001Routing"),(0,r.kt)("p",null,"\u8def\u7531\u6a21\u5f0f\u3001Topics \u4e3b\u9898\u6a21\u5f0f\u3001RPC \u8fdc\u7a0b\u8c03\u7528\u6a21\u5f0f\uff08\u8fdc\u7a0b\u8c03\u7528\uff0c\u4e0d\u592a\u7b97 MQ\uff1b\u6682\u4e0d\u4f5c\u4ecb\u7ecd\uff09\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200613074109383-dc1a9615.png",alt:"image-20200613074109383"}),"image-20200613074109383"),(0,r.kt)("h3",{id:"\u4e09bus-\u5feb\u901f\u5165\u95e8-\u8fd0\u7ef4"},"\u4e09\u3001Bus \u5feb\u901f\u5165\u95e8-\u8fd0\u7ef4"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418094548555-e5074738.png",alt:"image-20220418094548555"}),"image-20220418094548555"),(0,r.kt)("p",null,"1\u3001\u5206\u522b\u5728 config-server \u548c config-client\u4e2d\u5f15\u5165 bus\u4f9d\u8d56\uff1abus-amqp"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- bus --\x3e\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-bus-amqp</artifactId>\n</dependency>\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-actuator</artifactId>\n</dependency>\n")),(0,r.kt)("p",null,"2\u3001\u5206\u522b\u5728 config-server \u548c config-client\u4e2d\u914d\u7f6e RabbitMQ"),(0,r.kt)("p",null,"server \u7684\u914d\u7f6e\u6587\u4ef6\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 9527\n\nspring:\n  application:\n    name: config-server\n  # spring cloud config\n  cloud:\n    config:\n      server:\n        # git \u7684 \u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740\n        git:\n          uri: https://gitee.com/ydlclass_cch/ydlclass-configs.git\n      label: master # \u5206\u652f\u914d\u7f6e\n  #\u914d\u7f6erabbitmq\u4fe1\u606f\n  rabbitmq:\n    host: localhost\n    port: 5672\n    username: guest\n    password: guest\n    virtual-host: /\n\n# \u5c06\u81ea\u5df1\u6ce8\u518c\u5230eureka\u4e2d\neureka:\n  client:\n    service-url:\n      defaultZone: http://localhost:8761/eureka\n\n# \u66b4\u9732bus\u7684\u5237\u65b0\u7aef\u70b9\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: 'bus-refresh'\n")),(0,r.kt)("p",null,"client\u7684\u914d\u7f6e\u6587\u4ef6 bootstrap.yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"# \u914d\u7f6econfig-server\u5730\u5740\n# \u914d\u7f6e\u83b7\u5f97\u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0\u7b49\u4fe1\u606f\nspring:\n  cloud:\n    config:\n      # \u914d\u7f6econfig-server\u5730\u5740\n      # uri: http://localhost:9527\n      # \u914d\u7f6e\u83b7\u5f97\u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0\u7b49\u4fe1\u606f\n      name: config # \u6587\u4ef6\u540d\n      profile: dev # profile\u6307\u5b9a\uff0c  config-dev.yml\n      label: master # \u5206\u652f\n      # \u4ece\u6ce8\u518c\u4e2d\u5fc3\u53bb\u5bfb\u627econfig-server\u5730\u5740\n      discovery:\n        enabled: true\n        service-id: CONFIG-SERVER\n  #\u914d\u7f6erabbitmq\u4fe1\u606f\n  rabbitmq:\n    host: localhost\n    port: 5672\n    username: guest\n    password: guest\n    virtual-host: /\n\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: '*'\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5728config-server\u4e2d\u8bbe\u7f6e\u66b4\u9732\u76d1\u63a7\u65ad\u70b9\uff1abus-refresh")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```yaml\n# \u66b4\u9732bus\u7684\u5237\u65b0\u7aef\u70b9\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: 'bus-refresh'\n```\n")),(0,r.kt)("p",null,"bus\u81ea\u52a8\u5728mq\u4e2d\u5efa\u7acb\u4ea4\u6362\u673a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418095857082-c146dc82.png",alt:"image-20220418095857082"}),"image-20220418095857082"),(0,r.kt)("p",null,"\u53ea\u8981\u5fae\u670d\u52a1\u8d77\u8d77\u6765\uff0c\u81ea\u52a8\u5728mq\u4e2d\uff0c\u5efa\u7acb\u961f\u5217\uff0c\u548c\u4ea4\u6362\u673a\u7ed1\u5b9a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418100013437-ff032e6b.png",alt:"image-20220418100013437"}),"image-20220418100013437"),(0,r.kt)("p",null,"\u542f\u52a8\u6d4b\u8bd5"),(0,r.kt)("p",null,"1.git\u914d\u7f6e\u6539\u53d8"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418104835631-9d49fe01.png",alt:"image-20220418104835631"}),"image-20220418104835631"),(0,r.kt)("p",null,"2.\u5f80\u914d\u7f6e\u4e2d\u5fc3\u53d1\u8bf7\u6c42"),(0,r.kt)("p",null,"curl -X POST ",(0,r.kt)("a",{parentName:"p",href:"http://localhost:9527/actuator/bus-refresh"},"http://localhost:9527/actuator/bus-refreshopen in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAnIAAAA5CAYAAACyLsYTAAAHTElEQVR4nO3dW27kKhCAYXeURy/KS/cCsqeehyPrIBqKAgpwtf9PijTxhauNqzE9ee37/t4AAADgzs/qAgAAAKANgRwAAIBTBHIAAABOEcgBAAA4RSAHAADgFIEcAACAUwRyAAAATnUHcud5WpRjGe/lBzBXacxgTPlu9K+M9pnvte/7O9Xwx3GoEznPM3l8mO61P7VttVz5a4/pyX/b2tuj93zPRvbL6nL03j+5ATU+r5RmbnyQBuw79MkIpX6WxsKVbbI6/x7S9am5xuNjpH25fMLjvbbjDLTPGr+phreKqK/BPkw/te2bPDmoWmH19TTy02fv/ZM7NtwW7y/9fm0L80ilqfGEe2X17ISUv4f211yPtYF16p6K96Ofh+urxuz61OTHGrkKmhu8pZOP4+i6OHrP37bxg9eMgGcFi7YvpR/WzTJozT0UtW2ZK4e2fLWz/j37Vxl9ffTkP7Nc1pMDVkpB3iyex9+cbwngtu3/62Lms6am/X5SB+deDUjT0HcdSDVK5f/mGcRv4f0a9OQb7wVpfAuPaXmtijJN+69G/8qe0j53rOPv6gJsW34NTm5/br1Qbi1F7xrAktwApFlDpFn/oa2btK5Dk388ldvSvtJritxUcW//xsfUrtdM1SWV36r1nWHesweRWa+uNdeW1F+p/am+vOMgLK3hSh1Tu8axtgza+zO3PzxGc//3kspeO+vbUrbaMbjl+s0dU8p/5vgrqa2LxfO7NT6o7Z+e9FP7S8ck677v+9vi5+/vT7093Na7//o9d47mfKn8pfRqyl+bTqputeW3qr9FPVrLJ+WvSVP63Sr/UplKbRv/aK6D1vRb+0R7j7SUr+f6LNWl5tpprV9P+TTXX+53i/uv5/6wGF9q2q3Unz391LKv5dq1HL/vMv623n8W8UFp/JwRH7Smr61fqSxmM3KWn9xb15lpz6+dzdm2tWtwrD/BWrZv6ZOTFW3/9i6O7s2/J91RLO/JEbNzo9sg7jtPr4BK16/F/Xfn/qydGS/Nykvje++4kGp/q/GnNf8R+dSW3/r+aynLqPF7RPot18vyV6vxjXltC/VcoJr0JanAwJPe+mvkXkfO5ukBXSOs1+o6eguEnmDl/TdjfLFIb+Q1u3r8W53/SDOfX6OUllhZ1C/734+0fjppObeUv3WEmyujpvweH2RW/Ztyl7a4Szm+De167y853KF/Ro4vJZq8esszYibPyur8Z5Rh9PU1842AZn9L/T7++xFpWnpE5NqSZs05sz+h3O0T0ej2bTnPuo2kCz/1iUfK/479l3o1YSHXNqsfDCWl+kv9PXt861Vz/a6cDeo9R2p/Tf/l9ucmKkbILVqvGX9K+y3GrpXPRE3/Sb/PMHOGziqvj7/sUFoj1vLpR/utkFwZcue3nJs6Jj4+lX7NttINXXoYW+QV1kfaH4r7WHtuql6l41Lb4zy0/asJPKRrXNOmmnNzx7TSXn8159ceV3uP1S5biM/TlKVmjLquj5Zzw/OlOtQ8mHJ5SPvjY6R2qbmHW8a3OP+e8UW7T3tuan/uXtb2s3bG70pTM8a1XIPhubk+vuP4q7n/pPr1jK+1z6/UMdr7Z3T6pfHxte/7+yOlTh4+1Uu8lx/Af3rv5d5ADr7RvzLa5x74yw4AvtL16bXn9UXt+hZ8F/pXRvvcw5AZOQAAAIzHjBwAAIBTBHIAAABOEcgBAAA4RSAHAADgFIEcAACAUwRyAAAAThHIAQAAOEUgBwAA4BSBHAAAgFMEcgAAAE4RyAEAADhFIAcAAOAUgRwAAIBTBHIAAABOEcgBAAA4RSAHAADgFIEcAACAU92B3HmeFuVYxnv5AQDAc732fX+ngpnjONSJnOeZPD5M99qf2rZarvy1x/Tkv23t7dF7vmcj+wUAgLv7uR6E4Y+VK60wzdS2b3KeJ7N8Ex3HQXsDAB6LNXIVNAFDS4DaG0BbBOCjg6GR6RPMAQCe6icVAORek+Yelt4fpKXy8/ru/rxfgwAAtPhdXYBtS8/WhIFTvD+33i63/q53DWBJLoCQAgvNmsFw7Zumbrk6SfUP98Vr7VraN1eHVPq58tXmHx9D0A0AeAp1IDdyoX/p4Z/aH75OvGYLc8FJKXDQSgUKUvrx8al/p8oc5yflKZ1fKl98fnxcS/vGv0vpS+XT9m+MYA4A8CRma+QsX221rjPTni/N5uSs/BKDdVBi2b6lmU8r2v4liAMAPMnyV6upAMpqBk2bviQ14+RJb/01cq+AZyOIAwA8za/0aqtW62utUv69D2dt/TTl9/jqzqp/U+7SFncpBwAAM328WpXWMo2YbWlJs+ac2TNEd5uxG92+LedZtxFBHADgqT7+skPpm48tfwFBerWn+Uap5luN2nNTx8THS98o1WyTvrggHWOZV1gfaX9I+taqdG6qXqXjUtvjPLT9SxAHAHiq177vb+tEvT9cvZcfAAA8A3/ZAQAAwKkhM3IAAAAYjxk5AAAApwjkAAAAnPoHQ79Y4agfxf4AAAAASUVORK5CYII=",alt:"image-20220418104622908"}),"image-20220418104622908"),(0,r.kt)("p",null,"3.\u5fae\u670d\u52a1\u81ea\u52a8\u91cd\u542f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418104702500-bbdf21ca.png",alt:"image-20220418104702500"}),"image-20220418104702500"),(0,r.kt)("p",null,"4.\u8bbf\u95ee\u5fae\u670d\u52a1\uff0c\u53d1\u73b0\u914d\u7f6e\u5df2\u7ecf\u6539\u53d8"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418104819862-b829a33e.png",alt:"image-20220418104819862"}),"image-20220418104819862"),(0,r.kt)("h2",{id:"\u7b2c\u5341\u4e94\u7ae0-springcloud-stream\u6d88\u606f\u9a71\u52a8"},"\u7b2c\u5341\u4e94\u7ae0 SpringCloud Stream\u6d88\u606f\u9a71\u52a8"),(0,r.kt)("h3",{id:"\u4e00stream-\u6982\u8ff0"},"\u4e00\u3001Stream \u6982\u8ff0"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418111329857-7c8547d2.png",alt:"image-20220418111329857"}),"image-20220418111329857"),(0,r.kt)("p",null,"1.Spring Cloud Stream \u662f\u4e00\u4e2a\u6784\u5efa\u6d88\u606f\u9a71\u52a8\u5fae\u670d\u52a1\u5e94\u7528\u7684\u6846\u67b6\u3002"),(0,r.kt)("p",null,"2.Stream \u89e3\u51b3\u4e86\u5f00\u53d1\u4eba\u5458",(0,r.kt)("strong",{parentName:"p"},"\u65e0\u611f\u77e5"),"\u7684\u4f7f\u7528\u6d88\u606f\u4e2d\u95f4\u4ef6\u7684\u95ee\u9898\uff0c\u56e0\u4e3aStream\u5bf9\u6d88\u606f\u4e2d\u95f4\u4ef6\u7684\u8fdb\u4e00\u6b65\u5c01\u88c5\uff0c\u53ef\u4ee5\u505a\u5230\u4ee3\u7801\u5c42\u9762\u5bf9\u4e2d\u95f4\u4ef6\u7684\u65e0\u611f\u77e5\uff0c\u751a\u81f3\u4e8e",(0,r.kt)("strong",{parentName:"p"},"\u52a8\u6001\u7684\u5207\u6362\u4e2d\u95f4\u4ef6"),"\uff0c\u4f7f\u5f97\u5fae\u670d\u52a1\u5f00\u53d1\u7684\u9ad8\u5ea6\u89e3\u8026\uff0c\u670d\u52a1\u53ef\u4ee5\u5173\u6ce8\u66f4\u591a\u81ea\u5df1\u7684\u4e1a\u52a1\u6d41\u7a0b\u3002"),(0,r.kt)("p",null,"3.Spring Cloud Stream\u76ee\u524d\u652f\u6301\u4e24\u79cd\u6d88\u606f\u4e2d\u95f4\u4ef6RabbitMQ\u548cKafka"),(0,r.kt)("p",null,"\u5c31\u50cfjdbc\u4e00\u6837"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418111643163-1006efdf.png",alt:"image-20220418111643163"}),"image-20220418111643163"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Stream \u7ec4\u4ef6")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200613074759833-b4428b4e.png",alt:"image-20200613074759833"}),"image-20200613074759833"),(0,r.kt)("p",null,"Spring Cloud Stream \u6784\u5efa\u7684\u5e94\u7528\u7a0b\u5e8f\u4e0e\u6d88\u606f\u4e2d\u95f4\u4ef6\u4e4b\u95f4\u662f\u901a\u8fc7\u7ed1\u5b9a\u5668 Binder \u76f8\u5173\u8054\u7684\u3002\u7ed1\u5b9a\u5668\u5bf9\u4e8e\u5e94\u7528\u7a0b\u5e8f\u800c\u8a00\u8d77\u5230\u4e86\u9694\u79bb\u4f5c\u7528\uff0c \u5b83\u4f7f\u5f97\u4e0d\u540c\u6d88\u606f\u4e2d\u95f4\u4ef6\u7684\u5b9e\u73b0\u7ec6\u8282\u5bf9\u5e94\u7528\u7a0b\u5e8f\u6765\u8bf4\u662f\u900f\u660e\u7684\u3002"),(0,r.kt)("p",null,"binding \u662f\u6211\u4eec\u901a\u8fc7\u914d\u7f6e\u628a\u5e94\u7528\u548cspring cloud stream \u7684 binder \u7ed1\u5b9a\u5728\u4e00\u8d77"),(0,r.kt)("p",null,"output\uff1a\u53d1\u9001\u6d88\u606f Channel\uff0c\u5185\u7f6e Source\u63a5\u53e3"),(0,r.kt)("p",null,"input\uff1a\u63a5\u6536\u6d88\u606f Channel\uff0c\u5185\u7f6e Sink\u63a5\u53e3"),(0,r.kt)("h3",{id:"\u4e8cstream-\u6d88\u606f\u751f\u4ea7\u8005"},"\u4e8c\u3001Stream \u6d88\u606f\u751f\u4ea7\u8005"),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <artifactId>stream-parent</artifactId>\n        <groupId>com.ydlclass</groupId>\n        <version>1.0-SNAPSHOT</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>stream-producer</artifactId>\n\n\n    <dependencies>\n\n        \x3c!--spring boot web--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n\n        \x3c!-- stream --\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-stream-rabbit</artifactId>\n        </dependency>\n\n    </dependencies>\n\n</project>\n')),(0,r.kt)("p",null,"ProducerApp"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.stream;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class ProducerApp {\n    public static void main(String[] args) {\n\n        SpringApplication.run(ProducerApp.class,args);\n    }\n}\n")),(0,r.kt)("p",null,"application.yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 8000\n\nspring:\n  cloud:\n    stream:\n      # \u5b9a\u4e49\u7ed1\u5b9a\u5668\uff0c\u7ed1\u5b9a\u5230\u54ea\u4e2a\u6d88\u606f\u4e2d\u95f4\u4ef6\u4e0a\n      binders:\n        ydlclass_binder: # \u81ea\u5b9a\u4e49\u7684\u7ed1\u5b9a\u5668\u540d\u79f0\n          type: rabbit # \u7ed1\u5b9a\u5668\u7c7b\u578b\n          environment: # \u6307\u5b9amq\u7684\u73af\u5883\n            spring:\n              rabbitmq:\n                host: localhost\n                port: 5672\n                username: guest\n                password: guest\n                virtual-host: /\n      bindings:\n        output: # channel\u540d\u79f0\n          binder: ydlclass_binder #\u6307\u5b9a\u4f7f\u7528\u54ea\u4e00\u4e2abinder\n          destination: ydlclass_exchange # \u6d88\u606f\u76ee\u7684\u5730\n")),(0,r.kt)("p",null,"\u6d88\u606f\u53d1\u9001\u7c7b MessageProducer"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.stream.producer;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.cloud.stream.annotation.EnableBinding;\nimport org.springframework.cloud.stream.messaging.Source;\nimport org.springframework.messaging.MessageChannel;\nimport org.springframework.messaging.support.MessageBuilder;\nimport org.springframework.stereotype.Component;\n\nimport java.nio.charset.StandardCharsets;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@Component\n@EnableBinding(Source.class)//\u8fd9\u4e2a\u7c7b\u662fstream\u7684\u53d1\u9001\u8005\npublic class MessageProducer {\n    @Autowired\n    MessageChannel output;\n\n    public void send(String msg){\n        output.send(MessageBuilder.withPayload(msg).build());\n        System.out.println("MessageProducer \u786e\u5b9e\u53d1\u4e86\u6d88\u606f\u4e86\uff01");\n    }\n}\n')),(0,r.kt)("p",null,"\u8c03\u7528\u7684controller ProducerController"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.stream.controller;\n\nimport com.ydlclass.stream.producer.MessageProducer;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@RestController\n@RequestMapping("test")\npublic class ProducerController {\n    @Autowired\n    MessageProducer messageProducer;\n    //\u4e1a\u52a1\u903b\u8f91\n    @GetMapping("/send")\n    public String send(){\n        //\u53d1\u6d88\u606f\n        String msg="\u4f7f\u7528stream\u6765\u53d1\u6d88\u606f\u4e86\uff01";\n\n        messageProducer.send(msg);\n\n        return "success!";\n    }\n}\n')),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418114016165-e7af66ff.png",alt:"image-20220418114016165"}),"image-20220418114016165"),(0,r.kt)("h3",{id:"\u4e09stream-\u6d88\u606f\u6d88\u8d39\u8005"},"\u4e09\u3001Stream \u6d88\u606f\u6d88\u8d39\u8005"),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <artifactId>stream-parent</artifactId>\n        <groupId>com.ydlclass</groupId>\n        <version>1.0-SNAPSHOT</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>stream-consumer</artifactId>\n\n\n    <dependencies>\n\n        \x3c!--spring boot web--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n\n        \x3c!-- stream --\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-stream-rabbit</artifactId>\n        </dependency>\n\n    </dependencies>\n</project>\n')),(0,r.kt)("p",null,"ConsumerApp"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.stream;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class ConsumerApp {\n    public static void main(String[] args) {\n\n        SpringApplication.run(ConsumerApp.class,args);\n    }\n}\n")),(0,r.kt)("p",null,"application.yml"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 9000\n\n\n\nspring:\n  cloud:\n    stream:\n      # \u5b9a\u4e49\u7ed1\u5b9a\u5668\uff0c\u7ed1\u5b9a\u5230\u54ea\u4e2a\u6d88\u606f\u4e2d\u95f4\u4ef6\u4e0a\n      binders:\n        ydlclass_binder: # \u81ea\u5b9a\u4e49\u7684\u7ed1\u5b9a\u5668\u540d\u79f0\n          type: rabbit # \u7ed1\u5b9a\u5668\u7c7b\u578b\n          environment: # \u6307\u5b9amq\u7684\u73af\u5883\n            spring:\n              rabbitmq:\n                host: localhost\n                port: 5672\n                username: guest\n                password: guest\n                virtual-host: /\n      bindings:\n        input: # channel\u540d\u79f0\n          binder: ydlclass_binder #\u6307\u5b9a\u4f7f\u7528\u54ea\u4e00\u4e2abinder\n          destination: ydlclass_exchange # \u6d88\u606f\u76ee\u7684\u5730\n")),(0,r.kt)("p",null,"\u6d88\u606f\u63a5\u6536\u7c7b MessageListener"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.stream.consumer;\n\nimport org.springframework.cloud.stream.annotation.EnableBinding;\nimport org.springframework.cloud.stream.annotation.StreamListener;\nimport org.springframework.cloud.stream.messaging.Sink;\nimport org.springframework.messaging.Message;\nimport org.springframework.stereotype.Component;\n\n/**\n * \u6d88\u606f\u63a5\u6536\u7c7b\n */\n@EnableBinding({Sink.class})\n@Component\npublic class MessageListener {\n\n    @StreamListener(Sink.INPUT)\n    public void receive(Message message){\n\n        System.out.println(message);\n        System.out.println(message.getPayload());\n    }\n}\n")),(0,r.kt)("p",null,"\u6d4b\u8bd5"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418154602979-4f1f002f.png",alt:"image-20220418154602979"}),"image-20220418154602979"),(0,r.kt)("h2",{id:"\u7b2c\u5341\u516d\u7ae0-springcloud-sleuth\u5206\u5e03\u5f0f\u8bf7\u6c42\u94fe\u8def\u8ffd\u8e2a"},"\u7b2c\u5341\u516d\u7ae0 SpringCloud Sleuth\u5206\u5e03\u5f0f\u8bf7\u6c42\u94fe\u8def\u8ffd\u8e2a"),(0,r.kt)("h3",{id:"\u4e00\u6982\u8ff0-2"},"\u4e00\u3001\u6982\u8ff0"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418155007573-1c1b8bdd.png",alt:"image-20220418155007573"}),"image-20220418155007573"),(0,r.kt)("p",null,"Spring Cloud Sleuth \u5176\u5b9e\u662f\u4e00\u4e2a\u5de5\u5177,\u5b83\u5728\u6574\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u80fd\u8ddf\u8e2a\u4e00\u4e2a\u7528\u6237\u8bf7\u6c42\u7684\u8fc7\u7a0b\uff0c\u6355\u83b7\u8fd9\u4e9b\u8ddf\u8e2a\u6570\u636e\uff0c\u5c31\u80fd\u6784\u5efa\u5fae\u670d\u52a1\u7684\u6574\u4e2a\u8c03\u7528\u94fe\u7684\u89c6\u56fe\uff0c\u8fd9\u662f\u8c03\u8bd5\u548c\u76d1\u63a7\u5fae\u670d\u52a1\u7684\u5173\u952e\u5de5\u5177\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"\u8017\u65f6\u5206\u6790 \n\u53ef\u89c6\u5316\u9519\u8bef \n\u94fe\u8def\u4f18\u5316\n")),(0,r.kt)("p",null,"Zipkin \u662f Twitter \u7684\u4e00\u4e2a\u5f00\u6e90\u9879\u76ee\uff0c\u5b83\u81f4\u529b\u4e8e\u6536\u96c6\u670d\u52a1\u7684\u5b9a\u65f6\u6570\u636e\uff0c\u4ee5\u89e3\u51b3\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\u7684\u5ef6\u8fdf\u95ee\u9898\uff0c\u5305\u62ec\u6570\u636e\u7684\u6536\u96c6\u3001\u5b58\u50a8\u3001\u67e5\u627e\u548c\u5c55\u73b0\u3002"),(0,r.kt)("h3",{id:"\u4e8c\u5feb\u901f\u5165\u95e8-1"},"\u4e8c\u3001\u5feb\u901f\u5165\u95e8"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5b89\u88c5\u542f\u52a8zipkin\u3002 java \u2013jar zipkin.jar"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418185033323-76dc027c.png",alt:"image-20220418185033323"}),"image-20220418185033323")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u8bbf\u95eezipkin web\u754c\u9762\u3002 ",(0,r.kt)("a",{parentName:"p",href:"http://localhost:9411/"},"http://localhost:9411/open in new window")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200613080015686-e297485f.png",alt:"image-20200613080015686"}),"image-20200613080015686")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728\u670d\u52a1\u63d0\u4f9b\u65b9\u548c\u6d88\u8d39\u65b9\u5206\u522b\u5f15\u5165 sleuth \u548c zipkin \u4f9d\u8d56"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```xml\n        \x3c!-- sleuth-zipkin --\x3e\n        \x3c!--<dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-sleuth</artifactId>\n        </dependency>--\x3e\n\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-zipkin</artifactId>\n        </dependency>\n```\n")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5206\u522b\u914d\u7f6e\u670d\u52a1\u63d0\u4f9b\u65b9\u548c\u6d88\u8d39\u65b9\u3002"),(0,r.kt)("p",{parentName:"li"},"provider"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```yaml\nserver:\n  port: 8001\n\neureka:\n  client:\n    service-url:\n      defaultZone: http://localhost:8761/eureka\nspring:\n  application:\n    name: feign-provider\n  zipkin:\n    base-url: http://localhost:9411/  # \u8bbe\u7f6ezipkin\u7684\u670d\u52a1\u7aef\u8def\u5f84\n  sleuth:\n    sampler:\n      probability: 1 # \u91c7\u96c6\u7387 \u9ed8\u8ba4 0.1 \u767e\u5206\u4e4b\u5341\u3002\n```\n\nconsumer\n\n\n\n```yaml\nserver:\n  port: 9000\n\neureka:\n  instance:\n    hostname: localhost # \u4e3b\u673a\u540d\n  client:\n    service-url:\n      defaultZone: http://localhost:8761/eureka\nspring:\n  application:\n    name: feign-consumer # \u8bbe\u7f6e\u5f53\u524d\u5e94\u7528\u7684\u540d\u79f0\u3002\u5c06\u6765\u4f1a\u5728eureka\u4e2dApplication\u663e\u793a\u3002\u5c06\u6765\u9700\u8981\u4f7f\u7528\u8be5\u540d\u79f0\u6765\u83b7\u53d6\u8def\u5f84\n  zipkin:\n    base-url: http://localhost:9411/  # \u8bbe\u7f6ezipkin\u7684\u670d\u52a1\u7aef\u8def\u5f84\n  sleuth:\n    sampler:\n      probability: 1 # \u91c7\u96c6\u7387 \u9ed8\u8ba4 0.1 \u767e\u5206\u4e4b\u5341\u3002\nlogging:\n  level:\n    com.ydlclass: debug\n```\n")),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"\u542f\u52a8\uff0c\u6d4b\u8bd5")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418160537372-c7993f21.png",alt:"image-20220418160537372"}),"image-20220418160537372"),(0,r.kt)("p",null,"\u8c03\u7528\u5173\u7cfb\u56fe\u4e5f\u80fd\u5c55\u73b0"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220418160602065-25c4ceff.png",alt:"image-20220418160602065"})))}d.isMDXComponent=!0}}]);