"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5361],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>u});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var o=a.createContext({}),p=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(o.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,o=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),d=p(n),g=l,u=d["".concat(o,".").concat(g)]||d[g]||c[g]||r;return n?a.createElement(u,s(s({ref:t},m),{},{components:n})):a.createElement(u,s({ref:t},m))}));function u(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,s=new Array(r);s[0]=g;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i[d]="string"==typeof e?e:l,s[1]=i;for(var p=2;p<r;p++)s[p]=n[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},6201:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var a=n(7462),l=(n(7294),n(3905));const r={},s="1. \u77ed\u4fe1\u8c03\u5ea6",i={unversionedId:"Java/\u9879\u76ee/\u77ed\u4fe1\u8c03\u5ea6",id:"Java/\u9879\u76ee/\u77ed\u4fe1\u8c03\u5ea6",title:"1. \u77ed\u4fe1\u8c03\u5ea6",description:"1. \u9879\u76ee\u6982\u8ff0",source:"@site/docs/Java/10.\u9879\u76ee/1. \u77ed\u4fe1\u8c03\u5ea6.md",sourceDirName:"Java/10.\u9879\u76ee",slug:"/Java/\u9879\u76ee/\u77ed\u4fe1\u8c03\u5ea6",permalink:"/docs/Java/\u9879\u76ee/\u77ed\u4fe1\u8c03\u5ea6",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Java/10.\u9879\u76ee/1. \u77ed\u4fe1\u8c03\u5ea6.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"Java",previous:{title:"9. Docker",permalink:"/docs/Java/Docker"},next:{title:"3. \u81ea\u52a8\u5316\u6784\u5efa",permalink:"/docs/Java/\u9879\u76ee/\u81ea\u52a8\u5316\u6784\u5efa"}},o={},p=[{value:"1. \u9879\u76ee\u6982\u8ff0",id:"1-\u9879\u76ee\u6982\u8ff0",level:2},{value:"#1.1 \u80cc\u666f\u4ecb\u7ecd",id:"11-\u80cc\u666f\u4ecb\u7ecd",level:3},{value:"#1.2 \u4e1a\u52a1\u67b6\u6784",id:"12-\u4e1a\u52a1\u67b6\u6784",level:3},{value:"#1.3 \u6280\u672f\u67b6\u6784",id:"13-\u6280\u672f\u67b6\u6784",level:3},{value:"#1.3.1 \u7cfb\u7edf\u7ba1\u7406\u670d\u52a1",id:"131-\u7cfb\u7edf\u7ba1\u7406\u670d\u52a1",level:4},{value:"#1.3.2 \u77ed\u4fe1\u63a5\u6536\u670d\u52a1",id:"132-\u77ed\u4fe1\u63a5\u6536\u670d\u52a1",level:4},{value:"#1.3.3 \u77ed\u4fe1\u53d1\u9001\u670d\u52a1",id:"133-\u77ed\u4fe1\u53d1\u9001\u670d\u52a1",level:4},{value:"#1.4 \u9879\u76ee\u6a21\u5757\u4ecb\u7ecd",id:"14-\u9879\u76ee\u6a21\u5757\u4ecb\u7ecd",level:3},{value:"#2. \u9879\u76ee\u73af\u5883\u51c6\u5907",id:"2-\u9879\u76ee\u73af\u5883\u51c6\u5907",level:2},{value:"#2.1 \u73af\u5883\u8981\u6c42",id:"21-\u73af\u5883\u8981\u6c42",level:3},{value:"#2.2 Redis\u96c6\u7fa4",id:"22-redis\u96c6\u7fa4",level:3},{value:"#2.3 \u540e\u7aef\u5de5\u7a0b\u5bfc\u5165",id:"23-\u540e\u7aef\u5de5\u7a0b\u5bfc\u5165",level:3},{value:"#2.4 \u6570\u636e\u5e93",id:"24-\u6570\u636e\u5e93",level:3},{value:"#2.5 \u524d\u7aef\u5de5\u7a0b",id:"25-\u524d\u7aef\u5de5\u7a0b",level:3},{value:"#3. \u540e\u53f0\u7ba1\u7406\u670d\u52a1",id:"3-\u540e\u53f0\u7ba1\u7406\u670d\u52a1",level:2},{value:"#3.1. \u9879\u76ee\u7ed3\u6784",id:"31-\u9879\u76ee\u7ed3\u6784",level:3},{value:"#3.1.1 \u57fa\u7840\u5de5\u7a0b",id:"311-\u57fa\u7840\u5de5\u7a0b",level:4},{value:"#3.1.2 \u7ba1\u7406\u7aef\u5de5\u7a0b",id:"312-\u7ba1\u7406\u7aef\u5de5\u7a0b",level:4},{value:"#3.2. \u529f\u80fd\u6e05\u5355",id:"32-\u529f\u80fd\u6e05\u5355",level:3},{value:"#3.3. \u6570\u636e\u6a21\u578b\u4e0e\u7c7b",id:"33-\u6570\u636e\u6a21\u578b\u4e0e\u7c7b",level:3},{value:"#3.4. \u57fa\u7840\u5c5e\u6027\u81ea\u52a8\u6ce8\u5165",id:"34-\u57fa\u7840\u5c5e\u6027\u81ea\u52a8\u6ce8\u5165",level:3},{value:"#3.4.1 \u57fa\u7840\u5c5e\u6027",id:"341-\u57fa\u7840\u5c5e\u6027",level:4},{value:"#3.4.2 \u81ea\u5b9a\u4e49\u6ce8\u89e3",id:"342-\u81ea\u5b9a\u4e49\u6ce8\u89e3",level:4},{value:"#3.4.3 \u5b9a\u4e49\u5207\u9762\u7c7b",id:"343-\u5b9a\u4e49\u5207\u9762\u7c7b",level:4},{value:"#3.4.4 \u4f7f\u7528\u6ce8\u89e3",id:"344-\u4f7f\u7528\u6ce8\u89e3",level:4},{value:"#3.5. Redis\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f",id:"35-redis\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f",level:3},{value:"#3.5.1 \u6848\u4f8b\u6f14\u793a",id:"351-\u6848\u4f8b\u6f14\u793a",level:4},{value:"#3.5.2 \u4ee3\u7801\u6848\u4f8b",id:"352-\u4ee3\u7801\u6848\u4f8b",level:4},{value:"#3.6. \u901a\u9053\u7ba1\u7406",id:"36-\u901a\u9053\u7ba1\u7406",level:3},{value:"#3.6.1 \u4ea7\u54c1\u539f\u578b",id:"361-\u4ea7\u54c1\u539f\u578b",level:4},{value:"#3.6.2 \u9700\u6c42\u5206\u6790",id:"362-\u9700\u6c42\u5206\u6790",level:4},{value:"#3.6.3 \u5177\u4f53\u5b9e\u73b0",id:"363-\u5177\u4f53\u5b9e\u73b0",level:4},{value:"#1. \u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u4ecb\u7ecd",id:"1-\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u4ecb\u7ecd",level:2},{value:"#2. Redis\u6d88\u606f\u961f\u5217",id:"2-redis\u6d88\u606f\u961f\u5217",level:2},{value:"#2.1 Redis\u961f\u5217\u4ecb\u7ecd",id:"21-redis\u961f\u5217\u4ecb\u7ecd",level:3},{value:"#2.2 \u6848\u4f8b\u6f14\u793a",id:"22-\u6848\u4f8b\u6f14\u793a",level:3},{value:"#2.3 \u4ee3\u7801\u6848\u4f8b",id:"23-\u4ee3\u7801\u6848\u4f8b",level:3},{value:"#3. \u77ed\u4fe1\u63a5\u6536\u670d\u52a1",id:"3-\u77ed\u4fe1\u63a5\u6536\u670d\u52a1",level:2},{value:"#3.1 \u9700\u6c42\u5206\u6790-\u91cd\u70b9",id:"31-\u9700\u6c42\u5206\u6790-\u91cd\u70b9",level:3},{value:"#3.2 \u9879\u76ee\u7ed3\u6784",id:"32-\u9879\u76ee\u7ed3\u6784",level:3},{value:"#3.3 \u6570\u636e\u6a21\u578b\u4e0e\u7c7b",id:"33-\u6570\u636e\u6a21\u578b\u4e0e\u7c7b-1",level:3},{value:"#3.4 \u6d88\u606f\u5b58\u50a8",id:"34-\u6d88\u606f\u5b58\u50a8",level:3},{value:"#3.5 TCP\u63a5\u53e3",id:"35-tcp\u63a5\u53e3",level:3},{value:"#3.6 SDK",id:"36-sdk",level:3},{value:"#3.6.1 \u8bf4\u660e",id:"361-\u8bf4\u660e",level:4},{value:"#3.6.2 \u5b9e\u73b0",id:"362-\u5b9e\u73b0",level:4},{value:"#3.6.3 \u6d4b\u8bd5",id:"363-\u6d4b\u8bd5",level:4},{value:"#1. \u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u4ecb\u7ecd",id:"1-\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u4ecb\u7ecd",level:2},{value:"#2. Redis\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501",id:"2-redis\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501",level:2},{value:"#2.1 SETNX",id:"21-setnx",level:3},{value:"#2.2 SET",id:"22-set",level:3},{value:"#2.3 \u4ee3\u7801\u5b9e\u73b0",id:"23-\u4ee3\u7801\u5b9e\u73b0",level:3},{value:"#3. Spring Task\u5b9a\u65f6\u4efb\u52a1",id:"3-spring-task\u5b9a\u65f6\u4efb\u52a1",level:2},{value:"#3.1 Spring Task\u4ecb\u7ecd",id:"31-spring-task\u4ecb\u7ecd",level:3},{value:"#3.2 \u4ee3\u7801\u6848\u4f8b",id:"32-\u4ee3\u7801\u6848\u4f8b",level:3},{value:"#4. \u77ed\u4fe1\u53d1\u9001\u670d\u52a1",id:"4-\u77ed\u4fe1\u53d1\u9001\u670d\u52a1",level:2},{value:"#4.1 \u9700\u6c42\u5206\u6790",id:"41-\u9700\u6c42\u5206\u6790",level:3},{value:"#4.2 \u9879\u76ee\u7ed3\u6784",id:"42-\u9879\u76ee\u7ed3\u6784",level:3},{value:"#4.3 \u6838\u5fc3\u4ee3\u7801",id:"43-\u6838\u5fc3\u4ee3\u7801",level:3},{value:"#4.4 \u529f\u80fd\u5b9e\u73b0",id:"44-\u529f\u80fd\u5b9e\u73b0",level:3},{value:"#4.4.1 \u670d\u52a1\u6ce8\u518c\u5668",id:"441-\u670d\u52a1\u6ce8\u518c\u5668",level:4},{value:"#4.4.2 \u901a\u9053\u5b9e\u4f8b\u52a0\u8f7d\u5668",id:"442-\u901a\u9053\u5b9e\u4f8b\u52a0\u8f7d\u5668",level:4},{value:"#4.4.3 \u5b9a\u65f6\u77ed\u4fe1\u4e1a\u52a1\u5904\u7406\u5668",id:"443-\u5b9a\u65f6\u77ed\u4fe1\u4e1a\u52a1\u5904\u7406\u5668",level:4},{value:"#4.4.4 \u77ed\u4fe1\u53d1\u9001\u5b9a\u65f6\u4efb\u52a1",id:"444-\u77ed\u4fe1\u53d1\u9001\u5b9a\u65f6\u4efb\u52a1",level:4},{value:"#4.4.5 \u77ed\u4fe1\u76d1\u542c\u5668",id:"445-\u77ed\u4fe1\u76d1\u542c\u5668",level:4},{value:"#4.4.6 \u901a\u9053\u6d88\u606f\u76d1\u542c\u5668",id:"446-\u901a\u9053\u6d88\u606f\u76d1\u542c\u5668",level:4},{value:"#5\u5bf9\u63a5\u963f\u91cc\u77ed\u4fe1\u8fdb\u884c\u771f\u5b9e\u53d1\u9001\uff01",id:"5\u5bf9\u63a5\u963f\u91cc\u77ed\u4fe1\u8fdb\u884c\u771f\u5b9e\u53d1\u9001",level:2}],m={toc:p};function d(e){let{components:t,...n}=e;return(0,l.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"1-\u77ed\u4fe1\u8c03\u5ea6"},"1. \u77ed\u4fe1\u8c03\u5ea6"),(0,l.kt)("h2",{id:"1-\u9879\u76ee\u6982\u8ff0"},"1. \u9879\u76ee\u6982\u8ff0"),(0,l.kt)("h3",{id:"11-\u80cc\u666f\u4ecb\u7ecd"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_1-1-%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D"},"#"),"1.1 \u80cc\u666f\u4ecb\u7ecd"),(0,l.kt)("p",null,"\u968f\u7740\u4f01\u4e1a\u4e1a\u52a1\u6269\u5f20\u3001\u5e94\u7528\u6210\u500d\u7684\u589e\u52a0\u3001\u77ed\u4fe1\u89c4\u6a21\u5316\u4f7f\u7528\uff0c\u4f20\u7edf\u77ed\u4fe1\u5e73\u53f0\u7684\u63a5\u5165\u65b9\u5f0f\u548c\u5355\u4e00\u7684\u4fe1\u606f\u53d1\u9001\u529f\u80fd\uff0c\u5df2\u7ecf\u4e0d\u80fd\u5b8c\u5168\u6ee1\u8db3\u73b0\u4ee3\u4f01\u4e1a\u7ba1\u7406\u7684\u9700\u6c42\uff0c\u6240\u4ee5\u7edf\u4e00\u5165\u53e3\u3001\u51cf\u5c11\u5bf9\u63a5\u6210\u672c\u3001\u540c\u65f6\u517c\u987e\u591a\u79cd\u77ed\u4fe1\u4e1a\u52a1\u3001\u7b80\u5355\u6613\u884c\u7684\u64cd\u4f5c\u4e0e\u7ef4\u62a4\u3001\u9ad8\u7a33\u5b9a\u3001\u9ad8\u53ef\u9760\u7684\u79fb\u52a8\u4fe1\u606f\u5316\u5e94\u7528\u6210\u4e3a\u77ed\u4fe1\u5e73\u53f0\u53d1\u5c55\u8d8b\u52bf\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916094348274-a7627fe5.png",alt:"image-20210916094348274"}),"image-20210916094348274"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u670d\u52a1\u8d8a\u6765\u8d8a\u591a\uff0c\u6bcf\u4e2a\u670d\u52a1\u90fd\u6709\u53ef\u80fd\u53d1\u9001\u77ed\u4fe1\uff0c\u662f\u5426\u6bcf\u4e2a\u670d\u52a1\u90fd\u9700\u8981\u5bf9\u63a5\u4e00\u904d\uff1f"),(0,l.kt)("li",{parentName:"ul"},"\u591a\u5e94\u7528\u5bf9\u63a5\u77ed\u4fe1\uff0c\u5982\u4f55\u505a\u5230\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u9ad8\u6548\u3001\u7a33\u5b9a\uff1f"),(0,l.kt)("li",{parentName:"ul"},"\u77ed\u4fe1\u901a\u9053\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u5982\u4f55\u5feb\u901f\u5207\u6362\u901a\u9053\uff1f"),(0,l.kt)("li",{parentName:"ul"},"\u5207\u6362\u901a\u9053\u65f6\uff0c\u5982\u4f55\u505a\u5230\u5e94\u7528\u670d\u52a1\u65e0\u611f\u77e5\uff1f"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u4f55\u7edf\u8ba1\u5404\u670d\u52a1\u77ed\u4fe1\u53d1\u9001\u60c5\u51b5\uff0c\u4ee5\u4fbf\u8fdb\u884c\u540e\u7eed\u8425\u9500\u5206\u6790\uff1f")),(0,l.kt)("p",null,"\u672c\u9879\u76ee\uff08\u52a8\u529b\u77ed\u4fe1\u5e73\u53f0\uff09\u7684\u6838\u5fc3\u5728\u4e8e\u4fdd\u8bc1\u77ed\u4fe1\u9ad8\u6548\u3001\u51c6\u786e\u7684\u9001\u8fbe\u3001\u7b80\u5355\u6613\u64cd\u4f5c\u7684\u5bf9\u63a5\u65b9\u5f0f\u3002\u901a\u8fc7\u5bf9\u670d\u52a1\u7684\u89e3\u8026\u3001\u901a\u8baf\u65b9\u5f0f\u7684\u5347\u7ea7\u6765\u63d0\u5347\u7cfb\u7edf\u7684\u541e\u5410\u91cf\u3002\u540c\u65f6\u5728\u591a\u901a\u9053\u7684\u52a0\u6301\u4e0b\uff0c\u901a\u8fc7\u667a\u80fd\u52a8\u6001\u7684\u901a\u9053\u8bc4\u7ea7\u3001\u9009\u4e3e\u3001\u964d\u7ea7\u3001\u70ed\u63d2\u62d4\uff0c\u589e\u5f3a\u4e86\u7cfb\u7edf\u7684\u5065\u58ee\u6027\uff0c\u6446\u8131\u5bf9\u5355\u4e00\u901a\u9053\u7684\u4f9d\u8d56\u3002\u5e76\u4e14\u63d0\u4f9b\u591a\u79cd\u5bf9\u63a5\u65b9\u5f0f\uff0c\u6ee1\u8db3\u4f01\u4e1a\u5185\u90e8\u7684\u5404\u79cd\u9700\u6c42\u3002"),(0,l.kt)("p",null,"\u52a8\u529b\u77ed\u4fe1\u5e73\u53f0\u7684\u6574\u4f53\u67b6\u6784\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916095249795-9bf62f5d.png",alt:"image-20210916095249795"}),"image-20210916095249795"),(0,l.kt)("h3",{id:"12-\u4e1a\u52a1\u67b6\u6784"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_1-2-%E4%B8%9A%E5%8A%A1%E6%9E%B6%E6%9E%84"},"#"),"1.2 \u4e1a\u52a1\u67b6\u6784"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916100828128-e2e1e21d.png",alt:"image-20210916100828128"}),"image-20210916100828128"),(0,l.kt)("h3",{id:"13-\u6280\u672f\u67b6\u6784"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_1-3-%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84"},"#"),"1.3 \u6280\u672f\u67b6\u6784"),(0,l.kt)("h4",{id:"131-\u7cfb\u7edf\u7ba1\u7406\u670d\u52a1"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_1-3-1-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1"},"#"),"1.3.1 \u7cfb\u7edf\u7ba1\u7406\u670d\u52a1"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916104038523-7ad154dc.png",alt:"image-20210916104038523"}),"image-20210916104038523"),(0,l.kt)("h4",{id:"132-\u77ed\u4fe1\u63a5\u6536\u670d\u52a1"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_1-3-2-%E7%9F%AD%E4%BF%A1%E6%8E%A5%E6%94%B6%E6%9C%8D%E5%8A%A1"},"#"),"1.3.2 \u77ed\u4fe1\u63a5\u6536\u670d\u52a1"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916104817659-13994a17.png",alt:"image-20210916104817659"}),"image-20210916104817659"),(0,l.kt)("h4",{id:"133-\u77ed\u4fe1\u53d1\u9001\u670d\u52a1"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_1-3-3-%E7%9F%AD%E4%BF%A1%E5%8F%91%E9%80%81%E6%9C%8D%E5%8A%A1"},"#"),"1.3.3 \u77ed\u4fe1\u53d1\u9001\u670d\u52a1"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916105359377-2a3183cd.png",alt:"image-20210916105359377"}),"image-20210916105359377"),(0,l.kt)("h3",{id:"14-\u9879\u76ee\u6a21\u5757\u4ecb\u7ecd"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_1-4-%E9%A1%B9%E7%9B%AE%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D"},"#"),"1.4 \u9879\u76ee\u6a21\u5757\u4ecb\u7ecd"),(0,l.kt)("p",null,"\u52a8\u529b\u77ed\u4fe1\u5e73\u53f0\uff0c\u9879\u76ee\u6574\u4f53\u5de5\u7a0b\u7ed3\u6784\u548c\u6a21\u5757\u529f\u80fd\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"ydl-sms-backend          # \u52a8\u529b\u77ed\u4fe1\u5e73\u53f0\u7236\u5de5\u7a0b\n    \u251c\u2500\u2500 ydl-sms-entity       # \u77ed\u4fe1\u5e73\u53f0\u5b9e\u4f53\n    \u251c\u2500\u2500 ydl-sms-manage       # \u7cfb\u7edf\u7ba1\u7406\u670d\u52a1\n    \u251c\u2500\u2500 ydl-sms-api          # \u77ed\u4fe1\u63a5\u6536\u670d\u52a1\uff0c\u5e94\u7528\u7cfb\u7edf\u8c03\u7528\u63a5\u53e3\u3001\u53d1\u9001\u77ed\u4fe1\n    \u251c\u2500\u2500 ydl-sms-server       # \u77ed\u4fe1\u53d1\u9001\u670d\u52a1\uff0c\u8c03\u7528\u77ed\u4fe1\u901a\u9053\u3001\u53d1\u9001\u77ed\u4fe1\n    \u2514\u2500\u2500 ydl-sms-sdk          # \u77ed\u4fe1SDK\uff0c\u5e94\u7528\u7cfb\u7edf\u5f15\u5165\u3001\u53d1\u9001\u77ed\u4fe1\n")),(0,l.kt)("p",null,"\u52a8\u529b\u77ed\u4fe1\u670d\u52a1\u6709\u4e09\u4e2a\uff1a\u540e\u53f0\u7ba1\u7406\u670d\u52a1\uff0c\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\uff0c\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\uff1a"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u5e94\u7528"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7aef\u53e3"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"),(0,l.kt)("th",{parentName:"tr",align:null},"\u542f\u52a8\u547d\u4ee4"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"ydl-sms-manage"),(0,l.kt)("td",{parentName:"tr",align:null},"8770"),(0,l.kt)("td",{parentName:"tr",align:null},"\u540e\u53f0\u7ba1\u7406\u670d\u52a1"),(0,l.kt)("td",{parentName:"tr",align:null},"java -jar ydl-sms-manage.jar &")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"ydl-sms-api"),(0,l.kt)("td",{parentName:"tr",align:null},"8771"),(0,l.kt)("td",{parentName:"tr",align:null},"\u77ed\u4fe1\u63a5\u6536\u670d\u52a1"),(0,l.kt)("td",{parentName:"tr",align:null},"java -jar ydl-sms-api.jar &")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"ydl-sms-server"),(0,l.kt)("td",{parentName:"tr",align:null},"8772"),(0,l.kt)("td",{parentName:"tr",align:null},"\u77ed\u4fe1\u53d1\u9001\u670d\u52a1"),(0,l.kt)("td",{parentName:"tr",align:null},"java -jar ydl-sms-server.jar &")))),(0,l.kt)("h2",{id:"2-\u9879\u76ee\u73af\u5883\u51c6\u5907"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-%E9%A1%B9%E7%9B%AE%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"},"#"),"2. \u9879\u76ee\u73af\u5883\u51c6\u5907"),(0,l.kt)("h3",{id:"21-\u73af\u5883\u8981\u6c42"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-1-%E7%8E%AF%E5%A2%83%E8%A6%81%E6%B1%82"},"#"),"2.1 \u73af\u5883\u8981\u6c42"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"JDK \uff1a 1.8 +")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Maven\uff1a 3.3 + ",(0,l.kt)("a",{parentName:"p",href:"http://maven.apache.org/download.cgi"},"http://maven.apache.org/download.cgiopen in new window"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Docker: 18 +"),(0,l.kt)("p",{parentName:"li"},"  docker-compose: 1.23 +")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Mysql\uff1a 5.7.0 + ",(0,l.kt)("a",{parentName:"p",href:"https://downloads.mysql.com/archives/community"},"https://downloads.mysql.com/archives/communityopen in new window"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Redis\uff1a 4.0 + ",(0,l.kt)("a",{parentName:"p",href:"https://redis.io/downloa"},"https://redis.io/downloaopen in new window"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Nacos\uff1a 1.1.4 ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/alibaba/nacos/releases"},"https://github.com/alibaba/nacos/releasesopen in new window"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Node\uff1a 11.3+\uff08\u96c6\u6210npm\uff09 ",(0,l.kt)("a",{parentName:"p",href:"https://nodejs.org/en/download"},"https://nodejs.org/en/downloadopen in new window")))),(0,l.kt)("h3",{id:"22-redis\u96c6\u7fa4"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-2-redis%E9%9B%86%E7%BE%A4"},"#"),"2.2 Redis\u96c6\u7fa4"),(0,l.kt)("p",null,"Redis\u96c6\u7fa4\u7684\u54e8\u5175\u6a21\u5f0f\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6a21\u5f0f\uff0c\u9996\u5148Redis\u63d0\u4f9b\u4e86\u54e8\u5175\u7684\u547d\u4ee4\uff0c\u54e8\u5175\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u8fdb\u7a0b\uff0c\u4f5c\u4e3a\u8fdb\u7a0b\uff0c\u5b83\u4f1a\u72ec\u7acb\u8fd0\u884c\u3002\u5176\u539f\u7406\u662f\u54e8\u5175\u901a\u8fc7\u53d1\u9001\u547d\u4ee4\uff0c\u7b49\u5f85Redis\u670d\u52a1\u5668\u54cd\u5e94\uff0c\u4ece\u800c\u76d1\u63a7\u8fd0\u884c\u7684\u591a\u4e2aRedis\u5b9e\u4f8b\u3002 \u54e8\u5175\u6a21\u5f0f\u4f5c\u7528\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u901a\u8fc7\u53d1\u9001\u547d\u4ee4\uff0c\u8ba9Redis\u670d\u52a1\u5668\u8fd4\u56de\u76d1\u63a7\u5176\u8fd0\u884c\u72b6\u6001\uff0c\u5305\u62ec\u4e3b\u670d\u52a1\u5668\u548c\u4ece\u670d\u52a1\u5668\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5f53\u54e8\u5175\u76d1\u6d4b\u5230master\u5b95\u673a\uff0c\u4f1a\u81ea\u52a8\u5c06slave\u5207\u6362\u6210master\uff0c\u7136\u540e\u901a\u8fc7\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\u901a\u77e5\u5176\u4ed6\u7684\u4ece\u670d\u52a1\u5668\uff0c\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff0c\u8ba9\u5b83\u4eec\u5207\u6362\u4e3b\u673a\u3002")),(0,l.kt)("p",null,"\u9664\u4e86\u76d1\u63a7Redis\u670d\u52a1\u4e4b\u5916\uff0c\u54e8\u5175\u4e4b\u95f4\u4e5f\u4f1a\u4e92\u76f8\u76d1\u63a7\u3002\u672c\u6587\u91c7\u7528\u4e00\u4e3b\u3001\u53cc\u4ece\u3001\u4e09\u54e8\u5175\u65b9\u5f0f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916120800855-410069e3.png",alt:"image-20210916120800855"}),"image-20210916120800855"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u90e8\u7f72\u65b9\u5f0f\u4e3a"),"\uff1adocker compose\uff1a"),(0,l.kt)("p",null,"\u5b89\u88c5\u3001\u5347\u7ea7docker\u56fe\u6587\u8bf7\u770b\uff1a",(0,l.kt)("a",{parentName:"p",href:"https://mp.weixin.qq.com/s/F3kQvSMYSKbnyLaDIbVl1Q"},"https://mp.weixin.qq.com/s/F3kQvSMYSKbnyLaDIbVl1Qopen in new window")),(0,l.kt)("p",null,"\u7b2c\u4e00\u6b65\uff1a\u521b\u5efaredis docker-compose.yml\u914d\u7f6e\u6587\u4ef6 \u76ee\u5f55,\u5e76\u590d\u5236docs/dockerfile/redis/docker-compose.yml \u5230\u5f53\u524d\u76ee\u5f55\uff0c\u914d\u7f6e\u6587\u4ef6\u53ef\u6839\u636e\u9700\u8981\u8c03\u6574"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-docker-compose.yml"},'version: \'3.4\'\nservices:\n master:\n  image: redis\n  restart: always\n  container_name: redis-master\n  network_mode: "host"\n  command: redis-server --port 16380 --requirepass 123456 --protected-mode no --daemonize no\n  ports:\n   - 16380:16380\n slave1:\n  image: redis\n  restart: always\n  container_name: redis-slave-1\n  network_mode: "host"\n  command: redis-server --slaveof 127.0.0.1 16380 --port 16381 --requirepass 123456 --masterauth 123456 --protected-mode no --daemonize no\n  ports:\n   - 16381:16381\n slave2:\n  image: redis\n  restart: always\n  container_name: redis-slave-2\n  network_mode: "host" \n  command: redis-server --slaveof 127.0.0.1 16380 --port 16382 --requirepass 123456 --masterauth 123456 --protected-mode no --daemonize no\n  ports:\n   - 16382:16382\n')),(0,l.kt)("p",null,"\u7b2c\u4e8c\u6b65\uff1a\u6267\u884c\u542f\u52a8\u547d\u4ee4 \u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u6267\u884c\u542f\u52a8\u547d\u4ee4"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"docker-compose -f docker-compose.yml up -d\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210922111122880-a79ca594.png",alt:"image-20210922111122880"}),"image-20210922111122880"),(0,l.kt)("p",null,"\u7b2c\u4e09\u6b65\uff1a\u521b\u5efasentinel docker-compose.yml\u914d\u7f6e\u6587\u4ef6 \u76ee\u5f55,\u5e76\u590d\u5236\u914d\u7f6e\u6587\u4ef6 \u590d\u5236 docs/dockerfile/sentinel/docker-compose.yml \u5230\u5f53\u524d\u76ee\u5f55 \u590d\u5236 docs/dockerfile/sentinel/sentinel1.conf \u5230\u5f53\u524d\u76ee\u5f55 \u590d\u5236 docs/dockerfile/sentinel/sentinel2.conf \u5230\u5f53\u524d\u76ee\u5f55 \u590d\u5236 docs/dockerfile/sentinel/sentinel3.conf \u5230\u5f53\u524d\u76ee\u5f55 docker-compose.yml"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'version: \'3.4\'\nservices:\n sentinel1:\n  image: redis\n  restart: always\n  container_name: redis-sentinel-1\n  network_mode: "host"\n  command: redis-sentinel /root/dockerfile/sentinel/sentinel1.conf\n  volumes:\n   - ./sentinel1.conf:/root/dockerfile/sentinel/sentinel1.conf\n sentinel2:\n  image: redis\n  restart: always\n  container_name: redis-sentinel-2\n  network_mode: "host" \n  command: redis-sentinel /root/dockerfile/sentinel/sentinel2.conf\n  volumes:\n   - ./sentinel2.conf:/root/dockerfile/sentinel/sentinel2.conf\n sentinel3:\n  image: redis\n  restart: always\n  container_name: redis-sentinel-3\n  network_mode: "host" \n  command: redis-sentinel /root/dockerfile/sentinel/sentinel3.conf\n  volumes:\n   - ./sentinel3.conf:/root/dockerfile/sentinel/sentinel3.conf\n')),(0,l.kt)("p",null,"sentinel1.conf"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"port 26380\ndaemonize no\npidfile /var/run/redis-sentinel1.pid\ndir /tmp\nsentinel monitor mymaster 127.0.0.1 16380 2\nsentinel auth-pass mymaster 123456\nsentinel down-after-milliseconds mymaster 30000\nsentinel parallel-syncs mymaster 1\nsentinel failover-timeout mymaster 180000\nsentinel deny-scripts-reconfig yes\n")),(0,l.kt)("p",null,"sentinel2.conf"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"port 26381\ndaemonize no\npidfile /var/run/redis-sentinel2.pid\ndir /tmp\nsentinel monitor mymaster 127.0.0.1 16380 2\nsentinel auth-pass mymaster 123456\nsentinel down-after-milliseconds mymaster 30000\nsentinel parallel-syncs mymaster 1\nsentinel failover-timeout mymaster 180000\nsentinel deny-scripts-reconfig yes\n")),(0,l.kt)("p",null,"sentinel3.conf"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"port 26382\ndaemonize no\npidfile /var/run/redis-sentinel3.pid\ndir /tmp\nsentinel monitor mymaster 127.0.0.1 16380 2\nsentinel auth-pass mymaster 123456\nsentinel down-after-milliseconds mymaster 30000\nsentinel parallel-syncs mymaster 1\nsentinel failover-timeout mymaster 180000\nsentinel deny-scripts-reconfig yes\n")),(0,l.kt)("p",null,"\u7b2c\u56db\u6b65\uff1a\u6267\u884c\u542f\u52a8\u547d\u4ee4 \u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u6267\u884c\u542f\u52a8\u547d\u4ee4"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"docker-compose -f docker-compose.yml up -d\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210913180549154-65b12f87.png",alt:"image-20210913180549154"}),"image-20210913180549154"),(0,l.kt)("h3",{id:"23-\u540e\u7aef\u5de5\u7a0b\u5bfc\u5165"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-3-%E5%90%8E%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%AF%BC%E5%85%A5"},"#"),"2.3 \u540e\u7aef\u5de5\u7a0b\u5bfc\u5165"),(0,l.kt)("p",null,"\u5c06 \u8d44\u6599\u5939\\\u8d44\u6599\\\u540e\u7aef\u521d\u59cb\u9879\u76ee\\jars \u4e2d\u7684jar\u5305install\u5165\u672c\u5730\u4ed3\u5e93\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"mvn install:install-file -Dfile=./ydl-tools-common.jar -DgroupId=com.ydl -DartifactId=ydl-tools-common -Dversion=1.0-SNAPSHOT -Dpackaging=jar\n\nmvn install:install-file -Dfile=./ydl-tools-core.jar -DgroupId=com.ydl -DartifactId=ydl-tools-core -Dversion=1.0-SNAPSHOT -Dpackaging=jar\n\nmvn install:install-file -Dfile=./ydl-tools-databases.jar -DgroupId=com.ydl -DartifactId=ydl-tools-databases -Dversion=1.0-SNAPSHOT -Dpackaging=jar\n\nmvn install:install-file -Dfile=./ydl-tools-dozer.jar -DgroupId=com.ydl -DartifactId=ydl-tools-dozer -Dversion=1.0-SNAPSHOT -Dpackaging=jar\n\nmvn install:install-file -Dfile=./ydl-tools-j2cache.jar -DgroupId=com.ydl -DartifactId=ydl-tools-j2cache -Dversion=1.0-SNAPSHOT -Dpackaging=jar\n\nmvn install:install-file -Dfile=./ydl-tools-jwt.jar -DgroupId=com.ydl -DartifactId=ydl-tools-jwt -Dversion=1.0-SNAPSHOT -Dpackaging=jar\n\nmvn install:install-file -Dfile=./ydl-tools-log.jar -DgroupId=com.ydl -DartifactId=ydl-tools-log -Dversion=1.0-SNAPSHOT -Dpackaging=jar\n\nmvn install:install-file -Dfile=./ydl-tools-swagger2.jar -DgroupId=com.ydl -DartifactId=ydl-tools-swagger2 -Dversion=1.0-SNAPSHOT -Dpackaging=jar\n\nmvn install:install-file -Dfile=./ydl-tools-user.jar -DgroupId=com.ydl -DartifactId=ydl-tools-user -Dversion=1.0-SNAPSHOT -Dpackaging=jar\n\nmvn install:install-file -Dfile=./ydl-tools-validator.jar -DgroupId=com.ydl -DartifactId=ydl-tools-validator -Dversion=1.0-SNAPSHOT -Dpackaging=jar\n\nmvn install:install-file -Dfile=./ydl-tools-xss.jar -DgroupId=com.ydl -DartifactId=ydl-tools-xss -Dversion=1.0-SNAPSHOT -Dpackaging=jar\n")),(0,l.kt)("p",null,"\u5c06\u8d44\u6599\u4e2d\u7684\u521d\u59cb\u5de5\u7a0b\u5bfc\u5165\u5f00\u53d1\u5de5\u5177\uff0c\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210914111704042-878af5c7.png",alt:"image-20210914111704042"}),"image-20210914111704042"),(0,l.kt)("h3",{id:"24-\u6570\u636e\u5e93"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-4-%E6%95%B0%E6%8D%AE%E5%BA%93"},"#"),"2.4 \u6570\u636e\u5e93"),(0,l.kt)("p",null,"\u6570\u636e\u5e93\u811a\u672c\u4f4d\u4e8e\u5bfc\u5165\u7684\u521d\u59cb\u5de5\u7a0b",(0,l.kt)("inlineCode",{parentName:"p"},"/docs/mysql/ydl-sms.sql"),"\uff0c\u521b\u5efaydl_sms\u6570\u636e\u5e93\u5e76\u6267\u884cydl-sms.sql\u811a\u672c\u6587\u4ef6\u5b8c\u6210\u5efa\u8868\u64cd\u4f5c\u3002\u521b\u5efa\u5b8c\u6210\u540e\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u8868\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210914111857698-46a16fe7.png",alt:"image-20210914111857698"}),"image-20210914111857698"),(0,l.kt)("h3",{id:"25-\u524d\u7aef\u5de5\u7a0b"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-5-%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B"},"#"),"2.5 \u524d\u7aef\u5de5\u7a0b"),(0,l.kt)("p",null,"\u524d\u7aef\u5de5\u7a0b\u91c7\u7528vue2 + ts + spa\u67b6\u6784\uff0c\u524d\u7aef\u5de5\u7a0b\u5728\u8d44\u6599\u4e2d\u5df2\u7ecf\u63d0\u4f9b\uff0c\u4f4d\u7f6e\u4e3a\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"/\u8d44\u6599/\u524d\u7aef\u5de5\u7a0b")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u524d\u7aef\u4ee3\u7801\u7ed3\u6784\u548c\u6838\u5fc3\u4ee3\u7801"),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210914114002904-4e51013b.png",alt:"image-20210914114002904"}),"image-20210914114002904")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u7f16\u8bd1\u3001\u8fd0\u884c\u524d\u7aef\u4ee3\u7801"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"```javascript\nnpm install\nnpm run serve\n```\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210914112925481-3b82f420.png",alt:"image-20210914112925481"}),"image-20210914112925481"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210914113139513-1aa9d6f1.png",alt:"image-20210914113139513"}),"image-20210914113139513"),(0,l.kt)("p",null,"\u767b\u9646\u9875\u9762\u6548\u679c"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916201900615-d4c8c1db.png",alt:"image-20210916201900615"}),"image-20210916201900615"),(0,l.kt)("p",null,"\u8fdb\u5165\u6548\u679c"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916201911039-7c876a07.png",alt:"image-20210916201911039"}),"image-20210916201911039"),(0,l.kt)("h2",{id:"3-\u540e\u53f0\u7ba1\u7406\u670d\u52a1"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1"},"#"),"3. \u540e\u53f0\u7ba1\u7406\u670d\u52a1"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916095249795-9bf62f5d.png",alt:"image-20210916095249795"}),"image-20210916095249795"),(0,l.kt)("h3",{id:"31-\u9879\u76ee\u7ed3\u6784"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-1-%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"},"#"),"3.1. \u9879\u76ee\u7ed3\u6784"),(0,l.kt)("h4",{id:"311-\u57fa\u7840\u5de5\u7a0b"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-1-1-%E5%9F%BA%E7%A1%80%E5%B7%A5%E7%A8%8B"},"#"),"3.1.1 \u57fa\u7840\u5de5\u7a0b"),(0,l.kt)("p",null,"\u57fa\u7840\u5de5\u7a0b\u4e3aydl-sms-entity\u5de5\u7a0b\uff0c\u4e3b\u8981\u662f\u4e00\u4e9b\u5b9e\u4f53\u7c7b\u3001DTO\u3001\u5de5\u5177\u7c7b\u3001Mapper\u63a5\u53e3\u7b49\uff0c\u4f5c\u4e3a\u57fa\u7840\u6a21\u5757\uff0c\u5176\u4ed6\u51e0\u4e2a\u670d\u52a1\u90fd\u4f1a\u4f9d\u8d56\u6b64\u57fa\u7840\u6a21\u5757\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916220116083-f9647338.png",alt:"image-20210916220116083"}),"image-20210916220116083"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6ce8\u610f"),"\uff1adto entity vo \u5173\u7cfb\u56fe"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916221225307-6b199bf6.png",alt:"image-20210916221225307"}),"image-20210916221225307"),(0,l.kt)("h4",{id:"312-\u7ba1\u7406\u7aef\u5de5\u7a0b"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-1-2-%E7%AE%A1%E7%90%86%E7%AB%AF%E5%B7%A5%E7%A8%8B"},"#"),"3.1.2 \u7ba1\u7406\u7aef\u5de5\u7a0b"),(0,l.kt)("p",null,"ydl-sms-manage\u4f5c\u4e3a\u540e\u53f0\u7ba1\u7406\u670d\u52a1\u7684maven\u5de5\u7a0b\uff0c\u4e3b\u8981\u529f\u80fd\u662f\u5bf9\u57fa\u7840\u6570\u636e\u8fdb\u884c\u7ef4\u62a4\u64cd\u4f5c\uff0c\u4f8b\u5982\u7b7e\u540d\u7ba1\u7406\u3001\u6a21\u677f\u7ba1\u7406\u3001\u901a\u9053\u7ba1\u7406\u3001\u901a\u9053\u4f18\u5148\u7ea7\u914d\u7f6e\u3001\u6570\u636e\u7edf\u8ba1\u7b49\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916220303128-fc7c1102.png",alt:"image-20210916220303128"}),"image-20210916220303128"),(0,l.kt)("h3",{id:"32-\u529f\u80fd\u6e05\u5355"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-2-%E5%8A%9F%E8%83%BD%E6%B8%85%E5%8D%95"},"#"),"3.2. \u529f\u80fd\u6e05\u5355"),(0,l.kt)("p",null,"\u4e0b\u56fe\u5c55\u793a\u4e86\u540e\u53f0\u7ba1\u7406\u670d\u52a1\u5b9e\u73b0\u7684\u529f\u80fd\u6e05\u5355\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916224738144-fee7fde4.png",alt:"image-20210916224738144"}),"image-20210916224738144"),(0,l.kt)("h3",{id:"33-\u6570\u636e\u6a21\u578b\u4e0e\u7c7b"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-3-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B%E4%B8%8E%E7%B1%BB"},"#"),"3.3. \u6570\u636e\u6a21\u578b\u4e0e\u7c7b"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u5e8f\u53f7"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8868\u540d"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u540d"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"1"),(0,l.kt)("td",{parentName:"tr",align:null},"signature"),(0,l.kt)("td",{parentName:"tr",align:null},"SignatureEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u77ed\u4fe1\u7b7e\u540d")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"2"),(0,l.kt)("td",{parentName:"tr",align:null},"template"),(0,l.kt)("td",{parentName:"tr",align:null},"TemplateEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u77ed\u4fe1\u6a21\u677f")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"3"),(0,l.kt)("td",{parentName:"tr",align:null},"config"),(0,l.kt)("td",{parentName:"tr",align:null},"ConfigEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u77ed\u4fe1\u901a\u9053\u914d\u7f6e")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"4"),(0,l.kt)("td",{parentName:"tr",align:null},"config_signature"),(0,l.kt)("td",{parentName:"tr",align:null},"ConfigSignatureEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u901a\u9053\u4e0e\u7b7e\u540d\u5173\u7cfb")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"5"),(0,l.kt)("td",{parentName:"tr",align:null},"config_template"),(0,l.kt)("td",{parentName:"tr",align:null},"ConfigTemplateEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u901a\u9053\u4e0e\u6a21\u677f\u5173\u7cfb")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"6"),(0,l.kt)("td",{parentName:"tr",align:null},"platform"),(0,l.kt)("td",{parentName:"tr",align:null},"PlatformEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u63a5\u5165\u5e73\u53f0(\u5e94\u7528\u7ba1\u7406)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"7"),(0,l.kt)("td",{parentName:"tr",align:null},"receive_log"),(0,l.kt)("td",{parentName:"tr",align:null},"ReceiveLogEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u77ed\u4fe1\u63a5\u6536\u65e5\u5fd7")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"8"),(0,l.kt)("td",{parentName:"tr",align:null},"manual_process"),(0,l.kt)("td",{parentName:"tr",align:null},"ManualProcessEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u4eba\u5de5\u5904\u7406\u4efb\u52a1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"9"),(0,l.kt)("td",{parentName:"tr",align:null},"send_log"),(0,l.kt)("td",{parentName:"tr",align:null},"SendLogEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u77ed\u4fe1\u53d1\u9001\u65e5\u5fd7")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"10"),(0,l.kt)("td",{parentName:"tr",align:null},"black_list"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackListEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9ed1\u540d\u5355")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"11"),(0,l.kt)("td",{parentName:"tr",align:null},"timing_push"),(0,l.kt)("td",{parentName:"tr",align:null},"TimingPushEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5b9a\u65f6\u53d1\u9001")))),(0,l.kt)("p",null,"\u540d\u8bcd\u89e3\u91ca\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u77ed\u4fe1\u7b7e\u540d\uff1a\u662f\u6307\u4e3b\u53eb\u7528\u6237\u5728\u53d1\u9001\u77ed\u4fe1\u8fc7\u7a0b\u4e2d\uff0c\u9644\u52a0\u4e3b\u53eb\u7528\u6237\u7684\u4e2a\u6027\u5316\u7b7e\u540d\uff0c\u53d1\u9001\u5230\u88ab\u53eb\u624b\u673a\u7528\u6237\u7684\u4e1a\u52a1\u3002")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916194042731-a1d97f78.png",alt:"image-20210916194042731"}),"image-20210916194042731"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u77ed\u4fe1\u6a21\u677f\uff1a\u5373\u5177\u4f53\u53d1\u9001\u7684\u77ed\u4fe1\u5185\u5bb9\uff0c\u77ed\u4fe1\u6a21\u7248\u901a\u5e38\u53ef\u4ee5\u652f\u6301\u9a8c\u8bc1\u7801\u3001\u901a\u77e5\u3001\u63a8\u5e7f\u4e09\u79cd\u77ed\u4fe1\u7c7b\u578b\u3002")),(0,l.kt)("p",null,"\u4e3e\u4f8b\uff1a\u5c0a\u656c\u7684\u3010\u53d8\u91cfa\u3011\u5148\u751f\uff0c\u60a8\u5c3e\u53f7\u4e3a\u3010\u53d8\u91cfb\u3011\u7684\u5361\uff0c\u6d88\u8d39\u4e86\u3010\u53d8\u91cfc\u3011\u5143\u3002\u3010\u519c\u4e1a\u94f6\u884c\u3011"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u77ed\u4fe1\u901a\u9053\uff1a\u6307\u7b2c\u4e09\u65b9\u77ed\u4fe1\u5e73\u53f0\uff0c\u4f8b\u5982\u963f\u91cc\u4e91\u77ed\u4fe1\u3001\u4e50\u4fe1\u77ed\u4fe1\u3001\u68a6\u7f51\u77ed\u4fe1\u7b49\u3002")),(0,l.kt)("h3",{id:"34-\u57fa\u7840\u5c5e\u6027\u81ea\u52a8\u6ce8\u5165"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-4-%E5%9F%BA%E7%A1%80%E5%B1%9E%E6%80%A7%E8%87%AA%E5%8A%A8%E6%B3%A8%E5%85%A5"},"#"),"3.4. \u57fa\u7840\u5c5e\u6027\u81ea\u52a8\u6ce8\u5165"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u529f\u80fd"),"\uff1a\u901a\u8fc7\u81ea\u5b9a\u4e49\u6ce8\u89e3\u548c\u5207\u9762\uff0c\u5728\u8fdb\u884c\u6570\u636e\u7ef4\u62a4\u65f6\u5b9e\u73b0\u5b9e\u4f53\u4e2d\u57fa\u7840\u5c5e\u6027\u7684\u81ea\u52a8\u8d4b\u503c\uff08\u521b\u5efa\u8005\u3001\u521b\u5efa\u65f6\u95f4\u3001\u4fee\u6539\u8005\u3001\u4fee\u6539\u8005\uff09\u3002"),(0,l.kt)("h4",{id:"341-\u57fa\u7840\u5c5e\u6027"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-4-1-%E5%9F%BA%E7%A1%80%E5%B1%9E%E6%80%A7"},"#"),"3.4.1 \u57fa\u7840\u5c5e\u6027"),(0,l.kt)("p",null,"\u57fa\u7840\u5b9e\u4f53\u7c7b\uff0c\u4e1a\u52a1\u5b9e\u4f53\u7c7b\u7684\u57fa\u7c7b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.sms.entity.base;\n\nimport com.baomidou.mybatisplus.annotation.TableId;\nimport io.swagger.annotations.ApiModelProperty;\nimport lombok.Data;\n\nimport java.io.Serializable;\nimport java.time.LocalDateTime;\n\n/**\n * \u57fa\u7840\u5b9e\u4f53\u7c7b\uff0c\u6240\u6709\u5b9e\u4f53\u90fd\u9700\u8981\u7ee7\u627f\n */\n@Data\npublic abstract class BaseEntity implements Serializable {\n\n    @TableId\n    @ApiModelProperty(value = "\u4e3b\u952e")\n    private String id;\n\n    @ApiModelProperty(value = "\u521b\u5efa\u65f6\u95f4")\n    private LocalDateTime createTime;\n\n    @ApiModelProperty(value = "\u521b\u5efa\u4eba")\n    private String createUser = "0";\n\n    @ApiModelProperty(value = "\u4fee\u6539\u65f6\u95f4")\n    private LocalDateTime updateTime;\n\n    @ApiModelProperty(value = "\u4fee\u6539\u4eba")\n    private String updateUser;\n\n    @ApiModelProperty(value = "\u903b\u8f91\u5220\u9664\uff1a0\u5220\u9664")\n    private Integer isDelete;\n\n}\n')),(0,l.kt)("h4",{id:"342-\u81ea\u5b9a\u4e49\u6ce8\u89e3"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-4-2-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3"},"#"),"3.4.2 \u81ea\u5b9a\u4e49\u6ce8\u89e3"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.METHOD)\npublic @interface DefaultParams {\n}\n")),(0,l.kt)("h4",{id:"343-\u5b9a\u4e49\u5207\u9762\u7c7b"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-4-3-%E5%AE%9A%E4%B9%89%E5%88%87%E9%9D%A2%E7%B1%BB"},"#"),"3.4.3 \u5b9a\u4e49\u5207\u9762\u7c7b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * \u901a\u8fc7\u5207\u9762\u65b9\u5f0f\uff0c\u81ea\u5b9a\u4e49\u6ce8\u89e3\uff0c\u5b9e\u73b0\u5b9e\u4f53\u57fa\u7840\u6570\u636e\u7684\u6ce8\u5165\uff08\u521b\u5efa\u8005\u3001\u521b\u5efa\u65f6\u95f4\u3001\u4fee\u6539\u8005\u3001\u4fee\u6539\u65f6\u95f4\uff09\n */\n@Component\n@Aspect\n@Slf4j\npublic class DefaultParamsAspect {\n    @SneakyThrows\n    @Before("@annotation(com.itheima.sms.annotation.DefaultParams)")\n    public void beforeEvent(JoinPoint point) {\n        //\u4ecethreadlocal\u4e2d\u83b7\u53d6\u7528\u6237id\n        Long userId = BaseContextHandler.getUserId();\n        if (userId == null) {\n            userId = 0L;\n        }\n        Object[] args = point.getArgs();\n        for (int i = 0; i < args.length; i++) {\n            Class<?> classes = args[i].getClass();\n            Object id = null;\n            Method method = getMethod(classes, "getId");\n            if (null != method) {\n                id = method.invoke(args[i]);\n            }\n\n            //\u8bf7\u6c42\u64cd\u4f5c\u7684\u5bf9\u8c61\u7684id\u4e3a\u7a7a\u65f6\uff0c\u4e3a\u521b\u5efa\u64cd\u4f5c\n            if (null == id) {\n                method = getMethod(classes, "setCreateUser", String.class);\n                if (null != method) {\n                    method.invoke(args[i], userId.toString());\n                }\n                method = getMethod(classes, "setCreateTime", LocalDateTime.class);\n                if (null != method) {\n                    method.invoke(args[i], LocalDateTime.now());\n                }\n            }\n\n            //\u65b0\u5efa\u4fee\u6539\u66f4\u65b0\n            method = getMethod(classes, "setUydlateUser", String.class);\n            if (null != method) {\n                method.invoke(args[i], userId.toString());\n            }\n            method = getMethod(classes, "setUydlateTime", LocalDateTime.class);\n            if (null != method) {\n                method.invoke(args[i], LocalDateTime.now());\n            }\n        }\n    }\n\n    private Method getMethod(Class classes, String name, Class... types) {\n        try {\n            return classes.getMethod(name, types);\n        } catch (NoSuchMethodException e) {\n            return null;\n        }\n    }\n}\n')),(0,l.kt)("h4",{id:"344-\u4f7f\u7528\u6ce8\u89e3"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-4-4-%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3"},"#"),"3.4.4 \u4f7f\u7528\u6ce8\u89e3"),(0,l.kt)("p",null,"\u5728Controller\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u6ce8\u89e3\uff0c\u4fdd\u5b58\u57fa\u7840\u5c5e\u6027\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@PostMapping\n@ApiOperation("\u4fdd\u5b58")\n@DefaultParams\npublic R save(@RequestBody ObjectEntity entity) {\n    //\u5177\u4f53\u5b9e\u73b0\u903b\u8f91...\n    return R.success();\n}\n')),(0,l.kt)("h3",{id:"35-redis\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-5-redis%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F"},"#"),"3.5. Redis\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f"),(0,l.kt)("p",null,"Redis \u53d1\u5e03\u8ba2\u9605 (pub/sub) \u662f\u4e00\u79cd\u6d88\u606f\u901a\u4fe1\u6a21\u5f0f\uff1a\u53d1\u9001\u8005 (pub) \u53d1\u9001\u6d88\u606f\uff0c\u8ba2\u9605\u8005 (sub) \u63a5\u6536\u6d88\u606f\u3002Redis \u5ba2\u6237\u7aef\u53ef\u4ee5\u8ba2\u9605\u4efb\u610f\u6570\u91cf\u7684\u9891\u9053\u3002"),(0,l.kt)("p",null,"Redis\u7684\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\u672c\u8d28\u548c\u4f20\u7edf\u7684MQ\u7684\u53d1\u5e03\u8ba2\u9605\u7c7b\u4f3c\uff0c\u4f46\u662f\u76f8\u5bf9\u4e8e\u5176\u5b83\u51e0\u6b3eMQ\u4ea7\u54c1\u6765\u8bf4\uff0credis\u7684\u4f7f\u7528\u66f4\u52a0\u4fbf\u6377\uff0c\u4e5f\u66f4\u52a0\u8f7b\u91cf\u5316\uff0c\u4e0d\u9700\u8981\u5355\u72ec\u53bb\u642d\u5efa\u96c6\u6210\u4e00\u5957\u7e41\u91cd\u7684MQ\u6846\u67b6\u3002\u4f46\u7f3a\u70b9\u4e5f\u5f88\u660e\u663e\uff0credis\u53d1\u5e03\u7684\u6d88\u606f\u4e0d\u4f1a\u6301\u4e45\u5316\uff0c\u6240\u4ee5\u5f53\u67d0\u4e00\u53f0\u670d\u52a1\u5668\u51fa\u73b0\u95ee\u9898\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u6d88\u606f\u4f1a\u4e22\u5931\uff0c\u6240\u4ee5\u5728\u8003\u8651\u4f7f\u7528\u4e4b\u524d\u8981\u614e\u91cd\uff0c\u5f53\u524d\u7684\u4e1a\u52a1\u662f\u5426\u5bf9\u6570\u636e\u4e00\u81f4\u6027\u8981\u6c42\u5f88\u9ad8\uff0c\u5982\u679c\u8981\u6c42\u5f88\u9ad8\uff0c\u8fd8\u662f\u5efa\u8bae\u4f7f\u7528MQ\u4ea7\u54c1\u3002"),(0,l.kt)("p",null,"\u5728\u53d1\u5e03\u8005\u8ba2\u9605\u8005\u6a21\u5f0f\u4e0b\uff0c\u53d1\u5e03\u8005\u5c06\u6d88\u606f\u53d1\u5e03\u5230\u6307\u5b9a\u7684 channel \u91cc\u9762\uff0c \u51e1\u662f\u76d1\u542c\u8be5 channel \u7684\u6d88\u8d39\u8005\u90fd\u4f1a\u6536\u5230\u540c\u6837\u7684\u4e00\u4efd\u6d88\u606f\uff0c\u8fd9\u79cd\u6a21\u5f0f\u7c7b\u4f3c\u4e8e\u662f\u6536\u97f3\u673a\u6a21\u5f0f\uff0c\u5373\u51e1\u662f\u6536\u542c\u67d0\u4e2a\u9891\u9053\u7684\u542c\u4f17\u90fd\u4f1a\u6536\u5230\u4e3b\u6301\u4eba\u53d1\u5e03\u7684\u76f8\u540c\u7684\u6d88\u606f\u5185\u5bb9\u3002 \u6b64\u6a21\u5f0f\u5e38\u7528\u4e8e\u7fa4\u804a\u5929\u3001 \u7fa4\u901a\u77e5\u3001\u7fa4\u516c\u544a\u7b49\u573a\u666f\u3002"),(0,l.kt)("p",null,"\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\u4e0b\u7684\u51e0\u4e2a\u6982\u5ff5\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Publisher\uff1a \u53d1\u5e03\u8005"),(0,l.kt)("li",{parentName:"ul"},"Subscriber\uff1a\u8ba2\u9605\u8005"),(0,l.kt)("li",{parentName:"ul"},"Channel\uff1a \u9891\u9053")),(0,l.kt)("p",null,"\u4e0b\u56fe\u5c55\u793a\u4e86\u9891\u9053 channel1 \uff0c \u4ee5\u53ca\u8ba2\u9605\u8fd9\u4e2a\u9891\u9053\u7684\u4e09\u4e2a\u5ba2\u6237\u7aef \u2014\u2014 client1\u3001 client2 \u548c client3 \u4e4b\u95f4\u7684\u5173\u7cfb\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210922171439646-5d5f3cd6.png",alt:"image-20210922171439646"}),"image-20210922171439646"),(0,l.kt)("p",null,"\u5f53\u6709\u65b0\u6d88\u606f\u901a\u8fc7 PUBLISH \u547d\u4ee4\u53d1\u9001\u7ed9\u9891\u9053 channel1 \u65f6\uff0c \u8fd9\u4e2a\u6d88\u606f\u5c31\u4f1a\u88ab\u53d1\u9001\u7ed9\u8ba2\u9605\u5b83\u7684\u4e09\u4e2a\u5ba2\u6237\u7aef\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210922171712064-3e8ebe3a.png",alt:"image-20210922171712064"}),"image-20210922171712064"),(0,l.kt)("h4",{id:"351-\u6848\u4f8b\u6f14\u793a"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-5-1-%E6%A1%88%E4%BE%8B%E6%BC%94%E7%A4%BA"},"#"),"3.5.1 \u6848\u4f8b\u6f14\u793a"),(0,l.kt)("p",null,"1.\u9996\u5148\u8fdc\u7a0b\u542f\u52a8redis\u670d\u52a1\u542f\u52a8"),(0,l.kt)("p",null,"2.\u542f\u52a84\u4e2a\u5ba2\u6237\u7aef redis-cli"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"redis-cli.exe -h 192.168.200.131 -p 16380 -a 123456\n")),(0,l.kt)("p",null,"3.\u5c06\u5176\u4e2d\u4e09\u4e2a\u5ba2\u6237\u7aef\u8bbe\u7f6e\u76d1\u542c\u9891\u9053 test"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"subscribe ydlchannel\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210922172222994-5efc86a4.png",alt:"image-20210922172222994"}),"image-20210922172222994"),(0,l.kt)("p",null,"4.\u5c06\u7b2c\u56db\u4e2a\u5ba2\u6237\u7aef\u4f5c\u4e3a\u6d88\u606f\u53d1\u5e03\u7684\u5ba2\u6237\u7aef\uff0c\u5411\u9891\u9053 ydlchannel\u53d1\u5e03\u6d88\u606f"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"publish ydlchannel 'im itlilaoshi'\n")),(0,l.kt)("p",null,"\u53ef\u4ee5\u770b\u5230\u53e6\u5916\u4e09\u4e2a\u5ba2\u6237\u7aef\u90fd\u6536\u5230\u4e86\u6d88\u606f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210922172441645-d471fdfc.png",alt:"image-20210922172441645"}),"image-20210922172441645"),(0,l.kt)("h4",{id:"352-\u4ee3\u7801\u6848\u4f8b"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-5-2-%E4%BB%A3%E7%A0%81%E6%A1%88%E4%BE%8B"},"#"),"3.5.2 \u4ee3\u7801\u6848\u4f8b"),(0,l.kt)("p",null,"1\u3001\u5bfc\u5165spring-boot-starter-data-redis\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-redis</artifactId>\n</dependency>\n")),(0,l.kt)("p",null,"2\u3001\u7f16\u5199\u6d88\u606f\u76d1\u542c\u5668\uff0c\u4f5c\u4e3a\u6d88\u606f\u7684\u8ba2\u9605\u8005"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.sms.listener;\n\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.data.redis.connection.Message;\nimport org.springframework.data.redis.connection.MessageListener;\nimport org.springframework.stereotype.Component;\n\n/**\n * \u81ea\u5b9a\u4e49\u6d88\u606f\u76d1\u542c\u5668\uff0c\u7528\u4e8e\u76d1\u542cRedis\u9891\u9053\u4e2d\u7684\u6d88\u606f\n */\n@Component\n@Slf4j\npublic class MyListener implements MessageListener {\n    /**\n     * \u76d1\u542c\u65b9\u6cd5\n     * @param message\n     * @param pattern\n     */\n    @Override\n    public void onMessage(Message message, byte[] pattern) {\n        log.info("\u63a5\u6536\u5230\u6d88\u606f\uff1a" + message);\n    }\n}\n')),(0,l.kt)("p",null,"3\u3001\u7f16\u5199\u8ba2\u9605\u53d1\u5e03\u6a21\u5f0f\u7684\u5bb9\u5668\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.sms.config;\n\nimport com.ydl.sms.listener.MyListener;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.autoconfigure.AutoConfigureAfter;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.data.redis.connection.RedisConnectionFactory;\nimport org.springframework.data.redis.listener.PatternTopic;\nimport org.springframework.data.redis.listener.RedisMessageListenerContainer;\nimport org.springframework.data.redis.listener.adapter.MessageListenerAdapter;\n\n/**\n * \u8ba2\u9605\u53d1\u5e03\u6a21\u5f0f\u7684\u5bb9\u5668\u914d\u7f6e\n */\n@Configuration\n@AutoConfigureAfter({MyListener.class})\npublic class SubscriberConfig {\n\n    @Autowired\n    private MyListener myListener;\n\n    /**\n     * \u521b\u5efa\u6d88\u606f\u76d1\u542c\u5bb9\u5668\n     *\n     * @param redisConnectionFactory\n     * @return\n     */\n    @Bean\n    public RedisMessageListenerContainer getRedisMessageListenerContainer(RedisConnectionFactory redisConnectionFactory) {\n        RedisMessageListenerContainer redisMessageListenerContainer = new RedisMessageListenerContainer();\n        redisMessageListenerContainer.setConnectionFactory(redisConnectionFactory);\n\n        //\u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a\u76d1\u542c\u8ba2\u9605\u9891\u9053\n        //\u5f53\u524d\u76d1\u542c\u7684\u662f\u901a\u9053\uff1aMYTOPIC\n        redisMessageListenerContainer.addMessageListener(new MessageListenerAdapter(myListener), new PatternTopic("MYTOPIC"));\n\n        return redisMessageListenerContainer;\n    }\n}\n')),(0,l.kt)("p",null,"4\u3001\u7f16\u5199\u6d88\u606f\u53d1\u5e03\u8005"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u901a\u8fc7redis\u5ba2\u6237\u7aef\u53d1\u9001\u6d88\u606f")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210922182117550-f0162cfe.png",alt:"image-20210922182117550"}),"image-20210922182117550"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u901a\u8fc7Java\u4ee3\u7801\u53d1\u9001\u6d88\u606f")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.test;\n\nimport com.ydl.sms.SmsManageApplication;\nimport org.junit.runner.RunWith;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.data.redis.core.RedisTemplate;\nimport org.springframework.test.context.junit4.SpringRunner;\n\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = SmsManageApplication.class)\npublic class RedisTest {\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    //@Test\n    public void test1(){\n        for (int i = 0; i < 10; i++) {\n            redisTemplate.convertAndSend("MYTOPIC","im itlilaoshi");\n        }\n    }\n\n}\n')),(0,l.kt)("h3",{id:"36-\u901a\u9053\u7ba1\u7406"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-6-%E9%80%9A%E9%81%93%E7%AE%A1%E7%90%86"},"#"),"3.6. \u901a\u9053\u7ba1\u7406"),(0,l.kt)("h4",{id:"361-\u4ea7\u54c1\u539f\u578b"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-6-1-%E4%BA%A7%E5%93%81%E5%8E%9F%E5%9E%8B"},"#"),"3.6.1 \u4ea7\u54c1\u539f\u578b"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210922182054655-e855759f.png",alt:"image-20210922182054655"}),"image-20210922182054655"),(0,l.kt)("h4",{id:"362-\u9700\u6c42\u5206\u6790"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-6-2-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"},"#"),"3.6.2 \u9700\u6c42\u5206\u6790"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u901a\u9053\u4fe1\u606f\u589e\u3001\u5220\u3001\u6539\u3001\u67e5\uff08\u5206\u9875\u3001\u8be6\u60c5\uff09"),(0,l.kt)("li",{parentName:"ul"},"\u901a\u9053\u6392\u5e8f\uff1a\u901a\u8fc7\u62d6\u52a8\u5bf9\u524d\u7aef\u901a\u9053\u8fdb\u884c\u6392\u5e8f"),(0,l.kt)("li",{parentName:"ul"},"\u5173\u8054\u901a\u9053\u4e0e\u77ed\u4fe1\u7b7e\u540d\uff1a\u4e00\u4e2a\u901a\u9053\u53ef\u4ee5\u6709\u591a\u4e2a\u7b7e\u540d"),(0,l.kt)("li",{parentName:"ul"},"\u5173\u8054\u901a\u9053\u4e0e\u77ed\u4fe1\u6a21\u677f\uff1a\u4e00\u4e2a\u901a\u9053\u53ef\u4ee5\u6709\u591a\u4e2a\u6a21\u677f"),(0,l.kt)("li",{parentName:"ul"},"\u901a\u9053\u4f18\u5148\u7ea7\u6392\u5e8f\u540e\u901a\u77e5\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\uff0c\u66f4\u65b0\u7f13\u5b58\u4e2d\u7684\u901a\u9053\u4f18\u5148\u7ea7")),(0,l.kt)("h4",{id:"363-\u5177\u4f53\u5b9e\u73b0"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-6-3-%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0"},"#"),"3.6.3 \u5177\u4f53\u5b9e\u73b0"),(0,l.kt)("p",null,"\u7ba1\u7406\u7aef\u670d\u52a1\u6709\u4e00\u4e2a\u573a\u666f\u4f7f\u7528\u4e86redis\u7684\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\uff1a\u77ed\u4fe1\u901a\u9053\u7684\u4f18\u5148\u7ea7\u53d1\u751f\u53d8\u5316\uff08\u5982\u4eba\u5de5\u8bbe\u7f6e\uff09\u540e\uff0c\u901a\u8fc7redis\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\u901a\u77e5\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\uff0c\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u63a5\u6536\u5230\u6d88\u606f\u540e\u81ea\u52a8\u8c03\u6574\u77ed\u4fe1\u53d1\u9001\u65f6\u4f7f\u7528\u7684\u901a\u9053\u7684\u4f18\u5148\u7ea7\uff08\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u7f13\u5b58\u4e86\u77ed\u4fe1\u901a\u9053\u7684\u914d\u7f6e\u4fe1\u606f\uff09\u3002"),(0,l.kt)("p",null,"\u57fa\u7840\u4ee3\u7801\u90fd\u5df2\u7ecf\u5b9e\u73b0\uff0c\u6b64\u5904\u53ea\u9700\u8981\u5b9e\u73b0\u901a\u9053\u6392\u5e8f\u540e\u901a\u77e5\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u7684\u4ee3\u7801\u5373\u53ef\u3002\u4e5f\u5c31\u662fConfigServiceImpl\u7c7b\u7684sendUpdateMessage\u65b9\u6cd5\u3002"),(0,l.kt)("p",null,"\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u4e1a\u52a1\u903b\u8f91\u8bf4\u660e\uff1a"),(0,l.kt)("p",null,"1\u3001\u4e3a\u4e86\u4fdd\u8bc1\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u7684\u53ef\u7528\u6027\uff0c\u5728\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u542f\u52a8\u65f6\u4f1a\u81ea\u52a8\u751f\u6210\u5f53\u524d\u670d\u52a1\u5b9e\u4f8b\u7684\u4e00\u4e2auuid\u4f5c\u4e3a\u670d\u52a1\u6807\u8bc6\u4fdd\u5b58\u5230redis\u4e2d\uff0c\u5e76\u4e14\u6bcf\u96943\u5206\u949f\u4e0a\u62a5\u670d\u52a1\u4fe1\u606f\u8bc1\u660e\u670d\u52a1\u72b6\u6001\u6b63\u5e38"),(0,l.kt)("p",null,"2\u3001\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u542f\u52a8\u540e\u4f1a\u6bcf\u969410\u5206\u949f\u68c0\u67e5redis\u4e2d\u7684\u670d\u52a1\u4e0a\u62a5\u4fe1\u606f\uff0c\u5982\u679c\u67d0\u4e2a\u5b9e\u4f8b\u8d85\u8fc75\u5206\u949f\u6ca1\u6709\u4e0a\u62a5\u5219\u8ba4\u4e3a\u6b64\u670d\u52a1\u4e0b\u7ebf\uff0c\u5c31\u4f1a\u4eceredis\u4e2d\u5c06\u6b64\u670d\u52a1\u5b9e\u4f8b\u4fe1\u606f\u5220\u9664"),(0,l.kt)("p",null,"3\u3001\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u5728\u542f\u52a8\u65f6\u4f1a\u4ece\u6570\u636e\u5e93\u4e2d\u67e5\u8be2\u51fa\u53ef\u7528\u901a\u9053\u5217\u8868\u5e76\u6309\u7167\u4f18\u5148\u7ea7\u6392\u5e8f\uff0c\u7136\u540e\u7f13\u5b58\u5230redis\u4e2d"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'//\u53d1\u9001\u6d88\u606f\uff0c\u901a\u77e5\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u66f4\u65b0\u7f13\u5b58\u4e2d\u7684\u901a\u9053\u4f18\u5148\u7ea7\npublic void sendUpdateMessage() {\n    //\u83b7\u5f97\u6240\u6709\u6ce8\u518c\u5230redis\u4e2d\u7684\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u5b9e\u4f8b\n    Map map = redisTemplate.opsForHash().entries("SERVER_ID_HASH");\n    log.info("\u5168\u90e8\u670d\u52a1\uff1a{}", map);\n    Long current = System.currentTimeMillis();\n\n    for (Object key : map.keySet()) {\n        long valueLong = Long.parseLong(map.get(key).toString());\n        \n        //\u4e94\u5206\u949f\u5185\u62a5\u544a\uff0c\u8bf4\u660e\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u72b6\u6001\u6b63\u5e38\n        if (current - valueLong < (1000 * 60 * 5)) {\n            //\u5220\u9664redis\u4e2d\u7f13\u5b58\u7684\u53ef\u7528\u901a\u9053\uff0c\u56e0\u4e3a\u901a\u9053\u4f18\u5148\u7ea7\u53d1\u751f\u53d8\u5316\uff0credis\u4e2d\u7f13\u5b58\u7684\u53ef\u7528\u901a\u9053\u9700\u8981\u91cd\u65b0\u52a0\u8f7d\n            redisTemplate.delete("listForConnect");\n            \n            //\u53d1\u5e03\u6d88\u606f\n            redisTemplate.convertAndSend("TOPIC_HIGH_SERVER",\n                                         ServerTopic\n                                         .builder()\n                                         .option(ServerTopic.INIT_CONNECT)\n                                         .value(key.toString())\n                                         .build()\n                                         .toString()\n                                        );\n            log.info("\u53d1\u9001\u6d88\u606f\u901a\u77e5\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u91cd\u65b0\u6784\u5efa\u901a\u9053");\n            return;\n        }\n    }\n}\n')),(0,l.kt)("h1",{id:"\u7b2c2\u7ae0-\u77ed\u4fe1\u63a5\u6536\u670d\u52a1"},(0,l.kt)("a",{parentName:"h1",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#%E7%AC%AC2%E7%AB%A0-%E7%9F%AD%E4%BF%A1%E6%8E%A5%E6%94%B6%E6%9C%8D%E5%8A%A1"},"#"),"\u7b2c2\u7ae0 \u77ed\u4fe1\u63a5\u6536\u670d\u52a1"),(0,l.kt)("h2",{id:"1-\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u4ecb\u7ecd"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_1-%E7%9F%AD%E4%BF%A1%E6%8E%A5%E6%94%B6%E6%9C%8D%E5%8A%A1%E4%BB%8B%E7%BB%8D"},"#"),"1. \u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u4ecb\u7ecd"),(0,l.kt)("p",null,"\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u7684\u4f5c\u7528\u5c31\u662f\u4e3a\u5e94\u7528\u63d0\u4f9b\u8bbf\u95ee\u63a5\u53e3\uff0c\u5e94\u7528\u9700\u8981\u53d1\u9001\u77ed\u4fe1\u65f6\u53ea\u9700\u8981\u8c03\u7528\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\uff0c\u7531\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u5c06\u4fe1\u606f\u4fdd\u5b58\u5230\u6d88\u606f\u7f13\u51b2\u533a\uff08Mysql\u3001Redis\uff09\u3002\u540e\u7eed\u4f1a\u7531\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u4ece\u6d88\u606f\u7f13\u51b2\u533a\u83b7\u53d6\u6d88\u606f\u5e76\u53d1\u9001\u77ed\u4fe1\u3002"),(0,l.kt)("p",null,"\u52a8\u529b\u77ed\u4fe1\u77ed\u4fe1\u5e73\u53f0\u6574\u4f53\u67b6\u6784\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916095249795-9bf62f5d.png",alt:"image-20210916095249795"}),"image-20210916095249795"),(0,l.kt)("p",null,"\u52a8\u529b\u77ed\u4fe1\u77ed\u4fe1\u5e73\u53f0\u4e1a\u52a1\u67b6\u6784\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210916100828128-e2e1e21d.png",alt:"image-20210916100828128"}),"image-20210916100828128"),(0,l.kt)("p",null,"\u901a\u8fc7\u4e0a\u9762\u7684\u4e1a\u52a1\u67b6\u6784\u53ef\u4ee5\u770b\u5230\uff0c\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\uff08pd-sms-api\uff09\u63d0\u4f9b3\u79cd\u65b9\u5f0f\u4f9b\u4e1a\u52a1\u7cfb\u7edf\u8c03\u7528\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"HTTP\u63a5\u53e3"),(0,l.kt)("li",{parentName:"ul"},"TCP"),(0,l.kt)("li",{parentName:"ul"},"SDK\u5f62\u5f0f")),(0,l.kt)("p",null,"\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u901a\u8fc7\u8d44\u8d28\u9a8c\u8bc1\uff08\u53ef\u5f00\u5173\uff09\u3001\u77ed\u4fe1\u5185\u5bb9\u6821\u9a8c\u540e\u5c06\u77ed\u4fe1\u4fe1\u606f\u53d1\u9001\u5230\u5bf9\u5e94\u4e2d\u95f4\u4ef6\u4e2d\uff08Redis\u3001MySQL\uff09\u3002"),(0,l.kt)("p",null,"\u77ed\u4fe1\u53d1\u9001\u65b9\u5f0f\u5206\u4e3a\u4e24\u79cd\u7c7b\u578b\uff1a"),(0,l.kt)("p",null,"1\u3001\u5b9a\u65f6\u53d1\u9001\u77ed\u4fe1\uff1a\u5c06\u77ed\u4fe1\u5185\u5bb9\u5b58\u50a8\u5230MySQL\u6570\u636e\u5e93\u4e2d\uff0c\u7531\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u901a\u8fc7\u5b9a\u65f6\u4efb\u52a1\u83b7\u53d6\u5e76\u53d1\u9001 2\u3001\u666e\u901a\u77ed\u4fe1\uff1a\u5c06\u77ed\u4fe1\u5185\u5bb9\u63a8\u9001\u5230Redis\u961f\u5217\u4e2d\uff0c\u7531\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u5f02\u6b65\u63a5\u6536\u5e76\u53d1\u9001"),(0,l.kt)("h2",{id:"2-redis\u6d88\u606f\u961f\u5217"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-redis%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97"},"#"),"2. Redis\u6d88\u606f\u961f\u5217"),(0,l.kt)("h3",{id:"21-redis\u961f\u5217\u4ecb\u7ecd"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-1-redis%E9%98%9F%E5%88%97%E4%BB%8B%E7%BB%8D"},"#"),"2.1 Redis\u961f\u5217\u4ecb\u7ecd"),(0,l.kt)("p",null,"Redis\u652f\u6301\u4e94\u79cd\u6570\u636e\u7c7b\u578b\uff1astring\uff08\u5b57\u7b26\u4e32\uff09\uff0chash\uff08\u54c8\u5e0c\uff09\uff0clist\uff08\u5217\u8868\uff09\uff0cset\uff08\u96c6\u5408\uff09\u53cazset(sorted set\uff1a\u6709\u5e8f\u96c6\u5408)\u3002"),(0,l.kt)("p",null,"Redis\u7684list\u662f\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u5217\u8868\uff0c\u6309\u7167\u63d2\u5165\u987a\u5e8f\u6392\u5e8f\u3002\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2a\u5143\u7d20\u5230\u5217\u8868\u7684\u5934\u90e8\uff08\u5de6\u8fb9\uff09\u6216\u8005\u5c3e\u90e8\uff08\u53f3\u8fb9\uff09\u3002"),(0,l.kt)("p",null,"\u4f7f\u7528Redis\u7684list\u53ef\u4ee5\u6a21\u62df\u6d88\u606f\u961f\u5217\uff0c\u5373\u4f7f\u7528",(0,l.kt)("strong",{parentName:"p"},"rpush"),"\u548c",(0,l.kt)("strong",{parentName:"p"},"lpush"),"\u547d\u4ee4\u5c06\u6570\u636e\u63d2\u5165\u961f\u5217\uff08\u751f\u4ea7\u6d88\u606f\uff09\uff0c\u4f7f\u7528",(0,l.kt)("strong",{parentName:"p"},"lpop"),"\u548c",(0,l.kt)("strong",{parentName:"p"},"rpop"),"\u547d\u4ee4\u5c06\u6570\u636e\u5f39\u51fa\u961f\u5217\uff08\u6d88\u8d39\u6d88\u606f\uff09\u3002"),(0,l.kt)("p",null,"\u961f\u5217\u4e2d\u7684\u6d88\u606f\u53ef\u4ee5\u7531\u4e0d\u540c\u7684\u751f\u4ea7\u8005\u5199\u5165\uff0c\u4e5f\u53ef\u4ee5\u7531\u4e0d\u540c\u7684\u6d88\u8d39\u8005\u6d88\u8d39\uff0c\u4f46\u662f\u4e00\u4e2a\u6d88\u606f\u4e00\u5b9a\u662f\u53ea\u80fd\u88ab\u6d88\u8d39\u4e00\u6b21\u3002"),(0,l.kt)("p",null,"redis\u6240\u6709\u547d\u4ee4\uff0c\u53ef\u4ece\u5b98\u7f51\u67e5\u770b\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://redis.cn/commands.html#list"},"http://redis.cn/commands.html#listopen in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210923092616090-47c54f2f.png",alt:"image-20210923092616090"}),"image-20210923092616090"),(0,l.kt)("h3",{id:"22-\u6848\u4f8b\u6f14\u793a"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-2-%E6%A1%88%E4%BE%8B%E6%BC%94%E7%A4%BA"},"#"),"2.2 \u6848\u4f8b\u6f14\u793a"),(0,l.kt)("p",null,"\u53d1\u5e03\u6d88\u606f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"root@77889f10b0c8:/data# redis-cli\n127.0.0.1:6379> LPUSH ydllist msg1\n(integer) 1\n127.0.0.1:6379> LPUSH ydllist msg2\n(integer) 2\n127.0.0.1:6379> LPUSH ydllist msg3\n(integer) 3\n127.0.0.1:6379> LPUSH ydllist msg4\n(integer) 4\n127.0.0.1:6379> LPUSH ydllist msg5\n(integer) 5\n")),(0,l.kt)("p",null,"\u67e5\u770b\u6d88\u606f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},'127.0.0.1:6379> LRANGE ydllist 0 -1\n1) "msg5"\n2) "msg4"\n3) "msg3"\n4) "msg2"\n5) "msg1"\n')),(0,l.kt)("p",null,"\u6d88\u8d39\u6d88\u606f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},'127.0.0.1:6379> RPOP ydllist\n"msg1"\n127.0.0.1:6379> RPOP ydllist\n"msg2"\n127.0.0.1:6379> LRANGE ydllist 0 -1\n1) "msg5"\n2) "msg4"\n3) "msg3"\n127.0.0.1:6379> RPOP ydllist\n"msg3"\n127.0.0.1:6379> RPOP ydllist\n"msg4"\n127.0.0.1:6379> RPOP ydllist\n"msg5"\n127.0.0.1:6379> RPOP ydllist\n(nil)\n127.0.0.1:6379> LRANGE channel1 0 -1\n(empty list or set)\n127.0.0.1:6379> \n')),(0,l.kt)("p",null,"RPOP\u547d\u4ee4\u4e0d\u5177\u6709\u963b\u585e\u529f\u80fd\uff0c\u5982\u679c\u9700\u8981\u963b\u585e\u529f\u80fd\u53ef\u4ee5\u4f7f\u7528BRPOP\u547d\u4ee4\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210923105449996-c59b3a97.png",alt:"image-20210923105449996"}),"image-20210923105449996"),(0,l.kt)("h3",{id:"23-\u4ee3\u7801\u6848\u4f8b"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-3-%E4%BB%A3%E7%A0%81%E6%A1%88%E4%BE%8B"},"#"),"2.3 \u4ee3\u7801\u6848\u4f8b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.test;\n\nimport com.ydl.sms.SmsApiApplication;\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.data.redis.core.RedisTemplate;\nimport org.springframework.test.context.junit4.SpringRunner;\n\nimport java.util.concurrent.TimeUnit;\n\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = SmsApiApplication.class)\npublic class RedisListTest {\n    @Autowired\n    RedisTemplate redisTemplate;\n\n    //\u6d88\u606f\u53d1\u9001\u8005\n    @Test\n    public void testPush(){\n        for (int i = 0; i < 10; i++) {\n            redisTemplate.opsForList().leftPush("ydllist123", "msg"+i);\n        }\n    }\n\n    //\u6d88\u606f\u6d88\u8d39\u8005\n    @Test\n    public void testPop(){\n        for (int i = 0; i < 11; i++) {\n            Object value = redisTemplate.opsForList().rightPop("ydllist123");\n            System.out.println("\u53d6\u51fa\u7684\u503c\u662f\uff1a"+value);\n        }\n    }\n\n    //\u6d88\u8d39\u8005\u963b\u585e\u76d1\u542c\u961f\u5217\n    @Test\n    public void testPopBlock(){\n       while (true){\n           Object value = redisTemplate.opsForList().rightPop("ydllist123", 10L, TimeUnit.SECONDS);\n           //\u4e1a\u52a1\u903b\u8f91\n           System.out.println("\u53d6\u51fa\u7684\u503c\u662f\uff1a"+value);\n       }\n    }\n}\n')),(0,l.kt)("h2",{id:"3-\u77ed\u4fe1\u63a5\u6536\u670d\u52a1"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-%E7%9F%AD%E4%BF%A1%E6%8E%A5%E6%94%B6%E6%9C%8D%E5%8A%A1"},"#"),"3. \u77ed\u4fe1\u63a5\u6536\u670d\u52a1"),(0,l.kt)("h3",{id:"31-\u9700\u6c42\u5206\u6790-\u91cd\u70b9"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-%E9%87%8D%E7%82%B9"},"#"),"3.1 \u9700\u6c42\u5206\u6790-\u91cd\u70b9"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u529f\u80fd\u9700\u6c42\uff1a")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5e94\u7528\u7cfb\u7edf\u8c03\u7528\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u63d0\u4f9b\u7684\u63a5\u53e3\uff0c\u7531\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u5c06\u4fe1\u606f\u4fdd\u5b58\u5230\u6d88\u606f\u7f13\u51b2\u533a\uff08Mysql\u3001Redis\uff09"),(0,l.kt)("li",{parentName:"ul"},"\u8c03\u7528\u65b9\u5f0f\uff1aHTTP\u3001TCP\u3001SDK")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5904\u7406\u6d41\u7a0b\uff1a")),(0,l.kt)("p",null,"\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u63a5\u6536\u5230\u5e94\u7528\u7cfb\u7edf\u8bf7\u6c42\u540e\uff0c\u4f1a\u8fdb\u884c\u76f8\u5173\u7684\u6821\u9a8c\u5904\u7406\uff0c\u6821\u9a8c\u901a\u8fc7\u5219\u5c06\u4fe1\u606f\u4fdd\u5b58\u5230\u6d88\u606f\u7f13\u5b58\u533a\uff0c\u5177\u4f53\u5904\u7406\u6d41\u7a0b\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210923174235681-3ea1eb65.png",alt:"image-20210923174235681"}),"image-20210923174235681"),(0,l.kt)("h3",{id:"32-\u9879\u76ee\u7ed3\u6784"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-2-%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"},"#"),"3.2 \u9879\u76ee\u7ed3\u6784"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210923100907654-c30c191f.png",alt:"image-20210923100907654"}),"image-20210923100907654"),(0,l.kt)("h3",{id:"33-\u6570\u636e\u6a21\u578b\u4e0e\u7c7b-1"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-3-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B%E4%B8%8E%E7%B1%BB-1"},"#"),"3.3 \u6570\u636e\u6a21\u578b\u4e0e\u7c7b"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u5e8f\u53f7"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8868\u540d"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u540d"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"1"),(0,l.kt)("td",{parentName:"tr",align:null},"signature"),(0,l.kt)("td",{parentName:"tr",align:null},"SignatureEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u77ed\u4fe1\u7b7e\u540d")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"2"),(0,l.kt)("td",{parentName:"tr",align:null},"template"),(0,l.kt)("td",{parentName:"tr",align:null},"TemplateEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u77ed\u4fe1\u6a21\u677f")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"3"),(0,l.kt)("td",{parentName:"tr",align:null},"config"),(0,l.kt)("td",{parentName:"tr",align:null},"ConfigEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u77ed\u4fe1\u901a\u9053\u914d\u7f6e")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"4"),(0,l.kt)("td",{parentName:"tr",align:null},"config_signature"),(0,l.kt)("td",{parentName:"tr",align:null},"ConfigSignatureEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u901a\u9053\u4e0e\u7b7e\u540d\u5173\u7cfb")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"5"),(0,l.kt)("td",{parentName:"tr",align:null},"config_template"),(0,l.kt)("td",{parentName:"tr",align:null},"ConfigTemplateEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u901a\u9053\u4e0e\u6a21\u677f\u5173\u7cfb")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"6"),(0,l.kt)("td",{parentName:"tr",align:null},"platform"),(0,l.kt)("td",{parentName:"tr",align:null},"PlatformEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u63a5\u5165\u5e73\u53f0(\u5e94\u7528\u7ba1\u7406)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"7"),(0,l.kt)("td",{parentName:"tr",align:null},"receive_log"),(0,l.kt)("td",{parentName:"tr",align:null},"ReceiveLogEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u77ed\u4fe1\u63a5\u6536\u65e5\u5fd7")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"8"),(0,l.kt)("td",{parentName:"tr",align:null},"black_list"),(0,l.kt)("td",{parentName:"tr",align:null},"BlackListEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9ed1\u540d\u5355")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"9"),(0,l.kt)("td",{parentName:"tr",align:null},"timing_push"),(0,l.kt)("td",{parentName:"tr",align:null},"TimingPushEntity"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5b9a\u65f6\u53d1\u9001")))),(0,l.kt)("p",null,"\u6ce8\u610f\uff1a\u6b64\u5904\u53ea\u662f\u5217\u51fa\u548c\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u6709\u5173\u7684\u6570\u636e\u6a21\u578b\u548c\u7c7b\u3002"),(0,l.kt)("h3",{id:"34-\u6d88\u606f\u5b58\u50a8"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-4-%E6%B6%88%E6%81%AF%E5%AD%98%E5%82%A8"},"#"),"3.4 \u6d88\u606f\u5b58\u50a8"),(0,l.kt)("p",null,"\u5bfc\u5165\u7684\u521d\u59cb\u5de5\u7a0b\u4e2d\u5df2\u7ecf\u5b9e\u73b0\u4e86\u5927\u90e8\u5206\u4ee3\u7801\uff0c\u4e3b\u8981\u903b\u8f91\u4e3a\u901a\u8fc7Controller\u63d0\u4f9bHTTP\u63a5\u53e3\u670d\u52a1\u63a5\u6536\u5e94\u7528\u7cfb\u7edf\u8bf7\u6c42\uff0c\u7136\u540e\u8c03\u7528Service\uff0c\u5728Service\u4e2d\u8fdb\u884c\u4e00\u7cfb\u5217\u6821\u9a8c\uff0c\u5982\u679c\u6821\u9a8c\u901a\u8fc7\u5219\u9700\u8981\u5c06\u6d88\u606f\u4fdd\u5b58\u5230\u6d88\u606f\u7f13\u51b2\u533a\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5c06\u6d88\u606f\u4fdd\u5b58\u5230\u6d88\u606f\u7f13\u51b2\u533a\u7684\u4e1a\u52a1\u903b\u8f91\u4e3a\uff1a")),(0,l.kt)("p",null,"1\u3001\u8fdb\u884c\u77ed\u4fe1\u5206\u7c7b\uff0c\u5206\u4e3a\u5b9e\u65f6\u53d1\u9001\u77ed\u4fe1\u548c\u5b9a\u65f6\u53d1\u9001\u77ed\u4fe1"),(0,l.kt)("p",null,"2\u3001\u5982\u679c\u662f\u5b9a\u65f6\u53d1\u9001\u77ed\u4fe1\u5219\u5c06\u6d88\u606f\u4fdd\u5b58\u5230Mysql\u6570\u636e\u5e93"),(0,l.kt)("p",null,"3\u3001\u5982\u679c\u662f\u5b9e\u65f6\u53d1\u9001\u77ed\u4fe1\u5219\u5c06\u6d88\u606f\u4fdd\u5b58\u5230Redis\u961f\u5217\uff0c\u5224\u65ad\u77ed\u4fe1\u6a21\u677f\u7c7b\u578b\uff0c\u5982\u679c\u662f\u9a8c\u8bc1\u7801\u7c7b\u578b\u5219\u5c06\u6d88\u606f\u4fdd\u5b58\u5230\u9ad8\u4f18\u5148\u7ea7\u961f\u5217TOPIC_HIGH_SMS\uff0c\u5982\u679c\u662f\u5176\u4ed6\u7c7b\u578b\u5219\u5c06\u6d88\u606f\u4fdd\u5b58\u5230\u666e\u901a\u961f\u5217TOPIC_GENERAL_SMS"),(0,l.kt)("p",null,"4\u3001\u4fdd\u5b58\u77ed\u4fe1\u63a5\u6536\u65e5\u5fd7\u5230Mysql\u6570\u636e\u5e93"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5177\u4f53\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff08SmsSendServiceImpl\u7c7b\u7684pushSmsMessage\u65b9\u6cd5\uff09\uff1a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'//\u7f3a\u5565\u8865\u5565\n    /**\n     * \u6839\u636e\u77ed\u4fe1\u6a21\u677f\u5206\u7c7b \u5e76\u5206\u53d1\n     *\n     * @param templateEntity\n     * @param smsSendDTO\n     * @param platformEntity\n     */\n    private void pushSmsMessage(TemplateEntity templateEntity, SmsSendDTO smsSendDTO, PlatformEntity platformEntity) {\n        // TODO \u77ed\u4fe1\u63a5\u6536\u670d\u52a1\uff1a\u5c06\u77ed\u4fe1\u4fe1\u606f\u4fdd\u5b58\u5230\u6570\u636e\u5e93\u6216\u8005Redis\u961f\u5217\n        ReceiveLogEntity receiveLogEntity = new ReceiveLogEntity();\n        receiveLogEntity.setApiLogId(UUID.randomUUID().toString());\n        long start = System.currentTimeMillis();\n        try {\n            //1\u3001\u8fdb\u884c\u77ed\u4fe1\u5206\u7c7b\uff0c\u5206\u4e3a\u5b9e\u65f6\u53d1\u9001\u77ed\u4fe1\u548c\u5b9a\u65f6\u53d1\u9001\u77ed\u4fe1\n            String sendTime = smsSendDTO.getSendTime();\n\n            String request = JSON.toJSONString(smsSendDTO);\n            if (StringUtils.isNotEmpty(sendTime)) {\n                //2\u3001\u5982\u679c\u662f\u5b9a\u65f6\u53d1\u9001\u77ed\u4fe1\u5219\u5c06\u6d88\u606f\u4fdd\u5b58\u5230Mysql\u6570\u636e\u5e93\n                TimingPushEntity timingPushEntity = new TimingPushEntity();\n                timingPushEntity.setMobile(smsSendDTO.getMobile());\n                timingPushEntity.setTemplate(smsSendDTO.getTemplate());\n                timingPushEntity.setRequest(request);\n                timingPushEntity.setSignature(smsSendDTO.getSignature());\n                timingPushEntity.setTiming(sendTime);\n\n                timingPushService.save(timingPushEntity);\n            } else {\n                //3\u3001\u5982\u679c\u662f\u5b9e\u65f6\u53d1\u9001\u77ed\u4fe1\u5219\u5c06\u6d88\u606f\u4fdd\u5b58\u5230Redis\u961f\u5217\uff0c\u5224\u65ad\u77ed\u4fe1\u6a21\u677f\u7c7b\u578b\uff0c\u5982\u679c\u662f\u9a8c\u8bc1\u7801\u7c7b\u578b\u5219\u5c06\u6d88\u606f\u4fdd\u5b58\u5230\u9ad8\u4f18\u5148\u7ea7\u961f\u5217TOPIC_HIGH_SMS\uff0c\u5982\u679c\u662f\u5176\u4ed6\u7c7b\u578b\u5219\u5c06\u6d88\u606f\u4fdd\u5b58\u5230\u666e\u901a\u961f\u5217TOPIC_GENERAL_SMS\n\n                if (templateEntity.getType() == TemplateType.VERIFICATION.getCode()) {\n                    //\u60a8\u7684\u9a8c\u8bc1\u7801\u662f${code}\n                    redisTemplate.opsForList().leftPush("TOPIC_HIGH_SMS", request);\n                } else {\n                    //\u7406\u8d22\u4ea7\u54c1${product}\n                    redisTemplate.opsForList().leftPush("TOPIC_GENERAL_SMS", request);\n                }\n            }\n            receiveLogEntity.setStatus(1);\n        } catch (Exception e) {\n            receiveLogEntity.setStatus(0);\n            receiveLogEntity.setError(ExceptionUtils.getErrorStackTrace(e));\n        } finally {\n            //4\u3001\u4fdd\u5b58\u77ed\u4fe1\u63a5\u6536\u65e5\u5fd7\u5230Mysql\u6570\u636e\u5e93\n            receiveLogEntity.setPlatformId(platformEntity.getId());\n            receiveLogEntity.setPlatformName(platformEntity.getName());\n            receiveLogEntity.setBusiness(smsSendDTO.getBatchCode());\n            receiveLogEntity.setConfigIds(StringUtils.join(smsSendDTO.getConfigIds(), ",")); //[1,2,3]---\x3e1,2,3\n            receiveLogEntity.setTemplate(smsSendDTO.getTemplate());\n            receiveLogEntity.setSignature(smsSendDTO.getSignature());\n            receiveLogEntity.setMobile(smsSendDTO.getMobile());\n            receiveLogEntity.setRequest(JSON.toJSONString(smsSendDTO.getParams()));\n            receiveLogEntity.setUseTime(System.currentTimeMillis() - start);\n\n            receiveLogMapper.insert(receiveLogEntity);\n        }\n    }\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210924114955634-fe15e5da.png",alt:"image-20210924114955634"}),"image-20210924114955634"),(0,l.kt)("h3",{id:"35-tcp\u63a5\u53e3"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-5-tcp%E6%8E%A5%E5%8F%A3"},"#"),"3.5 TCP\u63a5\u53e3"),(0,l.kt)("p",null,"\u57fa\u4e8eNetty\u8fdb\u884c\u7f51\u7edc\u7f16\u7a0b\uff0c\u4e3a\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u63d0\u4f9b",(0,l.kt)("strong",{parentName:"p"},"TCP\u63a5\u53e3"),"\uff0c\u5e94\u7528\u7cfb\u7edf\u53ef\u4ee5\u901a\u8fc7TCP\u8c03\u7528\u6b64\u63a5\u53e3\u6765\u548c\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u5bf9\u63a5\u3002"),(0,l.kt)("p",null,"\u6d89\u53ca\u5230\u7684\u7c7b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210924114505723-89d34225.png",alt:"image-20210924114505723"}),"image-20210924114505723"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Netty\u670d\u52a1\u542f\u52a8\u7c7b\uff1a\u7528\u4e8e\u542f\u52a8Netty\u670d\u52a1"),(0,l.kt)("li",{parentName:"ul"},"\u901a\u9053\u521d\u59cb\u5316\u5668\uff1a\u4e3b\u8981\u76ee\u7684\u662f\u4e3a\u7a0b\u5e8f\u5458\u63d0\u4f9b\u4e00\u4e2a\u7b80\u5355\u7684\u5de5\u5177\uff0c\u7528\u4e8e\u5728\u67d0\u4e2aChannel\u6ce8\u518c\u5230EventLoop\u540e\uff0c\u5bf9\u8fd9\u4e2aChannel\u6267\u884c\u4e00\u4e9b\u521d\u59cb\u5316\u64cd\u4f5c\uff0c\u4f8b\u5982\u53ef\u4ee5\u6dfb\u52a0\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u670d\u52a1\u7aef\u5904\u7406\u5668"),(0,l.kt)("li",{parentName:"ul"},"\u670d\u52a1\u7aef\u5904\u7406\u5668\uff1a\u5177\u4f53\u6267\u884c\u5904\u7406\u903b\u8f91\uff0c\u4f8b\u5982\u8bfb\u53d6\u6d88\u606f")),(0,l.kt)("p",null,"\u5bfc\u5165\u7684\u521d\u59cb\u5de5\u7a0b\u4e2d\u4e3b\u4f53\u4ee3\u7801\u5df2\u7ecf\u5b8c\u6210\uff0c\u53ea\u9700\u8981\u5b9e\u73b0\u670d\u52a1\u7aef\u5904\u7406\u5668\u7684\u5177\u4f53\u5904\u7406\u903b\u8f91\u5373\u53ef\uff08NettyServerHandler\u7684channelRead0\u65b9\u6cd5\uff09\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'//\u4e1a\u52a1\u903b\u8f91\n    @Override\n    protected void channelRead0(ChannelHandlerContext ctx, String msg) {\n        // TODO \u77ed\u4fe1\u63a5\u6536\u670d\u52a1\uff1a\u63a5\u6536\u5e94\u7528\u7cfb\u7edf\u7684\u62a5\u6587\u5e76\u89e3\u6790\uff0c\u8c03\u7528Service\u5c06\u6d88\u606f\u4fdd\u5b58\u5230\u6d88\u606f\u7f13\u51b2\u533a\n        //\u5c31\u662f\u548ccontroller\u4e00\u6837 \u8c03\u7528service\u5c42\u5373\u53ef\n        String restMsg="success";\n        log.info("tcp\u63a5\u53e3\u63a5\u53d7\u5230\u6d88\u606f:"+msg);\n        try {\n            //1sring msg--\x3e SmsParamsDTO\n            SmsParamsDTO smsParamsDTO = parseMessage(msg);\n            if(null==smsParamsDTO){\n                log.info("\u62a5\u6587\u89e3\u6790\u5931\u8d25\uff01");\n                return;\n            }\n            //2\u8c03\u7528service\u5c42\u5373\u53ef\n            SpringUtils.getBean(SmsSendService.class).send(smsParamsDTO);\n\n        }catch (Exception e){\n            log.error("netty\u53d1\u9001\u65f6\uff0c\u62a5\u9519\u4e86\uff01",e);\n            restMsg=e.getMessage();\n        }\n\n        log.info("\u56de\u63a8\u62a5\u6587============="+restMsg);\n        ctx.writeAndFlush(restMsg+"\\n"); //\u4e3a\u4ec0\u4e48\u8981\u52a0\\n \u4e0d\u52a0\u5ba2\u6237\u7aef\u63a5\u6536\u4e0d\u5230\u6d88\u606f\n    }\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,l.kt)("p",null,"\u6253\u5f00telnet\u529f\u80fd"),(0,l.kt)("p",null,"\u516c\u4f17\u53f7\u6dfb\u52a0\u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\uff0c\u5b9a\u671f\u6280\u672f\u5206\u4eab\u54e6\u3002"),(0,l.kt)("p",null,"\u53ef\u4ee5\u4f7f\u7528telnet\u4f5c\u4e3aNetty\u5ba2\u6237\u7aef\u6765\u6d4b\u8bd5Netty\u670d\u52a1\uff0c\u62a5\u6587\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'{"accessKeyId": "dcbd824751cf448fa0b569f1f07b9b32","encryption": "2f2e4da7fffd4391a9aaabd594f37db3","mobile": "15718888888","params": {"code":"79857"},"signature": "DXQM_000000001","template": "DXMB_000000001","timestamp": "","sendTime":"2021-12-25 12:00"}\n')),(0,l.kt)("h3",{id:"36-sdk"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-6-sdk"},"#"),"3.6 SDK"),(0,l.kt)("h4",{id:"361-\u8bf4\u660e"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-6-1-%E8%AF%B4%E6%98%8E"},"#"),"3.6.1 \u8bf4\u660e"),(0,l.kt)("p",null,"SDK \u662f Software Development Kit \u7684\u7f29\u5199\uff0c\u5373\u8f6f\u4ef6\u5f00\u53d1\u5de5\u5177\u5305\u3002SDK\u88ab\u5f00\u53d1\u51fa\u6765\u662f\u4e3a\u4e86\u51cf\u5c11\u7a0b\u5e8f\u5458\u5de5\u4f5c\u91cf\u7684\uff0c\u6bd4\u5982\u516c\u53f8\u5f00\u53d1\u51fa\u67d0\u79cd\u8f6f\u4ef6\u7684\u67d0\u4e00\u529f\u80fd\uff0c\u628a\u5b83\u5c01\u88c5\u6210SDK\uff0c\u63d0\u4f9b\u7ed9\u5176\u4ed6\u516c\u53f8\u548c\u4e2a\u4eba\u4f7f\u7528\u3002"),(0,l.kt)("p",null,"\u672c\u5c0f\u8282\u9700\u8981\u5f00\u53d1\u77ed\u4fe1\u63a5\u6536\u670d\u52a1SDK\uff0c\u901a\u8fc7SDK\u53ef\u4ee5\u4f7f\u5e94\u7528\u7cfb\u7edf\u66f4\u52a0\u65b9\u4fbf\u7684\u8c03\u7528\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u3002"),(0,l.kt)("p",null,"\u901a\u8fc7SDK\u65b9\u5f0f\u8c03\u7528\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\uff0c\u672c\u8d28\u4e0a\u8fd8\u662f\u8c03\u7528\u7684\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u63d0\u4f9b\u7684HTTP\u63a5\u53e3\uff08Controller\uff09\uff0c\u53ea\u4e0d\u8fc7\u662f\u8c03\u7528\u7684\u8fc7\u7a0b\u5728SDK\u4e2d\u8fdb\u884c\u4e86\u5c01\u88c5\u3002"),(0,l.kt)("p",null,"\u9879\u76ee\u7ed3\u6784\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210924143027782-346a3429.png",alt:"image-20210924143027782"}),"image-20210924143027782"),(0,l.kt)("h4",{id:"362-\u5b9e\u73b0"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-6-2-%E5%AE%9E%E7%8E%B0"},"#"),"3.6.2 \u5b9e\u73b0"),(0,l.kt)("p",null,"\u5bfc\u5165\u7684\u521d\u59cb\u5de5\u7a0b\u4e2d\u4e3b\u4f53\u4ee3\u7801\u5df2\u7ecf\u5b8c\u6210\uff0c\u53ea\u9700\u8981\u5b9e\u73b0\u4e1a\u52a1\u5904\u7406\u7c7b\u7684\u5177\u4f53\u903b\u8f91\u5373\u53ef\uff08SmsSendServiceImpl\u7684send\u65b9\u6cd5\uff09\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n     * \u901a\u8fc7HttpClient\u53d1\u9001post\u8bf7\u6c42\uff0c\u8bf7\u6c42\u77ed\u4fe1\u63a5\u6536\u670d\u52a1HTTP\u63a5\u53e3\n     *\n     * @param baseParamsDTO\n     * @param url\n     * @return\n     */\n    private R send(BaseParamsDTO baseParamsDTO, String url) {\n        //\u8bbe\u7f6e\u6b64\u5e73\u53f0\u7684\u79d8\u94a5\n        baseParamsDTO.setAccessKeyId(accessKeyId);\n\n        //\u7535\u5546 \u5e73\u53f0\u662f\u5426\u8ba4\u8bc1\n        if (auth) {\n            //key secret \u90fd\u8981\u6709\n            if (StringUtils.isBlank(accessKeyId) || StringUtils.isBlank(accessKeySecret)) {\n                return R.fail("accessKeyId\u6216accessKeySecret\u4e0d\u80fd\u4e3a\u7a7a");\n            }\n        }\n\n        baseParamsDTO.setTimestamp(System.currentTimeMillis() + "");\n        baseParamsDTO.setEncryption(SmsEncryptionUtils.encode(baseParamsDTO.getTimestamp(), baseParamsDTO.getAccessKeyId(), accessKeySecret));\n\n        if (StringUtils.isBlank(domain)) {\n            return R.fail("domain\u4e0d\u80fd\u4e3a\u7a7a");\n        }\n\n        //1 httpclien okhttp\n        CloseableHttpClient httpClient = HttpClients.createDefault();\n        //\u6784\u9020post\u8bf7\u6c42\n        HttpPost post = new HttpPost(url);\n        //\u8bbe\u7f6e\u8bf7\u6c42\u5934\n        post.setHeader("Content-Type", "application/json; charset=UTF-8");\n        //\u8bbe\u7f6e\u8bf7\u6c42\u4f53\n        StringEntity stringEntity = new StringEntity(JSON.toJSONString(baseParamsDTO), "UTF-8");\n        post.setEntity(stringEntity);\n\n        try {\n            //\u53d1\u9001post\u8bf7\u6c42\n            CloseableHttpResponse response = httpClient.execute(post);\n            HttpEntity responseEntity = response.getEntity();\n\n            //\u89e3\u6790\u54cd\u5e94\u7801\n            if (response.getStatusLine().getStatusCode() == 200) {\n                //\u53d1\u9001\u6210\u529f\n                log.info("httpRequest access success, StatusCode is:{}", response.getStatusLine().getStatusCode());\n                String responseEntityStr = EntityUtils.toString(responseEntity);\n                log.info("responseContent is :" + responseEntityStr);\n\n                return JSON.parseObject(responseEntityStr, R.class);\n            } else {\n                //\u53d1\u9001\u5931\u8d25\n                log.error("httpRequest access fail ,StatusCode is:{}", response.getStatusLine().getStatusCode());\n                return R.fail("status is " + response.getStatusLine().getStatusCode());\n            }\n\n        } catch (Exception e) {\n            log.error("error", e);\n            return R.fail(e.getMessage());\n        } finally {\n            post.releaseConnection();\n        }\n    }\n')),(0,l.kt)("p",null,"SDK\u5f00\u53d1\u5b8c\u6210\u540e\uff0c\u4e3a\u4e86\u65b9\u4fbf\u5176\u4ed6\u5e94\u7528\u4f7f\u7528\uff0c\u901a\u5e38\u4f1a\u5c06SDK\u6253\u6210jar\u5305\u4e0a\u4f20\u5230\u8fdc\u7a0bmaven\u4ed3\u5e93\uff0c\u5728\u5e94\u7528\u7cfb\u7edf\u4e2d\u76f4\u63a5\u901a\u8fc7maven\u5750\u6807\u5bfc\u5165SDK\u5373\u53ef\u4f7f\u7528\u3002"),(0,l.kt)("p",null,"\u5982\u4e0b\u662f\u5c06SDK\u4e0a\u4f20\u5230Nexus\u540e\u7684\u6548\u679c\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210924221808372-59eb0132.png",alt:"image-20210924221808372"}),"image-20210924221808372"),(0,l.kt)("p",null,"\u5982\u4f55\u642d\u5efa\u79c1\u670d\uff0c\u8be6\u89c1\u516c\u4f17\u53f7\uff1aIT\u674e\u54e5\u4ea4\u670b\u53cb"),(0,l.kt)("h4",{id:"363-\u6d4b\u8bd5"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-6-3-%E6%B5%8B%E8%AF%95"},"#"),"3.6.3 \u6d4b\u8bd5"),(0,l.kt)("p",null,"\u7b2c\u4e00\u6b65\uff1a\u5f15\u5165SDK\u7684maven\u5750\u6807"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<repositories>\n    <repository>\n      <id>ydlrepo</id>\n      <url>http://192.168.200.131:8081/repository/ydlrepo/</url>\n    </repository>\n</repositories>\n\n\n<dependency>\n    <groupId>com.ydl</groupId>\n    <artifactId>ydl-sms-sdk</artifactId>\n    <version>1.0.0</version>\n</dependency>\n")),(0,l.kt)("p",null,"\u7b2c\u4e8c\u6b65\uff1a\u7f16\u5199\u914d\u7f6e\u6587\u4ef6"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"# \u670d\u52a1\u7aef\u4f7f\u7528sdk\u914d\u7f6e\u4fe1\u606f\nydlclass:\n  sms:\n    auth: true\n    domain: http://localhost:8771\n    accessKeyId: dcbd824751cf448fa0b569f1f07b9b32\n    accessKeySecret: 2f2e4da7fffd4391a9aaabd594f37db3\n")),(0,l.kt)("p",null,"\u7b2c\u4e09\u6b65\uff1a\u7f16\u5199\u5355\u5143\u6d4b\u8bd5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.test;\n\nimport com.itheima.sms.SmsManageApplication;\nimport com.itheima.sms.sms.dto.SmsParamsDTO;\nimport com.itheima.sms.sms.service.SmsSendService;\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.test.context.junit4.SpringRunner;\nimport java.util.HashMap;\nimport java.util.Map;\n\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = SmsManageApplication.class)\npublic class SdkTest {\n    @Autowired\n    private SmsSendService smsSendService;\n\n    /**\n     * \u901a\u8fc7SDK\u65b9\u5f0f\u8c03\u7528\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\n     */\n    @Test\n    public void testSend(){\n         SmsParamsDTO dto = new SmsParamsDTO();\n        dto.setMobile("15718888888");\n        dto.setSignature("DXQM_000000001");\n        dto.setTemplate("DXMB_000000001");\n        Map<String, String> map = new HashMap<>();\n        map.put("code","79857");\n        dto.setParams(map);\n        dto.setSendTime("2021-12-18 10:00");\n        dto.setTimestamp(System.currentTimeMillis() +"");\n\n        return smsSendService.sendSms(dto);\n    }\n}\n')),(0,l.kt)("h1",{id:"\u7b2c3\u7ae0-\u77ed\u4fe1\u53d1\u9001\u670d\u52a1"},(0,l.kt)("a",{parentName:"h1",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#%E7%AC%AC3%E7%AB%A0-%E7%9F%AD%E4%BF%A1%E5%8F%91%E9%80%81%E6%9C%8D%E5%8A%A1"},"#"),"\u7b2c3\u7ae0 \u77ed\u4fe1\u53d1\u9001\u670d\u52a1"),(0,l.kt)("h2",{id:"1-\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u4ecb\u7ecd"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_1-%E7%9F%AD%E4%BF%A1%E5%8F%91%E9%80%81%E6%9C%8D%E5%8A%A1%E4%BB%8B%E7%BB%8D"},"#"),"1. \u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u4ecb\u7ecd"),(0,l.kt)("p",null,"\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u7684\u4f5c\u7528\u5c31\u662f\u4ece\u6d88\u606f\u7f13\u51b2\u533a\u83b7\u53d6\u6d88\u606f\u5e76\u548c\u5177\u4f53\u7684\u77ed\u4fe1\u901a\u9053(\u4f8b\u5982\uff1a\u963f\u91cc\u4e91\u77ed\u4fe1\u3001\u68a6\u7f51\u77ed\u4fe1\u3001\u4e50\u4fe1\u77ed\u4fe1\u7b49)\u5bf9\u63a5\u6765\u53d1\u9001\u77ed\u4fe1\u3002"),(0,l.kt)("p",null,"\u52a8\u529b\u77ed\u4fe1\u77ed\u4fe1\u5e73\u53f0\u6574\u4f53\u67b6\u6784\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210924192730206-3ec853e0.png",alt:"image-20210924192730206"}),"image-20210924192730206"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u53d1\u9001\u77ed\u4fe1\uff1a\u5b9e\u65f6\u53d1\u9001\u3001\u5b9a\u65f6\u53d1\u9001"),(0,l.kt)("li",{parentName:"ul"},"\u901a\u9053\u964d\u7ea7\uff1a\u901a\u9053\u53d1\u9001\u5931\u8d25\uff0c\u9009\u62e9\u4e0b\u4e00\u901a\u9053\u53d1\u9001\u77ed\u4fe1"),(0,l.kt)("li",{parentName:"ul"},"\u901a\u9053\u9009\u4e3e\uff1a\u540c\u4e00\u901a\u9053\u591a\u6b21\u53d1\u9001\u5931\u8d25\uff0c\u964d\u7ea7\u901a\u9053"),(0,l.kt)("li",{parentName:"ul"},"\u670d\u52a1\u6ce8\u518c\uff1a\u6709\u4e14\u53ea\u6709\u4e00\u53f0\u673a\u5668\u6267\u884c\u901a\u9053\u9009\u4e3e")),(0,l.kt)("h2",{id:"2-redis\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-redis%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81"},"#"),"2. Redis\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501"),(0,l.kt)("p",null,"\u5bf9\u4e8e\u7b80\u5355\u7684\u5355\u4f53\u9879\u76ee\uff0c\u5373\u8fd0\u884c\u65f6\u7a0b\u5e8f\u5728\u540c\u4e00\u4e2aJava\u865a\u62df\u673a\u4e2d\uff0c\u4f7f\u7528Java\u7684\u9501\u673a\u5236\uff08synchronized\u6216\u8005ReentrantLock\uff09\u53ef\u4ee5\u89e3\u51b3\u591a\u7ebf\u7a0b\u5e76\u53d1\u95ee\u9898\u3002"),(0,l.kt)("p",null,"\u53ef\u4ee5\u8fd0\u884c",(0,l.kt)("inlineCode",{parentName:"p"},"\u8d44\u6599/redis-lock-demo"),"\u6765\u91cd\u73b0\u7ebf\u7a0b\u5e76\u53d1\u95ee\u9898\u3002"),(0,l.kt)("p",null,"\u6d4b\u8bd5\u8fc7\u7a0b\uff1a"),(0,l.kt)("p",null,"\u7b2c\u4e00\u6b65\uff1a\u542f\u52a8redis-lock-demo\u670d\u52a1"),(0,l.kt)("p",null,"\u7b2c\u4e8c\u6b65\uff1a\u8bbe\u7f6eredis\u4e2d\u5e93\u5b58stock\u503c\u4e3a100"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210925110700603-21e4920b.png",alt:"image-20210925110700603"}),"image-20210925110700603"),(0,l.kt)("p",null,"\u7b2c\u4e09\u6b65\uff1a\u4f7f\u7528apache jmeter\u8fdb\u884c\u538b\u529b\u6d4b\u8bd5"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210925110733847-2c796dcb.png",alt:"image-20210925110733847"}),"image-20210925110733847"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210925110744160-4fdcd282.png",alt:"image-20210925110744160"}),"image-20210925110744160"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"\u6ce8\uff1aApache JMeter\u662fApache\u7ec4\u7ec7\u5f00\u53d1\u7684\u57fa\u4e8eJava\u7684\u538b\u529b\u6d4b\u8bd5\u5de5\u5177\u3002\u7528\u4e8e\u5bf9\u8f6f\u4ef6\u505a\u538b\u529b\u6d4b\u8bd5\uff0c\u5b83\u6700\u521d\u88ab\u8bbe\u8ba1\u7528\u4e8eWeb\u5e94\u7528\u6d4b\u8bd5\uff0c\u4f46\u540e\u6765\u6269\u5c55\u5230\u5176\u4ed6\u6d4b\u8bd5\u9886\u57df\u3002\n")),(0,l.kt)("p",null,"\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e\u5355\u5b9e\u4f8b\u7684\u5e94\u7528\u6765\u8bf4\uff0c\u4f7f\u7528Java\u9501\u673a\u5236\u5c31\u53ef\u4ee5\u89e3\u51b3\u7ebf\u7a0b\u5e76\u53d1\u95ee\u9898\u3002"),(0,l.kt)("p",null,"\u4f46\u662f\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\uff0c\u7a0b\u5e8f\u662f\u96c6\u7fa4\u65b9\u5f0f\u90e8\u7f72\uff0c\u5982\u4e0b\u56fe\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210925114905838-f1702291.png",alt:"image-20210925114905838"}),"image-20210925114905838"),(0,l.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7\u542f\u52a8\u4e24\u4e2a\u670d\u52a1\u5b9e\u4f8b\u6765\u6d4b\u8bd5\u96c6\u7fa4\u90e8\u7f72\u65f6\u7ebf\u7a0b\u5e76\u53d1\u95ee\u9898\uff0c\u5177\u4f53\u6d4b\u8bd5\u6b65\u9aa4\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,"\u7b2c\u4e00\u6b65\uff1a\u5206\u522b\u542f\u52a8\u4e24\u4e2aredis-lock-demo\u670d\u52a1\u5b9e\u4f8b\uff0c\u7aef\u53e3\u53f7\u5206\u522b\u4e3a8001\u548c8002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210925113940599-a3eb3342.png",alt:"image-20210925113940599"}),"image-20210925113940599"),(0,l.kt)("p",null,"\u7b2c\u4e8c\u6b65\uff1a\u914d\u7f6eNginx\u8d1f\u8f7d\u5747\u8861\uff0c\u901a\u8fc7Nginx\u5c06\u538b\u529b\u5206\u53d1\u5230\u4e24\u4e2a\u5b9e\u4f8b\u4e0a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"upstream upstream_name{\n    server 127.0.0.1:8001;\n    server 127.0.0.1:8002;\n}\n\nserver {\n    listen       8080;\n    server_name  localhost;\n\n    location / {\n        proxy_pass http://upstream_name;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n}\n")),(0,l.kt)("p",null,"\u7b2c\u4e09\u6b65\uff1a\u4f7f\u7528Apache jmeter\u8fdb\u884c\u538b\u529b\u6d4b\u8bd5"),(0,l.kt)("p",null,"\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e\u96c6\u7fa4\u73af\u5883\u4e0b\u7684\u591a\u4e2a\u670d\u52a1\u5b9e\u4f8b\u53c8\u4ea7\u751f\u4e86\u7ebf\u7a0b\u5e76\u53d1\u95ee\u9898\u3002"),(0,l.kt)("p",null,"\u4e0a\u9762\u7684\u96c6\u7fa4\u90e8\u7f72\u65b9\u5f0f\u4f9d\u7136\u4f1a\u4ea7\u751f\u7ebf\u7a0b\u5e76\u53d1\u95ee\u9898\uff0c\u56e0\u4e3asynchronized\u3001ReentrantLock\u53ea\u662fjvm\u7ea7\u522b\u7684\u52a0\u9501\uff0c\u6ca1\u6709\u529e\u6cd5\u63a7\u5236\u5176\u4ed6jvm\u3002\u4e5f\u5c31\u662f\u4e0a\u9762\u4e24\u4e2atomcat\u5b9e\u4f8b\u8fd8\u662f\u53ef\u4ee5\u51fa\u73b0\u5e76\u53d1\u6267\u884c\u7684\u60c5\u51b5\u3002\u8981\u89e3\u51b3\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u7684\u5e76\u53d1\u95ee\u9898\uff0c\u5219\u5fc5\u987b\u4f7f\u7528\u5206\u5e03\u5f0f\u9501\u3002"),(0,l.kt)("p",null,"\u5206\u5e03\u5f0f\u9501\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a\u63a7\u5236\u5206\u5e03\u5f0f\u7cfb\u7edf\u6709\u5e8f\u7684\u53bb\u5bf9\u5171\u4eab\u8d44\u6e90\u8fdb\u884c\u64cd\u4f5c\uff0c\u901a\u8fc7\u4e92\u65a5\u6765\u4fdd\u8bc1\u6570\u636e\u7684\u4e00\u81f4\u6027\u3002"),(0,l.kt)("p",null,"\u5206\u5e03\u5f0f\u9501\uff0c\u662f\u63a7\u5236\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e4b\u95f4\u540c\u6b65\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u7684\u4e00\u79cd\u65b9\u5f0f\u3002\u5982\u679c\u4e0d\u540c\u7684\u7cfb\u7edf\u6216\u662f\u540c\u4e00\u4e2a\u7cfb\u7edf\u7684\u4e0d\u540c\u4e3b\u673a\u4e4b\u95f4\u5171\u4eab\u4e86\u4e00\u4e2a\u6216\u4e00\u7ec4\u8d44\u6e90\uff0c\u90a3\u4e48\u8bbf\u95ee\u8fd9\u4e9b\u8d44\u6e90\u7684\u65f6\u5019\uff0c\u5f80\u5f80\u9700\u8981\u4e92\u65a5\u6765\u9632\u6b62\u5f7c\u6b64\u5e72\u6270\u6765\u4fdd\u8bc1\u4e00\u81f4\u6027\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4fbf\u9700\u8981\u4f7f\u7528\u5230\u5206\u5e03\u5f0f\u9501\u3002"),(0,l.kt)("p",null,"\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501\u7684\u65b9\u5f0f\u5f88\u591a\uff0c\u4f8b\u5982\uff1aRedis\u3001\u6570\u636e\u5e93\u3001Zookeeper\u7b49\u3002"),(0,l.kt)("p",null,"\u672c\u5c0f\u8282\u4e3b\u8981\u8bb2Redis\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501\u7684\u65b9\u5f0f\u3002"),(0,l.kt)("h3",{id:"21-setnx"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-1-setnx"},"#"),"2.1 SETNX"),(0,l.kt)("p",null,"\u8fd9\u79cd\u52a0\u9501\u7684\u601d\u8def\u662f\uff0c\u5982\u679c key \u4e0d\u5b58\u5728\u5219\u4e3a key \u8bbe\u7f6e value\uff0c\u5982\u679c key \u5df2\u5b58\u5728\u5219 SETNX \u547d\u4ee4\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aefA\u8bf7\u6c42\u670d\u52a1\u5668\u8bbe\u7f6ekey\u7684\u503c\uff0c\u5982\u679c\u8bbe\u7f6e\u6210\u529f\u5c31\u8868\u793a\u52a0\u9501\u6210\u529f mykey->myvalue"),(0,l.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aefB\u4e5f\u53bb\u8bf7\u6c42\u670d\u52a1\u5668\u8bbe\u7f6ekey\u7684\u503c\uff0c\u5982\u679c\u8fd4\u56de\u5931\u8d25\uff0c\u90a3\u4e48\u5c31\u4ee3\u8868\u52a0\u9501\u5931\u8d25 mykey->myvalue"),(0,l.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aefA\u6267\u884c\u4ee3\u7801\u5b8c\u6210\uff0c\u5220\u9664\u9501"),(0,l.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aefB\u5728\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\u540e\u518d\u53bb\u8bf7\u6c42\u8bbe\u7f6ekey\u7684\u503c\uff0c\u8bbe\u7f6e\u6210\u529f mykey->myvalue"),(0,l.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aefB\u6267\u884c\u4ee3\u7801\u5b8c\u6210\uff0c\u5220\u9664\u9501")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u683c\u5f0f"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"#\u5c1d\u8bd5\u83b7\u53d6\u9501\n127.0.0.1:6379> SETNX key value\n#\u8bbe\u7f6e\u9501\u8fc7\u671f\u65f6\u95f4\n127.0.0.1:6379> EXPIRE key seconds\n#\u5220\u9664\u9501\n127.0.0.1:6379> DEL key\n")),(0,l.kt)("p",null,"\u4e3a\u4ec0\u4e48\u8981\u8bbe\u7f6ekey\u8fc7\u671f\u65f6\u95f4\u5462\uff1f"),(0,l.kt)("p",null,"\u5982\u679c\u67d0\u4e2a\u5ba2\u6237\u7aef\u83b7\u5f97\u9501\u540e\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u610f\u5916\u9000\u51fa\u4e86\uff0c\u5bfc\u81f4\u521b\u5efa\u4e86\u9501\u4f46\u662f\u6ca1\u6709\u6765\u5f97\u53ca\u5220\u9664\u9501\uff0c\u90a3\u4e48\u8fd9\u4e2a\u9501\u5c06\u4e00\u76f4\u5b58\u5728\uff0c\u540e\u9762\u6240\u6709\u7684\u5ba2\u6237\u7aef\u90fd\u65e0\u6cd5\u518d\u83b7\u5f97\u9501\uff0c\u6240\u4ee5\u5fc5\u987b\u8981\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u3002"),(0,l.kt)("h3",{id:"22-set"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-2-set"},"#"),"2.2 SET"),(0,l.kt)("p",null,"\u901a\u8fc7\u524d\u9762\u7684expire\u547d\u4ee4\u6765\u8bbe\u7f6e\u9501\u8fc7\u671f\u65f6\u95f4\u8fd8\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662fSETNX\u548cEXPIRE\u4e24\u4e2a\u547d\u4ee4\u4e0d\u662f\u539f\u5b50\u6027\u64cd\u4f5c\u3002\u5728\u6781\u7aef\u60c5\u51b5\u4e0b\u53ef\u80fd\u4f1a\u51fa\u73b0\u83b7\u53d6\u9501\u540e\u8fd8\u6ca1\u6765\u5f97\u53ca\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7a0b\u5e8f\u5c31\u6302\u6389\u4e86\uff0c\u8fd9\u6837\u5c31\u53c8\u51fa\u73b0\u4e86\u9501\u4e00\u76f4\u5b58\u5728\uff0c\u540e\u9762\u6240\u6709\u7684\u5ba2\u6237\u7aef\u90fd\u65e0\u6cd5\u518d\u83b7\u5f97\u9501\u7684\u95ee\u9898\u3002"),(0,l.kt)("p",null,"\u5982\u4f55\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1f\u7b54\u6848\u662f\u4f7f\u7528SET\u547d\u4ee4\u3002"),(0,l.kt)("p",null,"SET \u547d\u4ee4\u4eceRedis 2.6.12 \u7248\u672c\u5f00\u59cb\u5305\u542b\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u7684\u529f\u80fd\uff0c\u8fd9\u6837\u83b7\u53d6\u9501\u548c\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u5c31\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\u4e86\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u683c\u5f0f"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"SET key value [EX seconds] [NX]\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u793a\u4f8b"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"127.0.0.1:6379> SET mykey myvalue EX 5 NX\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"EX seconds \uff1a\u5c06\u952e\u7684\u8fc7\u671f\u65f6\u95f4\u8bbe\u7f6e\u4e3a seconds \u79d2"),(0,l.kt)("li",{parentName:"ul"},"NX \uff1a\u53ea\u5728key\u4e0d\u5b58\u5728\u65f6\u624d\u5bf9\u952e\u8fdb\u884c\u8bbe\u7f6e\u64cd\u4f5c")),(0,l.kt)("h3",{id:"23-\u4ee3\u7801\u5b9e\u73b0"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_2-3-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"},"#"),"2.3 \u4ee3\u7801\u5b9e\u73b0"),(0,l.kt)("p",null,"\u57fa\u4e8eredis\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},' @Autowired\n    RedisLock redisLock;\n\n    //\u4f7f\u7528redis\u5206\u5e03\u5f0f\u9501\uff0c\u65e0\u963b\u585e\n    @GetMapping("/stock3")\n    public String stock3() {\n        String mylock = redisLock.tryLock("MYLOCK", 2000);\n        if(mylock!=null){\n            int stock = Integer.parseInt(stringRedisTemplate.opsForValue().get("stock"));\n            if (stock > 0) {\n                stock--;\n                //\u653e\u56deredis\n                stringRedisTemplate.opsForValue().set("stock", stock + "");\n                System.out.println("\u51cf\u5e93\u5b58\u6210\u529f\uff0c\u5269\u4f59\u5e93\u5b58\u662f\uff1a" + stock);\n            } else {\n                System.out.println("\u5e93\u5b58\u4e0d\u8db3\u4e86\uff01");\n            }\n\n            redisLock.unlock("MYLOCK",mylock);\n        }\n        return "OK";\n    }\n\n    //\u4f7f\u7528redis\u5206\u5e03\u5f0f\u9501\uff0c\u6709\u963b\u585e\n    @GetMapping("/stock4")\n    public String stock4() {\n        String mylock = redisLock.lock("MYLOCK", 2000,1000);\n        if(mylock!=null){\n            int stock = Integer.parseInt(stringRedisTemplate.opsForValue().get("stock"));\n            if (stock > 0) {\n                stock--;\n                //\u653e\u56deredis\n                stringRedisTemplate.opsForValue().set("stock", stock + "");\n                System.out.println("\u51cf\u5e93\u5b58\u6210\u529f\uff0c\u5269\u4f59\u5e93\u5b58\u662f\uff1a" + stock);\n            } else {\n                System.out.println("\u5e93\u5b58\u4e0d\u8db3\u4e86\uff01");\n            }\n\n            redisLock.unlock("MYLOCK",mylock);\n        }\n        return "OK";\n    }\n')),(0,l.kt)("h2",{id:"3-spring-task\u5b9a\u65f6\u4efb\u52a1"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-spring-task%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"},"#"),"3. Spring Task\u5b9a\u65f6\u4efb\u52a1"),(0,l.kt)("h3",{id:"31-spring-task\u4ecb\u7ecd"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-1-spring-task%E4%BB%8B%E7%BB%8D"},"#"),"3.1 Spring Task\u4ecb\u7ecd"),(0,l.kt)("p",null,"\u5728\u4f01\u4e1a\u8f6f\u4ef6\u5f00\u53d1\u4e2d\u7ecf\u5e38\u4f1a\u9047\u5230\u5b9a\u65f6\u4efb\u52a1\u5904\u7406\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u4f8b\u5982\u94f6\u884c\u7cfb\u7edf\u6bcf\u665a\u4f1a\u5b9a\u65f6\u6267\u884c\u5bf9\u8d26\u4e1a\u52a1\uff0c\u5f88\u591a\u7cfb\u7edf\u6bcf\u665a\u90fd\u4f1a\u5b9a\u65f6\u6267\u884c\u6570\u636e\u5907\u4efd\u7b49\u7b49\u3002"),(0,l.kt)("p",null,"\u5b9a\u65f6\u4efb\u52a1\u7684\u5b9e\u73b0\u65b9\u6848\u6709\u5f88\u591a\uff0c\u4f8b\u5982\uff1aQuartz\u3001Spring Task\u3001XXL job\u7b49\u3002\u5bf9\u4e8e\u7b80\u5355\u7684\u5e94\u7528\u573a\u666f\u53ef\u4ee5\u4f7f\u7528Spring Task\u3002Spring Task\u76f8\u5173API\u5728spring-context\u5305\u4e2d\u5df2\u7ecf\u63d0\u4f9b\u4e86\uff0c\u4e0d\u9700\u8981\u989d\u5916\u5bfc\u5165\u5176\u4ed6jar\u5305\u3002"),(0,l.kt)("h3",{id:"32-\u4ee3\u7801\u6848\u4f8b"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_3-2-%E4%BB%A3%E7%A0%81%E6%A1%88%E4%BE%8B"},"#"),"3.2 \u4ee3\u7801\u6848\u4f8b"),(0,l.kt)("p",null,"\u5728Spring Boot\u9879\u76ee\u4e2d\u4f7f\u7528Spring Task\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5728Bean\u7684\u65b9\u6cd5\u4e0a\u52a0\u5165@Scheduled\u6ce8\u89e3\uff0c\u5e76\u901a\u8fc7cron\u8868\u8fbe\u5f0f\u6307\u5b9a\u89e6\u53d1\u7684\u65f6\u95f4\u5373\u53ef\u3002"),(0,l.kt)("p",null,"\u7b2c\u4e00\u6b65\uff1a\u5728\u542f\u52a8\u7c7b\u4e0a\u52a0\u5165@EnableScheduling\u6ce8\u89e3"),(0,l.kt)("p",null,"\u7b2c\u4e8c\u6b65\uff1a\u7f16\u5199\u5b9a\u65f6\u4efb\u52a1\u7c7b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.itheima.job;\n\nimport org.springframework.scheduling.annotation.Scheduled;\nimport org.springframework.stereotype.Component;\n\nimport java.util.Date;\n\n@Component\npublic class DemoJob {\n\n\n    @Scheduled(cron = "0/5 * * * * ?")\n    public void testJob() {\n        System.out.println("\u73b0\u5728\u65f6\u95f4\u662f" + new Date());\n    }\n\n}\n')),(0,l.kt)("h2",{id:"4-\u77ed\u4fe1\u53d1\u9001\u670d\u52a1"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_4-%E7%9F%AD%E4%BF%A1%E5%8F%91%E9%80%81%E6%9C%8D%E5%8A%A1"},"#"),"4. \u77ed\u4fe1\u53d1\u9001\u670d\u52a1"),(0,l.kt)("h3",{id:"41-\u9700\u6c42\u5206\u6790"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_4-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"},"#"),"4.1 \u9700\u6c42\u5206\u6790"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u529f\u80fd\u9700\u6c42\uff1a")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u548c\u5177\u4f53\u7684\u77ed\u4fe1\u901a\u9053\u5bf9\u63a5\uff08\u4f8b\u5982\uff1a\u963f\u91cc\u4e91\u77ed\u4fe1\u3001\u68a6\u7f51\u77ed\u4fe1\u7b49\uff09\uff0c\u53d1\u9001\u77ed\u4fe1"),(0,l.kt)("li",{parentName:"ul"},"\u77ed\u4fe1\u5b9a\u65f6\u53d1\u9001"),(0,l.kt)("li",{parentName:"ul"},"\u77ed\u4fe1\u5b9e\u65f6\u53d1\u9001"),(0,l.kt)("li",{parentName:"ul"},"\u670d\u52a1\u6ce8\u518c\uff0c\u4fdd\u8bc1\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u9ad8\u53ef\u7528"),(0,l.kt)("li",{parentName:"ul"},"\u901a\u9053\u81ea\u52a8\u9009\u4e3e\u3001\u964d\u7ea7")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5904\u7406\u8fc7\u7a0b\uff1a")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210925174705923-00994348.png",alt:"image-20210925174705923"}),"image-20210925174705923"),(0,l.kt)("h3",{id:"42-\u9879\u76ee\u7ed3\u6784"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_4-2-%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"},"#"),"4.2 \u9879\u76ee\u7ed3\u6784"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210925165514680-59fef8a7.png",alt:"image-20210925165514680"}),"image-20210925165514680"),(0,l.kt)("h3",{id:"43-\u6838\u5fc3\u4ee3\u7801"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_4-3-%E6%A0%B8%E5%BF%83%E4%BB%A3%E7%A0%81"},"#"),"4.3 \u6838\u5fc3\u4ee3\u7801"),(0,l.kt)("p",null,"\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u6838\u5fc3\u7c7b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"ServerRegister\uff1a\u670d\u52a1\u6ce8\u518c\u5668\uff0c\u7528\u4e8e\u5c06\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u6ce8\u518c\u5230Redis\u4e2d\uff0c\u5b9a\u65f6\u670d\u52a1\u4e0a\u62a5\uff0c\u5b9a\u65f6\u670d\u52a1\u68c0\u67e5"),(0,l.kt)("li",{parentName:"ul"},"ConfigServiceImpl\uff1a\u901a\u9053\u914d\u7f6e\u5668\uff0c\u7528\u4e8e\u67e5\u8be2\u53ef\u7528\u901a\u9053\uff08\u963f\u91cc\u77ed\u4fe1\u3001\u534e\u4e3a\u77ed\u4fe1\u7b49\uff09\uff0c\u901a\u9053\u9009\u4e3e\u3001\u964d\u7ea7"),(0,l.kt)("li",{parentName:"ul"},"AbstractSmsService\uff1a\u77ed\u4fe1\u53d1\u9001\u5668\u62bd\u8c61\u7236\u7c7b\uff0c\u5b50\u7c7b\u9700\u8981\u548c\u5177\u4f53\u7684\u77ed\u4fe1\u901a\u9053\u5bf9\u63a5\u6765\u5b8c\u6210\u53d1\u9001\u77ed\u4fe1\u7684\u5de5\u4f5c"),(0,l.kt)("li",{parentName:"ul"},"SmsConnectLoader\uff1a\u901a\u9053\u5b9e\u4f8b\u52a0\u8f7d\u5668\uff0c\u6839\u636e\u901a\u9053\u914d\u7f6e\uff0c\u521d\u59cb\u5316\u6bcf\u4e2a\u901a\u9053\u7684Bean\u5bf9\u8c61"),(0,l.kt)("li",{parentName:"ul"},"SmsFactory\uff1a\u77ed\u4fe1\u53d1\u9001\u5de5\u5382\uff0c\u83b7\u53d6\u5177\u4f53\u7684\u901a\u9053\u5b9e\u4f8bBean\u5bf9\u8c61\uff08\u4f8b\u5982AliyunSmsService\uff09\u6765\u53d1\u9001\u77ed\u4fe1\uff0c \u5982\u679c\u53d1\u9001\u51fa\u73b0\u5f02\u5e38\uff0c\u89e6\u53d1\u901a\u9053\u9009\u4e3e\u548c\u901a\u9053\u964d\u7ea7\u7b56\u7565"),(0,l.kt)("li",{parentName:"ul"},"SendTimingSmsImpl\uff1a\u5b9a\u65f6\u77ed\u4fe1\u4e1a\u52a1\u5904\u7406\u5668\uff0c\u5177\u4f53\u8d1f\u8d23\u5b9a\u65f6\u77ed\u4fe1\u7684\u53d1\u9001"),(0,l.kt)("li",{parentName:"ul"},"SendSmsJob\uff1a\u77ed\u4fe1\u53d1\u9001\u5b9a\u65f6\u4efb\u52a1\uff0c\u7528\u4e8e\u5b9a\u65f6\u77ed\u4fe1\u7684\u53d1\u9001\uff0c\u8c03\u7528SendTimingSmsImpl\u53d1\u9001\u5b9a\u65f6\u77ed\u4fe1"),(0,l.kt)("li",{parentName:"ul"},"GeneralSmsListener\u3001HighSmsListener\uff1a\u77ed\u4fe1\u63a5\u6536\u5668\uff0cRedis\u961f\u5217\u7684\u6d88\u8d39\u8005\uff0c\u76d1\u542c\u961f\u5217\u4e2d\u7684\u6d88\u606f\uff0c\u5982\u679c\u6709\u6d88\u606f\u5219\u8c03\u7528SmsFactory\u53d1\u9001\u5b9e\u65f6\u77ed\u4fe1"),(0,l.kt)("li",{parentName:"ul"},"HighServerReceiver\uff1a\u901a\u9053\u6d88\u606f\u76d1\u542c\u5668\uff0c\u901a\u8fc7Redis\u7684\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\u76d1\u542c\u901a\u9053\u76f8\u5173\u6d88\u606f\uff0c\u8c03\u7528SmsConnectLoader\u521d\u59cb\u5316\u901a\u9053\u548c\u66f4\u65b0\u901a\u9053"),(0,l.kt)("li",{parentName:"ul"},"SubscriberConfig\uff1a\u8ba2\u9605\u53d1\u5e03\u6a21\u5f0f\u7684\u5bb9\u5668\u914d\u7f6e\uff0c\u521b\u5efa\u6d88\u606f\u76d1\u542c\u5bb9\u5668\uff0c\u5e76\u5c06HighServerReceiver\u52a0\u5165\u5bb9\u5668\u4e2d")),(0,l.kt)("h3",{id:"44-\u529f\u80fd\u5b9e\u73b0"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_4-4-%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"},"#"),"4.4 \u529f\u80fd\u5b9e\u73b0"),(0,l.kt)("h4",{id:"441-\u670d\u52a1\u6ce8\u518c\u5668"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_4-4-1-%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%99%A8"},"#"),"4.4.1 \u670d\u52a1\u6ce8\u518c\u5668"),(0,l.kt)("p",null,"\u670d\u52a1\u6ce8\u518c\u5668\u5bf9\u5e94\u7684\u4e3aServerRegister\u7c7b\u3002"),(0,l.kt)("p",null,"\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u652f\u6301\u5206\u5e03\u5f0f\u96c6\u7fa4\u90e8\u7f72\uff0c\u53ef\u4ee5\u662f\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5b9e\u4f8b\u8d8a\u591a\uff0c\u53d1\u9001\u77ed\u4fe1\u7684\u80fd\u529b\u8d8a\u5f3a\u3002\u4f46\u662f\u5bf9\u4e8e\u901a\u9053\u9009\u4e3e\u3001\u6301\u4e45\u5316\u901a\u9053\u7b49\u64cd\u4f5c\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u670d\u52a1\u5b9e\u4f8b\u6267\u884c\uff0c\u5176\u4ed6\u670d\u52a1\u5b9e\u4f8b\u901a\u8fc7redis\u7684\u5e7f\u64ad\u673a\u5236\u83b7\u5f97\u901a\u9053\u53d8\u5316\u3002"),(0,l.kt)("p",null,"\u5982\u679c\u8981\u5b9e\u73b0\u8fd9\u4e00\u529f\u80fd\uff0c\u9700\u8981\u5c06\u6240\u6709\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u5b9e\u4f8b\u6ce8\u518c\u5230\u67d0\u4e2a\u5730\u65b9\uff0c\u5f53\u524d\u5b9e\u73b0\u662f\u5c06\u6240\u6709\u670d\u52a1\u5b9e\u4f8b\u6ce8\u518c\u5230Redis\u4e2d\u3002\u5e76\u4e14\u4e3a\u4e86\u80fd\u591f\u76d1\u63a7\u6bcf\u4e2a\u670d\u52a1\u5b9e\u4f8b\u8fd0\u884c\u72b6\u6001\uff0c\u9700\u8981\u6bcf\u4e2a\u670d\u52a1\u5b9e\u4f8b\u5b9a\u65f6\u4e0a\u62a5\u5e76\u4e14\u5b9a\u65f6\u8fdb\u884c\u670d\u52a1\u68c0\u67e5\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4e1a\u52a1\u903b\u8f91\uff1a")),(0,l.kt)("p",null,"1\u3001\u670d\u52a1\u6ce8\u518c\uff0c\u9879\u76ee\u542f\u52a8\u65f6\u5c06\u5f53\u524d\u670d\u52a1\u5b9e\u4f8bid\u6ce8\u518c\u5230redis"),(0,l.kt)("p",null,"2\u3001\u670d\u52a1\u4e0a\u62a5\uff0c\u6bcf\u4e09\u5206\u949f\u62a5\u544a\u4e00\u6b21\uff0c\u5e76\u4f20\u5165\u5f53\u524d\u65f6\u95f4\u6233"),(0,l.kt)("p",null,"3\u3001\u670d\u52a1\u68c0\u67e5\uff0c\u6bcf\u5341\u5206\u949f\u68c0\u67e5\u4e00\u6b21\u670d\u52a1\u5217\u8868\uff0c\u6e05\u7a7a\u8d85\u8fc7\u4e94\u5206\u949f\u6ca1\u6709\u62a5\u544a\u7684\u670d\u52a1"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4ee3\u7801\u5b9e\u73b0\uff1a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.sms.factory;\n\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.CommandLineRunner;\nimport org.springframework.core.annotation.Order;\nimport org.springframework.data.redis.core.RedisTemplate;\nimport org.springframework.data.redis.core.StringRedisTemplate;\nimport org.springframework.scheduling.annotation.Scheduled;\nimport org.springframework.stereotype.Component;\n\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.UUID;\n\n/**\n * \u670d\u52a1\u6ce8\u518c\u5668\uff0c\u5c06\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u6ce8\u518c\u5230Redis\u4e2d\uff0c\u5b9a\u65f6\u670d\u52a1\u4e0a\u62a5\uff0c\u5b9a\u65f6\u670d\u52a1\u68c0\u67e5\n */\n@Component\n@Slf4j\n@Order(value = 100)\npublic class ServerRegister implements CommandLineRunner {\n    //\u5f53\u524d\u670d\u52a1\u5b9e\u4f8b\u7684\u552f\u4e00\u6807\u8bc6\uff0c\u53ef\u4ee5\u4f7f\u7528UUID\u968f\u673a\u751f\u6210\n    public static String SERVER_ID = null;\n\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n\n    /**\n     * \u9879\u76ee\u542f\u52a8\u65f6\u81ea\u52a8\u6267\u884c\u6b64\u65b9\u6cd5\uff0c\u5c06\u5f53\u524d\u670d\u52a1\u5b9e\u4f8b\u6ce8\u518c\u5230redis\n     *\n     * @param args\n     */\n    @Override\n    public void run(String... args) {\n        //TODO \u670d\u52a1\u6ce8\u518c\u5668\uff0c\u9879\u76ee\u542f\u52a8\u65f6\u5c06\u5f53\u524d\u670d\u52a1id\u6ce8\u518c\u5230Redis\u4e2d\uff0c\u4f7f\u7528Redis\u7684Hash\u7ed3\u6784\uff0ckey\u4e3aSERVER_ID_HASH\uff0cHash\u7ed3\u6784\u7684key\u4e3a\u670d\u52a1id\uff0cvalue\u4e3a\u65f6\u95f4\u6233\n        // SERVER_ID_HASH   key  value\n        SERVER_ID = UUID.randomUUID().toString(); //\u5f53\u524d\u5b9e\u4f8bkey\n        log.info("server\u5b9e\u4f8b\u542f\u52a8\uff0c\u751f\u6210\u7684id:{}", SERVER_ID);\n        redisTemplate.opsForHash().put("SERVER_ID_HASH", SERVER_ID, System.currentTimeMillis());\n    }\n\n    /**\n     * \u5b9a\u65f6\u670d\u52a1\u62a5\u544a\n     * \u62a5\u544a\u670d\u52a1\u4fe1\u606f\u8bc1\u660e\u670d\u52a1\u5b58\u5728 \u6bcf\u4e09\u5206\u949f\u62a5\u544a\u4e00\u6b21\uff0c\u5e76\u4f20\u5165\u5f53\u524d\u65f6\u95f4\u6233\n     */\n    @Scheduled(cron = "1 1/3 * * * ?")\n    public void serverReport() {\n        //TODO \u670d\u52a1\u6ce8\u518c\u5668\uff0c\u6bcf\u4e09\u5206\u949f\u62a5\u544a\u4e00\u6b21\uff0c\u5e76\u4f20\u5165\u5f53\u524d\u65f6\u95f4\u6233\n\n        log.info("\u670d\u52a1\u5b9a\u65f6\u4e0a\u62a5\u3002id:{}",SERVER_ID);\n        redisTemplate.opsForHash().put("SERVER_ID_HASH", SERVER_ID, System.currentTimeMillis());\n    }\n\n    /**\n     * \u5b9a\u65f6\u670d\u52a1\u68c0\u67e5\n     * \u6bcf\u5341\u5206\u949f\u68c0\u67e5\u4e00\u6b21\u670d\u52a1\u5217\u8868\uff0c\u6e05\u7a7a\u8d85\u8fc7\u4e94\u5206\u949f\u6ca1\u6709\u62a5\u544a\u7684\u670d\u52a1\n     */\n    @Scheduled(cron = "30 1/10 * * * ?")\n    public void checkServer() {\n        //TODO \u670d\u52a1\u6ce8\u518c\u5668\uff0c\u5b9a\u65f6\u68c0\u67e5redis,\u6bcf\u969410\u5206\u949f\u67e5\u770b\uff0c\u8d85\u8fc75\u5206\u949f\u8fd8\u6ca1\u4e0a\u62a5\u81ea\u5df1\u4fe1\u606f\u7684\u670d\u52a1\uff0c\u6e05\u9664\u6389\n        log.info("\u5b9a\u65f6\u670d\u52a1\u68c0\u67e5\u3002id:{}",SERVER_ID);\n        Map map = redisTemplate.opsForHash().entries("SERVER_ID_HASH");\n        log.info("\u5f53\u524d\u670d\u52a1\u6709\uff1a"+map);\n\n        long now = System.currentTimeMillis();\n        List removeKeys=new ArrayList(); //\u8be5\u8981\u5220\u9664\u7684key\n        //jdk8 lambda\u8868\u8fbe\u5f0f\n        map.forEach((key,value)->{\n            long registrTime = Long.parseLong(value.toString());\n            if(now-registrTime>(5*60*1000)){\n                removeKeys.add(key);\n            }\n        });\n\n        log.info("\u8be5\u8981\u5220\u9664\u7684key\u6709\uff1a{}",removeKeys);\n        removeKeys.forEach(key->{\n            redisTemplate.opsForHash().delete("SERVER_ID_HASH", key);\n        });\n\n    }\n}\n')),(0,l.kt)("p",null,"\u53ef\u4ee5\u542f\u52a8\u4e24\u4e2a\u670d\u52a1\u5b9e\u4f8b\u6765\u6d4b\u8bd5\u670d\u52a1\u6ce8\u518c\u3001\u670d\u52a1\u4e0a\u62a5\u3001\u670d\u52a1\u68c0\u67e5\u662f\u5426\u80fd\u591f\u6b63\u5e38\u6267\u884c\u3002"),(0,l.kt)("h4",{id:"442-\u901a\u9053\u5b9e\u4f8b\u52a0\u8f7d\u5668"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_4-4-2-%E9%80%9A%E9%81%93%E5%AE%9E%E4%BE%8B%E5%8A%A0%E8%BD%BD%E5%99%A8"},"#"),"4.4.2 \u901a\u9053\u5b9e\u4f8b\u52a0\u8f7d\u5668"),(0,l.kt)("p",null,"\u901a\u9053\u5b9e\u4f8b\u52a0\u8f7d\u5668\u5bf9\u5e94\u7684\u4e3aSmsConnectLoader\u7c7b\u3002"),(0,l.kt)("p",null,"\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u5b58\u5728\u591a\u4e2a\u901a\u9053\uff08\u4f8b\u5982\u963f\u91cc\u4e91\u77ed\u4fe1\u3001\u534e\u4e3a\u4e91\u77ed\u4fe1\u7b49\uff09\uff0c\u8fd9\u4e9b\u901a\u9053\u662f\u901a\u8fc7\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u8bbe\u7f6e\u7684\uff0c\u5305\u62ec\u901a\u9053\u7684\u540d\u79f0\u3001\u7b7e\u540d\u3001\u6a21\u677f\u3001\u8fde\u63a5\u65b9\u5f0f\u7b49\u4fe1\u606f\u3002\u5f53\u77ed\u4fe1\u53d1\u9001\u670d\u52a1\u542f\u52a8\u65f6\uff0c\u6216\u8005\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u8bbe\u7f6e\u901a\u9053\u65f6\uff0c\u5c06\u4f1a\u521d\u59cb\u5316\u77ed\u4fe1\u901a\u9053\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210925180125503-14602673.png",alt:"image-20210925180125503"}),"image-20210925180125503"),(0,l.kt)("p",null,"\u901a\u9053\u5b9e\u4f8b\u52a0\u8f7d\u5668\u7684\u4f5c\u7528\u5c31\u662f\u6839\u636e\u901a\u9053\u914d\u7f6e\uff0c\u521d\u59cb\u5316\u6bcf\u4e2a\u901a\u9053\u7684Bean\u5bf9\u8c61\uff08\u4f8b\u5982AliyunSmsService\u3001MengWangSmsService\u7b49\uff09\u3002"),(0,l.kt)("p",null,"SmsConnectLoader\u7c7b\u4e2d\u53ea\u9700\u8981\u5b9e\u73b0initConnect\u65b9\u6cd5\u5373\u53ef\uff0c\u5176\u4ed6\u65b9\u6cd5\u5df2\u7ecf\u63d0\u4f9b\u597d\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4e1a\u52a1\u903b\u8f91\uff1a")),(0,l.kt)("p",null,"1\u3001\u67e5\u8be2\u6570\u636e\u5e93\u83b7\u5f97\u901a\u9053\u5217\u8868"),(0,l.kt)("p",null,"2\u3001\u904d\u5386\u901a\u9053\u5217\u8868\uff0c\u901a\u8fc7\u53cd\u5c04\u521b\u5efa\u6bcf\u4e2a\u901a\u9053\u7684Bean\u5bf9\u8c61\uff08\u4f8b\u5982AliyunSmsService\u3001MengWangSmsService\u7b49\uff09"),(0,l.kt)("p",null,"3\u3001\u5c06\u6bcf\u4e2a\u901a\u9053\u7684Bean\u5bf9\u8c61\u4fdd\u5b58\u5230CONNECT_LIST\u96c6\u5408\u4e2d"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n     * \u6839\u636e\u901a\u9053\u914d\u7f6e\uff0c\u521d\u59cb\u5316\u6bcf\u4e2a\u901a\u9053\u7684bean\u5bf9\u8c61\n     */\n    @SneakyThrows\n    public void initConnect() {\n        //TODO \u6839\u636e\u901a\u9053\u914d\u7f6e\uff0c\u521d\u59cb\u5316\u6bcf\u4e2a\u901a\u9053\u7684bean\u5bf9\u8c61\n        //1\u3001\u67e5\u8be2\u6570\u636e\u5e93\u83b7\u5f97\u901a\u9053\u5217\u8868\n        List<ConfigEntity> configEntitiesList = configService.listForConnect();\n        List constructorList=new ArrayList();\n        //2\u3001\u904d\u5386\u901a\u9053\u5217\u8868\uff0c\u901a\u8fc7\u53cd\u5c04\u521b\u5efa\u6bcf\u4e2a\u901a\u9053\u7684Bean\u5bf9\u8c61\uff08\u4f8b\u5982AliyunSmsService\u3001MengWangSmsService\u7b49\uff09\n        configEntitiesList.forEach(configEntity->{\n            try {\n                SmsConfig config=new SmsConfig();\n                config.setId(configEntity.getId());\n                config.setDomain(configEntity.getDomain());\n                config.setName(configEntity.getName());\n                config.setPlatform(configEntity.getPlatform().trim());\n                config.setAccessKeyId(configEntity.getAccessKeyId().trim());\n                config.setAccessKeySecret(configEntity.getAccessKeySecret().trim());\n                if(StringUtils.isNotBlank(configEntity.getOther())){\n                    LinkedHashMap linkedHashMap = JSON.parseObject(configEntity.getOther(), LinkedHashMap.class);\n                    config.setOtherConfig(linkedHashMap);\n                }\n\n                //\u53cd\u5c04 \u521b\u5efaService\n                //\u5168\u9650\u5b9a\u540d com.ydl.sms.sms.AliyunSmsService\n                String className="com.ydl.sms.sms."+config.getPlatform()+"SmsService";\n                System.out.println(className);\n\n                Class<?> aClass = Class.forName(className); //\u52a0\u8f7d\u7c7b\n                Constructor<?> constructor = aClass.getConstructor(SmsConfig.class);//\u62ff\u5230\u5177\u4f53\u7684\u6784\u9020\u65b9\u6cd5\n                Object obj = constructor.newInstance(config); //\u521b\u5efa\u5bf9\u8c61\n\n                //\u4ece\u5bb9\u5668\u4e2d\u83b7\u53d6\u7b7e\u540d\u548c\u6a21\u677f\u7684service\n                SignatureService signatureService = SpringUtils.getBean(SignatureService.class);\n                TemplateService templateService = SpringUtils.getBean(TemplateService.class);\n                //\u627e\u5230\u8fd9\u4e24\u4e2aservice\u5728\u7236\u7c7b\u4e2d\u7684\u5c5e\u6027\n                Field signatureServiceField = aClass.getSuperclass().getDeclaredField("signatureService");\n                Field templateServiceField = aClass.getSuperclass().getDeclaredField("templateService");\n                //\u6253\u5f00\u8bbf\u95ee\u6743\u9650\n                signatureServiceField.setAccessible(true);\n                templateServiceField.setAccessible(true);\n                //\u8bbe\u7f6e\u5c5e\u6027\u503c\u4e86\n                signatureServiceField.set(obj,signatureService);\n                templateServiceField.set(obj,templateService);\n\n                constructorList.add(obj);\n\n                log.info("\u521d\u59cb\u5316\u901a\u9053\u6210\u529f\uff1a{}\uff0c{}",config.getName(),config.getPlatform());\n            }catch (Exception e){\n                log.warn("\u521d\u59cb\u5316\u901a\u9053\u5f02\u5e38\uff1a{}",e.getMessage());\n            }\n\n        });\n        //3\u3001\u5c06\u6bcf\u4e2a\u901a\u9053\u7684Bean\u5bf9\u8c61\u4fdd\u5b58\u5230CONNECT_LIST\u96c6\u5408\u4e2d\n        if(!CONNECT_LIST.isEmpty()){\n            CONNECT_LIST.clear();\n        }\n        CONNECT_LIST.addAll(constructorList);\n\n        //\u89e3\u9501\u903b\u8f91\n        if(StringUtils.isNotBlank(BUILD_NEW_CONNECT_TOKEN)){\n            redisLock.unlock("buildNewConnect", BUILD_NEW_CONNECT_TOKEN);\n        }\n\n        log.info("\u901a\u9053\u521d\u59cb\u5316\u5b8c\u6210\u4e86\u3002{}",CONNECT_LIST);\n    }\n')),(0,l.kt)("h4",{id:"443-\u5b9a\u65f6\u77ed\u4fe1\u4e1a\u52a1\u5904\u7406\u5668"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_4-4-3-%E5%AE%9A%E6%97%B6%E7%9F%AD%E4%BF%A1%E4%B8%9A%E5%8A%A1%E5%A4%84%E7%90%86%E5%99%A8"},"#"),"4.4.3 \u5b9a\u65f6\u77ed\u4fe1\u4e1a\u52a1\u5904\u7406\u5668"),(0,l.kt)("p",null,"\u5b9a\u65f6\u77ed\u4fe1\u4e1a\u52a1\u5904\u7406\u5668\u5bf9\u5e94\u7684\u662fSendTimingSmsImpl\u7c7b\uff0c\u5177\u4f53\u8d1f\u8d23\u5b9a\u65f6\u77ed\u4fe1\u7684\u53d1\u9001\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4e1a\u52a1\u903b\u8f91\uff1a")),(0,l.kt)("p",null,"1\u3001\u67e5\u8be2\u6570\u636e\u5e93\u83b7\u53d6\u672c\u6b21\u9700\u8981\u53d1\u9001\u7684\u5b9a\u65f6\u77ed\u4fe1"),(0,l.kt)("p",null,"2\u3001\u8c03\u7528\u77ed\u4fe1\u5de5\u5382\u53d1\u9001\u77ed\u4fe1"),(0,l.kt)("p",null,"3\u3001\u66f4\u65b0\u77ed\u4fe1\u53d1\u9001\u72b6\u6001\u4e3a\u201c\u5df2\u5904\u7406\u201d"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5b9e\u73b0\u4ee3\u7801\uff1a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.sms.job;\n\nimport com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;\nimport com.ydl.sms.entity.TimingPushEntity;\nimport com.ydl.sms.factory.SmsFactory;\nimport com.ydl.sms.mapper.TimingPushMapper;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.scheduling.annotation.Async;\nimport org.springframework.stereotype.Component;\n\nimport java.time.LocalDateTime;\nimport java.util.List;\n/**\n * \u5b9a\u65f6\u77ed\u4fe1\u4e1a\u52a1\u5904\u7406\u5668\n */\n@Component\n@Slf4j\npublic class SendTimingSmsImpl implements SendTimingSms {\n\n    @Autowired\n    private TimingPushMapper timingPushMapper;\n\n    @Autowired\n    private SmsFactory smsFactory;\n\n    /**\n     * \u53d1\u9001\u5b9a\u65f6\u77ed\u4fe1\n     * @param timing\n     */\n    @Override\n    @Async\n    public void execute(String timing) {//timing\u683c\u5f0f\uff1ayyyy-MM-dd HH:mm  2021-12-25 18:00\n        //TODO \u67e5\u8be2\u6570\u636e\u5e93\u83b7\u53d6\u672c\u6b21\u9700\u8981\u53d1\u9001\u7684\u5b9a\u65f6\u77ed\u4fe1\uff0c\u8c03\u7528\u77ed\u4fe1\u5de5\u5382\u53d1\u9001\u77ed\u4fe1\n        //1\u3001\u67e5\u8be2\u6570\u636e\u5e93\u83b7\u53d6\u672c\u6b21\u9700\u8981\u53d1\u9001\u7684\u5b9a\u65f6\u77ed\u4fe1\n        LambdaQueryWrapper<TimingPushEntity> wrapper = new LambdaQueryWrapper<>();\n        wrapper.eq(TimingPushEntity::getStatus,0);\n        wrapper.eq(TimingPushEntity::getTiming,timing);\n        wrapper.orderByAsc(TimingPushEntity::getCreateTime);\n        List<TimingPushEntity> list = timingPushMapper.selectList(wrapper);\n\n        log.info("\u8fd9\u4e00\u6279\u6b21\u8981\u53d1\u7684\u77ed\u4fe1\u6761\u6570\u662f\uff1a{}\uff0c{}",timing,list.size());\n\n        list.forEach(x->{\n            //2\u3001\u8c03\u7528\u77ed\u4fe1\u5de5\u5382\u53d1\u9001\u77ed\u4fe1\n            String request = x.getRequest();\n            smsFactory.send(request);\n            //3\u3001\u66f4\u65b0\u77ed\u4fe1\u53d1\u9001\u72b6\u6001\u4e3a\u201c\u5df2\u5904\u7406\u201d\n            x.setStatus(1);\n            x.setUpdateTime(LocalDateTime.now());\n            x.setUpdateUser("system");\n            timingPushMapper.updateById(x);\n        });\n\n        log.info("\u4efb\u52a1\u6267\u884c\u5b8c\u6bd5"+timing);\n\n    }\n}\n')),(0,l.kt)("h4",{id:"444-\u77ed\u4fe1\u53d1\u9001\u5b9a\u65f6\u4efb\u52a1"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_4-4-4-%E7%9F%AD%E4%BF%A1%E5%8F%91%E9%80%81%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"},"#"),"4.4.4 \u77ed\u4fe1\u53d1\u9001\u5b9a\u65f6\u4efb\u52a1"),(0,l.kt)("p",null,"\u77ed\u4fe1\u53d1\u9001\u5b9a\u65f6\u4efb\u52a1\u5bf9\u5e94\u7684\u662fSendSmsJob\u7c7b\uff0c\u7528\u4e8e\u5b9a\u65f6\u77ed\u4fe1\u7684\u53d1\u9001\uff0c\u8c03\u7528SendTimingSmsImpl\u53d1\u9001\u5b9a\u65f6\u77ed\u4fe1\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4e1a\u52a1\u903b\u8f91\uff1a")),(0,l.kt)("p",null,"1\u3001\u6bcf\u5206\u949f\u89e6\u53d1\u4e00\u6b21\u5b9a\u65f6\u4efb\u52a1"),(0,l.kt)("p",null,"2\u3001\u4e3a\u4e86\u9632\u6b62\u77ed\u4fe1\u91cd\u590d\u53d1\u9001\uff0c\u9700\u8981\u4f7f\u7528\u5206\u5e03\u5f0f\u9501"),(0,l.kt)("p",null,"3\u3001\u8c03\u7528SendTimingSmsImpl\u53d1\u9001\u5b9a\u65f6\u77ed\u4fe1"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4ee3\u7801\u5b9e\u73b0\uff1a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.sms.job;\n\nimport com.ydl.sms.config.RedisLock;\nimport com.ydl.utils.DateUtils;\nimport lombok.extern.slf4j.Slf4j;\nimport org.apache.commons.lang3.StringUtils;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.scheduling.annotation.Scheduled;\nimport org.springframework.stereotype.Component;\nimport java.util.Date;\n\n/**\n * \u5b9a\u65f6\u4efb\u52a1\uff0c\u7528\u4e8e\u53d1\u9001\u5b9a\u65f6\u77ed\u4fe1\n */\n@Component\n@Slf4j\npublic class SendSmsJob {\n\n    @Autowired\n    private SendTimingSms sendTimingSms;\n\n    @Autowired\n    private RedisLock redisLock;\n\n    /**\n     * \u6bcf\u5206\u949f\u68c0\u67e5\u4e00\u6b21\u662f\u5426\u6709\u5b9a\u65f6\u77ed\u4fe1\u9700\u8981\u53d1\u9001\n     * @throws InterruptedException\n     */\n    //1\u3001\u6bcf\u5206\u949f\u89e6\u53d1\u4e00\u6b21\u5b9a\u65f6\u4efb\u52a1\n    @Scheduled(cron = "10 0/1 * * * ?")     //\u6bcf\u5206\u949f\u7684\u7b2c10\u79d2\u6267\u884c\u4e00\u6b21\n    public void sendTimingSms() throws InterruptedException {\n        //TODO \u5b9a\u65f6\u4efb\u52a1\uff0c\u6bcf\u5206\u949f\u68c0\u67e5\u4e00\u6b21\u662f\u5426\u6709\u5b9a\u65f6\u77ed\u4fe1\u9700\u8981\u53d1\u9001\n        //1\u3001\u6bcf\u5206\u949f\u89e6\u53d1\u4e00\u6b21\u5b9a\u65f6\u4efb\u52a1\n        //2\u3001\u4e3a\u4e86\u9632\u6b62\u77ed\u4fe1\u91cd\u590d\u53d1\u9001\uff0c\u9700\u8981\u4f7f\u7528\u5206\u5e03\u5f0f\u9501\n        String lock = redisLock.tryLock("SEND_TIMING_SMS", 30 * 1000);\n        if(StringUtils.isNotBlank(lock)){\n            //3\u3001\u8c03\u7528SendTimingSmsImpl\u53d1\u9001\u5b9a\u65f6\u77ed\u4fe1\n            sendTimingSms.execute(DateUtils.format(new Date(),"yyyy-MM-dd HH:mm"));\n        }\n    }\n}\n')),(0,l.kt)("h4",{id:"445-\u77ed\u4fe1\u76d1\u542c\u5668"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_4-4-5-%E7%9F%AD%E4%BF%A1%E7%9B%91%E5%90%AC%E5%99%A8"},"#"),"4.4.5 \u77ed\u4fe1\u76d1\u542c\u5668"),(0,l.kt)("p",null,"\u5e94\u7528\u7cfb\u7edf\u8c03\u7528\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\uff0c\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u5c06\u77ed\u4fe1\u6d88\u606f\u653e\u5165\u6d88\u606f\u961f\u5217\uff0c\u5b9e\u73b0\u77ed\u4fe1\u7684\u63a5\u6536\u548c\u53d1\u9001\u7684\u89e3\u8026\uff0c\u8fd9\u79cd\u65b9\u6848\u53ef\u4ee5\u6700\u5927\u5316\u63d0\u9ad8\u77ed\u4fe1\u63a5\u6536\u670d\u52a1\u6027\u80fd\uff0c\u4e0d\u4f1a\u7531\u4e8e\u5916\u90e8\u77ed\u4fe1\u901a\u9053\u5f71\u54cd\u5e94\u7528\u7cfb\u7edf\u7684\u54cd\u5e94\uff0c\u4ece\u800c\u8d77\u5230\u524a\u5cf0\u586b\u8c37\u7684\u6548\u679c\u3002"),(0,l.kt)("p",null,"\u672c\u7cfb\u7edf\u4f7f\u7528\u7684Redis\u96c6\u7fa4\u4f5c\u4e3a\u6d88\u606f\u961f\u5217\uff0c\u5728\u4f20\u8f93\u77ed\u4fe1\u65f6\uff0c\u91c7\u7528\u7684\u662f\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u5f0f\u3002"),(0,l.kt)("p",null,"\u77ed\u4fe1\u63a5\u6536\u5668\u5bf9\u5e94\u7684\u7c7b\u4e3aGeneralSmsListener\u548cHighSmsListener\uff0c\u89d2\u8272\u662fRedis\u961f\u5217\u7684\u6d88\u8d39\u8005\uff0c\u76d1\u542c\u961f\u5217\u4e2d\u7684\u6d88\u606f\uff0c\u5982\u679c\u6709\u6d88\u606f\u5219\u8c03\u7528SmsFactory\u53d1\u9001\u5b9e\u65f6\u77ed\u4fe1\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4e1a\u52a1\u903b\u8f91\uff1a")),(0,l.kt)("p",null,"1\u3001HighSmsListener\u76d1\u542cTOPIC_HIGH_SMS\u961f\u5217\uff0c\u5982\u679c\u6709\u6d88\u606f\u5219\u8c03\u7528\u77ed\u4fe1\u53d1\u9001\u5de5\u5382SmsFactory\u53d1\u9001\u5b9e\u65f6\u77ed\u4fe1"),(0,l.kt)("p",null,"2\u3001GeneralSmsListener\u76d1\u542cTOPIC_GENERAL_SMS\u961f\u5217\uff0c\u5982\u679c\u6709\u6d88\u606f\u5219\u8c03\u7528\u77ed\u4fe1\u53d1\u9001\u5de5\u5382SmsFactory\u53d1\u9001\u5b9e\u65f6\u77ed\u4fe1"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"HighSmsListener\u5177\u4f53\u5b9e\u73b0\uff1a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.sms.redismq;\n\nimport com.ydl.sms.factory.SmsFactory;\nimport lombok.extern.slf4j.Slf4j;\nimport org.apache.commons.lang3.StringUtils;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.data.redis.core.ListOperations;\nimport org.springframework.data.redis.core.RedisTemplate;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.PostConstruct;\nimport java.util.concurrent.TimeUnit;\n\n/**\n * Redis\u961f\u5217-----\u6d88\u8d39\u8005\n * \u76d1\u542c\u6d88\u606f\u961f\u5217\uff1aTOPIC_HIGH_SMS\uff0c\u9ad8\u4f18\u5148\u7ea7\u7684\u77ed\u4fe1\uff0c\u5982\u9a8c\u8bc1\u7801\u4e4b\u7c7b\u7684\u77ed\u4fe1\n */\n@Component\n@Slf4j\npublic class HighSmsListener extends Thread {\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    @Autowired\n    private SmsFactory smsFactory;\n\n    private String queueKey = "TOPIC_HIGH_SMS";\n\n    @Value("${spring.redis.queue.pop.timeout}")\n    private Long popTimeout = 8000L;\n\n    private ListOperations listOps;\n\n    @PostConstruct\n    private void init() {\n        listOps = redisTemplate.opsForList();\n        this.start();\n    }\n\n    @Override\n    public void run() {\n        //TODO \u76d1\u542cTOPIC_HIGH_SMS\u961f\u5217\uff0c\u5982\u679c\u6709\u6d88\u606f\u5219\u8c03\u7528\u77ed\u4fe1\u53d1\u9001\u5de5\u5382\u53d1\u9001\u5b9e\u65f6\u77ed\u4fe1\n        //\u76d1\u542c    TOPIC_HIGH_SMS \u53d1\u9001\n        while (true){\n            log.debug("\u961f\u5217{}\u6b63\u5728\u76d1\u542c\u4e2d",queueKey);\n            //SmsSendDTO --\x3estring\n            String message = (String) listOps.rightPop(queueKey, popTimeout, TimeUnit.MILLISECONDS);\n            if(StringUtils.isNotBlank(message)){\n                log.info("{}\u6536\u5230\u6d88\u606f\u4e86\uff1a{}",queueKey,message);\n                //\u53d1\u9001\n                smsFactory.send(message);\n            }\n        }\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"GeneralSmsListener\u5177\u4f53\u5b9e\u73b0\uff1a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.sms.redismq;\n\nimport com.ydl.sms.factory.SmsFactory;\nimport lombok.extern.slf4j.Slf4j;\nimport org.apache.commons.lang3.StringUtils;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.data.redis.core.ListOperations;\nimport org.springframework.data.redis.core.RedisTemplate;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.PostConstruct;\nimport java.util.concurrent.TimeUnit;\n\n/**\n * Redis\u961f\u5217\u6d88\u8d39\u8005\uff0c\u76d1\u542c\u6d88\u606f\u961f\u5217TOPIC_GENERAL_SMS\uff0c\u666e\u901a\u4f18\u5148\u7ea7\u7684\u77ed\u4fe1\uff0c\u5982\u8425\u9500\u77ed\u4fe1\n */\n@Component\n@Slf4j\npublic class GeneralSmsListener extends Thread {\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    @Autowired\n    private SmsFactory smsFactory;\n\n    private String queueKey = "TOPIC_GENERAL_SMS";\n\n    @Value("${spring.redis.queue.pop.timeout}")\n    private Long popTimeout = 8000L;\n\n    private ListOperations listOps;\n\n    @PostConstruct\n    private void init() {\n        listOps = redisTemplate.opsForList();\n        this.start();\n    }\n\n    @Override\n    public void run() {\n        //TODO \u76d1\u542cTOPIC_GENERAL_SMS\u961f\u5217\uff0c\u5982\u679c\u6709\u6d88\u606f\u5219\u8c03\u7528\u77ed\u4fe1\u53d1\u9001\u5de5\u5382\u53d1\u9001\u5b9e\u65f6\u77ed\u4fe1\n        //\u76d1\u542c    TOPIC_GENERAL_SMS \u53d1\u9001\n        while (true){\n            log.debug("\u961f\u5217{}\u6b63\u5728\u76d1\u542c\u4e2d",queueKey);\n            //SmsSendDTO --\x3estring\n            String message = (String) listOps.rightPop(queueKey, popTimeout, TimeUnit.MILLISECONDS);\n            if(StringUtils.isNotBlank(message)){\n                log.info("{}\u6536\u5230\u6d88\u606f\u4e86\uff1a{}",queueKey,message);\n                //\u53d1\u9001\n                smsFactory.send(message);\n            }\n        }\n    }\n}\n')),(0,l.kt)("h4",{id:"446-\u901a\u9053\u6d88\u606f\u76d1\u542c\u5668"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_4-4-6-%E9%80%9A%E9%81%93%E6%B6%88%E6%81%AF%E7%9B%91%E5%90%AC%E5%99%A8"},"#"),"4.4.6 \u901a\u9053\u6d88\u606f\u76d1\u542c\u5668"),(0,l.kt)("p",null,"\u901a\u9053\u6d88\u606f\u76d1\u542c\u5668\u5bf9\u5e94\u7684\u7c7b\u662fHighServerReceiver\uff0c\u4f5c\u7528\u662f\u901a\u8fc7Redis\u7684\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\u76d1\u542cTOPIC_HIGH_SERVER\u9891\u9053\u4e2d\u7684\u6d88\u606f\uff0c\u8c03\u7528SmsConnectLoader\u521d\u59cb\u5316\u901a\u9053\u548c\u66f4\u65b0\u901a\u9053\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4e1a\u52a1\u903b\u8f91\uff1a")),(0,l.kt)("p",null,"1\u3001\u901a\u8fc7Redis\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\u76d1\u542cTOPIC_HIGH_SERVER\u9891\u9053\u4e2d\u7684\u6d88\u606f"),(0,l.kt)("p",null,"2\u3001\u5982\u679c\u6d88\u606f\u4e3aUSE_NEW_CONNECT\uff0c\u8868\u793a\u901a\u9053\u66f4\u65b0\uff0c\u8c03\u7528\u901a\u9053\u5b9e\u4f8b\u52a0\u8f7d\u5668SmsConnectLoader\u66f4\u65b0\u901a\u9053"),(0,l.kt)("p",null,"3\u3001\u5982\u679c\u6d88\u606f\u4e3aINIT_CONNECT\uff0c\u8868\u793a\u901a\u9053\u521d\u59cb\u5316\uff0c\u8c03\u7528\u901a\u9053\u5b9e\u4f8b\u52a0\u8f7d\u5668SmsConnectLoader\u521d\u59cb\u5316\u901a\u9053"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5b9e\u73b0\u4ee3\u7801\uff1a")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydl.sms.redismq;\n\nimport com.ydl.sms.factory.SmsConnectLoader;\nimport com.ydl.sms.model.ServerTopic;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.data.redis.connection.Message;\nimport org.springframework.data.redis.connection.MessageListener;\nimport org.springframework.data.redis.core.RedisTemplate;\nimport org.springframework.data.redis.serializer.RedisSerializer;\nimport org.springframework.stereotype.Component;\n\n/**\n * Redis\u53d1\u5e03\u8ba2\u9605----\u8ba2\u9605\u8005\uff0c\u901a\u8fc7Redis\u7684\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\u76d1\u542cTOPIC_HIGH_SERVER\u9891\u9053\n */\n@Component\n@Slf4j\npublic class HighServerReceiver implements MessageListener {\n\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    @Autowired\n    private SmsConnectLoader smsConnectLoader;\n\n    /**\n     * \u6d88\u606f\u76d1\u542c\n     * @param message\n     * @param pattern\n     */\n    @Override\n    public void onMessage(Message message, byte[] pattern) {\n        //TODO \u6d88\u606f\u76d1\u542c\uff0c\u6839\u636e\u6d88\u606f\u5185\u5bb9\u8c03\u7528smsConnectLoader\u8fdb\u884c\u901a\u9053\u521d\u59cb\u5316\u6216\u8005\u901a\u9053\u66f4\u65b0\n\n        RedisSerializer<?> valueSerializer = redisTemplate.getDefaultSerializer();\n        String deserialize = valueSerializer.deserialize(message.getBody()).toString();\n        \n        ServerTopic serverTopic = ServerTopic.load(deserialize);\n\n        switch (serverTopic.getOption()) {\n            case ServerTopic.USE_NEW_CONNECT:\n                log.info("\u670d\u52a1\uff1a{} \u53d1\u8d77\u3010\u901a\u9053\u66f4\u65b0\u3011", serverTopic.getValue());\n                smsConnectLoader.changeNewConnect();\n                break;\n            case ServerTopic.INIT_CONNECT:\n                log.info("\u670d\u52a1\uff1a{} \u53d1\u8d77\u3010\u901a\u9053\u521d\u59cb\u5316\u3011", serverTopic.getValue());\n                smsConnectLoader.initConnect();\n                break;\n            default:\n                break;\n        }\n\n    }\n}\n')),(0,l.kt)("h2",{id:"5\u5bf9\u63a5\u963f\u91cc\u77ed\u4fe1\u8fdb\u884c\u771f\u5b9e\u53d1\u9001"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/1%E3%80%81%E7%9F%AD%E4%BF%A1%E9%80%9A%E9%81%93/#_5%E5%AF%B9%E6%8E%A5%E9%98%BF%E9%87%8C%E7%9F%AD%E4%BF%A1%E8%BF%9B%E8%A1%8C%E7%9C%9F%E5%AE%9E%E5%8F%91%E9%80%81"},"#"),"5\u5bf9\u63a5\u963f\u91cc\u77ed\u4fe1\u8fdb\u884c\u771f\u5b9e\u53d1\u9001\uff01"),(0,l.kt)("p",null,"1\u7533\u8bf7\u963f\u91cc\u77ed\u4fe1\u7684\u7b7e\u540d \u548c \u6a21\u677f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210926040554940-4c71e349.png",alt:"image-20210926040554940"}),"image-20210926040554940"),(0,l.kt)("p",null,"2\u83b7\u53d6accessKey\u548csecret"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210926040656499-ff340c30.png",alt:"image-20210926040656499"}),"image-20210926040656499"),(0,l.kt)("p",null,"3\u53c2\u8003\u6587\u6863\u7ecf\u884c\u4ee3\u7801\u7f16\u5199"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'private void init() {\n        //\u521d\u59cb\u5316acsClient\uff0c\u6682\u4e0d\u652f\u6301region\u5316 "cn-hangzhou"\n        //profile = DefaultProfile.getProfile(config.get("RegionId"), config.getAccessKeyId(), config.getAccessKeySecret());\n        aliconfig = new Config()\n                // \u60a8\u7684AccessKey ID\n                .setAccessKeyId(config.getAccessKeyId())\n                // \u60a8\u7684AccessKey Secret\n                .setAccessKeySecret( config.getAccessKeySecret());\n        // \u8bbf\u95ee\u7684\u57df\u540d\n        aliconfig.endpoint = "dysmsapi.aliyuncs.com";\n    }\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'@Override\n    protected String sendSms(String mobile, Map<String, String> params, String signature, String template) {\n        // \u83b7\u53d6 \u7b7e\u540d\u5185\u5bb9 \u548c\u6a21\u677fid\n        SignatureEntity signatureEntity = signatureService.getByCode(signature);\n        String code = templateService.getConfigCodeByCode(config.getId(), template);\n        try {\n            Client client = new Client(aliconfig);\n\n            SendSmsRequest request=new SendSmsRequest();\n            request.setPhoneNumbers(mobile);\n            request.setTemplateCode(code);\n            request.setTemplateParam(JSON.toJSONString(params));\n            request.setSignName(signatureEntity.getContent());\n\n            SendSmsResponse response = client.sendSms(request);\n            JSONObject jsonObject = JSON.parseObject(String.valueOf(response.getBody()));\n            if (response.getBody().getCode().equals("OK")) {\n                return response.getBody().toString();\n            } else {\n                return failResponse(jsonObject.getString("Message"),response.getBody().getMessage());\n            }\n        } catch (Exception e) {\n            log.error("Aliyun \u77ed\u4fe1\u53d1\u9001\u5931\u8d25\uff1a{} ,{}", mobile, template, e);\n            return failResponse(e.getMessage(), e.getMessage());\n        }\n        //"{\\"Message\\":\\"OK\\",\\"RequestId\\":\\"" + UUID.randomUUID().toString().toUpperCase() + "-@\\",\\"BizId\\":\\"" + System.currentTimeMillis() + "\\",\\"Code\\":\\"OK\\"}";\n    }\n')),(0,l.kt)("p",null,"4\u5e73\u53f0\u914d\u7f6e\u76f8\u5e94\u6b63\u786e\u53c2\u6570"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210926040844298-ea99a523.png",alt:"image-20210926040844298"}),"image-20210926040844298"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210926040853475-7995b0c6.png",alt:"image-20210926040853475"}),"image-20210926040853475"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210926040905138-5a424696.png",alt:"image-20210926040905138"}),"image-20210926040905138"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210926040915170-3ead5d57.png",alt:"image-20210926040915170"}),(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210926040924104-3d778718.png",alt:"image-20210926040924104"})),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210926040930674-851d3f30.png",alt:"image-20210926040930674"}),"image-20210926040930674"),(0,l.kt)("p",null,"5\u542f\u52a8\u4e09\u4e2a\u5e73\u53f0\uff0c\u548cshop\u670d\u52a1\uff0c\u8fdb\u884c\u53d1\u9001"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210926041010750-2bf815e3.png",alt:"image-20210926041010750"}),"image-20210926041010750"),(0,l.kt)("p",null,"6\u7ed3\u679c"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20210926041050855-067ff263.png",alt:"image-20210926041050855"})))}d.isMDXComponent=!0}}]);