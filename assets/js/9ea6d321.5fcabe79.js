"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1650],{3905:(e,n,a)=>{a.d(n,{Zo:()=>m,kt:()=>g});var t=a(7294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function l(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function s(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?l(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function p(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},l=Object.keys(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=t.createContext({}),i=function(e){var n=t.useContext(o),a=n;return e&&(a="function"==typeof e?e(n):s(s({},n),e)),a},m=function(e){var n=i(e.components);return t.createElement(o.Provider,{value:n},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,l=e.originalType,o=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),c=i(a),d=r,g=c["".concat(o,".").concat(d)]||c[d]||u[d]||l;return a?t.createElement(g,s(s({ref:n},m),{},{components:a})):t.createElement(g,s({ref:n},m))}));function g(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=a.length,s=new Array(l);s[0]=d;var p={};for(var o in n)hasOwnProperty.call(n,o)&&(p[o]=n[o]);p.originalType=e,p[c]="string"==typeof e?e:r,s[1]=p;for(var i=2;i<l;i++)s[i]=a[i];return t.createElement.apply(null,s)}return t.createElement.apply(null,a)}d.displayName="MDXCreateElement"},9837:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>c,frontMatter:()=>l,metadata:()=>p,toc:()=>i});var t=a(7462),r=(a(7294),a(3905));const l={},s="1.MyBatis",p={unversionedId:"Java/\u6846\u67b6/MyBatis",id:"Java/\u6846\u67b6/MyBatis",title:"1.MyBatis",description:"\u4e00\u3001\u4e86\u89e3MyBatis",source:"@site/docs/Java/6.\u6846\u67b6/1.MyBatis.md",sourceDirName:"Java/6.\u6846\u67b6",slug:"/Java/\u6846\u67b6/MyBatis",permalink:"/docs/Java/\u6846\u67b6/MyBatis",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Java/6.\u6846\u67b6/1.MyBatis.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"Java",previous:{title:"3.\u57fa\u7840\u8bbe\u8ba1\u6a21\u5f0f",permalink:"/docs/Java/\u57fa\u7840\u77e5\u8bc6/\u57fa\u7840\u8bbe\u8ba1\u6a21\u5f0f"},next:{title:"2.Spring",permalink:"/docs/Java/\u6846\u67b6/Spring"}},o={},i=[{value:"\u4e00\u3001\u4e86\u89e3MyBatis",id:"\u4e00\u4e86\u89e3mybatis",level:2},{value:"1\u3001\u5386\u53f2\uff08\u767e\u5ea6\u767e\u79d1\uff09",id:"1\u5386\u53f2\u767e\u5ea6\u767e\u79d1",level:3},{value:"2\u3001\u4f5c\u7528 \uff08\u767e\u5ea6\u767e\u79d1\uff09",id:"2\u4f5c\u7528-\u767e\u5ea6\u767e\u79d1",level:3},{value:"3\u3001\u8bf4\u8bf4\u6301\u4e45\u5316",id:"3\u8bf4\u8bf4\u6301\u4e45\u5316",level:3},{value:"4\u3001\u8bf4\u8bf4\u6301\u4e45\u5c42",id:"4\u8bf4\u8bf4\u6301\u4e45\u5c42",level:3},{value:"5\u3001\u804a\u804aORM",id:"5\u804a\u804aorm",level:3},{value:"6\u3001MyBatis\u7684\u4f18\u70b9\u548c\u7f3a\u70b9",id:"6mybatis\u7684\u4f18\u70b9\u548c\u7f3a\u70b9",level:3},{value:"\u4e8c\u3001\u642d\u5efa\u4e2a\u73af\u5883",id:"\u4e8c\u642d\u5efa\u4e2a\u73af\u5883",level:2},{value:"1\u3001\u5efa\u7acb\u6570\u636e\u5e93",id:"1\u5efa\u7acb\u6570\u636e\u5e93",level:3},{value:"2\u3001\u6784\u5efa\u4e00\u4e2a\u7236\u5de5\u7a0b",id:"2\u6784\u5efa\u4e00\u4e2a\u7236\u5de5\u7a0b",level:3},{value:"3\u3001\u7236\u5de5\u7a0b\u7684maven\u914d\u7f6e",id:"3\u7236\u5de5\u7a0b\u7684maven\u914d\u7f6e",level:3},{value:"4\u3001\u521b\u5efa\u5b50\u6a21\u5757",id:"4\u521b\u5efa\u5b50\u6a21\u5757",level:3},{value:"5\u3001\u56de\u987e\u6211\u4eec\u7684jdbc\u4ee3\u7801",id:"5\u56de\u987e\u6211\u4eec\u7684jdbc\u4ee3\u7801",level:3},{value:"6\u3001\u7f16\u5199MyBatis\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\uff0cmybatis-config.xml",id:"6\u7f16\u5199mybatis\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6mybatis-configxml",level:3},{value:"\uff081\uff09DTD\uff1a",id:"1dtd",level:5},{value:"\uff082\uff09XSD",id:"2xsd",level:5},{value:"7\u3001\u7f16\u5199\u5b9e\u4f53\u7c7b",id:"7\u7f16\u5199\u5b9e\u4f53\u7c7b",level:3},{value:"\u4e09\u3001\u65e5\u5fd7\u914d\u7f6e",id:"\u4e09\u65e5\u5fd7\u914d\u7f6e",level:2},{value:"1\u3001\u6807\u51c6\u65e5\u5fd7\u5b9e\u73b0",id:"1\u6807\u51c6\u65e5\u5fd7\u5b9e\u73b0",level:3},{value:"2\u3001\u7ec4\u5408logback\u5b8c\u6210\u65e5\u5fd7\u529f\u80fd\uff08\u6269\u5c55\uff09",id:"2\u7ec4\u5408logback\u5b8c\u6210\u65e5\u5fd7\u529f\u80fd\u6269\u5c55",level:3},{value:"\u56db\u3001CRUD\u6765\u4e00\u5957",id:"\u56dbcrud\u6765\u4e00\u5957",level:2},{value:"1\u3001\u57fa\u672c\u6d41\u7a0b\uff1a",id:"1\u57fa\u672c\u6d41\u7a0b",level:3},{value:"\uff081\uff09SqlSessionFactory",id:"1sqlsessionfactory",level:4},{value:"\uff082\uff09SqlSession",id:"2sqlsession",level:4},{value:"\uff083\uff09\u6d4b\u8bd5",id:"3\u6d4b\u8bd5",level:4},{value:"\uff084\uff09\u52a8\u6001\u4ee3\u7406\u5b9e\u73b0",id:"4\u52a8\u6001\u4ee3\u7406\u5b9e\u73b0",level:4},{value:"2\u3001select\uff08\u67e5\u8be2\uff09",id:"2select\u67e5\u8be2",level:3},{value:"3\u3001insert\uff08\u63d2\u5165\uff09",id:"3insert\u63d2\u5165",level:3},{value:"4\u3001update\uff08\u4fee\u6539\uff09",id:"4update\u4fee\u6539",level:3},{value:"5\u3001delete\uff08\u5220\u9664\uff09",id:"5delete\u5220\u9664",level:3},{value:"6\u3001\u6a21\u7cca\u67e5\u8be2",id:"6\u6a21\u7cca\u67e5\u8be2",level:3},{value:"7\u3001map\u7684\u4f7f\u7528",id:"7map\u7684\u4f7f\u7528",level:3},{value:"\u4e94\u3001\u4f7f\u7528\u6ce8\u89e3\u5f00\u53d1",id:"\u4e94\u4f7f\u7528\u6ce8\u89e3\u5f00\u53d1",level:2},{value:"1\u3001\u63a5\u53e3\u4e2d\u6dfb\u52a0\u6ce8\u89e3",id:"1\u63a5\u53e3\u4e2d\u6dfb\u52a0\u6ce8\u89e3",level:3},{value:"2\u3001\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e",id:"2\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e",level:3},{value:"3\u3001\u8fdb\u884c\u6d4b\u8bd5",id:"3\u8fdb\u884c\u6d4b\u8bd5",level:3},{value:"\u516d\u3001\u67b6\u6784\u6e90\u7801\u89e3\u6790\uff08\u9009\u5b66\uff09",id:"\u516d\u67b6\u6784\u6e90\u7801\u89e3\u6790\u9009\u5b66",level:2},{value:"1\u3001\u67b6\u6784\u8bb2\u89e3",id:"1\u67b6\u6784\u8bb2\u89e3",level:3},{value:"2\u3001\u6838\u5fc3\u6210\u5458\uff1a",id:"2\u6838\u5fc3\u6210\u5458",level:3},{value:"3\u3001\u6e90\u7801\u89e3\u8bfb",id:"3\u6e90\u7801\u89e3\u8bfb",level:3},{value:"\uff081\uff09\u6784\u5efasession\u5de5\u5382",id:"1\u6784\u5efasession\u5de5\u5382",level:4},{value:"\uff082\uff09\u914d\u7f6e\u6587\u4ef6\u7684\u89e3\u6790",id:"2\u914d\u7f6e\u6587\u4ef6\u7684\u89e3\u6790",level:4},{value:"\uff083\uff09mapper\u6587\u4ef6\u7684\u89e3\u6790\u8fc7\u7a0b",id:"3mapper\u6587\u4ef6\u7684\u89e3\u6790\u8fc7\u7a0b",level:4},{value:"\uff084\uff09\u901a\u8fc7sqlSession\u83b7\u53d6\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61",id:"4\u901a\u8fc7sqlsession\u83b7\u53d6\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61",level:4},{value:"\uff085\uff09\u65b9\u6cd5\u8c03\u7528",id:"5\u65b9\u6cd5\u8c03\u7528",level:4},{value:"\uff086\uff09\u7ee7\u7eed\u4e86\u89e3",id:"6\u7ee7\u7eed\u4e86\u89e3",level:4},{value:"4\u3001\u522b\u540d\u7cfb\u7edf",id:"4\u522b\u540d\u7cfb\u7edf",level:3},{value:"\u4e03\u3001resultMap\u8be6\u89e3",id:"\u4e03resultmap\u8be6\u89e3",level:2},{value:"\u516b\u3001\u52a8\u6001sql-\u5f88\u91cd\u8981",id:"\u516b\u52a8\u6001sql-\u5f88\u91cd\u8981",level:2},{value:"1\u3001 \u6982\u8ff0",id:"1-\u6982\u8ff0",level:3},{value:"2\u3001if\u5143\u7d20\uff08\u975e\u5e38\u5e38\u7528\uff09",id:"2if\u5143\u7d20\u975e\u5e38\u5e38\u7528",level:3},{value:"3\u3001where\u5143\u7d20",id:"3where\u5143\u7d20",level:3},{value:"4\u3001trim\u5143\u7d20",id:"4trim\u5143\u7d20",level:3},{value:"5\u3001choose\u3001when\u3001otherwise\u5143\u7d20",id:"5choosewhenotherwise\u5143\u7d20",level:3},{value:"6\u3001set\u5143\u7d20",id:"6set\u5143\u7d20",level:3},{value:"7\u3001foreach\u5143\u7d20",id:"7foreach\u5143\u7d20",level:3},{value:"8\u3001foreach\u6279\u91cf\u63d2\u5165",id:"8foreach\u6279\u91cf\u63d2\u5165",level:3},{value:"9\u3001SQL\u7247\u6bb5",id:"9sql\u7247\u6bb5",level:3},{value:"\u4e5d\u3001\u6570\u636e\u5173\u7cfb\u5904\u7406",id:"\u4e5d\u6570\u636e\u5173\u7cfb\u5904\u7406",level:2},{value:"1\u3001\u901a\u8fc7\u5458\u5de5\u7ea7\u8054\u90e8\u95e8",id:"1\u901a\u8fc7\u5458\u5de5\u7ea7\u8054\u90e8\u95e8",level:3},{value:"\uff081\uff09\u6309\u67e5\u8be2\u5d4c\u5957",id:"1\u6309\u67e5\u8be2\u5d4c\u5957",level:4},{value:"\uff082\uff09\u6309\u7ed3\u679c\u5d4c\u5957",id:"2\u6309\u7ed3\u679c\u5d4c\u5957",level:4},{value:"2\u3001\u901a\u8fc7\u90e8\u95e8\u7ea7\u8054\u7528\u6237",id:"2\u901a\u8fc7\u90e8\u95e8\u7ea7\u8054\u7528\u6237",level:3},{value:"\uff081\uff09\u6309\u7ed3\u679c\u5d4c\u5957\u5904\u7406",id:"1\u6309\u7ed3\u679c\u5d4c\u5957\u5904\u7406",level:4},{value:"\uff082\uff09\u6309\u67e5\u8be2\u5d4c\u5957\u5904\u7406",id:"2\u6309\u67e5\u8be2\u5d4c\u5957\u5904\u7406",level:4},{value:"3\u3001\u5c0f\u77e5\u8bc6\uff1a",id:"3\u5c0f\u77e5\u8bc6",level:3},{value:"\uff081\uff09\u61d2\u52a0\u8f7d",id:"1\u61d2\u52a0\u8f7d",level:4},{value:"\uff082\uff09Mybatis \u83b7\u53d6\u81ea\u589e\u4e3b\u952e\u7684\u65b9\u5f0f",id:"2mybatis-\u83b7\u53d6\u81ea\u589e\u4e3b\u952e\u7684\u65b9\u5f0f",level:4},{value:"\u5341\u3001Mybatis\u7f13\u5b58",id:"\u5341mybatis\u7f13\u5b58",level:2},{value:"1\u3001\u4e3a\u4ec0\u4e48\u8981\u7528\u7f13\u5b58\uff1f",id:"1\u4e3a\u4ec0\u4e48\u8981\u7528\u7f13\u5b58",level:3},{value:"2\u3001\u4e00\u7ea7\u7f13\u5b58\uff1a",id:"2\u4e00\u7ea7\u7f13\u5b58",level:3},{value:"3\u3001\u4e8c\u7ea7\u7f13\u5b58\uff1a",id:"3\u4e8c\u7ea7\u7f13\u5b58",level:3},{value:"\uff081\uff09cache\u5c5e\u6027\u7684\u7b80\u4ecb\uff1a",id:"1cache\u5c5e\u6027\u7684\u7b80\u4ecb",level:4},{value:"\uff082\uff09\u64cd\u4f5c\u8fc7\u7a0b\uff1a",id:"2\u64cd\u4f5c\u8fc7\u7a0b",level:4},{value:"4\u3001\u7b2c\u4e09\u65b9\u7f13\u5b58--EhCache\u5145\u5f53\u4e8c\u7ea7\u7f13\u5b58",id:"4\u7b2c\u4e09\u65b9\u7f13\u5b58--ehcache\u5145\u5f53\u4e8c\u7ea7\u7f13\u5b58",level:3},{value:"5\u3001\u4f7f\u7528\u7f13\u5b58\u72ec\u7acb\u63a7\u5236",id:"5\u4f7f\u7528\u7f13\u5b58\u72ec\u7acb\u63a7\u5236",level:3},{value:"\u5341\u4e00\u3001\u914d\u7f6e\u6587\u4ef6",id:"\u5341\u4e00\u914d\u7f6e\u6587\u4ef6",level:2},{value:"1\u3001environments\u5143\u7d20",id:"1environments\u5143\u7d20",level:3},{value:"2\u3001mappers\u5143\u7d20",id:"2mappers\u5143\u7d20",level:3},{value:"3\u3001Properties\u5143\u7d20",id:"3properties\u5143\u7d20",level:3},{value:"4\u3001\u5176\u4ed6\u914d\u7f6e\u6d4f\u89c8",id:"4\u5176\u4ed6\u914d\u7f6e\u6d4f\u89c8",level:3}],m={toc:i};function c(e){let{components:n,...a}=e;return(0,r.kt)("wrapper",(0,t.Z)({},m,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"1mybatis"},"1.MyBatis"),(0,r.kt)("h2",{id:"\u4e00\u4e86\u89e3mybatis"},"\u4e00\u3001\u4e86\u89e3MyBatis"),(0,r.kt)("h3",{id:"1\u5386\u53f2\u767e\u5ea6\u767e\u79d1"},"1\u3001\u5386\u53f2\uff08\u767e\u5ea6\u767e\u79d1\uff09"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"MyBatis \u672c\u662fapache\u7684\u4e00\u4e2a\u5f00\u6e90\u9879\u76ee\u3010iBatis\u3011, 2010\u5e74\u8fd9\u4e2a\u9879\u76ee\u7531apache software foundation\uff08Apache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\uff09 \u8fc1\u79fb\u5230\u4e86google code\uff08\u8c37\u6b4c\u7684\u4ee3\u7801\u6258\u7ba1\u5e73\u53f0\uff09\uff0c\u5e76\u4e14\u6539\u540d\u4e3aMyBatis \uff0c2013\u5e7411\u6708\u8fc1\u79fb\u5230Github\u3002")),(0,r.kt)("h3",{id:"2\u4f5c\u7528-\u767e\u5ea6\u767e\u79d1"},"2\u3001\u4f5c\u7528 \uff08\u767e\u5ea6\u767e\u79d1\uff09"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"MyBatis \u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u6301\u4e45\u5c42\u6846\u67b6\uff0c\u5b83\u652f\u6301\u81ea\u5b9a\u4e49 SQL\u3001\u5b58\u50a8\u8fc7\u7a0b\u4ee5\u53ca\u9ad8\u7ea7\u6620\u5c04\u3002MyBatis \u514d\u9664\u4e86\u51e0\u4e4e\u6240\u6709\u7684 JDBC \u4ee3\u7801\u4ee5\u53ca\u8bbe\u7f6e\u53c2\u6570\u548c\u83b7\u53d6\u7ed3\u679c\u96c6\u7684\u5de5\u4f5c\u3002")),(0,r.kt)("h3",{id:"3\u8bf4\u8bf4\u6301\u4e45\u5316"},"3\u3001\u8bf4\u8bf4\u6301\u4e45\u5316"),(0,r.kt)("p",null," \u6301\u4e45\u5316\u662f\u5c06\u7a0b\u5e8f\u6570\u636e\u5728\u6301\u4e45\u72b6\u6001\u548c\u77ac\u65f6\u72b6\u6001\u95f4\u8f6c\u6362\u7684\u673a\u5236\u3002\u901a\u4fd7\u7684\u8bb2\uff0c\u5c31\u662f\u77ac\u65f6\u6570\u636e\uff08\u6bd4\u5982\u5185\u5b58\u4e2d\u7684\u6570\u636e\uff0c\u662f\u4e0d\u80fd\u6c38\u4e45\u4fdd\u5b58\u7684\uff09\u6301\u4e45\u5316\u4e3a\u6301\u4e45\u6570\u636e\uff08\u6bd4\u5982\u6301\u4e45\u5316\u81f3\u6570\u636e\u5e93\u4e2d\uff0c\u80fd\u591f\u957f\u4e45\u4fdd\u5b58\uff09\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u7a0b\u5e8f\u4ea7\u751f\u7684\u6570\u636e\u9996\u5148\u90fd\u662f\u5728\u5185\u5b58\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5185\u5b58\u662f\u4e0d\u53ef\u9760\u7684\uff0c\u4ed6\u4e2b\u7684\u4e00\u65ad\u7535\u6570\u636e\u5c31\u6ca1\u4e86\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u90a3\u53ef\u9760\u7684\u5b58\u50a8\u5730\u65b9\u662f\u54ea\u91cc\uff1f\u786c\u76d8\u3001U\u76d8\u3001\u5149\u76d8\u7b49\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u6211\u4eec\u7684\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u8bf4\u7684\u6301\u4e45\u5316\u901a\u5e38\u5c31\u662f\u6307\u5c06\u5185\u5b58\u7684\u6570\u636e\u5b58\u5728\u786c\u76d8\u3002")),(0,r.kt)("h3",{id:"4\u8bf4\u8bf4\u6301\u4e45\u5c42"},"4\u3001\u8bf4\u8bf4\u6301\u4e45\u5c42"),(0,r.kt)("p",null,"\u5176\u5b9e\u5206\u5c42\u7684\u6982\u5ff5\u5df2\u7ecf\u8c08\u5230\u8fc7\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u4e1a\u52a1\u662f\u9700\u8981\u64cd\u4f5c\u6570\u636e\u7684"),(0,r.kt)("li",{parentName:"ul"},"\u6570\u636e\u662f\u5728\u78c1\u76d8\u4e0a\u7684"),(0,r.kt)("li",{parentName:"ul"},"\u5177\u4f53\u4e1a\u52a1\u8c03\u7528\u5177\u4f53\u7684\u6570\u636e\u5e93\u64cd\u4f5c\uff0c\u8026\u5408\u5ea6\u592a\u9ad8\uff0c\u590d\u7528\u6027\u592a\u5dee"),(0,r.kt)("li",{parentName:"ul"},"\u5c06\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u4ee3\u7801\u7edf\u4e00\u62bd\u79bb\u51fa\u6765\uff0c\u81ea\u7136\u5c31\u5f62\u6210\u4e86\u4ecb\u4e8e\u4e1a\u52a1\u5c42\u548c\u6570\u636e\u5e93\u4e2d\u95f4\u7684\u72ec\u7acb\u7684\u5c42")),(0,r.kt)("h3",{id:"5\u804a\u804aorm"},"5\u3001\u804a\u804aORM"),(0,r.kt)("p",null," ORM\uff0c\u5373Object-Relational Mapping\uff08\u5bf9\u8c61\u5173\u7cfb\u6620\u5c04\uff09\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u548c\u4e1a\u52a1\u5b9e\u4f53\u5bf9\u8c61\u4e4b\u95f4\u4f5c\u4e00\u4e2a\u6620\u5c04\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u5728\u5177\u4f53\u7684\u64cd\u4f5c\u4e1a\u52a1\u5bf9\u8c61\u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u9700\u8981\u518d\u53bb\u548c\u590d\u6742\u7684SQL\u8bed\u53e5\u6253\u4ea4\u9053\uff0c\u53ea\u9700\u7b80\u5355\u7684\u64cd\u4f5c\u5bf9\u8c61\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"jpa"),"\uff08Java Persistence API\uff09\u662fjava\u6301\u4e45\u5316\u89c4\u8303\uff0c\u662form\u6846\u67b6\u7684\u6807\u51c6\uff0c\u4e3b\u6d41orm\u6846\u67b6\u90fd\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u6807\u51c6\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"hibernate"),"\uff1a\u5168\u81ea\u52a8\u7684\u6846\u67b6\uff0c\u5f3a\u5927\u3001\u590d\u6742\u3001\u7b28\u91cd\u3001\u5b66\u4e60\u6210\u672c\u8f83\u9ad8\uff0c\u4e0d\u591f\u7075\u6d3b\uff0c\u5b9e\u73b0\u4e86jpa\u89c4\u8303\u3002Java Persistence API\uff08Java \u6301\u4e45\u5c42 API\uff09"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"MyBatis"),"\uff1a\u534a\u81ea\u52a8\u7684\u6846\u67b6(\u61c2\u6570\u636e\u5e93\u7684\u4eba \u624d\u80fd\u64cd\u4f5c) \u5fc5\u987b\u8981\u81ea\u5df1\u5199sql\uff0c\u4e0d\u662f\u4f9d\u7167\u7684jpa\u89c4\u8303\u5b9e\u73b0\u7684\u3002")),(0,r.kt)("p",null,"\u5f88\u591a\u4eba\u9752\u7750 MyBatis \uff0c\u539f\u56e0\u662f\u5176\u63d0\u4f9b\u4e86\u4fbf\u5229\u7684 SQL \u64cd\u4f5c\uff0c\u81ea\u7531\u5ea6\u9ad8\uff0c\u5c01\u88c5\u6027\u597d\u2026\u2026 JPA\u5bf9\u590d\u6742 SQL \u7684\u652f\u6301\u4e0d\u597d\uff0c\u6ca1\u6709\u5b9e\u4f53\u5173\u8054\u7684\u4e24\u4e2a\u8868\u8981\u505a join \uff0c\u7684\u786e\u8981\u82b1\u4e0d\u5c11\u529f\u592b\u3002"),(0,r.kt)("h3",{id:"6mybatis\u7684\u4f18\u70b9\u548c\u7f3a\u70b9"},"6\u3001MyBatis\u7684\u4f18\u70b9\u548c\u7f3a\u70b9"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"sql\u8bed\u53e5\u4e0e\u4ee3\u7801\u5206\u79bb\uff0c\u5b58\u653e\u4e8exml\u914d\u7f6e\u6587\u4ef6\u4e2d\uff1a"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"\u4f18\u70b9"),"\uff1a\u4fbf\u4e8e\u7ef4\u62a4\u7ba1\u7406\uff0c\u4e0d\u7528\u5728java\u4ee3\u7801\u4e2d\u627e\u8fd9\u4e9b\u8bed\u53e5\uff1b"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"\u7f3a\u70b9"),"\uff1a JDBC\u65b9\u5f0f\u53ef\u4ee5\u7528\u6253\u65ad\u70b9\u7684\u65b9\u5f0f\u8c03\u8bd5\uff0c\u4f46\u662fMyBatis\u8c03\u8bd5\u6bd4\u8f83\u590d\u6742\uff0c\u4e00\u822c\u8981\u901a\u8fc7log4j\u65e5\u5fd7\u8f93\u51fa\u65e5\u5fd7\u4fe1\u606f\u5e2e\u52a9\u8c03\u8bd5\uff0c\u7136\u540e\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fee\u6539\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u7528\u903b\u8f91\u6807\u7b7e\u63a7\u5236\u52a8\u6001SQL\u7684\u62fc\u63a5\uff1a"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"\u4f18\u70b9"),"\uff1a\u7528\u6807\u7b7e\u4ee3\u66ff\u7f16\u5199\u903b\u8f91\u4ee3\u7801\uff1b"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"\u7f3a\u70b9"),"\uff1a\u62fc\u63a5\u590d\u6742SQL\u8bed\u53e5\u65f6\uff0c\u6ca1\u6709\u4ee3\u7801\u7075\u6d3b\uff0c\u62fc\u5199\u6bd4\u8f83\u590d\u6742\u3002\u4e0d\u8981\u4f7f\u7528\u53d8\u901a\u7684\u624b\u6bb5\u6765\u5e94\u5bf9\u8fd9\u79cd\u590d\u6742\u7684\u8bed\u53e5\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u67e5\u8be2\u7684\u7ed3\u679c\u96c6\u4e0ejava\u5bf9\u8c61\u81ea\u52a8\u6620\u5c04\uff1a"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"\u4f18\u70b9"),"\uff1a\u4fdd\u8bc1\u540d\u79f0\u76f8\u540c\uff0c\u914d\u7f6e\u597d\u6620\u5c04\u5173\u7cfb\u5373\u53ef\u81ea\u52a8\u6620\u5c04\u6216\u8005\uff0c\u4e0d\u914d\u7f6e\u6620\u5c04\u5173\u7cfb\uff0c\u901a\u8fc7\u914d\u7f6e\u5217\u540d=\u5b57\u6bb5\u540d\u4e5f\u53ef\u5b8c\u6210\u81ea\u52a8\u6620\u5c04\u3002"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"\u7f3a\u70b9"),"\uff1a\u5bf9\u5f00\u53d1\u4eba\u5458\u6240\u5199\u7684SQL\u4f9d\u8d56\u5f88\u5f3a\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u7f16\u5199\u539f\u751fSQL\uff1a"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"\u4f18\u70b9"),"\uff1a\u63a5\u8fd1JDBC\uff0c\u6bd4\u8f83\u7075\u6d3b\u3002"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("strong",{parentName:"p"},"\u7f3a\u70b9"),"\uff1a\u5bf9SQL\u8bed\u53e5\u4f9d\u8d56\u7a0b\u5ea6\u5f88\u9ad8\uff1b\u5e76\u4e14\u5c5e\u4e8e\u534a\u81ea\u52a8\uff0c\u6570\u636e\u5e93\u79fb\u690d\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6bd4\u5982MySQL\u6570\u636e\u5e93\u7f16\u7a0bOracle\u6570\u636e\u5e93\uff0c\u90e8\u5206\u7684SQL\u8bed\u53e5\u9700\u8981\u8c03\u6574\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u6700\u91cd\u8981\u7684\u4e00\u70b9\uff0c\u4f7f\u7528\u7684\u4eba\u591a\uff01\u516c\u53f8\u9700\u8981\uff01"))),(0,r.kt)("h2",{id:"\u4e8c\u642d\u5efa\u4e2a\u73af\u5883"},"\u4e8c\u3001\u642d\u5efa\u4e2a\u73af\u5883"),(0,r.kt)("h3",{id:"1\u5efa\u7acb\u6570\u636e\u5e93"},"1\u3001\u5efa\u7acb\u6570\u636e\u5e93"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE DATABASE `ssm`;\nUSE `ssm`;\nDROP TABLE IF EXISTS `user`;\nCREATE TABLE `user` (\n`id` int(20) NOT NULL,\n`username` varchar(30) DEFAULT NULL,\n`password` varchar(30) DEFAULT NULL,\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\ninsert  into `user`(`id`,`username`,`password`) values (1,'itnanls','123456'),(2,'itlils','abcdef'),(3,'ydlclass','987654');\n")),(0,r.kt)("h3",{id:"2\u6784\u5efa\u4e00\u4e2a\u7236\u5de5\u7a0b"},"2\u3001\u6784\u5efa\u4e00\u4e2a\u7236\u5de5\u7a0b"),(0,r.kt)("p",null,"\u5c1d\u8bd5\u5b66\u4e60\u805a\u5408\u5de5\u7a0b\u7684\u89c4\u8303\uff0c\u5f53\u7136\u53ef\u4ee5\u642d\u5efa\u72ec\u7acb\u7684\u5de5\u7a0b\uff0c\u6211\u4eec\u9009\u62e9\u4e00\u4e2a\u6bd4\u8f83\u65b0\u7684jdk\u7248\u672c11\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211020111952686-7fef3b0f.png",alt:"image-20211020111952686"}),"image-20211020111952686"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211020112150144-39fa2d60.png",alt:"image-20211020112150144"}),"image-20211020112150144"),(0,r.kt)("p",null,"\u5c06\u7236\u5de5\u7a0b\u7684\u6253\u5305\u65b9\u5f0f\u4fee\u6539\u6210pom\uff0c\u8868\u793a\u4e00\u4e2a\u805a\u5408\u5de5\u7a0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"<packaging>pom</packaging>\n")),(0,r.kt)("h3",{id:"3\u7236\u5de5\u7a0b\u7684maven\u914d\u7f6e"},"3\u3001\u7236\u5de5\u7a0b\u7684maven\u914d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.ydlclass</groupId>\n    <artifactId>ssm</artifactId>\n    <version>1.0-SNAPSHOT</version>\n    <packaging>pom</packaging>\n\n    \x3c!-- \u7236\u6a21\u5757\u7528\u4e8e\u7ea6\u675f\u7248\u672c\u4fe1\u606f --\x3e\n    <properties>\n        <maven.compiler.source>11</maven.compiler.source>\n        <maven.compiler.target>11</maven.compiler.target>\n        <junit.version>4.13.1</junit.version>\n        <mybatis.version>3.5.7</mybatis.version>\n        <mysql-connector-java.version>8.0.26</mysql-connector-java.version>\n        <lombok.version>1.18.22</lombok.version>\n    </properties>\n\n    <dependencyManagement>\n        <dependencies>\n            \x3c!-- \u5355\u5143\u6d4b\u8bd5 --\x3e\n            <dependency>\n                <groupId>junit</groupId>\n                <artifactId>junit</artifactId>\n                <version>${junit.version}</version>\n                <scope>test</scope>\n            </dependency>\n            \x3c!-- mybatis \u6838\u5fc3 --\x3e\n            <dependency>\n                <groupId>org.mybatis</groupId>\n                <artifactId>mybatis</artifactId>\n                <version>${mybatis.version}</version>\n            </dependency>\n            \x3c!-- \u6570\u636e\u5e93\u786e\u5b9a --\x3e\n            <dependency>\n                <groupId>mysql</groupId>\n                <artifactId>mysql-connector-java</artifactId>\n                <version>${mysql-connector-java.version}</version>\n                <scope>runtime</scope>\n            </dependency>\n            <dependency>\n                <groupId>org.projectlombok</groupId>\n                <artifactId>lombok</artifactId>\n                <version>${lombok.version}</version>\n                <scope>provided</scope>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n\n</project>\n')),(0,r.kt)("h3",{id:"4\u521b\u5efa\u5b50\u6a21\u5757"},"4\u3001\u521b\u5efa\u5b50\u6a21\u5757"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211020112848952-dcb360d7.png",alt:"image-20211020112848952"}),"image-20211020112848952"),(0,r.kt)("p",null,"pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"<properties>\n    <maven.compiler.source>11</maven.compiler.source>\n    <maven.compiler.target>11</maven.compiler.target>\n</properties>\n<dependencies>\n    <dependency>\n        <groupId>junit</groupId>\n        <artifactId>junit</artifactId>\n        <scope>test</scope>\n    </dependency>\n    <dependency>\n        <groupId>mysql</groupId>\n        <artifactId>mysql-connector-java</artifactId>\n        <scope>runtime</scope>\n    </dependency>\n    <dependency>\n        <groupId>org.mybatis</groupId>\n        <artifactId>mybatis</artifactId>\n    </dependency>\n    <dependency>\n        <groupId>org.projectlombok</groupId>\n        <artifactId>lombok</artifactId>\n        <scope>provided</scope>\n    </dependency>\n</dependencies>\n\n\x3c!-- \u5904\u7406\u8d44\u6e90\u88ab\u8fc7\u6ee4\u95ee\u9898 --\x3e\n<build>\n    <plugins>\n        <plugin>\n            <groupId>org.apache.maven.plugins</groupId>\n            <artifactId>maven-compiler-plugin</artifactId>\n            <version>3.1</version>\n            <configuration>\n                <source>${maven.compiler.target}</source> \x3c!-- \u6e90\u4ee3\u7801\u4f7f\u7528\u7684JDK\u7248\u672c --\x3e\n                <target>${maven.compiler.target}</target> \x3c!-- \u9700\u8981\u751f\u6210\u7684\u76ee\u6807class\u6587\u4ef6\u7684\u7f16\u8bd1\u7248\u672c --\x3e\n                <encoding>UTF-8</encoding>\x3c!-- \u5b57\u7b26\u96c6\u7f16\u7801 --\x3e\n            </configuration>\n        </plugin>\n    </plugins>\n    <resources>\n        <resource>\n            <directory>src/main/java</directory>\n            <includes>\n                <include>**/*.properties</include>\n                <include>**/*.xml</include>\n            </includes>\n            <filtering>false</filtering>\n        </resource>\n        <resource>\n            <directory>src/main/resources</directory>\n            <includes>\n                <include>**/*.properties</include>\n                <include>**/*.xml</include>\n            </includes>\n            <filtering>false</filtering>\n        </resource>\n    </resources>\n</build>\n")),(0,r.kt)("h3",{id:"5\u56de\u987e\u6211\u4eec\u7684jdbc\u4ee3\u7801"},"5\u3001\u56de\u987e\u6211\u4eec\u7684jdbc\u4ee3\u7801"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void testConnection1() throws Exception{\n    //1.\u6570\u636e\u5e93\u8fde\u63a5\u76844\u4e2a\u57fa\u672c\u8981\u7d20\uff1a\n    String url = "jdbc:mysql://localhost:3306/ssm?characterEncoding=utf8&serverTimezone=Asia/Shanghai";\n    String username = "root";\n    String password = "root";\n    //8.0\u4e4b\u540e\u540d\u5b57\u6539\u4e86  com.mysql.cj.jdbc.Driver\n    String driverName = "com.mysql.cj.jdbc.Driver";\n\n    //2.\u5b9e\u4f8b\u5316Driver\n    Class clazz = Class.forName(driverName);\n    Driver driver = (Driver) clazz.newInstance();\n    //3.\u6ce8\u518c\u9a71\u52a8\n    DriverManager.registerDriver(driver);\n    //4.\u83b7\u53d6\u8fde\u63a5\n    Connection conn = DriverManager.getConnection(url, username, password);\n\n    PreparedStatement preparedStatement = conn.prepareStatement("select * from user where id = ?");\n    preparedStatement.setInt(1,1);\n    ResultSet resultSet = preparedStatement.executeQuery();\n\n    // \u5904\u7406\u7ed3\u679c\u96c6\n    while (resultSet.next()){\n        User user = new User();\n        user.setId(resultSet.getInt("id"));\n        user.setUsername(resultSet.getString("username"));\n        user.setPassword(resultSet.getString("password"));\n        System.out.println(user);\n    }\n}\n')),(0,r.kt)("h3",{id:"6\u7f16\u5199mybatis\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6mybatis-configxml"},"6\u3001\u7f16\u5199MyBatis\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\uff0cmybatis-config.xml"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u6709\u5174\u8da3\u7684\u81ea\u884c\u6df1\u5165\u7814\u7a76\u3002")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"UNPOOLED\uff1a\u4e0d\u4f7f\u7528\u8fde\u63a5\u6c60\u7684\u6570\u636e\u6e90"),(0,r.kt)("li",{parentName:"ol"},"POOLED\uff1a\u4f7f\u7528\u8fde\u63a5\u6c60\u7684\u6570\u636e\u6e90"),(0,r.kt)("li",{parentName:"ol"},"JNDI\uff1a\u4f7f\u7528JNDI\u5b9e\u73b0\u7684\u6570\u636e\u6e90\uff0c\u6211\u4eec\u5728\u5b66\u4e60JavaEE\u7684\u65f6\u5019\u5b66\u4e60\u8fc7\u4e86")),(0,r.kt)("p",null,"\u914d\u7f6e\u6587\u4ef6\u6211\u4eec\u4ece\u5b98\u7f51\u590d\u5236\uff1a",(0,r.kt)("a",{parentName:"p",href:"https://mybatis.org/mybatis-3/zh/getting-started.html"},"https://mybatis.org/mybatis-3/zh/getting-started.htmlopen in new window")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE configuration\n        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-config.dtd">\n<configuration>\n    <properties>\n        <property name="driver" value="com.mysql.cj.jdbc.Driver"/>\n        <property name="url" value="jdbc:mysql://localhost:3306/ssm?characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai"/>\n        <property name="username" value="root"/>\n        <property name="password" value="root"/>\n    </properties>\n\n    <environments default="development">\n        <environment id="development">\n            <transactionManager type="JDBC"/>\n            <dataSource type="POOLED">\n                <property name="driver" value="${driver}"/>\n                <property name="url" value="${url}"/>\n                <property name="username" value="${username}"/>\n                <property name="password" value="${password}"/>\n            </dataSource>\n        </environment>\n    </environments>\n</configuration>\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5c0f\u77e5\u8bc6\uff1a")),(0,r.kt)("h5",{id:"1dtd"},"\uff081\uff09DTD\uff1a"),(0,r.kt)("p",null,"DTD(Document Type Definition)\u5373\u6587\u6863\u7c7b\u578b\u5b9a\u4e49\uff0c\u662f\u4e00\u79cdXML\u7ea6\u675f\u6a21\u5f0f\u8bed\u8a00\uff0c\u662fXML\u6587\u4ef6\u7684\u9a8c\u8bc1\u673a\u5236"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5982\u4e0b\u6240\u793a\u662f\u516c\u5171DTD\u793a\u4f8b\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<!DOCTYPE configuration\n        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-config.dtd">\n')),(0,r.kt)("p",null,"\u5173\u4e8eDTD\u7684\u58f0\u660e\u89e3\u91ca\u5982\u4e0b\uff1a"),(0,r.kt)("p",null,"1\u3001DTD\u58f0\u660e\u59cb\u7ec8\u4ee5!DOCTYPE\u5f00\u5934\uff0c\u7a7a\u4e00\u683c\u540e\u8ddf\u7740\u6587\u6863\u6839\u5143\u7d20\u7684\u540d\u79f0\u3002"),(0,r.kt)("p",null,"2\u3001\u6839\u5143\u7d20\u540d\uff1aconfiguration\u3002\u6240\u4ee5\u6bcf\u4e00\u4e2a\u6807\u7b7e\u5e93\u5b9a\u4e49\u6587\u4ef6\u90fd\u662f\u4ee5taglib\u4e3a\u6839\u5143\u7d20\u7684\uff0c\u5426\u5219\u5c31\u4e0d\u4f1a\u9a8c\u8bc1\u901a\u8fc7\u3002"),(0,r.kt)("p",null,'3\u3001PUBLIC "-',(0,r.kt)("a",{parentName:"p",href:"https://mybatis.org//DTD"},"//mybatis.org//DTDopen in new window"),' Config 3.0//EN\uff0c\u8fd9\u662f\u4e00\u4e2a\u516c\u5171DTD\u7684\u540d\u79f0\uff08\u79c1\u6709\u7684\u4f7f\u7528SYSTEM\u8868\u793a\uff09\u3002\u8fd9\u4e2a\u4e1c\u897f\u547d\u540d\u662f\u6709\u4e9b\u8bb2\u7a76\u7684\u3002\u9996\u5148\u5b83\u662f\u4ee5"-"\u5f00\u5934\u7684\uff0c\u8868\u793a\u8fd9\u4e2aDTD\u4e0d\u662f\u4e00\u4e2a\u6807\u51c6\u7ec4\u7ec7\u5236\u5b9a\u7684\u3002\uff08\u5982\u679c\u662fISO\u6807\u51c6\u5316\u7ec4\u7ec7\u6279\u51c6\u7684\uff0c\u4ee5\u201cISO\u201d\u5f00\u5934\uff09\u3002\u63a5\u7740\u5c31\u662f\u53cc\u659c\u6760\u201c//\u201d\uff0c\u8ddf\u7740\u7684\u662fDTD\u6240\u6709\u8005\u7684\u540d\u5b57\uff0c\u5f88\u660e\u663e\u8fd9\u4e2aDTD\u662fMyBatis\u516c\u53f8\u5b9a\u7684\u3002\u63a5\u7740\u53c8\u662f\u53cc\u659c\u6760\u201c//\u201d\uff0c\u7136\u540e\u8ddf\u7740\u7684\u662fDTD\u63cf\u8ff0\u7684\u6587\u6863\u7c7b\u578b\uff0c\u53ef\u4ee5\u770b\u51fa\u8fd9\u4efdDTD\u63cf\u8ff0\u7684\u662fDTD Config 3.0\u7684\u683c\u5f0f\u3002\u518d\u8ddf\u7740\u7684\u5c31\u662f\u201c//\u201d\u548cISO 639\u8bed\u8a00\u6807\u8bc6\u7b26\u3002'),(0,r.kt)("p",null,'4\u3001\u7eff\u8272\u7684\u5b57"',(0,r.kt)("a",{parentName:"p",href:"http://mybatis.org/dtd/mybatis-3-config.dtd"},"http://mybatis.org/dtd/mybatis-3-config.dtdopen in new window"),'"\uff0c\u8868\u793a\u8fd9\u4e2aDTD\u7684\u4f4d\u7f6e\u3002'),(0,r.kt)("p",null,"\u7591\u95ee\uff1a\u662f\u4e0d\u662fxml\u5206\u6790\u5668\u90fd\u4f1a\u5230java.sun.com\u4e0a\u53bb\u627e\u8fd9\u4e2adtd\u5462\uff1f\u7b54\u6848\u662f\u5426\u5b9a\u7684\uff0cxml\u5206\u6790\u5668\u9996\u5148\u4f1a\u4ee5\u67d0\u79cd\u673a\u5236\u67e5\u627e\u516c\u5171DTD\u7684\u540d\u79f0\uff0c\u67e5\u5230\u4e86\uff0c\u5219\u4ee5\u6b64\u4e3a\u6807\u51c6\uff0c\u5982\u679c\u67e5\u4e0d\u5230\uff0c\u518d\u5230DTD\u4f4d\u7f6e\u4e0a\u53bb\u627e\u3002"),(0,r.kt)("h5",{id:"2xsd"},"\uff082\uff09XSD"),(0,r.kt)("p",null," \u6587\u6863\u7ed3\u6784\u63cf\u8ff0XML Schema Definition \u7f29\u5199\uff0c\u8fd9\u79cd\u6587\u4ef6\u540c\u6837\u53ef\u4ee5\u7528\u6765\u5b9a\u4e49\u6211\u4eecxml\u6587\u4ef6\u7684\u7ed3\u6784\uff01"),(0,r.kt)("p",null,"\u6211\u4eec\u770b\u770bpom\u6587\u4ef6\u7684xml\u5934\u90e8\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\n">\n')),(0,r.kt)("p",null,"1\u3001\u7b2c\u4e00\u884c\u7684xmlns\u4ee3\u8868\u4e86\u4e00\u4e2axml\u6587\u4ef6\u4e2d\u7684\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\uff0c\u901a\u5e38\u662f\u4e00\u4e2a\u552f\u4e00\u7684\u5b57\u7b26\u4e32\uff0c\u4e00\u822c\u4f7f\u7528\u4e00\u4e2aurl\uff0c\u56e0\u4e3a\u4e0d\u4f1a\u91cd\u590d\u561b\u3002"),(0,r.kt)("p",null,"\u5b83\u7684\u8bed\u6cd5\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'xmlns:namespace-prefix="namespaceURI"\n')),(0,r.kt)("p",null,"\u540e\u8fb9\u4ec0\u4e48\u4e5f\u4e0d\u52a0\uff0c\u4ee3\u8868\u9ed8\u8ba4\u547d\u540d\u7a7a\u95f4\uff0c\u6211\u4eec\u5728\u4e66\u5199\u6807\u7b7e\u7684\u65f6\u5019\u4e0d\u9700\u8981\u52a0\u4efb\u4f55\u524d\u7f00\u3002"),(0,r.kt)("p",null,"\u5982\u679c\u6211\u5c06\u5176\u6539\u4e3a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'xmlns:c="http://maven.apache.org/POM/4.0.0"\n')),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211104144031737-01128f11.png",alt:"image-20211104144031737"}),"image-20211104144031737"),(0,r.kt)("p",null,"2\u3001xmlns:xsi \u5b9a\u4e49\u4e86\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u524d\u7f00 xsi \u5bf9\u5e94\u7684\u552f\u4e00\u5b57\u7b26\u4e32 ",(0,r.kt)("a",{parentName:"p",href:"http://www.w3.org/2001/XMLSchema-instance%E3%80%82%E4%BD%86%E8%BF%99%E4%B8%AA"},"http://www.w3.org/2001/XMLSchema-instance\u3002\u4f46\u8fd9\u4e2aopen in new window")," xmlns:xsi \u5728\u4e0d\u540c\u7684 xml \u6587\u6863\u4e2d\u4f3c\u4e4e\u90fd\u4f1a\u51fa\u73b0\u3002 \u8fd9\u662f\u56e0\u4e3a\uff0c xsi \u5df2\u7ecf\u6210\u4e3a\u4e86\u4e00\u4e2a\u4e1a\u754c\u9ed8\u8ba4\u7684\u7528\u4e8e XSD(\uff08XML Schema Definition) \u6587\u4ef6\u7684\u547d\u540d\u7a7a\u95f4\u3002 \u800c XSD \u6587\u4ef6\uff08\u4e5f\u5e38\u5e38\u79f0\u4e3a Schema \u6587\u4ef6\uff09\u662f\u7528\u6765\u5b9a\u4e49 xml \u6587\u6863\u7ed3\u6784\u7684\u3002\u5269\u4f59\u4e24\u884c\u7684\u76ee\u7684\u5728\u4e8e\u4e3a\u6211\u4eec\u7684\u547d\u540d\u7a7a\u95f4\u6307\u5b9a\u5bf9\u5e94\u7684xsd\u6587\u4ef6\u3002"),(0,r.kt)("p",null,"\u4e8b\u5b9e\u4e0a\u6211\u4eec\u8fd9\u4e48\u5199\u4e5f\u662f\u53ef\u4ee5\u7684\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211104144300243-d09e7b2b.png",alt:"image-20211104144300243"}),"image-20211104144300243"),(0,r.kt)("p",null,'\u4e0a\u9762\u8fd9\u884c\u7684\u8bed\u6cd5\u5176\u5b9e\u662f\uff0c xsi:schemaLocation = "ns1url xsd1 ns2url xsd2\u201d'),(0,r.kt)("p",null,"XML Schema\u76f8\u5bf9\u4e8eDTD\u7684\u4f18\u70b9\u5728\u4e8e:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"XML Schema\u57fa\u4e8eXML\uff0c\u6ca1\u6709\u4e13\u95e8\u7684\u8bed\u6cd5\u3002"),(0,r.kt)("li",{parentName:"ol"},"XML Schema\u53ef\u4ee5\u50cf\u5176\u4ed6XML\u6587\u4ef6\u4e00\u6837\u89e3\u6790\u548c\u5904\u7406\u3002"),(0,r.kt)("li",{parentName:"ol"},"XML Schema\u6bd4DTD\u63d0\u4f9b\u4e86\u66f4\u4e30\u5bcc\u7684\u6570\u636e\u7c7b\u578b\u3002"),(0,r.kt)("li",{parentName:"ol"},"XML Schema\u63d0\u4f9b\u53ef\u6269\u5145\u7684\u6570\u636e\u6a21\u578b\u3002"),(0,r.kt)("li",{parentName:"ol"},"XML Schema\u652f\u6301\u7efc\u5408\u547d\u540d\u7a7a\u95f4\u3002"),(0,r.kt)("li",{parentName:"ol"},"XML Schema\u652f\u6301\u5c5e\u6027\u7ec4\u3002")),(0,r.kt)("h3",{id:"7\u7f16\u5199\u5b9e\u4f53\u7c7b"},"7\u3001\u7f16\u5199\u5b9e\u4f53\u7c7b"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"lombok")),(0,r.kt)("p",null,"\u5e73\u65f6\u7684\u5de5\u4f5c\u4e2d\u5199setter\u548cgetter\u4ee5\u53catoString\u65b9\u6cd5\u662f\u4e0d\u662f\u5df2\u7ecf\u70e6\u4e86\uff0c\u6bcf\u6b21\u6dfb\u52a0\u4e00\u4e2a\u5b57\u6bb5\u90fd\u8981\u91cd\u65b0\u6dfb\u52a0\u8fd9\u4e9b\u65b9\u6cd5\u3002"),(0,r.kt)("p",null,"\u4eca\u5929\u6211\u4eec\u5b66\u4e60\u4e00\u4e2a\u795e\u5668\uff0c\u4ece\u6b64\u518d\u4e5f\u4e0d\u7528\u5199\u8fd9\u4e9b\u91cd\u590d\u7684\u4ee3\u7801\u4e86\uff0c\u5b83\u4eec\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u52a8\u6001\u7684\u5e2e\u6211\u4eec\u751f\u6210\u8fd9\u4e9b\u4ee3\u7801\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"javac\u5bf9\u6e90\u4ee3\u7801\u8fdb\u884c\u5206\u6790\uff0c\u751f\u6210\u4e86\u4e00\u68f5\u62bd\u8c61\u8bed\u6cd5\u6811\uff08AST\uff09"),(0,r.kt)("li",{parentName:"ol"},"\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u8c03\u7528\u5b9e\u73b0\u4e86\u201cJSR 269 API\u201d\u7684Lombok\u7a0b\u5e8f"),(0,r.kt)("li",{parentName:"ol"},"\u6b64\u65f6Lombok\u5c31\u5bf9\u7b2c\u4e00\u6b65\u9aa4\u5f97\u5230\u7684AST\u8fdb\u884c\u5904\u7406\uff0c\u627e\u5230@Data\u6ce8\u89e3\u6240\u5728\u7c7b\u5bf9\u5e94\u7684\u8bed\u6cd5\u6811\uff08AST\uff09\uff0c\u7136\u540e\u4fee\u6539\u8be5\u8bed\u6cd5\u6811\uff08AST\uff09\uff0c\u589e\u52a0getter\u548csetter\u65b9\u6cd5\u5b9a\u4e49\u7684\u76f8\u5e94\u6811\u8282\u70b9"),(0,r.kt)("li",{parentName:"ol"},"javac\u4f7f\u7528\u4fee\u6539\u540e\u7684\u62bd\u8c61\u8bed\u6cd5\u6811\uff08AST\uff09\u751f\u6210\u5b57\u8282\u7801\u6587\u4ef6\uff0c\u5373\u7ed9class\u589e\u52a0\u65b0\u7684\u8282\u70b9\uff08\u4ee3\u7801\u5757\uff09")),(0,r.kt)("p",null,"1\uff0c\u9996\u5148\uff0c\u6211\u4eec\u5fc5\u987b\u5b89\u88c5\u4e00\u4e2a\u63d2\u4ef6\uff0c\u5426\u5219\u7f16\u8bd1\u7684\u65f6\u5019\u4f1a\u62a5\u9519\uff0c\u4f60\u6ca1\u6709\u5199setter\u65b9\u6cd5\uff0c\u53c8\u53bb\u8c03\u7528\u5b83\u5f53\u7136\u4e0d\u80fd\u7f16\u8bd1\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211020113926489-cc324000.png",alt:"image-20211020113926489"}),"image-20211020113926489"),(0,r.kt)("p",null,"2\u3001\u5f15\u5165\u4f9d\u8d56\uff0clombok\u5728\u7f16\u8bd1\u7684\u65f6\u5019\uff0c\u4f1a\u6839\u636e\u6211\u4eec\u7684\u6ce8\u89e3\u52a8\u6001\u751f\u6210\u6211\u4eec\u9700\u8981\u7684\u6784\u9020\u65b9\u6cd5\uff0csetter\u548cgetter\u7b49\uff0c\u8fd0\u884c\u7684\u65f6\u5019\u5c31\u6ca1\u7528\u4e86\u3002\u6240\u4ee5scope\u9009\u62e9provided\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --\x3e\n<dependency>\n    <groupId>org.projectlombok</groupId>\n    <artifactId>lombok</artifactId>\n    <version>1.18.16</version>\n    <scope>provided</scope>\n</dependency>\n")),(0,r.kt)("p",null,"\u4ece\u4eca\u5f80\u540e\uff0c\u53ea\u9700\u8981\u5728\u5bf9\u5e94\u7684\u7c7b\u4e0a\u52a0\u4e0a\u8fd9\u51e0\u4e2a\u6ce8\u89e3\uff0c\u5c31\u80fd\u5b8c\u6210\u5bf9\u5e94\u7684\u7f16\u8bd1\u5de5\u4f5c"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"@AllArgsConstructor\uff1a\u751f\u6210\u5168\u53c2\u6784\u9020\u5668\u3002"),(0,r.kt)("li",{parentName:"ul"},"@NoArgsConstructor\uff1a\u751f\u6210\u65e0\u53c2\u6784\u9020\u5668\u3002"),(0,r.kt)("li",{parentName:"ul"},"@Getter/@Setter\uff1a \u4f5c\u7528\u7c7b\u4e0a\uff0c\u751f\u6210\u6240\u6709\u6210\u5458\u53d8\u91cf\u7684getter/setter\u65b9\u6cd5\uff1b\u4f5c\u7528\u4e8e\u6210\u5458\u53d8\u91cf\u4e0a\uff0c\u751f\u6210\u8be5\u6210\u5458\u53d8\u91cf\u7684getter/setter\u65b9\u6cd5\u3002\u53ef\u4ee5\u8bbe\u5b9a\u8bbf\u95ee\u6743\u9650\u53ca\u662f\u5426\u61d2\u52a0\u8f7d\u7b49\u3002"),(0,r.kt)("li",{parentName:"ul"},"@Data\uff1a\u4f5c\u7528\u4e8e\u7c7b\u4e0a\uff0c\u662f\u4ee5\u4e0b\u6ce8\u89e3\u7684\u96c6\u5408\uff1a@ToString @EqualsAndHashCode @Getter @Setter @RequiredArgsConstructor"),(0,r.kt)("li",{parentName:"ul"},"@Log\uff1a\u4f5c\u7528\u4e8e\u7c7b\u4e0a\uff0c\u751f\u6210\u65e5\u5fd7\u53d8\u91cf\u3002\u9488\u5bf9\u4e0d\u540c\u7684\u65e5\u5fd7\u5b9e\u73b0\u4ea7\u54c1\uff0c\u6709\u4e0d\u540c\u7684\u6ce8\u89e3\u3002")),(0,r.kt)("p",null,"\u6ce8\u89e3\u8fd8\u6709\u5f88\u591a\uff0c\u81ea\u884c\u5b66\u4e60\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User implements Serializable {\n\n    private static final Long serialVersionUID = 1L;\n\n    private int id;\n    private String username;\n    private String password;\n}\n")),(0,r.kt)("p",null,"\u6b64\u65f6\u6211\u4eec\u7684User\u662f\u4e0d\u662f\u53d8\u5f97\u5f88\u7b80\u6d01\u5462\uff1f"),(0,r.kt)("p",null,"\u6211\u4eec\u968f\u4fbf\u5199\u4e00\u4e2amain\u65b9\u6cd5\uff0c\u7136\u540e\u7f16\u8bd1\u4e00\u4e0b\uff1a"),(0,r.kt)("p",null,"\u7f16\u8bd1\u540e\u7684\u7ed3\u679c\u662f\u8fd9\u4e2a\u6837\u5b50\u7684\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public class User implements Serializable {\n    private static final Long serialVersionUID = 1L;\n    private int id;\n    private String username;\n    private String password;\n\n    public static void main(String[] args) {\n    }\n\n    public int getId() {\n        return this.id;\n    }\n\n    public String getUsername() {\n        return this.username;\n    }\n\n    public String getPassword() {\n        return this.password;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public boolean equals(Object o) {\n        if (o == this) {\n            return true;\n        } else if (!(o instanceof User)) {\n            return false;\n        } else {\n            User other = (User)o;\n            if (!other.canEqual(this)) {\n                return false;\n            } else if (this.getId() != other.getId()) {\n                return false;\n            } else {\n                Object this$username = this.getUsername();\n                Object other$username = other.getUsername();\n                if (this$username == null) {\n                    if (other$username != null) {\n                        return false;\n                    }\n                } else if (!this$username.equals(other$username)) {\n                    return false;\n                }\n\n                Object this$password = this.getPassword();\n                Object other$password = other.getPassword();\n                if (this$password == null) {\n                    if (other$password != null) {\n                        return false;\n                    }\n                } else if (!this$password.equals(other$password)) {\n                    return false;\n                }\n\n                return true;\n            }\n        }\n    }\n\n    protected boolean canEqual(Object other) {\n        return other instanceof User;\n    }\n\n    public int hashCode() {\n        int PRIME = true;\n        int result = 1;\n        int result = result * 59 + this.getId();\n        Object $username = this.getUsername();\n        result = result * 59 + ($username == null ? 43 : $username.hashCode());\n        Object $password = this.getPassword();\n        result = result * 59 + ($password == null ? 43 : $password.hashCode());\n        return result;\n    }\n\n    public String toString() {\n        int var10000 = this.getId();\n        return "User(id=" + var10000 + ", username=" + this.getUsername() + ", password=" + this.getPassword() + ")";\n    }\n\n    public User(int id, String username, String password) {\n        this.id = id;\n        this.username = username;\n        this.password = password;\n    }\n\n    public User() {\n    }\n}\n')),(0,r.kt)("p",null,"\u6211\u4eec\u53d1\u73b0\uff0c\u7f16\u8bd1\u540e\u6ce8\u89e3\u6ca1\u4e86\uff0c\u5176\u4ed6\u7684\u90fd\u6709\u4e86\uff0c\u81ea\u7136\u8fd0\u884c\u65f6\u5c31\u80fd\u8c03\u7528\u4e86\u5440\uff01"),(0,r.kt)("h2",{id:"\u4e09\u65e5\u5fd7\u914d\u7f6e"},"\u4e09\u3001\u65e5\u5fd7\u914d\u7f6e"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u914d\u7f6e\u65e5\u5fd7\u7684\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\u662f\u60f3\u5728\u8c03\u8bd5\u7684\u65f6\u5019\u80fd\u89c2\u5bdf\u5230sql\u8bed\u53e5\u7684\u8f93\u51fa\uff0c\u80fd\u67e5\u770b\u4e2d\u95f4\u8fc7\u7a0b")),(0,r.kt)("h3",{id:"1\u6807\u51c6\u65e5\u5fd7\u5b9e\u73b0"},"1\u3001\u6807\u51c6\u65e5\u5fd7\u5b9e\u73b0"),(0,r.kt)("p",null,"\u6307\u5b9a MyBatis \u5e94\u8be5\u4f7f\u7528\u54ea\u4e2a\u65e5\u5fd7\u8bb0\u5f55\u5b9e\u73b0\u3002\u5982\u679c\u6b64\u8bbe\u7f6e\u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u81ea\u52a8\u53d1\u73b0\u65e5\u5fd7\u8bb0\u5f55\u5b9e\u73b0\u3002"),(0,r.kt)("p",null,"STD\uff1astandard out\uff1a\u8f93\u51fa"),(0,r.kt)("p",null,"STDOUT_LOGGING\uff1a\u6807\u51c6\u8f93\u51fa\u65e5\u5fd7"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<settings>\n    <setting name="logImpl" value="STDOUT_LOGGING"/>\n</settings>\n')),(0,r.kt)("p",null,"\u8fd9\u5c31\u597d\u4e86\uff0c\u6267\u884c\u4e00\u4e0b\u770b\u770b\u3002"),(0,r.kt)("h3",{id:"2\u7ec4\u5408logback\u5b8c\u6210\u65e5\u5fd7\u529f\u80fd\u6269\u5c55"},"2\u3001\u7ec4\u5408logback\u5b8c\u6210\u65e5\u5fd7\u529f\u80fd\uff08\u6269\u5c55\uff09"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4f7f\u7528\u6b65\u9aa4\uff1a")),(0,r.kt)("p",null,"1\u3001\u5bfc\u5165log4j\u7684\u5305"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>ch.qos.logback</groupId>\n    <artifactId>logback-classic</artifactId>\n    <version>${logback.version}</version>\n</dependency>\n")),(0,r.kt)("p",null,"2\u3001\u914d\u7f6e\u6587\u4ef6\u7f16\u5199 log4j.properties"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<configuration>\n\n    <property name="pattern" value="%d{yyyy-MM-dd HH:mm:ss} %c [%thread] %-5level %msg%n"/>\n    <property name="log_dir" value="d:/logs" />\n\n    <appender name="console" class="ch.qos.logback.core.ConsoleAppender">\n        <target>System.out</target>\n        <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">\n            <pattern>${pattern}</pattern>\n        </encoder>\n    </appender>\n\n    <appender name="file" class="ch.qos.logback.core.FileAppender">\n        \x3c!--\u65e5\u5fd7\u683c\u5f0f\u914d\u7f6e--\x3e\n        <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">\n            <pattern>${pattern}</pattern>\n        </encoder>\n        \x3c!--\u65e5\u5fd7\u8f93\u51fa\u8def\u5f84--\x3e\n        <file>${log_dir}/sql.log</file>\n    </appender>\n\n    <root level="ALL">\n        <appender-ref ref="console"/>\n    </root>\n\n    <logger name="mybatis.sql" level="debug" additivity="false">\n        <appender-ref ref="console"/>\n        <appender-ref ref="file"/>\n    </logger>\n\n</configuration>\n')),(0,r.kt)("p",null,"3\u3001setting\u8bbe\u7f6e\u65e5\u5fd7\u5b9e\u73b0"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<settings>\n   <setting name="logImpl" value="SLF4J"/>\n</settings>\n')),(0,r.kt)("h2",{id:"\u56dbcrud\u6765\u4e00\u5957"},"\u56db\u3001CRUD\u6765\u4e00\u5957"),(0,r.kt)("h3",{id:"1\u57fa\u672c\u6d41\u7a0b"},"1\u3001\u57fa\u672c\u6d41\u7a0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'// 1\u3001\u521b\u5efa\u4e00\u4e2aSqlSessionFactory\u7684 \u5efa\u9020\u8005 \uff0c\u7528\u4e8e\u521b\u5efaSqlSessionFactory\n// SqlSessionFactoryBuilder\u4e2d\u6709\u5927\u91cf\u7684\u91cd\u8f7d\u7684build\u65b9\u6cd5\uff0c\u53ef\u4ee5\u6839\u636e\u4e0d\u540c\u7684\u5165\u53c2\uff0c\u8fdb\u884c\u6784\u5efa\n// \u6781\u5927\u7684\u63d0\u9ad8\u4e86\u7075\u6d3b\u6027\uff0c\u6b64\u5904\u4f7f\u7528\u3010\u521b\u5efa\u8005\u8bbe\u8ba1\u6a21\u5f0f\u3011\nSqlSessionFactoryBuilder builder = new SqlSessionFactoryBuilder();\n// 2\u3001\u4f7f\u7528builder\u6784\u5efa\u4e00\u4e2asqlSessionFactory\uff0c\u6b64\u5904\u6211\u4eec\u57fa\u4e8e\u4e00\u4e2axml\u914d\u7f6e\u6587\u4ef6\n// \u6b64\u8fc7\u7a0b\u4f1a\u8fdb\u884cxml\u6587\u4ef6\u7684\u89e3\u6790\uff0c\u8fc7\u7a0b\u76f8\u5bf9\u6bd4\u8f83\u590d\u6742\nSqlSessionFactory sqlSessionFactory = builder.build(Thread.currentThread().getContextClassLoader().getResourceAsStream("mybatis-config.xml"));\n// 3\u3001\u901a\u8fc7sqlSessionFactory\u83b7\u53d6\u53e6\u4e00\u4e2asession\uff0c\u6b64\u5904\u4f7f\u7528\u3010\u5de5\u5382\u8bbe\u8ba1\u6a21\u5f0f\u3011\nSqlSession sqlSession = sqlSessionFactory.openSession();\n')),(0,r.kt)("p",null,"1\u3001\u521b\u5efa\u4e00\u4e2aSqlSessionFactory\u7684 \u5efa\u9020\u8005 \uff0c\u7528\u4e8e\u521b\u5efaSqlSessionFactory"),(0,r.kt)("p",null,"2\u3001\u4f7f\u7528builder\u6784\u5efa\u4e00\u4e2asqlSessionFactory\uff0c\u6b64\u5904\u6211\u4eec\u57fa\u4e8e\u4e00\u4e2axml\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("p",null,"3\u3001\u901a\u8fc7sqlSessionFactory\u83b7\u53d6\u53e6\u4e00\u4e2asession\uff0c\u6b64\u5904\u4f7f\u7528\u3010\u5de5\u5382\u8bbe\u8ba1\u6a21\u5f0f\u3011"),(0,r.kt)("p",null,"4\u3001\u4e00\u4e2asqlsession\u5c31\u662f\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528sqlsession\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u64cd\u4f5c\uff0c\u539f\u7406\u540e\u8fb9\u4f1a\u8bb2\u3002"),(0,r.kt)("p",null,"\u5176\u5b9e\u7b2c\u4e00\u6b21\u4f7f\u7528sqlsession\u6211\u4eec\u53ef\u80fd\u4f1a\u8fd9\u4e48\u64cd\u4f5c\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'try (SqlSession sqlSession = sqlSessionFactory.openSession();){\n    List<Object> objects = sqlSession.selectList("select * from user");\n}\n')),(0,r.kt)("h4",{id:"1sqlsessionfactory"},"\uff081\uff09SqlSessionFactory"),(0,r.kt)("p",null," \u6bcf\u4e2a\u57fa\u4e8e MyBatis \u7684\u5e94\u7528\u90fd\u662f\u4ee5\u4e00\u4e2a SqlSessionFactory \u7684\u5b9e\u4f8b\u4e3a\u6838\u5fc3\u7684\u3002SqlSessionFactory \u7684\u5b9e\u4f8b\u53ef\u4ee5\u901a\u8fc7 SqlSessionFactoryBuilder \u83b7\u5f97\u3002\u800c SqlSessionFactoryBuilder \u5219\u53ef\u4ee5\u4ece XML \u914d\u7f6e\u6587\u4ef6\u6216\u4e00\u4e2a\u9884\u5148\u914d\u7f6e\u7684 Configuration \u5b9e\u4f8b\u6765\u6784\u5efa\u51fa SqlSessionFactory \u5b9e\u4f8b\u3002"),(0,r.kt)("p",null," SqlSessionFactory \u4e00\u65e6\u88ab\u521b\u5efa\u5c31\u5e94\u8be5\u5728\u5e94\u7528\u7684\u8fd0\u884c\u671f\u95f4\u4e00\u76f4\u5b58\u5728\uff0c\u6ca1\u6709\u4efb\u4f55\u7406\u7531\u4e22\u5f03\u5b83\u6216\u91cd\u65b0\u521b\u5efa\u53e6\u4e00\u4e2a\u5b9e\u4f8b\u3002 \u4f7f\u7528 SqlSessionFactory \u7684\u6700\u4f73\u5b9e\u8df5\u662f\u5728\u5e94\u7528\u8fd0\u884c\u671f\u95f4\u4e0d\u8981\u91cd\u590d\u521b\u5efa\u591a\u6b21\uff0c\u591a\u6b21\u91cd\u5efa SqlSessionFactory \u88ab\u89c6\u4e3a\u4e00\u79cd\u4ee3\u7801\u201c\u574f\u4e60\u60ef\u201d\u3002\u56e0\u6b64 SqlSessionFactory \u7684\u6700\u4f73\u4f5c\u7528\u57df\u662f\u5e94\u7528\u4f5c\u7528\u57df\u3002 \u6709\u5f88\u591a\u65b9\u6cd5\u53ef\u4ee5\u505a\u5230\uff0c\u6700\u7b80\u5355\u7684\u5c31\u662f\u4f7f\u7528\u5355\u4f8b\u6a21\u5f0f\u3002"),(0,r.kt)("h4",{id:"2sqlsession"},"\uff082\uff09SqlSession"),(0,r.kt)("p",null," \u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u5e94\u8be5\u6709\u5b83\u81ea\u5df1\u7684 SqlSession \u5b9e\u4f8b\u3002SqlSession \u7684\u5b9e\u4f8b\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u56e0\u6b64\u662f\u4e0d\u80fd\u88ab\u5171\u4eab\u7684\uff0c\u6240\u4ee5\u5b83\u7684\u6700\u4f73\u7684\u4f5c\u7528\u57df\u662f\u8bf7\u6c42\u6216\u65b9\u6cd5\u4f5c\u7528\u57df\u3002 \u7edd\u5bf9\u4e0d\u80fd\u5c06 SqlSession \u5b9e\u4f8b\u7684\u5f15\u7528\u653e\u5728\u4e00\u4e2a\u7c7b\u7684\u9759\u6001\u57df\uff0c\u751a\u81f3\u4e00\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u53d8\u91cf\u4e5f\u4e0d\u884c\u3002 \u4e5f\u7edd\u4e0d\u80fd\u5c06 SqlSession \u5b9e\u4f8b\u7684\u5f15\u7528\u653e\u5728\u4efb\u4f55\u7c7b\u578b\u7684\u6258\u7ba1\u4f5c\u7528\u57df\u4e2d\uff0c\u6bd4\u5982 Servlet \u6846\u67b6\u4e2d\u7684 HttpSession\u3002 \u6362\u53e5\u8bdd\u8bf4\uff0c\u6bcf\u6b21\u6536\u5230 HTTP \u8bf7\u6c42\uff0c\u5c31\u53ef\u4ee5\u6253\u5f00\u4e00\u4e2a SqlSession\uff0c\u8fd4\u56de\u4e00\u4e2a\u54cd\u5e94\u540e\uff0c\u5c31\u5173\u95ed\u5b83\u3002 \u8fd9\u4e2a\u5173\u95ed\u64cd\u4f5c\u5f88\u91cd\u8981\uff0c\u4e3a\u4e86\u786e\u4fdd\u6bcf\u6b21\u90fd\u80fd\u6267\u884c\u5173\u95ed\u64cd\u4f5c\uff0c\u4f60\u5e94\u8be5\u628a\u8fd9\u4e2a\u5173\u95ed\u64cd\u4f5c\u653e\u5230 finally \u5757\u4e2d\u3002 \u4e0b\u9762\u7684\u793a\u4f8b\u5c31\u662f\u4e00\u4e2a\u786e\u4fdd SqlSession \u5173\u95ed\u7684\u6807\u51c6\u6a21\u5f0f\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"try (SqlSession session = sqlSessionFactory.openSession()) {\n  // \u4f60\u7684\u5e94\u7528\u903b\u8f91\u4ee3\u7801\n}\n")),(0,r.kt)("p",null,"\u5728\u6240\u6709\u4ee3\u7801\u4e2d\u90fd\u9075\u5faa\u8fd9\u79cd\u4f7f\u7528\u6a21\u5f0f\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6240\u6709\u6570\u636e\u5e93\u8d44\u6e90\u90fd\u80fd\u88ab\u6b63\u786e\u5730\u5173\u95ed\u3002"),(0,r.kt)("h4",{id:"3\u6d4b\u8bd5"},"\uff083\uff09\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'private SqlSessionFactory sqlSessionFactory = null;\nprivate static final Logger LOGGER = LoggerFactory.getLogger(TestMybatis.class);\n\n@Before\npublic void build() {\n    SqlSessionFactoryBuilder builder = new SqlSessionFactoryBuilder();\n    sqlSessionFactory = builder.build(Thread.currentThread().getContextClassLoader().getResourceAsStream("mybatis-config.xml"));\n}\n')),(0,r.kt)("p",null,"\u5f53\u6211\u4eec\u770b\u5230sqlSession\u6709selectList\uff0cdelete\uff0cupdate\u7b49\u65b9\u6cd5\u65f6\uff0c\u6211\u4eec\u4f1a\u5fcd\u4e0d\u4f4f\u8fd9\u6837\u53bb\u4f7f\u7528\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void testSession(){\n    try (SqlSession sqlSession = sqlSessionFactory.openSession();){\n        List<Object> objects = sqlSession.selectList("select * from user");\n        System.out.println(objects);\n    }\n}\n')),(0,r.kt)("p",null,"\u4f46\u662f\u8fd9\u6837\u786e\u5b9e\u662f\u9519\u8bef\u7684\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"org.apache.ibatis.exceptions.PersistenceException: \n### Error querying database.  Cause: java.lang.IllegalArgumentException: Mapped Statements collection does not contain value for select * from user\n### Cause: java.lang.IllegalArgumentException: Mapped Statements collection does not contain value for select * from user\n")),(0,r.kt)("p",null,"\u9519\u8bef\u6d88\u606f\u4e2d\u663e\u793aMapped Statements collection does not contain value for select ",(0,r.kt)("em",{parentName:"p"}," from user\uff0c\u8bf4\u662fmapper\u7684\u7533\u660e\u4e2d\u6ca1\u6709\u201cselect ")," from user\u201d\uff0c\u5176\u5b9e\u8fd9\u91cc\u8ba9\u4f60\u586b\u7684\u662f\u4e00\u4e2a\u7533\u660e\u3002\u6211\u4eec\u5728\u6e90\u7801\u6ce8\u91ca\u4e2d\u53ef\u4ee5\u770b\u5230\uff1a\u3011"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"/**\n* Retrieve a list of mapped objects from the statement key.\n* @param <E> the returned list element type\n* @param statement Unique identifier matching the statement to use.//\u4e0e\u8981\u4f7f\u7528\u7684\u8bed\u53e5\u5339\u914d\u7684\u552f\u4e00\u6807\u8bc6\u7b26\u3002  \n* @return List of mapped object\n*/\n<E> List<E> selectList(String statement);\n")),(0,r.kt)("p",null,"\u8bf4\u660e\u8fd9\u4e2a\u8fd8\u9700\u8981\u901a\u8fc7\u4f7f\u7528sql\u7684\u4e00\u4e2a\u6807\u8bc6\u7b26\u3002\u5728MyBatis\u4e2d\u6211\u4eec\u8fd8\u9700\u8981\u4e00\u4e2asql\u7684\u6620\u5c04\u6587\u4ef6\u6765\u7ed9\u6bcf\u4e00\u4e2asql\u8bed\u53e5\u5b9a\u4e49\u4e00\u4e2a\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u6211\u4eec\u8d77\u540dUserMapper.xml\uff0c\u5c06\u8fd9\u4e2a\u6587\u4ef6\u653e\u5728resources\u6587\u4ef6\u5939\u4e0b\u7684mapper\u6587\u4ef6\u5939\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="UserMapper">\n    <select id="selectOne" resultType="com.ydlclass.User">\n        select * from user where id = #{id}\n    </select>\n</mapper>\n')),(0,r.kt)("p",null,"\u8fd8\u9700\u8981\u8bb2\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u6ce8\u518c\u5230\u4e3b\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5728\u6700\u540e\u8fb9\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<mappers>\n    <mapper resource="mapper/UserMapper.xml"/>\n</mappers>\n')),(0,r.kt)("p",null,"\u6211\u4eec\u4f1a\u53d1\u73b0\u6bcf\u4e00\u4e2amapper\u6620\u5c04\u6587\u4ef6\u90fd\u6709\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\uff0c\u4ece\u4e0b\u8fb9\u7684\u7528\u6cd5\u6765\u770b\u6211\u4eec\u80fd\u5927\u81f4\u660e\u767d\u547d\u540d\u7a7a\u95f4\u7684\u4f5c\u7528\u3002\u5c31\u5982\u540c\u6211\u4eec\u56fd\u5bb6\u53ef\u4ee5\u6709\u76f8\u540c\u540d\u5b57\u7684\u53bf\uff0c\u4f46\u662f\u52a0\u4e0a\u5e02\u4ee5\u540e\u6211\u4eec\u5c31\u80fd\u5f88\u8f7b\u677e\u7684\u533a\u522b\u4e24\u4e2a\u53bf\uff0c\u8fd9\u4e2a\u5e02\u5c31\u662f\u53bf\u7684\u547d\u540d\u7a7a\u95f4\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'try (SqlSession sqlSession = sqlSessionFactory.openSession();){\n    List<Object> users = sqlSession.selectList("UserMapper.selectAll");\n    LOGGER.debug("result is [{}]",objects);\n}\n')),(0,r.kt)("p",null,"\u6211\u4eec\u5f97\u5230\u4e86\u6b63\u786e\u7684\u7ed3\u679c\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211104145927906-b917f2eb.png",alt:"image-20211104145927906"}),"image-20211104145927906"),(0,r.kt)("p",null,"\u5f53\u7136\u4e0d\u52a0\u547d\u540d\u7a7a\u95f4\u4e5f\u53ef\uff0c\u56e0\u4e3a\u6211\u4eec\u5e76\u6ca1\u6709\u5176\u4ed6\u91cd\u590d\u7684\u6807\u8bc6\u7b26\uff0c\u8fd9\u4e2aselectOne\u5c31\u662f\u8fd9\u6761\u8bed\u53e5\u7684\u6807\u8bc6\u7b26\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'try (SqlSession sqlSession = sqlSessionFactory.openSession();){\n    List<Object> users = sqlSession.selectList("selectAll");\n    LOGGER.debug("result is [{}]",objects);\n}\n')),(0,r.kt)("h4",{id:"4\u52a8\u6001\u4ee3\u7406\u5b9e\u73b0"},"\uff084\uff09\u52a8\u6001\u4ee3\u7406\u5b9e\u73b0"),(0,r.kt)("p",null,"\u4f46\u662fMyBatis\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u66f4\u597d\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u8fd9\u79cd\u65b9\u6848\u4f7f\u7528\u52a8\u6001\u4ee3\u7406\u7684\u6280\u672f\u5b9e\u73b0\uff0c\u540e\u8fb9\u4f1a\u8be6\u7ec6\u8bb2\u3002\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\uff1a"),(0,r.kt)("p",null,"1\u3001\u5b9a\u4e49\u4e00\u4e2a\u63a5\u53e3\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public interface UserMapper {\n    List<User> selectAll();\n}\n")),(0,r.kt)("p",null,"2\u3001\u4fee\u6539\u6620\u5c04\u6587\u4ef6\uff0c\u8ba9\u547d\u540d\u7a7a\u95f4\u6539\u4e3a\u63a5\u53e3\u7684\u6743\u9650\u5b9a\u540d\uff0cid\u6539\u4e3a\u65b9\u6cd5\u7684\u540d\u5b57"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<mapper namespace="com.ydlclass.mapper.UserMapper">\n    <select id="selectAll" resultType="com.ydlclass.entity.User">\n        select * from user\n    </select>\n</mapper>\n')),(0,r.kt)("p",null,"3\u3001\u6211\u4eec\u53ef\u4ee5\u5f88\u7b80\u5355\u7684\u4f7f\u7528\u5982\u4e0b\u7684\u65b9\u6cd5\u64cd\u4f5c\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'try (SqlSession sqlSession = sqlSessionFactory.openSession();){\n    UserMapper mapper = sqlSession.getMapper(UserMapper.class);\n    List<User> list = mapper.selectAll();\n    LOGGER.debug("result is [{}]",list);\n}\n')),(0,r.kt)("p",null,"\u8fd9\u6837\u5199\u8d77\u6765\u7b80\u76f4\u4e0d\u8981\u592a\u8212\u670d\uff0c\u4e5f\u786e\u5b9e\u62ff\u5230\u4e86\u5bf9\u5e94\u7684\u7ed3\u679c\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211104145927906-b917f2eb.png",alt:"image-20211104145927906"}),"image-20211104145927906"),(0,r.kt)("p",null," \u8fd9\u91cc\u5f88\u660e\u663e\u4f7f\u7528\u4e86\u52a8\u6001\u4ee3\u7406\u7684\u65b9\u5f0f\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"sqlSession.getMapper(UserMapper.class);"),"\u5e2e\u6211\u4eec\u751f\u6210\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u63a5\u53e3\u7684\u65b9\u6cd5\uff0c\u5177\u4f53\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u6bd4\u5982\u5efa\u7acb\u8fde\u63a5\uff0c\u521b\u5efastatment\u7b49\u91cd\u590d\u6027\u7684\u5de5\u4f5c\u4ea4\u7ed9\u6846\u67b6\u6765\u5904\u7406\uff0c\u552f\u4e00\u9700\u8981\u989d\u5916\u8865\u5145\u7684\u5c31\u662fsql\u8bed\u53e5\u4e86\uff0cxml\u6587\u4ef6\u5c31\u662f\u5728\u8865\u5145\u8fd9\u4e2a\u63cf\u8ff0\u4fe1\u606f\uff0c\u6bd4\u5982\u5177\u4f53\u7684sql\uff0c\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u7b49\uff0c\u6846\u67b6\u4f1a\u6839\u636e\u547d\u540d\u7a7a\u95f4\u81ea\u52a8\u5339\u914d\u5bf9\u5e94\u7684\u63a5\u53e3\uff0c\u6839\u636eid\u81ea\u52a8\u5339\u914d\u63a5\u53e3\u7684\u65b9\u6cd5\uff0c\u4e0d\u9700\u8981\u6211\u4eec\u518d\u505a\u989d\u5916\u7684\u64cd\u4f5c\u3002"),(0,r.kt)("p",null,"\u63a5\u4e0b\u6765\u6211\u4eec\u5c31\u628a\u589e\u5220\u6539\u67e5\u5168\u90e8\u5199\u4e00\u4e0b\uff0c\u611f\u53d7\u4e00\u4e0b\uff1a"),(0,r.kt)("h3",{id:"2select\u67e5\u8be2"},"2\u3001select\uff08\u67e5\u8be2\uff09"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"select\u6807\u7b7e\u662fmybatis\u4e2d\u6700\u5e38\u7528\u7684\u6807\u7b7e")),(0,r.kt)("p",null,"1\u3001\u5728UserMapper\u4e2d\u6dfb\u52a0\u5bf9\u5e94\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"/**\n     * \u6839\u636eid\u67e5\u8be2\u7528\u6237\n     * @param id\n     * @return\n     */\nUser selectUserById(int id);\n")),(0,r.kt)("p",null,"2\u3001\u5728UserMapper.xml\u4e2d\u6dfb\u52a0Select\u8bed\u53e5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="selectUserById" resultType="com.ydlclass.entity.User"  parameterType="int">\n    select id,username,password from user where id = #{id}\n</select>\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u65b0\u7684\u77e5\u8bc6\u70b9\uff0c\u5728\u6620\u5c04\u6587\u4ef6\u4e2d\u6709\u4e00\u4e9b\u5c5e\u6027\uff1a")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"resultType\uff1a\u6307\u5b9a\u8fd4\u56de\u7c7b\u578b\uff0c\u67e5\u8be2\u662f\u6709\u7ed3\u679c\u7684\uff0c\u7ed3\u679c\u5565\u7c7b\u578b\uff0c\u4f60\u5f97\u544a\u8bc9\u6211"),(0,r.kt)("li",{parentName:"ul"},"parameterType\uff1a\u6307\u5b9a\u53c2\u6570\u7c7b\u578b\uff0c\u67e5\u8be2\u662f\u6709\u53c2\u6570\u7684\uff0c\u53c2\u6570\u5565\u7c7b\u578b\uff0c\u4f60\u5f97\u544a\u8bc9\u6211"),(0,r.kt)("li",{parentName:"ul"},"id\uff1a\u6307\u5b9a\u5bf9\u5e94\u7684\u65b9\u6cd5\u6620\u5c04\u5173\u7cfb\uff0c\u5c31\u662f\u4f60\u5f97\u544a\u8bc9\u6211\u4f60\u8fd9sql\u5bf9\u5e94\u7684\u662f\u54ea\u4e2a\u65b9\u6cd5"),(0,r.kt)("li",{parentName:"ul"},"#","{id}\uff1asql\u4e2d\u7684\u53d8\u91cf\uff0c\u8981\u4fdd\u8bc1\u5927\u62ec\u53f7\u7684\u53d8\u91cf\u5fc5\u987b\u5728User\u5bf9\u8c61\u91cc\u6709"),(0,r.kt)("li",{parentName:"ul"},"#","{}\uff1a\u5360\u4f4d\u7b26\uff0c\u5176\u5b9e\u5c31\u662f\u54b1\u4eec\u7684\u3010",(0,r.kt)("strong",{parentName:"li"},"PreparedStatement"),"\u3011\u5904\u7406\u8fd9\u4e2a\u53d8\u91cf\uff0cmybatis\u4f1a\u5c06\u5b83\u66ff\u6362\u6210",(0,r.kt)("inlineCode",{parentName:"li"},"?"))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u9664\u4e86#{}\u8fd8\u6709${}\uff0c\u770b\u770b\u6709\u5565\u533a\u522b\uff0c\u9762\u8bd5\u5e38\u95ee")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"#","{} \u7684\u4f5c\u7528\u4e3b\u8981\u662f\u66ff\u6362\u9884\u7f16\u8bd1\u8bed\u53e5(PrepareStatement)\u4e2d\u7684\u5360\u4f4d\u7b26? \u3010\u63a8\u8350\u4f7f\u7528\u3011")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```sql\nINSERT INTO user (username) VALUES (#{username});\nINSERT INTO user (username) VALUES (?);\n```\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"${} \u7684\u4f5c\u7528\u662f\u76f4\u63a5\u8fdb\u884c\u5b57\u7b26\u4e32\u66ff\u6362")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```sql\nINSERT INTO user (username) VALUES ('${username}');\nINSERT INTO user (username) VALUES ('\u6960\u54e5');\n```\n")),(0,r.kt)("p",null,"3\u3001\u6d4b\u8bd5\u7c7b\u4e2d\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'try (SqlSession sqlSession = sqlSessionFactory.openSession();){\n    UserMapper mapper = sqlSession.getMapper(UserMapper.class);\n    User user = mapper.selectUserById(1);\n    LOGGER.debug("the user is [{}]",user);\n}\n')),(0,r.kt)("p",null,"\u7ed3\u679c\u6b63\u786e\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211020153327382-25da914f.png",alt:"image-20211020153327382"}),"image-20211020153327382"),(0,r.kt)("p",null,"\u6211\u4eec\u4e0d\u59a8\u628asession\u7684\u521b\u5efa\u5b9a\u4e49\u6210\u4e00\u4e2a\u65b9\u6cd5\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'private static SqlSession open(){\n    // 1\u3001\u521b\u5efa\u4e00\u4e2aSqlSessionFactory\u7684 \u5efa\u9020\u8005 \uff0c\u7528\u4e8e\u521b\u5efaSqlSessionFactory\n    SqlSessionFactoryBuilder builder = new SqlSessionFactoryBuilder();\n    // 2\u3001\u4f7f\u7528builder\u6784\u5efa\u4e00\u4e2asqlSessionFactory\uff0c\u6b64\u5904\u6211\u4eec\u57fa\u4e8e\u4e00\u4e2axml\u914d\u7f6e\u6587\u4ef6\n    SqlSessionFactory sqlSessionFactory = builder.build(Thread.currentThread().getContextClassLoader().getResourceAsStream("mybatis-config.xml"));\n    // 3\u3001\u901a\u8fc7sqlSessionFactory\u83b7\u53d6\u53e6\u4e00\u4e2asession\uff0c\u6b64\u5904\u4f7f\u7528\u3010\u5de5\u5382\u8bbe\u8ba1\u6a21\u5f0f\u3011\n    return sqlSessionFactory.openSession();\n}\n')),(0,r.kt)("h3",{id:"3insert\u63d2\u5165"},"3\u3001insert\uff08\u63d2\u5165\uff09"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"insert\u6807\u7b7e\u88ab\u7528\u4f5c\u63d2\u5165\u64cd\u4f5c")),(0,r.kt)("p",null,"1\u3001\u63a5\u53e3\u4e2d\u6dfb\u52a0\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"/**\n     * \u65b0\u589euser\n     * @param user\n     * @return\n     */\nint addUser(User user);\n")),(0,r.kt)("p",null,"2\u3001xml\u4e2d\u52a0\u5165insert\u8bed\u53e5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<insert id="addUser" parameterType="com.ydlclass.entity.User">\n    insert into user (id,username,password) values (#{id},#{username},#{password})\n</insert>\n')),(0,r.kt)("p",null,"3\u3001\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void testAdd(){\n    SqlSession sqlSession = open();\n    UserMapper mapper = sqlSession.getMapper(UserMapper.class);\n    int rows = mapper.addUser(new User(10, "lucy", "123"));\n    LOGGER.debug("Affected rows: [{}]",rows);\n}\n')),(0,r.kt)("p",null,"\u8fd4\u56de\u503c\u662f1\uff0c\u4f60\u6b23\u559c\u82e5\u72c2\uff0c\u603b\u4ee5\u4e3a\u5c31\u662f\u8fd9\u4e48\u7b80\u5355\uff0c\u4f46\u4e8b\u5b9e\u662f\uff0c\u6570\u636e\u5e93\u538b\u6839\u6ca1\u6709\u5b58\u8fdb\u53bb\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211020155233979-2bf9b328.png",alt:"image-20211020155233979"}),"image-20211020155233979"),(0,r.kt)("p",null,"\u6ce8\uff1a\u589e\u3001\u5220\u3001\u6539\u64cd\u4f5c\u9700\u8981\u63d0\u4ea4\u4e8b\u52a1\uff01\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0bMySQL\u7684\u4e8b\u52a1\u662f\u81ea\u52a8\u63d0\u4ea4\u7684\uff0c\u800c\u6846\u67b6\u5374\u9ed8\u8ba4\u8bbe\u7f6e\u6210\u4e86\u624b\u52a8\u63d0\u4ea4\uff0c\u6211\u4eec\u5f00\u542f\u4e86\u4e8b\u52a1\uff0c\u53c8\u6ca1\u6709\u53bb\u63d0\u4ea4\u4e8b\u52a1\uff0c\u7ed3\u675f\u540e\u81ea\u7136\u4f1a\u56de\u6eda\u554a:"),(0,r.kt)("p",null,"\u7b2c\u4e00\u79cd\u65b9\u5f0f\uff0c\u5728openSession\u65b9\u6cd5\u4f20\u5165true\uff0c\u5c31\u53d8\u6210\u81ea\u52a8\u63d0\u4ea4\u4e86\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"sqlSessionFactory.openSession(true);\n")),(0,r.kt)("p",null,"\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u624b\u52a8\u63d0\u4ea4\uff0c\u4e8b\u5b9e\u4e0a\u6211\u4eec\u80af\u5b9a\u8981\u624b\u52a8\u63d0\u4ea4\u4e8b\u52a1\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void testAdd(){\n    SqlSession sqlSession = open();\n    UserMapper mapper = sqlSession.getMapper(UserMapper.class);\n    int rows = mapper.addUser(new User(10, "lucy", "123"));\n    LOGGER.debug("Affected rows: [{}]",rows);\n    sqlSession.commit();\n    sqlSession.close();\n}\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u601d\u8003\uff0c\u5982\u679c\u53c2\u6570\u6ca1\u6709\u4f20\u5b9e\u4f53\u7c7b\u800c\u662f\u4f20\u4e86\u591a\u4e2a\u53c2\u6570\uff0c\uff0c\u80fd\u4e0d\u80fd\u6267\u884c")),(0,r.kt)("p",null,"\u6bd4\u5982\u6570\u636e\u5e93\u4e3aid\uff0c\u65b9\u5f0f\u4f20\u5165userId"),(0,r.kt)("p",null,"1\u3001\u5728UserMapper\u4e2d\u6dfb\u52a0\u5bf9\u5e94\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"/**\n     * \u65b0\u589e\u7528\u6237\n     * @param id\n     * @param name\n     * @param pws\n     * @return\n     */\nint insertUser(int id,String name,String pws);\n")),(0,r.kt)("p",null,"2\u3001\u5728UserMapper.xml\u4e2d\u6dfb\u52a0Select\u8bed\u53e5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<insert id="insertUser" parameterType="com.ydlclass.entity.User">\n    insert into user (id,username,password) values (#{id},#{username},#{password})\n</insert>\n')),(0,r.kt)("p",null,"3\u3001\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\n    public void testInsert(){\n        SqlSession sqlSession = open();\n        UserMapper mapper = sqlSession.getMapper(UserMapper.class);\n        int rows = mapper.insertUser(10, "lucy", "123");\n        LOGGER.debug("Affected rows: [{}]",rows);\n        sqlSession.commit();\n        sqlSession.close();\n    }\n')),(0,r.kt)("p",null,"\u51fa\u95ee\u9898\u4e86"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"}," Cause: org.apache.ibatis.binding.BindingException: Parameter 'id' not found. Available parameters are [arg2, arg1, arg0, param3, param1, param2]\n")),(0,r.kt)("p",null,"\u8fd9\u5c31\u65e0\u6cd5\u6620\u5c04\u4e86\u3002"),(0,r.kt)("p",null,"\u8fd9\u5c31\u9700\u8981\u6ce8\u89e3@Param\u4e86\uff0c\u8fd9\u5176\u5b9e\u5c31\u662f\u5728\u505a\u6620\u5c04\u5173\u7cfb\uff0cxml\u91cc\u7684${username}\u548c\u65b9\u6cd5\u4e2d\u7684name\u505a\u6620\u5c04\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'int insertUser(@Param("id") int id, @Param("username") String name,@Param("password") String pws);\n')),(0,r.kt)("p",null,"\u6b64\u65f6\u53c8\u4e00\u6b21\u6210\u529f\u4e86\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void testInsert(){\n    SqlSession sqlSession = open();\n    UserMapper mapper = sqlSession.getMapper(UserMapper.class);\n    int rows = mapper.insertUser(11, "lucy", "123");\n    LOGGER.debug("Affected rows: [{}]",rows);\n    sqlSession.commit();\n    sqlSession.close();\n}\n')),(0,r.kt)("p",null,"\u6240\u4ee5\u6211\u4eec\u9047\u5230mapper\u4e2d\u6709\u591a\u4e2a\u53c2\u6570\u65f6\uff0c\u4e00\u5b9a\u8981\u4f7f\u7528@Param\u6ce8\u89e3\uff0c\u5efa\u7acb\u6620\u5c04\u5173\u7cfb\u3002"),(0,r.kt)("h3",{id:"4update\u4fee\u6539"},"4\u3001update\uff08\u4fee\u6539\uff09"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"update\u6807\u7b7e\u7528\u4e8e\u66f4\u65b0\u64cd\u4f5c")),(0,r.kt)("p",null,"1\u3001\u5199\u63a5\u53e3"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * \u4fee\u6539\u7528\u6237\n * @param user\n * @return\n */\nint updateUser(User user);\n")),(0,r.kt)("p",null,"2\u3001\u5199SQL"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<update id="updateUser" parameterType="com.ydlclass.entity.User">\n    update user set username=#{username},password=#{password} where id = #{id}\n</update>\n')),(0,r.kt)("p",null,"3\u3001\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void testUpdate(){\n    SqlSession sqlSession = open();\n    UserMapper mapper = sqlSession.getMapper(UserMapper.class);\n    int rows = mapper.updateUser(new User(11, "\u5c0f\u5fae\u5fae", "123"));\n    LOGGER.debug("Affected rows: [{}]",rows);\n    sqlSession.commit();\n    sqlSession.close();\n}\n')),(0,r.kt)("h3",{id:"5delete\u5220\u9664"},"5\u3001delete\uff08\u5220\u9664\uff09"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"delete\u6807\u7b7e\u7528\u4e8e\u505a\u5220\u9664\u64cd\u4f5c")),(0,r.kt)("p",null,"1\u3001\u5199\u63a5\u53e3"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"/**\n* \u5220\u9664\u4e00\u4e2a\u7528\u6237\n* @param id\n* @return\n*/\nint deleteUser(int id);\n")),(0,r.kt)("p",null,"2\u3001\u5199SQL"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<delete id="deleteUser" parameterType="int">\n  delete from user where id = #{id}\n</delete>\n')),(0,r.kt)("p",null,"3\u3001\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},' @Test\npublic void testDeleteUser(){\n    SqlSession sqlSession = open();\n    UserMapper mapper = sqlSession.getMapper(UserMapper.class);\n    int affectedRows = mapper.deleteUser(5);\n    LOGGER.debug("Affected rows: [{}]",affectedRows);\n    sqlSession.commit();\n    sqlSession.close();\n}\n')),(0,r.kt)("h3",{id:"6\u6a21\u7cca\u67e5\u8be2"},"6\u3001\u6a21\u7cca\u67e5\u8be2"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u65b9\u6848\u4e00\uff1a\u5728Java\u4ee3\u7801\u4e2d\u62fc\u4e32")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"string name = \u201c%IT%\u201d;\nlist<name> names = mapper.getUserByName(name);\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"<select id=\u201dgetUsersByName\u201d>\n    select * from user where name like #{name}\n</select>\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u65b9\u6848\u4e8c\uff1a\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u62fc\u63a5")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"string name = \u201cIT\u201d;\nlist<User> users = mapper.getUserByName(name);\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'<select id=\u201dgetUsersByName\u201d>\n    select * from user where name like "%"#{name}"%"\n</select>\n')),(0,r.kt)("p",null,"\u4e3a\u4ec0\u4e48\u5fc5\u987b\u7528\u53cc\u5f15\u53f7\uff1f"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u65b9\u6848\u4e09\uff1a\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u62fc\u63a5")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'<select id=\u201dgetUsersByName\u201d>\n    select * from user where name like "%${name}%"\n</select>\n')),(0,r.kt)("h3",{id:"7map\u7684\u4f7f\u7528"},"7\u3001map\u7684\u4f7f\u7528"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"map\u53ef\u4ee5\u4ee3\u66ff\u4efb\u4f55\u7684\u5b9e\u4f53\u7c7b\uff0c\u6240\u4ee5\u5f53\u6211\u4eec\u6570\u636e\u6bd4\u8f83\u590d\u6742\u65f6\uff0c\u53ef\u4ee5\u9002\u5f53\u8003\u8651\u4f7f\u7528map\u6765\u5b8c\u6210\u76f8\u5173\u5de5\u4f5c")),(0,r.kt)("p",null,"1\u3001\u5199sql"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="getUsersByParams" parameterType="java.util.HashMapmap">\n    select id,username,password from user where username = #{name}\n</select>\n')),(0,r.kt)("p",null,"2\u3001\u5199\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"/**\n* \u6839\u636e\u4e00\u4e9b\u53c2\u6570\u67e5\u8be2\n* @param map\n* @return\n*/\nList<User> getUsersByParams(Map<String,String> map);\n")),(0,r.kt)("p",null,"3\u3001\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void findByParams() {\n    UserMapper mapper = session.getMapper(UserMapper.class);\n    Map<String,String> map = new HashMap<String, String>();\n    map.put("name","\u78ca\u78ca\u54e5");\n    List<User> users = mapper.getUsersByParams(map);\n    for (User user: users){\n        System.out.println(user.getUsername());\n    }\n}\n')),(0,r.kt)("h2",{id:"\u4e94\u4f7f\u7528\u6ce8\u89e3\u5f00\u53d1"},"\u4e94\u3001\u4f7f\u7528\u6ce8\u89e3\u5f00\u53d1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"DROP TABLE IF EXISTS `admin`;\nCREATE TABLE `admin` (\n`id` int(20) NOT NULL,\n`username` varchar(30) DEFAULT NULL,\n`password` varchar(30) DEFAULT NULL,\nPRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\ninsert  into `admin`(`id`,`username`,`password`) values (1,'itnanls','123456'),(2,'itlils','abcdef'),(3,'\u5c0f\u5fae','987654');\n")),(0,r.kt)("p",null," MyBatis\u6700\u521d\u914d\u7f6e\u4fe1\u606f\u662f\u57fa\u4e8e XML ,\u6620\u5c04\u8bed\u53e5(SQL)\u4e5f\u662f\u5b9a\u4e49\u5728 XML \u4e2d\u7684\u3002\u800c\u5230MyBatis 3\u63d0\u4f9b\u4e86\u65b0\u7684\u57fa\u4e8e\u6ce8\u89e3\u7684\u914d\u7f6e\u3002\u4e0d\u5e78\u7684\u662f\uff0cJava \u6ce8\u89e3\u7684\u7684\u8868\u8fbe\u529b\u548c\u7075\u6d3b\u6027\u5341\u5206\u6709\u9650\u3002\u6700\u5f3a\u5927\u7684 MyBatis \u6620\u5c04\u5e76\u4e0d\u80fd\u7528\u6ce8\u89e3\u6765\u6784\u5efa\uff0c\u6240\u4ee5\u8fd9\u91cc\u6211\u4eec\u4f5c\u4e3a\u4e86\u89e3\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"sql \u7c7b\u578b\u4e3b\u8981\u5206\u6210 :"),(0,r.kt)("li",{parentName:"ul"},"@select ()"),(0,r.kt)("li",{parentName:"ul"},"@update ()"),(0,r.kt)("li",{parentName:"ul"},"@Insert ()"),(0,r.kt)("li",{parentName:"ul"},"@delete ()")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a"),"\u5229\u7528\u6ce8\u89e3\u5f00\u53d1\u5c31\u4e0d\u9700\u8981mapper.xml\u6620\u5c04\u6587\u4ef6\u4e86 ."),(0,r.kt)("h3",{id:"1\u63a5\u53e3\u4e2d\u6dfb\u52a0\u6ce8\u89e3"},"1\u3001\u63a5\u53e3\u4e2d\u6dfb\u52a0\u6ce8\u89e3"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class Admin {\n\n    private static final Long serialVersionUID = 1L;\n\n    private int id;\n    private String username;\n    private String password;\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public interface AdminMapper {\n\n    /**\n     * \u4fdd\u5b58\u7ba1\u7406\u5458\n     * @param admin\n     * @return\n     */\n    @Insert("insert into admin (username,password) values (#{username},#{password})")\n    int saveAdmin(Admin admin);\n\n    /**\n     * \u8ddf\u65b0\u7ba1\u7406\u5458\n     * @param admin\n     * @return\n     */\n    @Update("update admin set username=#{username} , password=#{password} where id = #{id}")\n    int updateAdmin(Admin admin);\n\n    /**\n     * \u5220\u9664\u7ba1\u7406\u5458\n     * @param admin\n     * @return\n     */\n    @Delete("delete from admin where id=#{id}")\n    int deleteAdmin(int id);\n\n    /**\n     * \u6839\u636eid\u67e5\u627e\u7ba1\u7406\u5458\n     * @param id\n     * @return\n     */\n    @Select("select id,username,password from admin where id=#{id}")\n    Admin findAdminById(@Param("id") int id);\n\n    /**\n     * \u67e5\u8be2\u6240\u6709\u7684\u7ba1\u7406\u5458\n     * @return\n     */\n    @Select("select id,username,password from admin")\n    List<Admin> findAllAdmins();\n\n}\n')),(0,r.kt)("h3",{id:"2\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e"},"2\u3001\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e"),(0,r.kt)("p",null,"\u6dfb\u52a0\u4e00\u4e2amapper\u7684\u914d\u7f6e\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<mapper class="com.ydlclass.mapper.AdminMapper"/>\n')),(0,r.kt)("h3",{id:"3\u8fdb\u884c\u6d4b\u8bd5"},"3\u3001\u8fdb\u884c\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public class TestAdminMapper {\n\n    @Test\n    public void testSaveAdmin() {\n        SqlSession session = open();\n        AdminMapper mapper = session.getMapper(AdminMapper.class);\n        Admin admin = new Admin(1,"\u5fae\u5fae\u59d0","12345678");\n        int affectedRows = mapper.saveAdmin(admin);\n         LOGGER.debug("Affected rows: [{}]",affectedRows);\n        session.commit();\n        session.close();\n    }\n\n    @Test\n    public void testUpdateAdmin() {\n        SqlSession session = open();\n        AdminMapper mapper = session.getMapper(AdminMapper.class);\n        Admin user = new Admin(1,"\u78ca\u78ca\u54e5","12345678");\n        int affectedRows = mapper.updateAdmin(user);\n        LOGGER.debug("Affected rows: [{}]",affectedRows);\n        session.commit();\n        session.close();\n    }\n\n    @Test\n    public void testDeleteAdmin(){\n        SqlSession session = open();\n        AdminMapper mapper = session.getMapper(AdminMapper.class);\n        int affectedRows = mapper.deleteAdmin(2);\n        LOGGER.debug("Affected rows: [{}]",affectedRows);\n        session.commit();\n        session.close();\n    }\n\n    @Test\n    public void testGetAdminById(){\n        SqlSession session = open();\n        AdminMapper mapper = session.getMapper(AdminMapper.class);\n        Admin admin = mapper.findAdminById(1);\n        LOGGER.debug("The admin is: [{}]",admin);\n        session.commit();\n        session.close();\n    }\n\n    @Test\n    public void testGetAllAdmins(){\n        SqlSession session = open();\n        AdminMapper mapper = session.getMapper(AdminMapper.class);\n        List<Admin> admins = mapper.findAllAdmins();\n        LOGGER.debug("The admins is: [{}]",admin);\n        session.commit();\n        session.close();\n    }\n\n    private static SqlSession open(){\n        // 1\u3001\u521b\u5efa\u4e00\u4e2aSqlSessionFactory\u7684 \u5efa\u9020\u8005 \uff0c\u7528\u4e8e\u521b\u5efaSqlSessionFactory\n        SqlSessionFactoryBuilder builder = new SqlSessionFactoryBuilder();\n        // 2\u3001\u4f7f\u7528builder\u6784\u5efa\u4e00\u4e2asqlSessionFactory\uff0c\u6b64\u5904\u6211\u4eec\u57fa\u4e8e\u4e00\u4e2axml\u914d\u7f6e\u6587\u4ef6\n        SqlSessionFactory sqlSessionFactory = builder.build(Thread.currentThread().getContextClassLoader().getResourceAsStream("mybatis-config.xml"));\n        // 3\u3001\u901a\u8fc7sqlSessionFactory\u83b7\u53d6\u53e6\u4e00\u4e2asession\uff0c\u6b64\u5904\u4f7f\u7528\u3010\u5de5\u5382\u8bbe\u8ba1\u6a21\u5f0f\u3011\n        return sqlSessionFactory.openSession();\n    }\n\n}\n')),(0,r.kt)("h2",{id:"\u516d\u67b6\u6784\u6e90\u7801\u89e3\u6790\u9009\u5b66"},"\u516d\u3001\u67b6\u6784\u6e90\u7801\u89e3\u6790\uff08\u9009\u5b66\uff09"),(0,r.kt)("h3",{id:"1\u67b6\u6784\u8bb2\u89e3"},"1\u3001\u67b6\u6784\u8bb2\u89e3"),(0,r.kt)("p",null,"Mybatis\u7684\u529f\u80fd\u67b6\u6784\u5206\u4e3a\u4e09\u5c42\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211104152708780-788d171d.png",alt:"image-20211104152708780"}),"image-20211104152708780"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"API\u63a5\u53e3\u5c42"),"\uff1a\u63d0\u4f9b\u7ed9\u5916\u90e8\u4f7f\u7528\u7684\u63a5\u53e3API\uff0c\u5f00\u53d1\u4eba\u5458\u901a\u8fc7\u8fd9\u4e9b\u672c\u5730API\u6765\u64cd\u7eb5\u6570\u636e\u5e93\u3002\u63a5\u53e3\u5c42\u4e00\u63a5\u6536\u5230\u8c03\u7528\u8bf7\u6c42\u5c31\u4f1a\u8c03\u7528\u6570\u636e\u5904\u7406\u5c42\u6765\u5b8c\u6210\u5177\u4f53\u7684\u6570\u636e\u5904\u7406\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6570\u636e\u5904\u7406\u5c42"),"\uff1a\u8d1f\u8d23\u5177\u4f53\u7684SQL\u67e5\u627e\u3001SQL\u89e3\u6790\u3001SQL\u6267\u884c\u548c\u6267\u884c\u7ed3\u679c\u6620\u5c04\u5904\u7406\u7b49\u3002\u5b83\u4e3b\u8981\u7684\u76ee\u7684\u662f\u6839\u636e\u8c03\u7528\u7684\u8bf7\u6c42\u5b8c\u6210\u4e00\u6b21\u6570\u636e\u5e93\u64cd\u4f5c\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u57fa\u7840\u652f\u6491\u5c42"),"\uff1a\u8d1f\u8d23\u6700\u57fa\u7840\u7684\u529f\u80fd\u652f\u6491\uff0c\u5305\u62ec\u8fde\u63a5\u7ba1\u7406\u3001\u4e8b\u52a1\u7ba1\u7406\u3001\u914d\u7f6e\u52a0\u8f7d\u548c\u7f13\u5b58\u5904\u7406\uff0c\u8fd9\u4e9b\u90fd\u662f\u5171\u7528\u7684\u4e1c\u897f\uff0c\u5c06\u4ed6\u4eec\u62bd\u53d6\u51fa\u6765\u4f5c\u4e3a\u6700\u57fa\u7840\u7684\u7ec4\u4ef6\u3002\u4e3a\u4e0a\u5c42\u7684\u6570\u636e\u5904\u7406\u5c42\u63d0\u4f9b\u6700\u57fa\u7840\u7684\u652f\u6491\u3002"),(0,r.kt)("h3",{id:"2\u6838\u5fc3\u6210\u5458"},"2\u3001\u6838\u5fc3\u6210\u5458\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Configuration"),"\uff1aMyBatis\u6240\u6709\u7684\u914d\u7f6e\u4fe1\u606f\u90fd\u4fdd\u5b58\u5728Configuration\u5bf9\u8c61\u4e4b\u4e2d\uff0c\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u5927\u90e8\u5206\u914d\u7f6e\u90fd\u4f1a\u5b58\u50a8\u5230\u8be5\u7c7b\u4e2d"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"SqlSession"),"\uff1a\u4f5c\u4e3aMyBatis\u5de5\u4f5c\u7684\u4e3b\u8981\u9876\u5c42API\uff0c\u8868\u793a\u548c\u6570\u636e\u5e93\u4ea4\u4e92\u65f6\u7684\u4f1a\u8bdd\uff0c\u5b8c\u6210\u5fc5\u8981\u6570\u636e\u5e93\u589e\u5220\u6539\u67e5\u529f\u80fd"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Executor"),"\uff1aMyBatis\u6267\u884c\u5668\uff0c\u662fMyBatis \u8c03\u5ea6\u7684\u6838\u5fc3\uff0c\u8d1f\u8d23SQL\u8bed\u53e5\u7684\u751f\u6210\u548c\u67e5\u8be2\u7f13\u5b58\u7684\u7ef4\u62a4"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"StatementHandler"),"\uff1a\u5c01\u88c5\u4e86JDBC Statement\u64cd\u4f5c\uff0c\u8d1f\u8d23\u5bf9JDBC statement \u7684\u64cd\u4f5c\uff0c\u5982\u8bbe\u7f6e\u53c2\u6570\u7b49"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"ParameterHandler"),"\uff1a\u8d1f\u8d23\u5bf9\u7528\u6237\u4f20\u9012\u7684\u53c2\u6570\u8f6c\u6362\u6210JDBC Statement \u6240\u5bf9\u5e94\u7684\u6570\u636e\u7c7b\u578b"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"ResultSetHandler"),"\uff1a\u8d1f\u8d23\u5c06JDBC\u8fd4\u56de\u7684ResultSet\u7ed3\u679c\u96c6\u5bf9\u8c61\u8f6c\u6362\u6210List\u7c7b\u578b\u7684\u96c6\u5408"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"TypeHandler"),"\uff1a\u8d1f\u8d23java\u6570\u636e\u7c7b\u578b\u548cjdbc\u6570\u636e\u7c7b\u578b(\u4e5f\u53ef\u4ee5\u8bf4\u662f\u6570\u636e\u8868\u5217\u7c7b\u578b)\u4e4b\u95f4\u7684\u6620\u5c04\u548c\u8f6c\u6362"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"MappedStatement"),"\uff1aMappedStatement\u7ef4\u62a4\u4e00\u6761<select|update|delete|insert>\u8282\u70b9\u7684\u5c01\u88c5"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"SqlSource"),"\uff1a\u8d1f\u8d23\u6839\u636e\u7528\u6237\u4f20\u9012\u7684parameterObject\uff0c\u52a8\u6001\u5730\u751f\u6210SQL\u8bed\u53e5\uff0c\u5c06\u4fe1\u606f\u5c01\u88c5\u5230BoundSql\u5bf9\u8c61\u4e2d\uff0c\u5e76\u8fd4\u56de"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"BoundSql"),"\uff1a\u8868\u793a\u52a8\u6001\u751f\u6210\u7684SQL\u8bed\u53e5\u4ee5\u53ca\u76f8\u5e94\u7684\u53c2\u6570\u4fe1\u606f"),(0,r.kt)("li",{parentName:"ol"})),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/63651-20180924164811172-1839433605-c0404266.png",alt:"img"}),"img"),(0,r.kt)("h3",{id:"3\u6e90\u7801\u89e3\u8bfb"},"3\u3001\u6e90\u7801\u89e3\u8bfb"),(0,r.kt)("h4",{id:"1\u6784\u5efasession\u5de5\u5382"},"\uff081\uff09\u6784\u5efasession\u5de5\u5382"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"// 1\u3001\u521b\u5efa\u4e00\u4e2aSqlSessionFactory\u7684 \u5efa\u9020\u8005 \uff0c\u7528\u4e8e\u521b\u5efaSqlSessionFactory\n// SqlSessionFactoryBuilder\u4e2d\u6709\u5927\u91cf\u7684\u91cd\u8f7d\u7684build\u65b9\u6cd5\uff0c\u53ef\u4ee5\u6839\u636e\u4e0d\u540c\u7684\u5165\u53c2\uff0c\u8fdb\u884c\u6784\u5efa\n// \u6781\u5927\u7684\u63d0\u9ad8\u4e86\u7075\u6d3b\u6027\uff0c\u6b64\u5904\u4f7f\u7528\u3010\u521b\u5efa\u8005\u8bbe\u8ba1\u6a21\u5f0f\u3011\nSqlSessionFactoryBuilder builder = new SqlSessionFactoryBuilder();\n")),(0,r.kt)("p",null,"\u8fd9\u662f\u4e00\u4e2a\u521b\u5efa\u8005\u8bbe\u8ba1\u6a21\u5f0f\u7684\u7ecf\u5178\u5e94\u7528\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'// \u4f7f\u7528builder\u6784\u5efa\u4e00\u4e2asqlSessionFactory\uff0c\u6b64\u5904\u6211\u4eec\u57fa\u4e8e\u4e00\u4e2axml\u914d\u7f6e\u6587\u4ef6\n// \u6b64\u8fc7\u7a0b\u4f1a\u8fdb\u884cxml\u6587\u4ef6\u7684\u89e3\u6790\uff0c\u8fc7\u7a0b\u76f8\u5bf9\u6bd4\u8f83\u590d\u6742\nSqlSessionFactory sqlSessionFactory = builder.build(Thread.currentThread().getContextClassLoader().getResourceAsStream("mybatis-config.xml"));\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u6e90\u7801\u90e8\u5206\uff1a\u8fd9\u91cc\u6709\u4f17\u591a\u7684\u91cd\u8f7dbuild\u65b9\u6cd5\uff0c\u6211\u4eec\u8c03\u7528\u7684build\u65b9\u6cd5\uff0c\u4f1a\u662f\u5982\u4e0b\u5927\u6d41\u7a0b")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public SqlSessionFactory build(InputStream inputStream) {\n    return build(inputStream, null, null);\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public SqlSessionFactory build(InputStream inputStream, String environment, Properties properties) {\n    try {\n        XMLConfigBuilder parser = new XMLConfigBuilder(inputStream, environment, properties);\n        return build(parser.parse());\n    } catch (Exception e) {\n    ....\n}\n")),(0,r.kt)("p",null,"\u4ece\u4e0a\u8fb9\u7684return\u770b\uff0c\u5176\u5b9e\u6838\u5fc3\u7684\u4ee3\u7801\u53c8\u56de\u5f52\u5230\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"build(parser.parse())"),"\u8fd9\u4e2a\u6784\u9020\u5668\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public SqlSessionFactory build(Configuration config) {\n    return new DefaultSqlSessionFactory(config);\n}\n")),(0,r.kt)("p",null," \u5176\u5b9e\uff0c\u672c\u8d28\u4e0a\uff0c\u65e0\u8bba\u4f60\u505a\u4e86\u591a\u5c11\u5de5\u4f5c\uff0c\u4f60\u4f7f\u7528xml\u4e5f\u597d\uff0c\u4e0d\u4f7f\u7528xml\u4e5f\u597d\uff0c\u6700\u7ec8\u90fd\u662f\u9700\u8981\u4e00\u4e2aConfiguration\u5b9e\u4f8b\uff0c\u8fd9\u91cc\u4fdd\u5b58\u4e86\u6240\u6709\u7684\u914d\u7f6e\u9879\u3002"),(0,r.kt)("p",null," \u5f53\u7136\u6211\u4eec\u53ef\u4ee5\u72ec\u7acb\u53bb\u4f7f\u7528Configuration\u7c7b\u6784\u9020\u5b9e\u4f8b\uff0c\u4e0d\u4f7f\u7528xml\u3002"),(0,r.kt)("p",null,"\u4f8b\u5982\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'Configuration configuration = new Configuration();\n// \u521b\u5efa\u4e00\u4e2a\u6570\u636e\u6e90\nPooledDataSource pooledDataSource = new PooledDataSource();\npooledDataSource.setDriver("com.mysql.cj.jdbc.Driver");\npooledDataSource.setUrl("jdbc:mysql://127.0.0.1:3306/ydlclass?characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai");\npooledDataSource.setUsername("root");\npooledDataSource.setPassword("root");\nEnvironment environment = new Environment("env",new JdbcTransactionFactory(),new PooledDataSource());\nconfiguration.setEnvironment(environment);\n')),(0,r.kt)("p",null,"\u7b49\u540c\u4e8e\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<configuration>\n    <environments default="development">\n        <environment id="development">\n            <transactionManager type="JDBC"/>\n            <dataSource type="POOLED">\n                <property name="driver" value="com.mysql.cj.jdbc.Driver"/>\n                <property name="url" value="jdbc:mysql://127.0.0.1:3306/ydlclass?characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai"/>\n                <property name="username" value="root"/>\n                <property name="password" value="root"/>\n            </dataSource>\n        </environment>\n    </environments>\n</configuration>\n')),(0,r.kt)("p",null," xml\u7684\u89e3\u6790\u8fc7\u7a0b\u5c31\u662f\u5c06xml\u6587\u4ef6\u8f6c\u5316\u4e3aConfiguration\u5bf9\u8c61\uff0c\u5b83\u5728\u542f\u52a8\u7684\u65f6\u5019\u6267\u884c\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u5c31\u8981\u91cd\u542f\u3002\u6240\u4ee5\u672c\u73af\u8282\u7684\u91cd\u70b9\u5c31\u5230\u4e86\u3002"),(0,r.kt)("h4",{id:"2\u914d\u7f6e\u6587\u4ef6\u7684\u89e3\u6790"},"\uff082\uff09\u914d\u7f6e\u6587\u4ef6\u7684\u89e3\u6790"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"parser.parse()"),"\u8fd9\u4e2a\u65b9\u6cd5\u4e86\uff0c\u8fd9\u5c31\u662f\u5728\u89e3\u6790xml\u914d\u7f6e\u6587\u4ef6\u3002"),(0,r.kt)("p",null,"\u5728build\u65b9\u6cd5\u4e2d\u6211\u4eec\u770b\u5230\u4e86\u5982\u4e0b\u4ee3\u7801\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"XMLConfigBuilder parser = new XMLConfigBuilder(inputStream, environment, properties);\n")),(0,r.kt)("p",null,"\u8fd9\u4e00\u6b65\u5c31\u662f\u6784\u9020\u4e00\u4e2a\u89e3\u6790\u5668\uff0c\u6839\u636e\u6211\u4eec\u7684\u5165\u53c2\u6784\u5efa\u4e00\u4e2a\u6587\u6863\u89e3\u6790\u5668\u3002\u4f7f\u7528\u4e86sax\u8fdb\u884cxml\u7684\u89e3\u6790\uff0c\u6211\u4eec\u5728\u8bb2JavaEE\u7684\u65f6\u5019\u8bb2\u8fc7\u3002"),(0,r.kt)("p",null,"\u5f53\u7136\uff0c\u6211\u4eec\u8981\u628a\u91cd\u70b9\u653e\u5728parse()\u65b9\u6cd5\u4e0a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public Configuration parse() {\n    ...\u7701\u7565\u4e0d\u91cd\u8981\u7684\u4ee3\u7801\n    //\u6b64\u5904\u5c31\u662f\u89e3\u6790\u7684\u6838\u5fc3\u4ee3\u7801\n    parseConfiguration(parser.evalNode("/configuration"));\n    return configuration;\n}\n')),(0,r.kt)("p",null,"\u54b1\u4eec\u8fdb\u5165\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u6162\u6162\u5206\u6790\uff0c\u5176\u4e2d\u7684\u5185\u5bb9\u5f88\u591a\uff0c\u5f88\u660e\u663e\u770b\u5230\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u662f\u5728\u89e3\u6790\u6bcf\u4e00\u4e2a\u6807\u7b7e\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'private void parseConfiguration(XNode root) {\n    try {\n        // \u5904\u7406properties\u6807\u7b7e\n        propertiesElement(root.evalNode("properties"));\n        Properties settings = settingsAsProperties(root.evalNode("settings"));\n        loadCustomVfs(settings);\n        loadCustomLogImpl(settings);\n        // \u5904\u7406\u522b\u540d\u7684\u6807\u7b7e\n        typeAliasesElement(root.evalNode("typeAliases"));\n        pluginElement(root.evalNode("plugins"));\n        objectFactoryElement(root.evalNode("objectFactory"));\n        objectWrapperFactoryElement(root.evalNode("objectWrapperFactory"));\n        reflectorFactoryElement(root.evalNode("reflectorFactory"));\n        settingsElement(settings);\n        // read it after objectFactory and objectWrapperFactory issue #631\n        // \u5904\u7406environments\u6807\u7b7e\n        environmentsElement(root.evalNode("environments"));\n        databaseIdProviderElement(root.evalNode("databaseIdProvider"));\n        typeHandlerElement(root.evalNode("typeHandlers"));\n        // \u5904\u7406mappers\u6807\u7b7e\n        mapperElement(root.evalNode("mappers"));\n    } catch (Exception e) {\n        throw new BuilderException("Error parsing SQL Mapper Configuration. Cause: " + e, e);\n    }\n}\n')),(0,r.kt)("p",null," \u5176\u5b9e\u6211\u4eec\u770b\u5230\u8fd9\u91cc\u5c31\u5927\u81f4\u660e\u767d\u4e86MyBatis\u89e3\u6790xml\u7684\u65f6\u673a\u548c\u65b9\u6cd5\u4e86\u3002\u4ece\u8fd9\u91cc\u6211\u4eec\u4e5f\u80fd\u57fa\u672c\u770b\u51fa\u6765\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u5185\u80fd\u4f7f\u7528\u7684\u6807\u7b7e\uff0c\u4ee5\u53ca\u4e66\u5199\u6807\u7b7e\u7684\u987a\u5e8f\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u89e3\u6790\u8fc7\u7a0b\u4e5f\u662f\u6709\u987a\u5e8f\u7684\uff0c\u6211\u4eec\u968f\u4fbf\u5217\u51fa\u51e0\u4e2a\u6807\u7b7e\u770b\u770b\u914d\u7f6e\u6587\u4ef6\u957f\u4ec0\u4e48\u6837\u5b50\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<!DOCTYPE configuration\n        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-config.dtd">\n<configuration>\n    <properties>\n        <property name="username" value="root"/>\n    </properties>\n\n    <settings>\n        <setting name="" value=""/>\n    </settings>\n    <typeAliases>\n        <typeAlias type="com.ydlclass.User" alias="user"/>\n    </typeAliases>\n\n    <environments default="development">\n        <environment id="development">\n            <transactionManager type="JDBC"/>\n            <dataSource type="POOLED">\n                <property name="driver" value="com.mysql.cj.jdbc.Driver"/>\n                <property name="url" value="jdbc:mysql://127.0.0.1:3306/ydlclass?characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai"/>\n                <property name="username" value="root"/>\n                <property name="password" value="root"/>\n            </dataSource>\n        </environment>\n    </environments>\n    <mappers>\n        <mapper resource="userMapper.xml"/>\n    </mappers>\n</configuration>\n')),(0,r.kt)("h4",{id:"3mapper\u6587\u4ef6\u7684\u89e3\u6790\u8fc7\u7a0b"},"\uff083\uff09mapper\u6587\u4ef6\u7684\u89e3\u6790\u8fc7\u7a0b"),(0,r.kt)("p",null,"\u6211\u4eec\u6682\u4e14\u5ffd\u7565\u6389\u5176\u4ed6\u6807\u7b7e\u7684\u5904\u7406\uff0c\u4ee5",(0,r.kt)("inlineCode",{parentName:"p"},"mappers"),"\u6807\u7b7e\u4e3a\u4f8b\u7ee7\u7eed\u6df1\u5165\u63a2\u7d22\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'private void mapperElement(XNode parent) throws Exception {\n    if (parent != null) {\n        // \u5faa\u73af\u904d\u5386\u4ed6\u7684\u5b69\u5b50\u8282\u70b9\n        for (XNode child : parent.getChildren()) {\n            if ("package".equals(child.getName())) {\n                // <package name="com.ydlclass"/>\n                String mapperPackage = child.getStringAttribute("name");\n                // \u76f4\u63a5\u5c06\u5305\u540d\u52a0\u5165\u914d\u7f6e\u9879\n                configuration.addMappers(mapperPackage);\n            } else {\n         \n                String resource = child.getStringAttribute("resource");\n                String url = child.getStringAttribute("url");\n                String mapperClass = child.getStringAttribute("class");\n                // \u5982\u679c\u662fresource\u5c5e\u6027,\u5c31\u901a\u8fc7resource\u83b7\u53d6\u8d44\u6e90\u5e76\u89e3\u6790<mapper resource="userMapper.xml"/>\n                if (resource != null && url == null && mapperClass == null) {\n                    ErrorContext.instance().resource(resource);\n                    InputStream inputStream = Resources.getResourceAsStream(resource);\n                    XMLMapperBuilder mapperParser = new XMLMapperBuilder(inputStream, configuration, resource, configuration.getSqlFragments());\n                    mapperParser.parse();\n                // \u5982\u679c\u662furl\u5c5e\u6027,\u5c31\u901a\u8fc7url\u83b7\u53d6\u8d44\u6e90\u5e76\u89e3\u6790 <mapper url="http://www.ydlclass.com/UserMapper.xml"/>\n                } else if (resource == null && url != null && mapperClass == null) {\n                    ErrorContext.instance().resource(url);\n                    InputStream inputStream = Resources.getUrlAsStream(url);\n                    XMLMapperBuilder mapperParser = new XMLMapperBuilder(inputStream, configuration, url, configuration.getSqlFragments());\n                    mapperParser.parse();\n                // \u5982\u679c\u662furl\u5c5e\u6027,\u5c31\u901a\u8fc7url\u83b7\u53d6\u8d44\u6e90\u5e76\u89e3\u6790 <mapper class="com.ydlclass.UserMapper"/>\n                } else if (resource == null && url == null && mapperClass != null) {\n                    Class<?> mapperInterface = Resources.classForName(mapperClass);\n                    // \u6ce8\u518c\u4e00\u4e2amapper\n                    configuration.addMapper(mapperInterface);\n                } else {\n                    throw new BuilderException("A mapper element may only specify a url, resource or class, but not more than one.");\n                }\n            }\n        }\n    }\n}\n')),(0,r.kt)("p",null," \u8fd9\u91cc\u5c31\u662f\u60f3\u5c3d\u529e\u6cd5\uff0c\u83b7\u53d6mapper\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u7136\u540e\u505a\u4e0b\u4e00\u6b65\u5904\u7406\uff0c\u5176\u5b9e\u65e0\u8bba\u662f\u54ea\u4e00\u79cd\u65b9\u5f0f\u90fd\u662f\u4f1a\u5728Configuration\u7684mapperRegistry \uff08mapper\u6ce8\u518c\u5668\u4e2d\uff09\u4e2d\u6ce8\u518c\u4e00\u4e2amapper\u3002\u5176\u5b9e\u5c31\u662f\u5c06mapper\u7684class\u4fe1\u606f\u653e\u5728\u4e00\u4e2a\u540d\u4e3aknownMappers\u7684hashmap\u4e2d\uff0c\u4ee5\u4fbf\u540e\u7eed\u4f7f\u7528\u3002\u5f53\u7136\u4ed6\u7684\u503c\u4e00\u4e2a\u4e00\u4e2a\u4ee3\u7406\u5de5\u5382\uff0c\u8fd9\u73a9\u610f\u80fd\u5e2e\u6211\u4eec\u83b7\u53d6\u4e00\u4e2amapper\u7684\u4ee3\u7406\u5bf9\u8c61\uff0c\u66f4\u8be6\u7ec6\u7684\u540e\u7eed\u8bf4\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"private final Map<Class<?>, MapperProxyFactory<?>> knownMappers = new HashMap<>();\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5bf9\u4e8epackage\u5c5e\u6027")),(0,r.kt)("p",null,"\u76f4\u63a5\u5c06\u5305\u540d\u6ce8\u518c\u5230\u914d\u7f6e\u4e2d\uff0c\u7136\u540e\u8c03\u7528MapperRegistry\u7684addMappers\u65b9\u6cd5\uff0c\u901a\u8fc7\u626b\u63cf\u6587\u4ef6\u7684\u65b9\u5f0f\u5c06\u8fd9\u4e2a\u5305\u5e95\u4e0b\u7684class\u6dfb\u52a0\u8fdbkownMappers\u4e2d\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"}," public void addMappers(String packageName) {\n    mapperRegistry.addMappers(packageName);\n  }\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public void addMappers(String packageName) {\n    addMappers(packageName, Object.class);\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public void addMappers(String packageName, Class<?> superType) {\n    ResolverUtil<Class<?>> resolverUtil = new ResolverUtil<>();\n    resolverUtil.find(new ResolverUtil.IsA(superType), packageName);\n    Set<Class<? extends Class<?>>> mapperSet = resolverUtil.getClasses();\n    for (Class<?> mapperClass : mapperSet) {\n        addMapper(mapperClass);\n    }\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"public <T> void addMapper(Class<T> type) {\n    mapperRegistry.addMapper(type);\n  }\n")),(0,r.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u4eceMapperRegistry\u4e2d\u770b\u5230\uff0caddMapper\u7684\u6574\u4e2a\u8fc7\u7a0b\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},' public <T> void addMapper(Class<T> type) {\n    if (type.isInterface()) {\n      if (hasMapper(type)) {\n        throw new BindingException("Type " + type + " is already known to the MapperRegistry.");\n      }\n      boolean loadCompleted = false;\n      try {\n        knownMappers.put(type, new MapperProxyFactory<>(type));\n       ...\u7701\u7565\u4e0d\u91cd\u8981\u7684\u4ee3\u7801\n    }\n  }\n')),(0,r.kt)("p",null," \u6211\u4eec\u4e0d\u59a8\u628aMapperProxyFactory\u7684\u4ee3\u7801\u7c98\u8d34\u51fa\u6765\u770b\u770b\uff0c\u91cc\u8fb9\u7ef4\u62a4\u4e86\u4e00\u4e2a\u63a5\u53e3\u548c\u65b9\u6cd5\u7f13\u5b58\uff08\u8fd9\u4e2a\u540e\u8fb9\u4f1a\u8bb2\uff0c\u76ee\u524d\u4ed6\u662f\u4e00\u4e2a\u7a7a\u7684Map\uff09\uff0c\u8fd9\u4e2a\u4ee3\u7406\u5de5\u5382\u786e\u5b9e\u6709\u65b9\u6cd5\u5e2e\u6211\u4eec\u751f\u6210\u4ee3\u7406\u5bf9\u8c61\uff08newInstance\uff09\u3002\u6211\u4eec\u770b\u5230\u4e86\u4ee3\u7406\u8bbe\u8ba1\u6a21\u5f0f\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public class MapperProxyFactory<T> {\n\n  private final Class<T> mapperInterface;\n  private final Map<Method, MapperMethodInvoker> methodCache = new ConcurrentHashMap<>();\n\n  public MapperProxyFactory(Class<T> mapperInterface) {\n    this.mapperInterface = mapperInterface;\n  }\n\n  public Class<T> getMapperInterface() {\n    return mapperInterface;\n  }\n\n  public Map<Method, MapperMethodInvoker> getMethodCache() {\n    return methodCache;\n  }\n\n  @SuppressWarnings("unchecked")\n  protected T newInstance(MapperProxy<T> mapperProxy) {\n    return (T) Proxy.newProxyInstance(mapperInterface.getClassLoader(), new Class[] { mapperInterface }, mapperProxy);\n  }\n\n  public T newInstance(SqlSession sqlSession) {\n    final MapperProxy<T> mapperProxy = new MapperProxy<>(sqlSession, mapperInterface, methodCache);\n    return newInstance(mapperProxy);\n  }\n\n}\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5bf9\u4e0eclass\u5c5e\u6027\u7684\u5904\u7406")),(0,r.kt)("p",null," \u8fd9\u4e2a\u5c5e\u6027\u6211\u4eec\u914d\u7f6e\u7684\u662f\u4e00\u4e2aclass\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},'<mapper class="com.ydlclass.UserMapper"/>'),"\uff0c\u5bf9\u4e00class\u5c06\u6765\u80af\u5b9a\u8981\u4ece\u6ce8\u89e3\u4e2d\u89e3\u6790\u4fe1\u606f\uff0c\u76f4\u63a5\u628a\u4ed6\u7684class\u4fe1\u606f\u6ce8\u518c\u8fdb\u53bb\u5c31\u597d\u4e86\u3002"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"resource\u5c5e\u6027\u4ee5\u53caurl\u5c5e\u6027\u7684\u5904\u7406")),(0,r.kt)("p",null," \u5728resource\u5c5e\u6027\u4ee5\u53caurl\u5c5e\u6027\u4e2d\u6ca1\u6709\u770b\u5230configuration.addMapper()\u8fd9\u4e2a\u65b9\u6cd5\u7684\u5f71\u5b50\uff0c\u8fd9\u4e24\u4e2a\u5c5e\u6027\u90fd\u662f\u4ee5\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f\u52a0\u8f7d\uff0c\u81ea\u7136\u8981\u89e3\u6790mapper\u914d\u7f6e\u6587\u4ef6\u4e86\u3002"),(0,r.kt)("p",null,"\u6211\u4eec\u770b\u5230\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"XMLMapperBuilder"),"\u8fd9\u4e2a\u7c7b\u7684parse()\u65b9\u6cd5\u3002\u5f88\u660e\u663e\u8fd9\u4e2a\u65b9\u6cd5configurationElement\u662f\u7528\u6765\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\u7684\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public void parse() {\n    if (!configuration.isResourceLoaded(resource)) {\n        configurationElement(parser.evalNode("/mapper"));\n        configuration.addLoadedResource(resource);\n        bindMapperForNamespace();\n    }\n\n    parsePendingResultMaps();\n    parsePendingCacheRefs();\n    parsePendingStatements();\n}\n')),(0,r.kt)("p",null,"\u800c\u5728\u8fd9\u4e2a\u65b9\u6cd5\u4e2dbindMapperForNamespace\u6211\u4eec\u770b\u5230\u4e86\u6ce8\u518cmapper\u7684\u4ee3\u7801\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'private void bindMapperForNamespace() {\n       ...\u5176\u4ed6\u4ee3\u7801\u7701\u7565\n            configuration.addLoadedResource("namespace:" + namespace);\n            configuration.addMapper(boundType);\n        }\n    }\n}\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"mapper\u7684\u5177\u4f53\u89e3\u6790")),(0,r.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a\u89e3\u6790\u5668\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"XMLMapperBuilder mapperParser = new XMLMapperBuilder(inputStream, configuration, resource, configuration.getSqlFragments());\n")),(0,r.kt)("p",null,"\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u662f\u5bf9\u6bcf\u4e00\u4e2a\u6807\u7b7e\u7684\u89e3\u6790\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'private void configurationElement(XNode context) {\n    try {\n        String namespace = context.getStringAttribute("namespace");\n        if (namespace == null || namespace.isEmpty()) {\n            throw new BuilderException("Mapper\'s namespace cannot be empty");\n        }\n        builderAssistant.setCurrentNamespace(namespace);\n        cacheRefElement(context.evalNode("cache-ref"));\n        cacheElement(context.evalNode("cache"));\n        parameterMapElement(context.evalNodes("/mapper/parameterMap"));\n        resultMapElements(context.evalNodes("/mapper/resultMap"));\n        sqlElement(context.evalNodes("/mapper/sql"));\n        buildStatementFromContext(context.evalNodes("select|insert|update|delete"));\n    } catch (Exception e) {\n        throw new BuilderException("Error parsing Mapper XML. The XML location is \'" + resource + "\'. Cause: " + e, e);\n    }\n}\n')),(0,r.kt)("h4",{id:"4\u901a\u8fc7sqlsession\u83b7\u53d6\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61"},"\uff084\uff09\u901a\u8fc7sqlSession\u83b7\u53d6\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"\u901a\u8fc7sqlSessionFactory\u83b7\u53d6\u53e6\u4e00\u4e2asession\uff0c\u6b64\u5904\u4f7f\u7528\u3010\u5de5\u5382\u8bbe\u8ba1\u6a21\u5f0f\u3011\nSqlSession sqlSession = sqlSessionFactory.openSession();\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u63a5\u4e0b\u6765\u5c31\u8981\u7814\u7a76mapper\u7684\u4ee3\u7406\u5bf9\u8c61\u751f\u6210\u7684\u8fc7\u7a0b\u4e86\uff0c\u6b64\u5904\u4f7f\u7528\u3010\u4ee3\u7406\u8bbe\u8ba1\u6a21\u5f0f\u3011")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"// 4\u3001\u901a\u8fc7sqlSession\u83b7\u53d6\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff0c\u6b64\u5904\u4f7f\u7528\u3010\u4ee3\u7406\u8bbe\u8ba1\u6a21\u5f0f\u3011\nUserMapper mapper = sqlSession.getMapper(UserMapper.class);\n")),(0,r.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u8d70\u5230DefaultSqlSession\uff0c\u8fd9\u662fSqlSession\u7684\u4e00\u4e2a\u5b50\u7c7b\uff0c\u4eceopen\u65b9\u6cd5\u4e2d\u6211\u4eec\u80fd\u770b\u5230\u9ed8\u8ba4\u521b\u5efa\u7684sqlSession\u662f\u4ed6\u7684\u5b50\u7c7bDefaultSqlSession"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"private SqlSession openSessionFromDataSource(ExecutorType execType, TransactionIsolationLevel level, boolean autoCommit) {\n    ...\u7701\u7565\u4e0d\u91cd\u8981\u7684\u4ee3\u7801\n    return new DefaultSqlSession(configuration, executor, autoCommit);\n}\n")),(0,r.kt)("p",null,"\u4ece\u5b9e\u73b0\u7c7b\u7684getMapper\u4e2d\u5f97\u77e5\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public <T> T getMapper(Class<T> type) {\n    return configuration.getMapper(type, this);\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"public <T> T getMapper(Class<T> type, SqlSession sqlSession) {\n    return mapperRegistry.getMapper(type, sqlSession);\n  }\n")),(0,r.kt)("p",null,"\u4ece\u6ce8\u518c\u5668\u4e2d\u83b7\u53d6mapper\u5de5\u5382\uff0c\u5e76\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public <T> T getMapper(Class<T> type, SqlSession sqlSession) {\n    final MapperProxyFactory<T> mapperProxyFactory = (MapperProxyFactory<T>) knownMappers.get(type);\n    if (mapperProxyFactory == null) {\n        throw new BindingException("Type " + type + " is not known to the MapperRegistry.");\n    }\n    try {\n        // \u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\uff1a\n        return mapperProxyFactory.newInstance(sqlSession);\n    } catch (Exception e) {\n        throw new BindingException("Error getting mapper instance. Cause: " + e, e);\n    }\n}\n')),(0,r.kt)("p",null,"\u90a3\u6211\u4eec\u53ef\u4ee5\u804a\u4e00\u804aMapperProxyFactory\u8fd9\u4e2a\u7c7b\u4e86\uff0c\u5b83\u6301\u6709\u4e00\u4e2a\u63a5\u53e3\u548c\u4e00\u4e2amethodCache\uff0c\u8fd9\u4e2a\u63a5\u53e3\u5f53\u7136\u662f\u4e3a\u4e86\u751f\u6210\u4ee3\u7406\u5bf9\u8c61\u4f7f\u7528\u7684\u7c7b\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public class MapperProxyFactory<T> {\n    private final Class<T> mapperInterface;\n    private final Map<Method, MapperMethodInvoker> methodCache = new ConcurrentHashMap<>();\n}\n")),(0,r.kt)("p",null,"\u5728\u521b\u5efa\u5bf9\u8c61\u7684\u65f6\u5019\u521b\u5efa\u4e86\u4e00\u4e2aMapperProxy\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public T newInstance(SqlSession sqlSession) {\n    final MapperProxy<T> mapperProxy = new MapperProxy<>(sqlSession, mapperInterface, methodCache);\n    return newInstance(mapperProxy);\n}\n")),(0,r.kt)("p",null,"MapperProxy\u5c31\u662f\u6211\u4eec\u7684InvocationHandler\uff0c\u4e5f\u662f\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\u5fc5\u987b\u7684\uff0c\u5176\u4e2d\u7684\u6838\u5fc3\u65b9\u6cd5\u662finvoke\uff0c\u4f1a\u5728\u8c03\u7528\u4ee3\u7406\u5bf9\u8c61\u7684\u65b9\u6cd5\u65f6\u8c03\u7528\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public class MapperProxy<T> implements InvocationHandler, Serializable {\n\n    private static final long serialVersionUID = -4724728412955527868L;\n    private static final int ALLOWED_MODES = MethodHandles.Lookup.PRIVATE | MethodHandles.Lookup.PROTECTED\n        | MethodHandles.Lookup.PACKAGE | MethodHandles.Lookup.PUBLIC;\n    private static final Constructor<Lookup> lookupConstructor;\n    private static final Method privateLookupInMethod;\n    private final SqlSession sqlSession;\n    private final Class<T> mapperInterface;\n    private final Map<Method, MapperMethodInvoker> methodCache;\n\n    public MapperProxy(SqlSession sqlSession, Class<T> mapperInterface, Map<Method, MapperMethodInvoker> methodCache) {\n        this.sqlSession = sqlSession;\n        this.mapperInterface = mapperInterface;\n        this.methodCache = methodCache;\n    }\n\n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        try {\n            if (Object.class.equals(method.getDeclaringClass())) {\n                return method.invoke(this, args);\n            } else {\n                return cachedInvoker(method).invoke(proxy, method, args, sqlSession);\n            }\n        } catch (Throwable t) {\n            throw ExceptionUtil.unwrapThrowable(t);\n        }\n    }\n")),(0,r.kt)("p",null,"\u6838\u5fc3\u65b9\u6cd5\u5f53\u7136\u662finvoke\u4e86\uff0c\u5c06\u6765\u8c03\u7528\u4ee3\u7406\u5bf9\u8c61\u7684\u65b9\u6cd5\uff0c\u5176\u5b9e\u5c31\u662f\u5728\u6267\u884c\u6b64\u65b9\u6cd5\u3002"),(0,r.kt)("h4",{id:"5\u65b9\u6cd5\u8c03\u7528"},"\uff085\uff09\u65b9\u6cd5\u8c03\u7528"),(0,r.kt)("p",null,"\u5f53\u6211\u4eec\u6267\u884c\u4ee3\u7406\u7684\u5bf9\u8c61\u7684\u65b9\u6cd5\u65f6\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"List<User> allUser = mapper.findAllUser(12);\n")),(0,r.kt)("p",null,"invoke\u65b9\u6cd5\u4f1a\u88ab\u8c03\u7528\uff0c\u8fd9\u91cc\u4f1a\u5224\u65ad\u5b83\u8c03\u7528\u7684\u662f\u7ee7\u627f\u81eaObject\u7684\u65b9\u6cd5\u8fd8\u662f\u5b9e\u73b0\u7684\u63a5\u53e3\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u7684\u91cd\u70b9\u653e\u5728\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"cachedInvoker(method).invoke(proxy, method, args, sqlSession);\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"private MapperMethodInvoker cachedInvoker(Method method) throws Throwable {\n    try {\n      // \u8fd9\u91cc\u5c31\u77e5\u9053\u4e86methodCache\u7684\u5de6\u53f3\u4e86\uff0c\u65b9\u6cd5\u5b58\u5728\u7f13\u5b58\u91cc\u907f\u514d\u9891\u7e41\u7684\u521b\u5efa\n      MapperMethodInvoker invoker = methodCache.get(method);\n      if (invoker != null) {\n        return invoker;\n      }\n\n        // \u7f13\u5b58\u6ca1\u6709\u5c31\u521b\u5efa\u4e00\u4e2a\n      return methodCache.computeIfAbsent(method, m -> {\n          // \u8fd9\u91cc\u662f\u5904\u7406\u63a5\u53e3\u7684\u9ed8\u8ba4\u65b9\u6cd5\n        if (m.isDefault()) {\n          try {\n            if (privateLookupInMethod == null) {\n              return new DefaultMethodInvoker(getMethodHandleJava8(method));\n            } else {\n              return new DefaultMethodInvoker(getMethodHandleJava9(method));\n            }\n          } catch (IllegalAccessException | InstantiationException | InvocationTargetException\n              | NoSuchMethodException e) {\n            throw new RuntimeException(e);\n          }\n            // \u6838\u5fc3\u4ee3\u7801\u5728\u8fd9\u91cc\n        } else {\n          return new PlainMethodInvoker(new MapperMethod(mapperInterface, method, sqlSession.getConfiguration()));\n        }\n      });\n    } catch (RuntimeException re) {\n      Throwable cause = re.getCause();\n      throw cause == null ? re : cause;\n    }\n  }\n")),(0,r.kt)("p",null,"\u6838\u5fc3\u662f\uff08\u666e\u901a\u7684\u65b9\u6cd5\u8c03\u7528\u8005\uff09\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"}," new PlainMethodInvoker(new MapperMethod(mapperInterface, method, sqlSession.getConfiguration()));\n")),(0,r.kt)("p",null,"\u5728PlainMethodInvoker\u4f20\u5165\u4e86\u4e00\u4e2aMapperMethod\uff08\u65b9\u6cd5\u7684\u5305\u88c5\u7c7b\uff09\uff0c\u6839\u636e\u63a5\u53e3\u3001\u65b9\u6cd5\u7b7e\u540d\u548c\u6211\u4eec\u7684\u914d\u7f6e\u751f\u6210\u4e00\u4e2a\u65b9\u6cd5\u7684\u5305\u88c5\uff0c\u8fd9\u91cc\u6709SqlCommand\uff08\u7528\u6765\u6267\u884csql\uff09\uff0c\u8fd8\u6709\u6211\u4eec\u7684\u65b9\u6cd5\u7b7e\u540d\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public class MapperMethod {\n\n  private final SqlCommand command;\n  private final MethodSignature method;\n\n  public MapperMethod(Class<?> mapperInterface, Method method, Configuration config) {\n    this.command = new SqlCommand(config, mapperInterface, method);\n    this.method = new MethodSignature(config, mapperInterface, method);\n  }\n}\n")),(0,r.kt)("p",null,"\u5b83\u8fd8\u6709\u4e2a\u6838\u5fc3\u65b9\u6cd5\uff0c\u5c31\u662f\u6267\u884c\u5177\u4f53\u7684sql\u5566\uff01"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public Object execute(SqlSession sqlSession, Object[] args) {\n    Object result;\n    switch (command.getType()) {\n      case INSERT: {\n        Object param = method.convertArgsToSqlCommandParam(args);\n        result = rowCountResult(sqlSession.insert(command.getName(), param));\n        break;\n      }\n      case UPDATE: {\n        Object param = method.convertArgsToSqlCommandParam(args);\n        result = rowCountResult(sqlSession.update(command.getName(), param));\n        break;\n      }\n      case DELETE: {\n        Object param = method.convertArgsToSqlCommandParam(args);\n        result = rowCountResult(sqlSession.delete(command.getName(), param));\n        break;\n      }\n      case SELECT:\n        if (method.returnsVoid() && method.hasResultHandler()) {\n          executeWithResultHandler(sqlSession, args);\n          result = null;\n        } else if (method.returnsMany()) {\n          result = executeForMany(sqlSession, args);\n    // \u4e00\u4e0b\u90e8\u5206\u7701\u7565\n    return result;\n  }\n")),(0,r.kt)("p",null,"\u56de\u5934\u770b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"}," cachedInvoker(method).invoke(proxy, method, args, sqlSession);\n")),(0,r.kt)("p",null,"\u672c\u8d28\u8c03\u7528\u7684\u5c31\u662fPlainMethodInvoker\u8fd9\u4e2a\u5b50\u7c7b\u7684invoke\u65b9\u6cd5\uff0c\u800c\u5b83\u786e\u5b9e\u8c03\u7528mapperMethod.execute\u65b9\u6cd5\u3002\u5230\u6b64\u5c31\u660e\u767d\u4e86\u6574\u4e2a\u6d41\u7a0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"private static class PlainMethodInvoker implements MapperMethodInvoker {\n  private final MapperMethod mapperMethod;\n\n  public PlainMethodInvoker(MapperMethod mapperMethod) {\n    super();\n    this.mapperMethod = mapperMethod;\n  }\n\n  @Override\n  public Object invoke(Object proxy, Method method, Object[] args, SqlSession sqlSession) throws Throwable {\n    return mapperMethod.execute(sqlSession, args);\n  }\n}\n")),(0,r.kt)("h4",{id:"6\u7ee7\u7eed\u4e86\u89e3"},"\uff086\uff09\u7ee7\u7eed\u4e86\u89e3"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e00\u7ea7\u7f13\u5b58")),(0,r.kt)("p",null,"\u6211\u4eec\u4e0d\u59a8\u5728excute\u65b9\u6cd5\u4e2d\u968f\u673a\u627e\u4e00\u4e2aselect\u8bed\u53e5\u6df1\u5165\u6316\u6398\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"result = executeForMany(sqlSession, args);executeForMany(sqlSession, args);\n")),(0,r.kt)("p",null,"\u770b\u65b9\u6cd5\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"private <E> Object executeForMany(SqlSession sqlSession, Object[] args) {\n    List<E> result;\n    ...\u7701\u7565\u5176\u4ed6\u4ee3\u7801\n        result = sqlSession.selectList(command.getName(), param);\n   \n    return result;\n}\n")),(0,r.kt)("p",null,"\u8fd9\u91cc\u5c31\u80fd\u770b\u5230\u672c\u8d28\u4e0a\u4f7f\u7528\u7684\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"sqlSession.selectList(command.getName(), param);"),"\u8fd9\u8ddd\u79bb\u6211\u4eec\u719f\u6089\u7684\u8d8a\u6765\u8d8a\u8fd1\u4e86\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Override\npublic <E> List<E> selectList(String statement, Object parameter, RowBounds rowBounds) {\n    try {\n        // MappedStatement\uff0c\u4f7f\u7528\u6267\u884c\u5668\u6267\u884csql\n        MappedStatement ms = configuration.getMappedStatement(statement);\n        return executor.query(ms, wrapCollection(parameter), rowBounds, Executor.NO_RESULT_HANDLER);\n    } catch (Exception e) {\n        throw ExceptionFactory.wrapException("Error querying database.  Cause: " + e, e);\n    } finally {\n        ErrorContext.instance().reset();\n    }\n}\n')),(0,r.kt)("p",null,"MappedStatement\u5176\u5b9e\u5c31\u662f\u6211\u4eecmapper.xml\u7684\u89e3\u6790\u7ed3\u679c\uff0c\u653e\u4e86\u5f88\u591a\u7684\u4fe1\u606f\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public final class MappedStatement {\n\n  private String resource;\n  private Configuration configuration;\n  private String id;\n  private Integer fetchSize;\n  private Integer timeout;\n  private StatementType statementType;\n  private ResultSetType resultSetType;\n  private SqlSource sqlSource;\n  private Cache cache;\n  private ParameterMap parameterMap;\n  private List<ResultMap> resultMaps;\n  private boolean flushCacheRequired;\n  private boolean useCache;\n  private boolean resultOrdered;\n  private SqlCommandType sqlCommandType;\n  ...\u7701\u7565\n")),(0,r.kt)("p",null,"executor\u662f\u771f\u6b63\u6267\u884csql\u7684\u4e00\u4e2a\u6267\u884c\u5668\uff0c\u5b83\u662f\u4e00\u4e2a\u63a5\u53e3\uff0c\u6709\u5177\u4f53\u7684\u5b9e\u73b0\u6bd4\u5982\u62bd\u8c61\u7c7bBaseExecutor\uff0c\u5b9e\u73b0SimpleExecutor\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public interface Executor {\n\n\n    int update(MappedStatement ms, Object parameter) throws SQLException;\n\n    <E> List<E> query(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, CacheKey cacheKey, BoundSql boundSql) throws SQLException;\n\n    <E> List<E> query(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler) throws SQLException;\n\n    <E> Cursor<E> queryCursor(MappedStatement ms, Object parameter, RowBounds rowBounds) throws SQLException;\n\n    List<BatchResult> flushStatements() throws SQLException;\n\n    void commit(boolean required) throws SQLException;\n\n    void rollback(boolean required) throws SQLException;\n\n    ...\u7701\u7565\n\n}\n")),(0,r.kt)("p",null,"\u6211\u4eec\u7ee7\u7eed\u770b executor.query\uff0c\u5728\u62bd\u8c61\u7c7bBaseExecutor\u5b83\u662f\u8fd9\u4e48\u5b9e\u73b0\u7684\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public abstract class BaseExecutor implements Executor\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Override\npublic <E> List<E> query(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler) throws SQLException {\n    BoundSql boundSql = ms.getBoundSql(parameter);\n    // \u8bf7\u6ce8\u610f\u8fd9\u91cc\u521b\u5efa\u4e86key\n    CacheKey key = createCacheKey(ms, parameter, rowBounds, boundSql);\n    return query(ms, parameter, rowBounds, resultHandler, key, boundSql);\n}\n")),(0,r.kt)("p",null,"\u8fd9\u91cc\u6709\u4e00\u4e2a\u6838\u5fc3\u65b9\u6cd5queryFromDatabase"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'  @Override\n  public <E> List<E> query(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, CacheKey key, BoundSql boundSql) throws SQLException {\n    ErrorContext.instance().resource(ms.getResource()).activity("executing a query").object(ms.getId());\n    if (closed) {\n      throw new ExecutorException("Executor was closed.");\n    }\n    if (queryStack == 0 && ms.isFlushCacheRequired()) {\n      clearLocalCache();\n    }\n    List<E> list;\n    try {\n      queryStack++;\n       // \u8fd9\u91cc\u6709\u3010\u4e00\u7ea7\u7f13\u5b58\u3011\u7684\u5f71\u5b50\uff0c\u4f18\u5148\u53bb\u7f13\u5b58\u4e2d\u53d6\n      list = resultHandler == null ? (List<E>) localCache.getObject(key) : null;\n      if (list != null) {\n        handleLocallyCachedOutputParameters(ms, key, parameter, boundSql);\n      } else {\n        list = queryFromDatabase(ms, parameter, rowBounds, resultHandler, key, boundSql);\n      }\n    } finally {\n      queryStack--;\n    }\n    if (queryStack == 0) {\n      for (DeferredLoad deferredLoad : deferredLoads) {\n        deferredLoad.load();\n      }\n      // issue #601\n      deferredLoads.clear();\n      if (configuration.getLocalCacheScope() == LocalCacheScope.STATEMENT) {\n        // issue #482\n        clearLocalCache();\n      }\n    }\n    return list;\n  }\n')),(0,r.kt)("p",null,"\u4ece\u8fd9\u91cc\u6211\u4eec\u80fd\u770b\u5230\u3010\u4ee5\u53ca\u7f13\u5b58\u7684\u5f71\u5b50\u4e86\u3011localCache\uff0c\u901a\u8fc7doQuery\u67e5\u8be2\u7684\u7ed3\u679c\uff0c\u4f1a\u653e\u5728localCache\u4e2d\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"private <E> List<E> queryFromDatabase(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, CacheKey key, BoundSql boundSql) throws SQLException {\n    List<E> list;\n    localCache.putObject(key, EXECUTION_PLACEHOLDER);\n    try {\n        // \u6838\u5fc3\u65b9\u6cd5\n        list = doQuery(ms, parameter, rowBounds, resultHandler, boundSql);\n    } finally {\n        localCache.removeObject(key);\n    }\n    localCache.putObject(key, list);\n    if (ms.getStatementType() == StatementType.CALLABLE) {\n        localOutputParameterCache.putObject(key, parameter);\n    }\n    return list;\n}\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u539f\u751f\u7684jdbc")),(0,r.kt)("p",null,"\u6211\u4eec\u7ee7\u7eed\u770b\u5b9e\u73b0\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public class SimpleExecutor extends BaseExecutor\n")),(0,r.kt)("p",null,"\u6211\u4eec\u8fdb\u5165\u4e0a\u8fb9\u63d0\u53ca\u7684doQuery\uff0c\u8fd9\u91cc\u770b\u5230\u4e00\u4e0b\u539f\u751fjdbc\u7684\u5f71\u5b50\u4e86\uff0c\u6bd4\u5982stmt\uff1b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Override\npublic <E> List<E> doQuery(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, BoundSql boundSql) throws SQLException {\n    Statement stmt = null;\n    try {\n        Configuration configuration = ms.getConfiguration();\n        StatementHandler handler = configuration.newStatementHandler(wrapper, ms, parameter, rowBounds, resultHandler, boundSql);\n        // \u83b7\u53d6prepareStatement\n        stmt = prepareStatement(handler, ms.getStatementLog());\n        return handler.query(stmt, resultHandler);\n    } finally {\n        closeStatement(stmt);\n    }\n}\n")),(0,r.kt)("p",null,"\u8fd9\u91cc\u6709\u51e0\u4e2a\u65b9\u6cd5\uff1a"),(0,r.kt)("p",null,"\u83b7\u53d6prepareStatement\uff0c\u8fd9\u91cc\u770b\u5230\u4e86Connection\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"private Statement prepareStatement(StatementHandler handler, Log statementLog) throws SQLException {\n    Statement stmt;\n    Connection connection = getConnection(statementLog);\n    // \u521b\u5efaPreparedStatement\n    stmt = handler.prepare(connection, transaction.getTimeout());\n    // \u586b\u5145\u5360\u4f4d\u7b26\n    handler.parameterize(stmt);\n    return stmt;\n}\n")),(0,r.kt)("p",null,"\u7ee7\u7eed\u6df1\u5165\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"public abstract class BaseStatementHandler implements StatementHandler\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Override\npublic Statement prepare(Connection connection, Integer transactionTimeout) throws SQLException {\n    ErrorContext.instance().sql(boundSql.getSql());\n    Statement statement = null;\n    try {\n        // \u521b\u5efaPreparedStatement\n        statement = instantiateStatement(connection);\n        setStatementTimeout(statement, transactionTimeout);\n        setFetchSize(statement);\n        return statement;\n    } catch (SQLException e) {\n        closeStatement(statement);\n        throw e;\n    } catch (Exception e) {\n        closeStatement(statement);\n        throw new ExecutorException("Error preparing statement.  Cause: " + e, e);\n    }\n}\n')),(0,r.kt)("p",null,"\u7ee7\u7eed\u6df1\u5165\uff0c\u6211\u4eec\u770b\u5230\u4e86\u719f\u6089\u7684connection.prepareStatement(sql)\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"public class PreparedStatementHandler extends BaseStatementHandler \n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Override\nprotected Statement instantiateStatement(Connection connection) throws SQLException {\n    String sql = boundSql.getSql();\n    ... \u7701\u7565\n} else if (mappedStatement.getResultSetType() == ResultSetType.DEFAULT) {\n    return connection.prepareStatement(sql);\n} else {\n    return connection.prepareStatement(sql, mappedStatement.getResultSetType().getValue(), ResultSet.CONCUR_READ_ONLY);\n}\n}\n")),(0,r.kt)("p",null,"\u8fd9\u91cc\u5c31\u662f\u5bf9\u5360\u4f4d\u7b26\u8fdb\u884c\u66ff\u6362"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Override\npublic void parameterize(Statement statement) throws SQLException {\n    parameterHandler.setParameters((PreparedStatement) statement);\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},' @Override\n  public void setParameters(PreparedStatement ps) {\n    ErrorContext.instance().activity("setting parameters").object(mappedStatement.getParameterMap().getId());\n    List<ParameterMapping> parameterMappings = boundSql.getParameterMappings();\n    if (parameterMappings != null) {\n      for (int i = 0; i < parameterMappings.size(); i++) {\n        ParameterMapping parameterMapping = parameterMappings.get(i);\n        if (parameterMapping.getMode() != ParameterMode.OUT) {\n          Object value;\n          String propertyName = parameterMapping.getProperty();\n          if (boundSql.hasAdditionalParameter(propertyName)) { // issue #448 ask first for additional params\n            value = boundSql.getAdditionalParameter(propertyName);\n          } else if (parameterObject == null) {\n            value = null;\n          } else if (typeHandlerRegistry.hasTypeHandler(parameterObject.getClass())) {\n            value = parameterObject;\n          } else {\n            MetaObject metaObject = configuration.newMetaObject(parameterObject);\n            value = metaObject.getValue(propertyName);\n          }\n          TypeHandler typeHandler = parameterMapping.getTypeHandler();\n          JdbcType jdbcType = parameterMapping.getJdbcType();\n          if (value == null && jdbcType == null) {\n            jdbcType = configuration.getJdbcTypeForNull();\n          }\n          try {\n            typeHandler.setParameter(ps, i + 1, value, jdbcType);\n          } catch (TypeException | SQLException e) {\n            throw new TypeException("Could not set parameters for mapping: " + parameterMapping + ". Cause: " + e, e);\n          }\n        }\n      }\n    }\n  }\n')),(0,r.kt)("p",null,"\u5f53\u524d\u4f4d\u7f6e\u6211\u4eec\u5df2\u7ecf\u4ece\u5934\u5bf9MyBatis\u7684\u6e90\u7801\u64b8\u4e86\u4e00\u904d\uff0c\u6709\u5e2e\u52a9\u4e09\u8fde\u3002"),(0,r.kt)("h3",{id:"4\u522b\u540d\u7cfb\u7edf"},"4\u3001\u522b\u540d\u7cfb\u7edf"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u601d\u8003\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="getUsersByParams" parameterType="java.util.HashMap">\n    select id,username,password from user where username = #{name}\n</select>\n')),(0,r.kt)("p",null,"resultType\u5199\u6210java.util.HashMap\u4e5f\u884c\uff0c\u5199\u6210map\u4e5f\u884c\uff0c\u8bf4\u660eMyBatis\u5185\u7f6e\u5f88\u591a\u522b\u540d\uff0c\u5305\u62ec\u6211\u4eec\u7684\u914d\u7f6e\u4e2d\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<environment id="development">\n    <transactionManager type="JDBC"/>\n    <dataSource type="POOLED">\n        <property name="driver" value="${driver}"/>\n        <property name="url" value="${url}"/>\n        <property name="username" value="${username}"/>\n        <property name="password" value="${password}"/>\n    </dataSource>\n</environment>\n')),(0,r.kt)("p",null," \u5176\u4e2d\u4e3a\u4ec0\u4e48\u5199\u4e00\u4e2aPOOLED\u5c31\u80fd\u4ee3\u8868\u6211\u4eec\u4f7f\u7528\u4e86\u4ec0\u4e48\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u5176\u5b9e\u8fd9\u4e5f\u662f\u522b\u540d\uff0c\u7b80\u5355\u7406\u89e3\u5c31\u662f\u53ef\u4ee5\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u77ed\u5c0f\u7684\u540d\u5b57\u66ff\u4ee3\u5f88\u957f\u7684\u7c7b\u7684\u6743\u9650\u5b9a\u540d\u79f0\u3002"),(0,r.kt)("p",null,"\u5176\u5b9e\uff1a\u5728\u6784\u9020Configuration\u7c7b\u65f6\uff0c\u6ce8\u518c\u4e86\u5982\u4e0b\u7684\u522b\u540d\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public Configuration() {\n    typeAliasRegistry.registerAlias("JDBC", JdbcTransactionFactory.class);\n    typeAliasRegistry.registerAlias("MANAGED", ManagedTransactionFactory.class);\n\n    typeAliasRegistry.registerAlias("JNDI", JndiDataSourceFactory.class);\n    typeAliasRegistry.registerAlias("POOLED", PooledDataSourceFactory.class);\n    typeAliasRegistry.registerAlias("UNPOOLED", UnpooledDataSourceFactory.class);\n\n    typeAliasRegistry.registerAlias("PERPETUAL", PerpetualCache.class);\n    typeAliasRegistry.registerAlias("FIFO", FifoCache.class);\n    typeAliasRegistry.registerAlias("LRU", LruCache.class);\n    typeAliasRegistry.registerAlias("SOFT", SoftCache.class);\n    typeAliasRegistry.registerAlias("WEAK", WeakCache.class);\n\n    typeAliasRegistry.registerAlias("DB_VENDOR", VendorDatabaseIdProvider.class);\n\n    typeAliasRegistry.registerAlias("XML", XMLLanguageDriver.class);\n    typeAliasRegistry.registerAlias("RAW", RawLanguageDriver.class);\n\n    typeAliasRegistry.registerAlias("SLF4J", Slf4jImpl.class);\n    typeAliasRegistry.registerAlias("COMMONS_LOGGING", JakartaCommonsLoggingImpl.class);\n    typeAliasRegistry.registerAlias("LOG4J", Log4jImpl.class);\n    typeAliasRegistry.registerAlias("LOG4J2", Log4j2Impl.class);\n    typeAliasRegistry.registerAlias("JDK_LOGGING", Jdk14LoggingImpl.class);\n    typeAliasRegistry.registerAlias("STDOUT_LOGGING", StdOutImpl.class);\n    typeAliasRegistry.registerAlias("NO_LOGGING", NoLoggingImpl.class);\n\n    typeAliasRegistry.registerAlias("CGLIB", CglibProxyFactory.class);\n    typeAliasRegistry.registerAlias("JAVASSIST", JavassistProxyFactory.class);\n\n    languageRegistry.setDefaultDriverClass(XMLLanguageDriver.class);\n    languageRegistry.register(RawLanguageDriver.class);\n  }\n')),(0,r.kt)("p",null,"\u5728\u6784\u9020TypeAliasRegistry\u6ce8\u518c\u4e86\u5982\u4e0b\u7684\u522b\u540d\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4f7f\u7528\u4ee5\u4e0b\u7684\u522b\u540d\u6765\u4ee3\u66ff\u8fd9\u4e9b\u7c7b\u7684\u6743\u9650\u5b9a\u540d\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'public class TypeAliasRegistry {\n\n  private final Map<String, Class<?>> typeAliases = new HashMap<>();\n\n  public TypeAliasRegistry() {\n    registerAlias("string", String.class);\n\n    registerAlias("byte", Byte.class);\n    registerAlias("long", Long.class);\n    registerAlias("short", Short.class);\n    registerAlias("int", Integer.class);\n    registerAlias("integer", Integer.class);\n    registerAlias("double", Double.class);\n    registerAlias("float", Float.class);\n    registerAlias("boolean", Boolean.class);\n\n    registerAlias("byte[]", Byte[].class);\n    registerAlias("long[]", Long[].class);\n    registerAlias("short[]", Short[].class);\n    registerAlias("int[]", Integer[].class);\n    registerAlias("integer[]", Integer[].class);\n    registerAlias("double[]", Double[].class);\n    registerAlias("float[]", Float[].class);\n    registerAlias("boolean[]", Boolean[].class);\n\n    registerAlias("_byte", byte.class);\n    registerAlias("_long", long.class);\n    registerAlias("_short", short.class);\n    registerAlias("_int", int.class);\n    registerAlias("_integer", int.class);\n    registerAlias("_double", double.class);\n    registerAlias("_float", float.class);\n    registerAlias("_boolean", boolean.class);\n\n    registerAlias("_byte[]", byte[].class);\n    registerAlias("_long[]", long[].class);\n    registerAlias("_short[]", short[].class);\n    registerAlias("_int[]", int[].class);\n    registerAlias("_integer[]", int[].class);\n    registerAlias("_double[]", double[].class);\n    registerAlias("_float[]", float[].class);\n    registerAlias("_boolean[]", boolean[].class);\n\n    registerAlias("date", Date.class);\n    registerAlias("decimal", BigDecimal.class);\n    registerAlias("bigdecimal", BigDecimal.class);\n    registerAlias("biginteger", BigInteger.class);\n    registerAlias("object", Object.class);\n\n    registerAlias("date[]", Date[].class);\n    registerAlias("decimal[]", BigDecimal[].class);\n    registerAlias("bigdecimal[]", BigDecimal[].class);\n    registerAlias("biginteger[]", BigInteger[].class);\n    registerAlias("object[]", Object[].class);\n\n    registerAlias("map", Map.class);\n    registerAlias("hashmap", HashMap.class);\n    registerAlias("list", List.class);\n    registerAlias("arraylist", ArrayList.class);\n    registerAlias("collection", Collection.class);\n    registerAlias("iterator", Iterator.class);\n\n    registerAlias("ResultSet", ResultSet.class);\n  }\n')),(0,r.kt)("p",null,"\u5f53\u7136\u6211\u4eec\u53ef\u4ee5\u7ed9\u5199\u7684\u7c7b\u5b9a\u4e49\u522b\u540d\uff1a"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u7ed9\u81ea\u5df1\u7c7b\u8bbe\u5b9a\u522b\u540d")),(0,r.kt)("p",null,"\u5728\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u4e2d\u52a0\u5165"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<typeAliases>\n    <typeAlias type="com.ydlclass.entity.User"  alias="user"/>\n</typeAliases>\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"<typeAlias>")," \u6807\u7b7e\u4e2d \u6709 ",(0,r.kt)("inlineCode",{parentName:"p"},"type")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"alias")," \u4e24\u4e2a\u5c5e\u6027"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"type")," \u586b\u5199 \u5b9e\u4f53\u7c7b\u7684\u5168\u7c7b\u540d\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"alias")," \u53ef\u4ee5\u4e0d\u586b\uff0c\u4e0d\u586b\u7684\u8bdd\uff0c\u9ed8\u8ba4\u662f\u7c7b\u540d\uff0c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"alias")," \u586b\u4e86\u7684\u8bdd\u5c31\u4ee5 alias\u91cc\u7684\u503c\u4e3a\u51c6\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<typeAiases>\n    <package name=""/>\n</typeAliases>\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"<package>")," \u6807\u7b7e \u4e3a\u67d0\u4e2a\u5305\u4e0b\u7684\u6240\u6709\u7c7b\u8d77\u522b\u540d\uff1b ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," \u5c5e\u6027\u586b\u5199\u5305\u540d\u3002 \u522b\u540d\u9ed8\u8ba4\u662f\u7c7b\u540d\uff0c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'@Alias` \u6ce8\u89e3   \u52a0\u5728\u5b9e\u4f53\u7c7b\u4e0a\uff0c\u4e3a\u67d0\u4e2a\u7c7b\u8d77\u522b\u540d\uff1b\u4f8b\uff1a`@Alias("User")\n')),(0,r.kt)("h2",{id:"\u4e03resultmap\u8be6\u89e3"},"\u4e03\u3001resultMap\u8be6\u89e3"),(0,r.kt)("p",null,"\u5982\u679c\u6570\u636e\u5e93\u5b57\u6bb5\u548c\u5b9e\u4f53\u7684\u5b57\u6bb5\u662f\u4e00\u4e00\u5bf9\u5e94\uff0c\u90a3\u4e48MyBatis\u4f1a\u3010\u81ea\u52a8\u6620\u5c04\u3011\uff0c\u4f46\u662f\u5982\u679c\u4e0d\u4e00\u81f4\uff0c\u6bd4\u5982\u4e00\u4e2a\u53ebuser\u4e00\u4e2a\u53ebusername\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u6211\u4eec\u624b\u52a8\u7684\u5efa\u7acb\u4e00\u4e00\u6620\u5c04\u7684\u5173\u7cfb\u4e86\u3002"),(0,r.kt)("p",null,"\u6709\u65f6\u5019\u6211\u4eec\u7684\u6570\u636e\u5e93\u548c\u5b57\u6bb5\u548c\u5b9e\u4f8b\u7684\u5b57\u6bb5\u53ef\u80fd\u4e0d\u662f\u4e00\u4e00\u5bf9\u5e94\uff0c"),(0,r.kt)("p",null,"1\u3001Java\u4e2d\u7684\u5b9e\u4f53\u7c7b\u8bbe\u8ba1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public class User {\n\n   private int id;              //id\n   private String name;         //\u59d3\u540d\uff0c\u6570\u636e\u5e93\u4e3ausername\n   private String password;     //\u5bc6\u7801\uff0c\u4e00\u81f4\n   \n   //\u6784\u9020\n   //set/get\n   //toString()\n}\n")),(0,r.kt)("p",null,"3\u3001mapper"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"//\u6839\u636eid\u67e5\u8be2\u7528\u6237\nUser selectUserById(int id);\n")),(0,r.kt)("p",null,"4\u3001mapper\u6620\u5c04\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="selectUserById" resultType="user">\n  select * from user where id = #{id}\n</select>\n')),(0,r.kt)("p",null,"5\u3001\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Test\npublic void testSelectUserById() {\n   UserMapper mapper = session.getMapper(UserMapper.class);\n   User user = mapper.selectUserById(1);\n   System.out.println(user);\n   session.close();\n}\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7ed3\u679c:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"User"),(0,r.kt)("li",{parentName:"ul"},"\u67e5\u8be2\u51fa\u6765\u53d1\u73b0 name\u4e3a\u7a7a . \u8bf4\u660e\u51fa\u73b0\u4e86\u95ee\u9898\uff01")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5206\u6790\uff1a")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"select * from user where id = #{id} \u53ef\u4ee5\u770b\u505a"),(0,r.kt)("p",{parentName:"li"},"  select id,username,password from user where id = #")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"mybatis\u4f1a\u6839\u636e\u8fd9\u4e9b\u67e5\u8be2\u7684\u5217\u540d(\u4f1a\u5c06\u5217\u540d\u8f6c\u5316\u4e3a\u5c0f\u5199,\u6570\u636e\u5e93\u4e0d\u533a\u5206\u5927\u5c0f\u5199) , \u5229\u7528\u53cd\u5c04\u53bb\u5bf9\u5e94\u7684\u5b9e\u4f53\u7c7b\u4e2d\u67e5\u627e\u76f8\u5e94\u5217\u540d\u7684set\u65b9\u6cd5\u8bbe\u503c \uff0c\u5f53\u7136\u627e\u4e0d\u5230username"))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u89e3\u51b3\u65b9\u6848")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u65b9\u6848\u4e00\uff1a\u4e3a\u5217\u540d\u6307\u5b9a\u522b\u540d , \u522b\u540d\u548cjava\u5b9e\u4f53\u7c7b\u7684\u5c5e\u6027\u540d\u4e00\u81f4 .")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="selectUserById" resultType="User">\n  select id , username as name ,password from user where id = #{id}\n</select>\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u65b9\u6848\u4e8c\uff1a\u4f7f\u7528\u7ed3\u679c\u96c6\u6620\u5c04->ResultMap")," \u3010\u63a8\u8350\u3011"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<resultMap id="UserMap" type="User">\n   \x3c!-- id\u4e3a\u4e3b\u952e --\x3e\n   <id column="id" property="id"/>\n   \x3c!-- column\u662f\u6570\u636e\u5e93\u8868\u7684\u5217\u540d , property\u662f\u5bf9\u5e94\u5b9e\u4f53\u7c7b\u7684\u5c5e\u6027\u540d --\x3e\n   <result column="username" property="name"/>\n   <result column="password" property="password"/>\n</resultMap>\n\n<select id="selectUserById" resultMap="UserMap">\n  select id , username , password from user where id = #{id}\n</select>\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u7ed3\u8bba\uff1a")),(0,r.kt)("p",null,"\u8fd9\u4e2a\u5730\u65b9\u6211\u4eec\u624b\u52a8\u8c03\u6574\u4e86\u6620\u5c04\u5173\u7cfb\uff0c\u79f0\u4e4b\u4e3a\u3010\u624b\u52a8\u6620\u5c04\u3011\u3002"),(0,r.kt)("p",null,"\u4f46\u5982\u679c\u4e0d\u8c03\u6574\u5462\uff1f MyBatis\u5f53\u7136\u4f1a\u6309\u7167\u7ea6\u5b9a\u81ea\u52a8\u6620\u5c04\u3002"),(0,r.kt)("p",null,"\u6709\u4e86\u6620\u5c04\u8fd9\u79cd\u725b\u903c\u7684\u4e8b\u60c5\u4e4b\u540e\uff1a"),(0,r.kt)("p",null,"\u6211\u4eec\u7684\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'prepareStatement.setInt(1,21);\nprepareStatement.setString(2,"IT\u6960\u8001\u5e08");\n')),(0,r.kt)("p",null,"\u8fd8\u7528\u5199\u5417\uff1f\u4e24\u4e2a\u5b57\u3010",(0,r.kt)("strong",{parentName:"p"},"\u725b\u903c"),"\u3011\uff01"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5f53\u7136\u7ea6\u5b9a\u7684\u6700\u57fa\u672c\u7684\u64cd\u4f5c\u5c31\u662f\u5168\u90e8\u90fd\u4e00\u6837\uff0c\u8fd8\u6709\u5c31\u662f\u4e0b\u5212\u7ebf\u548c\u9a7c\u5cf0\u547d\u540d\u7684\u81ea\u52a8\u8f6c\u5316")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<settings>\n    \x3c!--\u5f00\u542f\u9a7c\u5cf0\u547d\u540d\u89c4\u5219--\x3e\n    <setting name="mapUnderscoreToCamelCase" value="true"/>\n</settings>\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u81ea\u5b9a\u4e49\u6570\u636e\u6e90")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public class MyDataSource implements DataSourceFactory {\n    private Properties properties;\n\n    @Override\n    public void setProperties(Properties properties) {\n        this.properties = properties;\n    }\n\n    @Override\n    public DataSource getDataSource() {\n\n        HikariConfig hikariConfig = new HikariConfig(properties);\n        return new HikariDataSource(hikariConfig);\n    }\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"username=root\npassword=root\njdbcUrl=jdbc:mysql://127.0.0.1:3306/ssm?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true&useSSL=false\ndriverClassName=com.mysql.cj.jdbc.Driver\n")),(0,r.kt)("h2",{id:"\u516b\u52a8\u6001sql-\u5f88\u91cd\u8981"},"\u516b\u3001\u52a8\u6001sql-\u5f88\u91cd\u8981"),(0,r.kt)("h3",{id:"1-\u6982\u8ff0"},"1\u3001 \u6982\u8ff0"),(0,r.kt)("p",null,"MyBatis\u63d0\u4f9b\u4e86\u5bf9SQL\u8bed\u53e5\u52a8\u6001\u7684\u7ec4\u88c5\u80fd\u529b\uff0c\u5927\u91cf\u7684\u5224\u65ad\u90fd\u53ef\u4ee5\u5728 MyBatis\u7684\u6620\u5c04XML\u6587\u4ef6\u91cc\u9762\u914d\u7f6e\uff0c\u4ee5\u8fbe\u5230\u8bb8\u591a\u6211\u4eec\u9700\u8981\u5927\u91cf\u4ee3\u7801\u624d\u80fd\u5b9e\u73b0\u7684\u529f\u80fd\uff0c\u5927\u5927\u51cf\u5c11\u4e86\u6211\u4eec\u7f16\u5199\u4ee3\u7801\u7684\u5de5\u4f5c\u91cf\u3002"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u52a8\u6001SQL\u7684\u5143\u7d20")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5143\u7d20"),(0,r.kt)("th",{parentName:"tr",align:null},"\u4f5c\u7528"),(0,r.kt)("th",{parentName:"tr",align:null},"\u5907\u6ce8"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"if"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5224\u65ad\u8bed\u53e5"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5355\u6761\u4ef6\u5206\u652f\u5224\u65ad")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"choose\u3001when\u3001otherwise"),(0,r.kt)("td",{parentName:"tr",align:null},"\u76f8\u5f53\u4e8eJava\u4e2d\u7684 case when\u8bed\u53e5"),(0,r.kt)("td",{parentName:"tr",align:null},"\u591a\u6761\u4ef6\u5206\u652f\u5224\u65ad")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"trim\u3001where\u3001set"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8f85\u52a9\u5143\u7d20"),(0,r.kt)("td",{parentName:"tr",align:null},"\u7528\u4e8e\u5904\u7406\u4e00\u4e9bSQL\u62fc\u88c5\u95ee\u9898")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"foreach"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5faa\u73af\u8bed\u53e5"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5728in\u8bed\u53e5\u7b49\u5217\u4e3e\u6761\u4ef6\u5e38\u7528")))),(0,r.kt)("h3",{id:"2if\u5143\u7d20\u975e\u5e38\u5e38\u7528"},"2\u3001if\u5143\u7d20\uff08\u975e\u5e38\u5e38\u7528\uff09"),(0,r.kt)("p",null,"if\u5143\u7d20\u76f8\u5f53\u4e8eJava\u4e2d\u7684if\u8bed\u53e5\uff0c\u5b83\u5e38\u5e38\u4e0etest\u5c5e\u6027\u8054\u5408\u4f7f\u7528\u3002\u73b0\u5728\u6211\u4eec\u8981\u6839\u636ename\u53bb\u67e5\u627e\u5b66\u751f\uff0c\u4f46\u662fname\u662f\u53ef\u9009\u7684\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="findUserById" resultType="com.ydlclass.entity.User">\n    select id,username,password from user\n    where 1 =1\n    <if test="id != null">\n        AND id = #{id}\n    </if>\n    <if test="username != null and username != \'\'">\n        AND username = #{username}\n    </if>\n    <if test="password != null and password != \'\'">\n        AND password = #{password}\n    </if>\n</select>\n')),(0,r.kt)("h3",{id:"3where\u5143\u7d20"},"3\u3001where\u5143\u7d20"),(0,r.kt)("p",null,"\u4e0a\u9762\u7684select\u8bed\u53e5\u6211\u4eec\u52a0\u4e86\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"1=1"),"\u7684\u7edd\u5bf9true\u7684\u8bed\u53e5\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u9632\u6b62\u8bed\u53e5\u9519\u8bef\uff0c\u53d8\u6210",(0,r.kt)("inlineCode",{parentName:"p"},"SELECT * FROM student WHERE"),"\u8fd9\u6837where\u540e\u6ca1\u6709\u5185\u5bb9\u7684\u9519\u8bef\u8bed\u53e5\u3002\u8fd9\u6837\u4f1a\u6709\u70b9\u5947\u602a\uff0c\u6b64\u65f6\u53ef\u4ee5\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"<where>"),"\u5143\u7d20\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="findUserById" resultType="com.ydlclass.entity.User">\n    select id,username,password from user\n    <where>\n        <if test="id != null">\n            AND id = #{id}\n        </if>\n        <if test="username != null and username != \'\'">\n            AND username = #{username}\n        </if>\n        <if test="password != null and password != \'\'">\n            AND password = #{password}\n        </if>\n    </where>\n</select>\n')),(0,r.kt)("h3",{id:"4trim\u5143\u7d20"},"4\u3001trim\u5143\u7d20"),(0,r.kt)("p",null,"\u6709\u65f6\u5019\u6211\u4eec\u8981\u53bb\u6389\u4e00\u4e9b\u7279\u6b8a\u7684SQL\u8bed\u6cd5\uff0c\u6bd4\u5982\u5e38\u89c1\u7684and\u3001or\uff0c\u6b64\u65f6\u53ef\u4ee5\u4f7f\u7528trim\u5143\u7d20\u3002trim\u5143\u7d20\u610f\u5473\u7740\u6211\u4eec\u9700\u8981\u53bb\u6389\u4e00\u4e9b\u7279\u6b8a\u7684\u5b57\u7b26\u4e32\uff0cprefix\u4ee3\u8868\u7684\u662f\u8bed\u53e5\u7684\u524d\u7f00\uff0c\u800cprefixOverrides\u4ee3\u8868\u7684\u662f\u4f60\u9700\u8981\u53bb\u6389\u7684\u90a3\u79cd\u5b57\u7b26\u4e32\uff0csuffix\u8868\u793a\u8bed\u53e5\u7684\u540e\u7f00\uff0csuffixOverrides\u4ee3\u8868\u53bb\u6389\u7684\u540e\u7f00\u5b57\u7b26\u4e32\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="select" resultType="com.ydlclass.entity.User">\n    SELECT * FROM user\n    <trim prefix="WHERE" prefixOverrides="AND">\n        <if test="username != null and username != \'\'">\n            AND username LIKE concat(\'%\', #{username}, \'%\')\n        </if>\n        <if test="id != null">\n            AND id = #{id}\n        </if>\n    </trim>\n</select>\n')),(0,r.kt)("h3",{id:"5choosewhenotherwise\u5143\u7d20"},"5\u3001choose\u3001when\u3001otherwise\u5143\u7d20"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u9009\u4e00\u4e2a")),(0,r.kt)("p",null,"\u6709\u4e9b\u65f6\u5019\u6211\u4eec\u8fd8\u9700\u8981\u591a\u79cd\u6761\u4ef6\u7684\u9009\u62e9\uff0c\u5728Java\u4e2d\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528switch\u3001case\u3001default\u8bed\u53e5\uff0c\u800c\u5728\u6620\u5c04\u5668\u7684\u52a8\u6001\u8bed\u53e5\u4e2d\u53ef\u4ee5\u4f7f\u7528choose\u3001when\u3001otherwise\u5143\u7d20\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u6709name\u7684\u65f6\u5019\u4f7f\u7528name\u641c\u7d22\uff0c\u6ca1\u6709\u7684\u65f6\u5019\u4f7f\u7528id\u641c\u7d22 --\x3e\n<select id="select" resultType="com.ydlclass.entity.User">\n    SELECT * FROM user\n    WHERE 1=1\n    <choose>\n        <when test="name != null and name != \'\'">\n            AND username LIKE concat(\'%\', #{username}, \'%\')\n        </when>\n        <when test="id != null">\n            AND id = #{id}\n        </when>\n    </choose>\n</select>\n')),(0,r.kt)("h3",{id:"6set\u5143\u7d20"},"6\u3001set\u5143\u7d20"),(0,r.kt)("p",null,"\u5728update\u8bed\u53e5\u4e2d\uff0c\u5982\u679c\u6211\u4eec\u53ea\u60f3\u66f4\u65b0\u67d0\u51e0\u4e2a\u5b57\u6bb5\u7684\u503c\uff0c\u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528set\u5143\u7d20\u914d\u5408if\u5143\u7d20\u6765\u5b8c\u6210\u3002",(0,r.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1aset\u5143\u7d20\u9047\u5230,\u4f1a\u81ea\u52a8\u628a,\u53bb\u6389"),"\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<update id="update">\n    UPDATE user\n    <set>\n        <if test="username != null and username != \'\'">\n            username = #{username},\n        </if>\n        <if test="password != null and password != \'\'">\n            password = #{password}\n        </if>\n    </set>\n    WHERE id = #{id}\n</update>\n')),(0,r.kt)("h3",{id:"7foreach\u5143\u7d20"},"7\u3001foreach\u5143\u7d20"),(0,r.kt)("p",null,"foreach\u5143\u7d20\u662f\u4e00\u4e2a\u5faa\u73af\u8bed\u53e5\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u904d\u5386\u96c6\u5408\uff0c\u53ef\u4ee5\u652f\u6301\u6570\u7ec4\u3001List\u3001Set\u63a5\u53e3\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="select" resultType="com.ydlclass.entity.User">\n    SELECT * FROM user\n    WHERE id IN\n    <foreach collection="ids" open="(" close=")" separator="," item="id">\n        #{id}\n    </foreach>\n</select>\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"collection\u914d\u7f6e\u7684\u662f\u4f20\u9012\u8fdb\u6765\u7684\u53c2\u6570\u540d\u79f0\u3002"),(0,r.kt)("li",{parentName:"ul"},"item\u914d\u7f6e\u7684\u662f\u5faa\u73af\u4e2d\u5f53\u524d\u7684\u5143\u7d20\u3002"),(0,r.kt)("li",{parentName:"ul"},"index\u914d\u7f6e\u7684\u662f\u5f53\u524d\u5143\u7d20\u5728\u96c6\u5408\u7684\u4f4d\u7f6e\u4e0b\u6807\u3002"),(0,r.kt)("li",{parentName:"ul"},"open\u548c close\u914d\u7f6e\u7684\u662f\u4ee5\u4ec0\u4e48\u7b26\u53f7\u5c06\u8fd9\u4e9b\u96c6\u5408\u5143\u7d20\u5305\u88c5\u8d77\u6765\u3002"),(0,r.kt)("li",{parentName:"ul"},"separator\u662f\u5404\u4e2a\u5143\u7d20\u7684\u95f4\u9694\u7b26\u3002")),(0,r.kt)("h3",{id:"8foreach\u6279\u91cf\u63d2\u5165"},"8\u3001foreach\u6279\u91cf\u63d2\u5165"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<insert id="batchInsert" parameterType="list">\n    insert into `user`( user_name, pass)\n    values\n    <foreach collection="users" item="user" separator=",">\n        (#{user.username}, #{user.password})\n    </foreach>\n\n</insert>\n')),(0,r.kt)("h3",{id:"9sql\u7247\u6bb5"},"9\u3001SQL\u7247\u6bb5"),(0,r.kt)("p",null,"\u6709\u65f6\u5019\u53ef\u80fd\u67d0\u4e2a sql \u8bed\u53e5\u6211\u4eec\u7528\u7684\u7279\u522b\u591a\uff0c\u4e3a\u4e86\u589e\u52a0\u4ee3\u7801\u7684\u91cd\u7528\u6027\uff0c\u7b80\u5316\u4ee3\u7801\uff0c\u6211\u4eec\u9700\u8981\u5c06\u8fd9\u4e9b\u4ee3\u7801\u62bd\u53d6\u51fa\u6765\uff0c\u7136\u540e\u4f7f\u7528\u65f6\u76f4\u63a5\u8c03\u7528\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u63d0\u53d6SQL\u7247\u6bb5\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<sql id="if-title-author">\n   <if test="title != null">\n      title = #{title}\n   </if>\n   <if test="author != null">\n      and author = #{author}\n   </if>\n</sql>\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5f15\u7528SQL\u7247\u6bb5\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="queryBlogIf" parameterType="map" resultType="blog">\n  select * from blog\n   <where>\n       \x3c!-- \u5f15\u7528 sql \u7247\u6bb5\uff0c\u5982\u679crefid \u6307\u5b9a\u7684\u4e0d\u5728\u672c\u6587\u4ef6\u4e2d\uff0c\u90a3\u4e48\u9700\u8981\u5728\u524d\u9762\u52a0\u4e0a namespace --\x3e\n       <include refid="if-title-author"></include>\n       \x3c!-- \u5728\u8fd9\u91cc\u8fd8\u53ef\u4ee5\u5f15\u7528\u5176\u4ed6\u7684 sql \u7247\u6bb5 --\x3e\n   </where>\n</select>\n')),(0,r.kt)("h2",{id:"\u4e5d\u6570\u636e\u5173\u7cfb\u5904\u7406"},"\u4e5d\u3001\u6570\u636e\u5173\u7cfb\u5904\u7406"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u90e8\u95e8\u548c\u5458\u5de5\u7684\u5173\u7cfb\uff0c\u4e00\u4e2a\u90e8\u95e8\u591a\u4e2a\u5458\u5de5\uff0c\u4e00\u4e2a\u5458\u5de5\u5c5e\u4e8e\u4e00\u4e2a\u90e8\u95e8"),(0,r.kt)("li",{parentName:"ul"},"\u90a3\u6211\u4eec\u53ef\u4ee5\u91c7\u53d6\u4e24\u79cd\u65b9\u5f0f\u6765\u7ef4\u62a4\u5173\u7cfb\uff0c\u4e00\u79cd\u5728\u4e00\u7684\u4e00\u65b9\uff0c\u4e00\u79cd\u5728\u591a\u7684\u4e00\u65b9\uff01")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u6570\u636e\u5e93\u8bbe\u8ba1")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE `dept` (\n`id` INT(10) NOT NULL,\n`name` VARCHAR(30) DEFAULT NULL,\nPRIMARY KEY (`id`)\n);\n\nINSERT INTO dept VALUES (1, '\u5143\u52a8\u529b\u5b66\u4e60\u4e00\u7ec4'),(2, '\u5143\u52a8\u529b\u5b66\u4e60\u4e8c\u7ec4');\n\nCREATE TABLE `employee` (\n`id` INT(10) NOT NULL,\n`name` VARCHAR(30) DEFAULT NULL,\n`did` INT(10) DEFAULT NULL,\nPRIMARY KEY (`id`),\nCONSTRAINT `fk_did` FOREIGN KEY (`did`) REFERENCES `dept` (`id`)\n) ;\n\n\nINSERT INTO employee VALUES (1, '\u90b8\u667a\u4f1f', 1),(2, '\u6210\u8679', 2),(3, '\u5eb7\u6c38\u4eae', 1),(4, '\u6768\u6625\u65fa', 2),(5, '\u9648\u5efa\u5f3a', 1);\n")),(0,r.kt)("h3",{id:"1\u901a\u8fc7\u5458\u5de5\u7ea7\u8054\u90e8\u95e8"},"1\u3001\u901a\u8fc7\u5458\u5de5\u7ea7\u8054\u90e8\u95e8"),(0,r.kt)("p",null,"1\u3001\u7f16\u5199\u5b9e\u4f53\u7c7b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class Dept  implements Serializable{\n    \n    private static final Long serialVersionUID = 1L;\n    \n    private int id;\n    private String name;\n    \n}\n\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class Employee  implements Serializable {\n    \n    private static final Long serialVersionUID = 1L;\n    \n    private int id;\n    private String name;\n    //\u7ef4\u62a4\u5173\u7cfb\n    private Dept dept;\n}\n")),(0,r.kt)("p",null,"2\u3001\u7f16\u5199\u5b9e\u4f53\u7c7b\u5bf9\u5e94\u7684Mapper\u63a5\u53e3"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public interface DeptMapper {\n}\npublic interface EmployeeMapper {\n}\n")),(0,r.kt)("p",null,"3\u3001\u7f16\u5199Mapper\u63a5\u53e3\u5bf9\u5e94\u7684 mapper.xml\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="com.ydlclass.dao.DeptMapper">\n\n</mapper>\n\n\n<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="com.ydlclass.dao.EmployeeMapper">\n\n</mapper>\n')),(0,r.kt)("p",null,"4\u3001\u5c06mapper\u8fdb\u884c\u6ce8\u518c\u3001\u53bbmybatis-config\u6587\u4ef6\u4e2d\u914d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<mapper resource="com/ydlclass/dao/DeptMapper.xml"/>\n<mapper resource="com/ydlclass/dao/EmployeeMapper.xml"/>\n')),(0,r.kt)("h4",{id:"1\u6309\u67e5\u8be2\u5d4c\u5957"},"\uff081\uff09\u6309\u67e5\u8be2\u5d4c\u5957"),(0,r.kt)("p",null,"\u8fd9\u79cd\u65b9\u5f0f\u662f\u4e00\u79cd\u7ea7\u8054\u67e5\u8be2\u7684\u65b9\u5f0f\uff0c\u4f1a\u4ea7\u751f\u591a\u4e2asql\u8bed\u53e5\uff0c\u7b2c\u4e00\u4e2asql\u7684\u67e5\u8be2\u8bed\u53e5\u7ed3\u679c\u4f1a\u89e6\u53d1\u7b2c\u4e8c\u4e2a\u67e5\u8be2\u8bed\u53e5\u3002"),(0,r.kt)("p",null,"1\u3001\u5199\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"List<Employee> select(Employee employee);\n")),(0,r.kt)("p",null,"2\u3001mapper\u5904\u7406"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="com.ydlclass.mapper.EmployeeMapper">\n\n    <resultMap id="employeeMap" type="employee">\n        <id column="id" property="id" />\n        <result column="name" property="name"/>\n        <association property="dept" column="did" javaType="dept"\n                     select="com.ydlclass.mapper.DeptMapper.select">\n            <id column="id" property="id"/>\n            <result column="name" property="name"/>\n\n        </association>\n    </resultMap>\n\n    <sql id="sql">\n        `id`,`name`,`did`\n    </sql>\n\n\n    <select id="select" resultMap="employeeMap">\n        select <include refid="sql" />\n        from employee\n    </select>\n\n</mapper>\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="com.ydlclass.mapper.DeptMapper">\n\n    <resultMap id="deptMap" type="dept">\n        <id column="id" property="id"/>\n        <result column="name" property="name"/>\n        <collection property="employees" javaType="list" ofType="employee"\n                    column="id" select="com.ydlclass.mapper.EmployeeMapper.selectByDid">\n            <id column="eid" property="id"/>\n            <result column="ename" property="name"/>\n        </collection>\n    </resultMap>\n\n    <sql id="sql">\n        `id`\n        ,`name`\n    </sql>\n\n    <select id="select" resultMap="deptMap">\n        select\n        <include refid="sql"/>\n        from dept where id = #{id}\n    </select>\n\n</mapper>\n')),(0,r.kt)("p",null,"3\u3001\u7f16\u5199\u5b8c\u6bd5\u53bbMybatis\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6ce8\u518cMapper"),(0,r.kt)("p",null,"4\u3001\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void testSelect() {\n    try (SqlSession session = sqlSessionFactory.openSession(true)) {\n        // statement\u662fsql\u7684\u7533\u660e\n        EmployeeMapper mapper = session.getMapper(EmployeeMapper.class);\n        List<Employee> employees = mapper.select(new Employee());\n\n        log.debug("The employees are [{}]",employees);\n    }\n}\n')),(0,r.kt)("p",null,"\u7ed3\u679c\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211112120442676-5498a3e8.png",alt:"image-20211112120442676"}),"image-20211112120442676"),(0,r.kt)("h4",{id:"2\u6309\u7ed3\u679c\u5d4c\u5957"},"\uff082\uff09\u6309\u7ed3\u679c\u5d4c\u5957"),(0,r.kt)("p",null,"\u7ed3\u679c\u5d4c\u5957\u662f\u4f7f\u7528\u590d\u6742\u67e5\u8be2\uff0c\u5728\u6839\u636e\u7ed3\u679c\u7684\u5b57\u6bb5\u8fdb\u884c\u5bf9\u8c61\u7684\u5c01\u88c5\uff0c\u672c\u8d28\u53ea\u4f1a\u53d1\u9001\u4e00\u4e2asql\u3002"),(0,r.kt)("p",null,"1\u3001\u63a5\u53e3\u65b9\u6cd5\u7f16\u5199"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"List<Employee> select2(Employee employee);\n")),(0,r.kt)("p",null,"2\u3001\u7f16\u5199\u5bf9\u5e94\u7684mapper\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="com.ydlclass.mapper.EmployeeMapper">\n\n    <resultMap id="employeeMap2" type="employee">\n        <id column="eid" property="id" />\n        <result column="ename" property="name"/>\n        <association property="dept" javaType="dept" >\n            <id column="did" property="id"/>\n            <result column="dname" property="name"/>\n        </association>\n    </resultMap>\n\n    <select id="select2" resultMap="employeeMap2" >\n        select e.id eid,e.name ename, d.id did,d.name dname\n        from employee e left join dept d\n                                  on d.id = e.did\n    </select>\n\n</mapper>\n')),(0,r.kt)("p",null,"4\u3001\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Test\npublic void testFindAllEmployees2() {\n    EmployeeMapper mapper = session.getMapper(EmployeeMapper.class);\n    List<Employee> allEmployees = mapper.findAllEmployees2();\n    for (Employee allEmployee : allEmployees) {\n        System.out.println(allEmployee);\n    }\n}\n")),(0,r.kt)("h3",{id:"2\u901a\u8fc7\u90e8\u95e8\u7ea7\u8054\u7528\u6237"},"2\u3001\u901a\u8fc7\u90e8\u95e8\u7ea7\u8054\u7528\u6237"),(0,r.kt)("p",null,"\u5728\u90e8\u95e8\u5904\u7ef4\u62a4\u5173\u7cfb\uff0c\u6b64\u5904\u53ef\u4ee5\u8054\u60f3\u8ba2\u5355\u548c\u8ba2\u5355\u8be6\u60c5\u3002"),(0,r.kt)("p",null,"\u4fee\u6539\u5b9e\u4f53\u7c7b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Data\npublic class Dept {\n    private int id;\n    private String name;\n    //\u7528\u4e8e\u5173\u7cfb\u7ef4\u62a4\n    List<Employee> employees;\n}\n\n@Data\npublic class Employee {\n    private int id;\n    private String name;\n}\n")),(0,r.kt)("h4",{id:"1\u6309\u7ed3\u679c\u5d4c\u5957\u5904\u7406"},"\uff081\uff09\u6309\u7ed3\u679c\u5d4c\u5957\u5904\u7406"),(0,r.kt)("p",null,"1\u3001\u5199\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public interface DeptMapper {\n    List<Dept> select(Dept dept);\n}\n")),(0,r.kt)("p",null,"2\u3001\u5199\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="com.ydlclass.mapper.DeptMapper">\n\n    <resultMap id="deptMap" type="dept">\n        <id column="id" property="id"/>\n        <result column="name" property="name"/>\n        <collection property="employees" javaType="list" ofType="employee"\n                    column="id" select="com.ydlclass.mapper.EmployeeMapper.selectByDid">\n            <id column="eid" property="id"/>\n            <result column="ename" property="name"/>\n        </collection>\n    </resultMap>\n\n    <sql id="sql">\n        `id`,`name`\n    </sql>\n\n    <select id="select" resultMap="deptMap">\n        select\n        <include refid="sql"/>\n        from dept where id = #{id}\n    </select>\n\n</mapper>\n')),(0,r.kt)("p",null,"\u5728EmployeeMapper\u4e2d\u6dfb\u52a0select\u8fdb\u884c\u7ea7\u8054\u67e5\u8be2"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="com.ydlclass.mapper.EmployeeMapper">\n\n    <resultMap id="employeeMap" type="employee">\n        <id column="id" property="id" />\n        <result column="name" property="name"/>\n        <association property="dept" column="did" javaType="dept"\n                     select="com.ydlclass.mapper.DeptMapper.select">\n            <id column="id" property="id"/>\n            <result column="name" property="name"/>\n\n        </association>\n    </resultMap>\n\n    <resultMap id="employeeMap2" type="employee">\n        <id column="eid" property="id" />\n        <result column="ename" property="name"/>\n        <association property="dept" javaType="dept" >\n            <id column="did" property="id"/>\n            <result column="dname" property="name"/>\n        </association>\n    </resultMap>\n\n    <select id="selectByDid" resultMap="employeeMap2" >\n        select id eid,name ename from employee where did=#{did}\n    </select>\n\n</mapper>\n')),(0,r.kt)("p",null,"3\u3001\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void testSelect() {\n    try (SqlSession session = sqlSessionFactory.openSession(true)) {\n        // statement\u662fsql\u7684\u7533\u660e\n        DeptMapper mapper = session.getMapper(DeptMapper.class);\n        List<Dept> depts = mapper.select(null);\n        log.debug("The depts are [{}]", depts);\n    }\n}\n')),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211112154559157-7977b62b.png",alt:"image-20211112154559157"}),"image-20211112154559157"),(0,r.kt)("h4",{id:"2\u6309\u67e5\u8be2\u5d4c\u5957\u5904\u7406"},"\uff082\uff09\u6309\u67e5\u8be2\u5d4c\u5957\u5904\u7406"),(0,r.kt)("p",null,"1\u3001TeacherMapper\u63a5\u53e3\u7f16\u5199\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"List<Dept> select2(Dept dept);\n")),(0,r.kt)("p",null,"2\u3001\u7f16\u5199\u63a5\u53e3\u5bf9\u5e94\u7684Mapper\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="com.ydlclass.mapper.DeptMapper">\n    <resultMap id="deptMap2" type="dept">\n        <id column="did" property="id"/>\n        <result column="dname" property="name"/>\n        <collection property="employees" javaType="list" ofType="employee">\n            <id column="eid" property="id"/>\n            <result column="ename" property="name"/>\n\n        </collection>\n    </resultMap>\n\n    <sql id="sql">\n        `id`,`name`\n    </sql>\n\n\n    <select id="select2" resultMap="deptMap2">\n        select d.id did, d.name dname, e.id eid, e.name ename\n        from dept d\n                 left join employee e on d.id = e.did\n    </select>\n</mapper>\n')),(0,r.kt)("p",null,"3\u3001\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void testSelect2() {\n    try (SqlSession session = sqlSessionFactory.openSession(true)) {\n        // statement\u662fsql\u7684\u7533\u660e\n        DeptMapper mapper = session.getMapper(DeptMapper.class);\n        List<Dept> depts = mapper.select2(null);\n        log.debug("The depts are [{}]", depts);\n    }\n}\n')),(0,r.kt)("p",null,"\u7ed3\u679c\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211112154831163-b41a99dc.png",alt:"image-20211112154831163"}),"image-20211112154831163"),(0,r.kt)("h3",{id:"3\u5c0f\u77e5\u8bc6"},"3\u3001\u5c0f\u77e5\u8bc6\uff1a"),(0,r.kt)("h4",{id:"1\u61d2\u52a0\u8f7d"},"\uff081\uff09\u61d2\u52a0\u8f7d"),(0,r.kt)("p",null," \u901a\u4fd7\u7684\u8bb2\u5c31\u662f\u6309\u9700\u52a0\u8f7d\uff0c\u6211\u4eec\u9700\u8981\u4ec0\u4e48\u7684\u65f6\u5019\u518d\u53bb\u8fdb\u884c\u4ec0\u4e48\u64cd\u4f5c\u3002\u800c\u4e14\u5148\u4ece\u5355\u8868\u67e5\u8be2\uff0c\u9700\u8981\u65f6\u518d\u4ece\u5173\u8054\u8868\u53bb\u5173\u8054\u67e5\u8be2\uff0c\u80fd\u5927\u5927\u63d0\u9ad8\u6570\u636e\u5e93\u6027\u80fd\uff0c\u56e0\u4e3a\u67e5\u8be2\u5355\u8868\u8981\u6bd4\u5173\u8054\u67e5\u8be2\u591a\u5f20\u8868\u901f\u5ea6\u8981\u5feb\u3002"),(0,r.kt)("p",null,"\u5728mybatis\u4e2d\uff0cresultMap\u53ef\u4ee5\u5b9e\u73b0\u9ad8\u7ea7\u6620\u5c04(\u4f7f\u7528association\u3001collection\u5b9e\u73b0\u4e00\u5bf9\u4e00\u53ca\u4e00\u5bf9\u591a\u6620\u5c04)\uff0cassociation\u3001collection\u5177\u5907\u5ef6\u8fdf\u52a0\u8f7d\u529f\u80fd\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!-- \u5f00\u542f\u61d2\u52a0\u8f7d\u914d\u7f6e --\x3e\n<settings>\n  \x3c!-- \u5ef6\u8fdf\u52a0\u8f7d\u7684\u5168\u5c40\u5f00\u5173\u3002\u5f53\u5f00\u542f\u65f6\uff0c\u6240\u6709\u5173\u8054\u5bf9\u8c61\u90fd\u4f1a\u5ef6\u8fdf\u52a0\u8f7d\u3002 --\x3e\n  <setting name="lazyLoadingEnabled" value="true"/>\n  \x3c!-- \u5f00\u542f\u65f6\uff0c\u4efb\u4e00\u65b9\u6cd5\u7684\u8c03\u7528\u90fd\u4f1a\u52a0\u8f7d\u8be5\u5bf9\u8c61\u7684\u6240\u6709\u5ef6\u8fdf\u52a0\u8f7d\u5c5e\u6027\u3002 \u5426\u5219\uff0c\u6bcf\u4e2a\u5ef6\u8fdf\u52a0\u8f7d\u5c5e\u6027\u4f1a\u6309\u9700\u52a0\u8f7d --\x3e\n  <setting name="aggressiveLazyLoading" value="false"/>\n</settings>\n')),(0,r.kt)("h4",{id:"2mybatis-\u83b7\u53d6\u81ea\u589e\u4e3b\u952e\u7684\u65b9\u5f0f"},"\uff082\uff09Mybatis \u83b7\u53d6\u81ea\u589e\u4e3b\u952e\u7684\u65b9\u5f0f"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4f7f\u7528 xml")),(0,r.kt)("p",null,"\u76f4\u63a5\u5728\u6807\u7b7e\u5c5e\u6027\u4e0a\u6dfb\u52a0 useGeneratedKeys\uff08\u662f\u5426\u662f\u81ea\u589e\u957f\uff0c\u5fc5\u987b\u8bbe\u7f6e true\uff09 \u548c keyProperty\uff08\u5b9e\u4f53\u7c7b\u4e3b\u952e\u5c5e\u6027\u540d\u79f0\uff09 \u3001keyColumn\uff08\u6570\u636e\u5e93\u4e3b\u952e\u5b57\u6bb5\u540d\u79f0\uff09"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<insert id="insert" useGeneratedKeys="true" keyColumn="id" keyProperty="id">\n    insert into `user`(id, username, password)\n    values (#{id}, #{username}, #{password})\n</insert>\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u6ce8\u89e3\u65b9\u5f0f useGeneratedKeys\uff08\u662f\u5426\u662f\u81ea\u589e\u957f\uff0c\u5fc5\u987b\u8bbe\u7f6e true\uff09 \u548c keyProperty\uff08\u5b9e\u4f53\u7c7b\u4e3b\u952e\u5c5e\u6027\u540d\u79f0\uff09 \u3001keyColumn\uff08\u6570\u636e\u5e93\u4e3b\u952e\u5b57\u6bb5\u540d\u79f0\uff09")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Insert("INSERT INTO user(name,age) VALUES(#{user.name},#{user.age})")\n@Options(useGeneratedKeys=true, keyProperty="user.id",keyColumn="id"  )\npublic int insert(@Param("user")User user);\n')),(0,r.kt)("p",null,"\u4e5f\u53ef\u4ee5\u5168\u5c40\u8bbe\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<setting name="useGeneratedKeys" value="true"/>\n')),(0,r.kt)("h2",{id:"\u5341mybatis\u7f13\u5b58"},"\u5341\u3001Mybatis\u7f13\u5b58"),(0,r.kt)("h3",{id:"1\u4e3a\u4ec0\u4e48\u8981\u7528\u7f13\u5b58"},"1\u3001\u4e3a\u4ec0\u4e48\u8981\u7528\u7f13\u5b58\uff1f"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u7f13\u5b58\u4e2d\u6709\u6570\u636e\uff0c\u5c31\u4e0d\u7528\u4ece\u6570\u636e\u5e93\u83b7\u53d6\uff0c\u5927\u5927\u63d0\u9ad8\u7cfb\u7edf\u6027\u80fd\u3002"),(0,r.kt)("li",{parentName:"ul"},"MyBatis\u63d0\u4f9b\u4e00\u7ea7\u7f13\u5b58\u548c\u4e8c\u7ea7\u7f13\u5b58")),(0,r.kt)("h3",{id:"2\u4e00\u7ea7\u7f13\u5b58"},"2\u3001\u4e00\u7ea7\u7f13\u5b58\uff1a"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e00\u7ea7\u7f13\u5b58\u662fsqlsession\u7ea7\u522b\u7684\u7f13\u5b58")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5728\u64cd\u4f5c\u6570\u636e\u5e93\u65f6\uff0c\u9700\u8981\u6784\u9020sqlsession\u5bf9\u8c61\uff0c\u5728\u5bf9\u8c61\u4e2d\u6709\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff08HashMap\uff09\u7528\u4e8e\u5b58\u50a8\u7f13\u5b58\u6570\u636e"),(0,r.kt)("li",{parentName:"ul"},"\u4e0d\u540c\u7684sqlsession\u4e4b\u95f4\u7684\u7f13\u5b58\u533a\u57df\u662f\u4e92\u76f8\u4e0d\u5f71\u54cd\u7684\u3002")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e00\u7ea7\u7f13\u5b58\u5de5\u4f5c\u539f\u7406\uff1a")),(0,r.kt)("p",null,"\u56fe\u89e3\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20221116100229864-99ff52e4.png",alt:"image-20221116100229864"}),"image-20221116100229864"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u7b2c\u4e00\u6b21\u53d1\u8d77\u67e5\u8be2sql\u67e5\u8be2\u7528\u6237id\u4e3a1\u7684\u7528\u6237\uff0c\u5148\u53bb\u627e\u7f13\u5b58\u4e2d\u662f\u5426\u6709id\u4e3a1\u7684\u7528\u6237\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u518d\u53bb\u6570\u636e\u5e93\u67e5\u8be2\u7528\u6237\u4fe1\u606f\u3002\u5f97\u5230\u7528\u6237\u4fe1\u606f\uff0c\u5c06\u7528\u6237\u4fe1\u606f\u5b58\u50a8\u5230\u4e00\u7ea7\u7f13\u5b58\u4e2d\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679csqlsession\u6267\u884c\u4e86commit\u64cd\u4f5c\uff08\u63d2\u5165\uff0c\u66f4\u65b0\uff0c\u5220\u9664\uff09\uff0c\u4f1a\u6e05\u7a7asqlsession\u4e2d\u7684\u4e00\u7ea7\u7f13\u5b58\uff0c\u907f\u514d\u810f\u8bfb"),(0,r.kt)("li",{parentName:"ul"},"\u7b2c\u4e8c\u6b21\u53d1\u8d77\u67e5\u8be2id\u4e3a1\u7684\u7528\u6237\uff0c\u7f13\u5b58\u4e2d\u5982\u679c\u627e\u5230\u4e86\uff0c\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\u7528\u6237\u4fe1\u606f"),(0,r.kt)("li",{parentName:"ul"},"MyBatis\u9ed8\u8ba4\u652f\u6301\u5e76\u5f00\u542f\u4e00\u7ea7\u7f13\u5b58\u3002")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e00\u7ea7\u7f13\u5b58\u6f14\u793a")),(0,r.kt)("p",null,"1\u3001\u5fc5\u987b\u914d\u7f6e\u65e5\u5fd7\uff0c\u8981\u4e0d\u770b\u4e0d\u89c1"),(0,r.kt)("p",null,"2\u3001\u7f16\u5199\u63a5\u53e3\u65b9\u6cd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'//\u6839\u636eid\u67e5\u8be2\u7528\u6237\nUser findUserById(@Param("id") int id);\n')),(0,r.kt)("p",null,"3\u3001\u63a5\u53e3\u5bf9\u5e94\u7684Mapper\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="findUserById" resultType="com.ydlclass.entity.User">\n  select * from user where id = #{id}\n</select>\n')),(0,r.kt)("p",null,"4\u3001\u6d4b\u8bd5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Test\npublic void testFindUserById(){\n    UserMapper mapper = session.getMapper(UserMapper.class);\n    User user1 = mapper.findUserById(1);\n    System.out.println(user1);\n    User user2 = mapper.findUserById(3);\n    System.out.println(user2);\n    User user3 = mapper.findUserById(1);\n    System.out.println(user3);\n}\n")),(0,r.kt)("p",null,"5\u3001\u901a\u8fc7\u65e5\u5fd7\u5206\u6790"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"[com.ydlclass.dao.UserMapper.findUserById]-==>  Preparing: select id,username,password from user where id = ? \n[com.ydlclass.dao.UserMapper.findUserById]-==> Parameters: 1(Integer)\n[com.ydlclass.dao.UserMapper.findUserById]-<==      Total: 1\nUser{id=1, username='\u6960\u54e5', password='123456'}         ----\x3eID\u4e3a1\uff0c\u7b2c\u4e00\u6b21\u6709sql\n[com.ydlclass.dao.UserMapper.findUserById]-==>  Preparing: select id,username,password from user where id = ? \n[com.ydlclass.dao.UserMapper.findUserById]-==> Parameters: 3(Integer)\n[com.ydlclass.dao.UserMapper.findUserById]-<==      Total: 1\nUser{id=3, username='\u78ca\u54e5', password='987654'}         ----\x3eID\u4e3a3\uff0c\u7b2c\u4e00\u6b21\u6709sql\nUser{id=1, username='\u6960\u54e5', password='123456'}         ----\x3eID\u4e3a1\uff0c\u7b2c\u4e8c\u6b21\u65e0sql\uff0c\u8d70\u7f13\u5b58\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e00\u7ea7\u7f13\u5b58\u5931\u6548")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"sqlSession\u4e0d\u540c"),(0,r.kt)("li",{parentName:"ol"},"\u5f53sqlSession\u5bf9\u8c61\u76f8\u540c\u7684\u65f6\u5019\uff0c\u67e5\u8be2\u7684\u6761\u4ef6\u4e0d\u540c\uff0c\u539f\u56e0\u662f\u7b2c\u4e00\u6b21\u67e5\u8be2\u65f6\u5019\uff0c\u4e00\u7ea7\u7f13\u5b58\u4e2d\u6ca1\u6709\u7b2c\u4e8c\u6b21\u67e5\u8be2\u6240\u9700\u8981\u7684\u6570\u636e"),(0,r.kt)("li",{parentName:"ol"},"\u5f53sqlSession\u5bf9\u8c61\u76f8\u540c\uff0c\u4e24\u6b21\u67e5\u8be2\u4e4b\u95f4\u8fdb\u884c\u4e86\u63d2\u5165\u7684\u64cd\u4f5c"),(0,r.kt)("li",{parentName:"ol"},"\u5f53sqlSession\u5bf9\u8c61\u76f8\u540c\uff0c\u624b\u52a8\u6e05\u9664\u4e86\u4e00\u7ea7\u7f13\u5b58\u4e2d\u7684\u6570\u636e")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e00\u7ea7\u7f13\u5b58\u751f\u547d\u5468\u671f")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"MyBatis\u5728\u5f00\u542f\u4e00\u4e2a\u6570\u636e\u5e93\u4f1a\u8bdd\u65f6\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684SqlSession\u5bf9\u8c61\uff0cSqlSession\u5bf9\u8c61\u4e2d\u4f1a\u6709\u4e00\u4e2a\u65b0\u7684Executor\u5bf9\u8c61\uff0cExecutor\u5bf9\u8c61\u4e2d\u6301\u6709\u4e00\u4e2a\u65b0\u7684PerpetualCache\u5bf9\u8c61\uff1b\u5f53\u4f1a\u8bdd\u7ed3\u675f\u65f6\uff0cSqlSession\u5bf9\u8c61\u53ca\u5176\u5185\u90e8\u7684Executor\u5bf9\u8c61\u8fd8\u6709PerpetualCache\u5bf9\u8c61\u4e5f\u4e00\u5e76\u91ca\u653e\u6389\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5982\u679cSqlSession\u8c03\u7528\u4e86close()\u65b9\u6cd5\uff0c\u4f1a\u91ca\u653e\u6389\u4e00\u7ea7\u7f13\u5b58PerpetualCache\u5bf9\u8c61\uff0c\u4e00\u7ea7\u7f13\u5b58\u5c06\u4e0d\u53ef\u7528\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5982\u679cSqlSession\u8c03\u7528\u4e86clearCache()\uff0c\u4f1a\u6e05\u7a7aPerpetualCache\u5bf9\u8c61\u4e2d\u7684\u6570\u636e\uff0c\u4f46\u662f\u8be5\u5bf9\u8c61\u4ecd\u53ef\u4f7f\u7528\u3002"),(0,r.kt)("li",{parentName:"ol"},"SqlSession\u4e2d\u6267\u884c\u4e86\u4efb\u4f55\u4e00\u4e2aupdate\u64cd\u4f5c(update()\u3001delete()\u3001insert()) \uff0c\u90fd\u4f1a\u6e05\u7a7aPerpetualCache\u5bf9\u8c61\u7684\u6570\u636e\uff0c\u4f46\u662f\u8be5\u5bf9\u8c61\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528\u3002")),(0,r.kt)("h3",{id:"3\u4e8c\u7ea7\u7f13\u5b58"},"3\u3001\u4e8c\u7ea7\u7f13\u5b58\uff1a"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e8c\u7ea7\u7f13\u5b58\u662fmapper\u7ea7\u522b\u7684\u7f13\u5b58")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u591a\u4e2asqlsession\u53bb\u64cd\u4f5c\u540c\u4e00\u4e2amapper\u7684sql\u8bed\u53e5\uff0c\u591a\u4e2asqlsession\u53ef\u4ee5\u5171\u7528\u4e8c\u7ea7\u7f13\u5b58\uff0c\u6240\u5f97\u5230\u7684\u6570\u636e\u4f1a\u5b58\u5728\u4e8c\u7ea7\u7f13\u5b58\u533a\u57df"),(0,r.kt)("li",{parentName:"ul"},"\u4e8c\u7ea7\u7f13\u5b58\u662f\u8de8sqlsession\u7684"),(0,r.kt)("li",{parentName:"ul"},"\u4e8c\u7ea7\u7f13\u5b58\u76f8\u6bd4\u4e00\u7ea7\u7f13\u5b58\u7684\u8303\u56f4\u66f4\u5927\uff08\u6309namespace\u6765\u5212\u5206\uff09\uff0c\u591a\u4e2asqlsession\u53ef\u4ee5\u5171\u4eab\u4e00\u4e2a\u4e8c\u7ea7\u7f13\u5b58")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20221116101253455-b70dd8b7.png",alt:"image-20221116101253455"}),"image-20221116101253455"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e8c\u7ea7\u7f13\u5b58\u5b9e\u73b0\u539f\u7406")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20221116110925341-d7ae9019.png",alt:"image-20221116110925341"}),"image-20221116110925341"),(0,r.kt)("p",null,"\u9996\u5148\u8981\u624b\u52a8\u5f00\u542fMyBatis\u4e8c\u7ea7\u7f13\u5b58\u3002"),(0,r.kt)("p",null,"\u5728config.xml\u8bbe\u7f6e\u4e8c\u7ea7\u7f13\u5b58\u5f00\u5173 \uff0c \u8fd8\u8981\u5728\u5177\u4f53\u7684mapper.xml\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<settings>\n    \x3c!--\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58--\x3e\n    <setting name="cacheEnabled" value="true"/>       \n</settings>\n\x3c!-- \u9700\u8981\u5c06\u6620\u5c04\u7684javabean\u7c7b\u5b9e\u73b0\u5e8f\u5217\u5316 --\x3e\n')),(0,r.kt)("p",null," class Student implements Serializable{}"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!--\u5f00\u542f\u672cMapper\u7684namespace\u4e0b\u7684\u4e8c\u7ea7\u7f13\u5b58--\x3e\n<cache eviction="LRU" flushInterval="100000"/>\n')),(0,r.kt)("h4",{id:"1cache\u5c5e\u6027\u7684\u7b80\u4ecb"},"\uff081\uff09cache\u5c5e\u6027\u7684\u7b80\u4ecb\uff1a"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"eviction"),"\u56de\u6536\u7b56\u7565\uff08\u7f13\u5b58\u6ee1\u4e86\u7684\u6dd8\u6c70\u673a\u5236\uff09\uff0c\u76ee\u524dMyBatis\u63d0\u4f9b\u4ee5\u4e0b\u7b56\u7565\u3002")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"LRU\uff08Least Recently Used\uff09\uff0c\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\u7684\uff0c\u6700\u957f\u65f6\u95f4\u4e0d\u7528\u7684\u5bf9\u8c61"),(0,r.kt)("li",{parentName:"ol"},"FIFO\uff08First In First Out\uff09\uff0c\u5148\u8fdb\u5148\u51fa\uff0c\u6309\u5bf9\u8c61\u8fdb\u5165\u7f13\u5b58\u7684\u987a\u5e8f\u6765\u79fb\u9664\u4ed6\u4eec"),(0,r.kt)("li",{parentName:"ol"},"SOFT\uff0c\u8f6f\u5f15\u7528\uff0c\u79fb\u9664\u57fa\u4e8e\u5783\u573e\u56de\u6536\u5668\u72b6\u6001\u548c\u8f6f\u5f15\u7528\u89c4\u5219\u7684\u5bf9\u8c61\uff0c\u5f53\u5185\u5b58\u4e0d\u8db3\uff0c\u4f1a\u89e6\u53d1JVM\u7684GC\uff0c\u5982\u679cGC\u540e\uff0c\u5185\u5b58\u8fd8\u662f\u4e0d\u8db3\uff0c\u5c31\u4f1a\u628a\u8f6f\u5f15\u7528\u7684\u5305\u88f9\u7684\u5bf9\u8c61\u7ed9\u5e72\u6389\uff0c\u4e5f\u5c31\u662f\u53ea\u6709\u5185\u5b58\u4e0d\u8db3\uff0cJVM\u624d\u4f1a\u56de\u6536\u8be5\u5bf9\u8c61\u3002"),(0,r.kt)("li",{parentName:"ol"},"WEAK\uff0c\u5f31\u5f15\u7528\uff0c\u66f4\u79ef\u6781\u7684\u79fb\u9664\u57fa\u4e8e\u5783\u573e\u6536\u96c6\u5668\u72b6\u6001\u548c\u5f31\u5f15\u7528\u89c4\u5219\u7684\u5bf9\u8c61\u3002\u5f31\u5f15\u7528\u7684\u7279\u70b9\u662f\u4e0d\u7ba1\u5185\u5b58\u662f\u5426\u8db3\u591f\uff0c\u53ea\u8981\u53d1\u751fGC\uff0c\u90fd\u4f1a\u88ab\u56de\u6536\u3002")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"flushInterval"),":\u5237\u65b0\u95f4\u9694\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u6beb\u79d2\uff0c")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u8fd9\u91cc\u914d\u7f6e\u7684\u662f100\u79d2\u5237\u65b0\uff0c\u5982\u679c\u4f60\u4e0d\u914d\u7f6e\u5b83\uff0c\u90a3\u4e48\u5f53SQL\u88ab\u6267\u884c\u7684\u65f6\u5019\u624d\u4f1a\u53bb\u5237\u65b0\u7f13\u5b58\u3002")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"size"),":\u5f15\u7528\u6570\u76ee\uff0c")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u4e00\u4e2a\u6b63\u6574\u6570\uff0c\u4ee3\u8868\u7f13\u5b58\u6700\u591a\u53ef\u4ee5\u5b58\u50a8\u591a\u5c11\u4e2a\u5bf9\u8c61\uff0c\u4e0d\u5b9c\u8bbe\u7f6e\u8fc7\u5927\u3002\u8bbe\u7f6e\u8fc7\u5927\u4f1a\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\u3002"),(0,r.kt)("p",{parentName:"li"},"\u8fd9\u91cc\u914d\u7f6e\u7684\u662f1024\u4e2a\u5bf9\u8c61"))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"readOnly:"),"\u53ea\u8bfb\uff0c")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u610f\u5473\u7740\u7f13\u5b58\u6570\u636e\u53ea\u80fd\u8bfb\u53d6\u800c\u4e0d\u80fd\u4fee\u6539\uff0c\u8fd9\u6837\u8bbe\u7f6e\u7684\u597d\u5904\u662f\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u8bfb\u53d6\u7f13\u5b58\uff0c\u7f3a\u70b9\u662f\u6211\u4eec\u6ca1\u6709"),(0,r.kt)("p",{parentName:"li"},"\u529e\u6cd5\u4fee\u6539\u7f13\u5b58\uff0c\u5b83\u7684\u9ed8\u8ba4\u503c\u662ffalse\uff0c\u4e0d\u5141\u8bb8\u6211\u4eec\u4fee\u6539"))),(0,r.kt)("h4",{id:"2\u64cd\u4f5c\u8fc7\u7a0b"},"\uff082\uff09\u64cd\u4f5c\u8fc7\u7a0b\uff1a"),(0,r.kt)("p",null,"sqlsession1\u67e5\u8be2\u7528\u6237id\u4e3a1\u7684\u4fe1\u606f\uff0c\u67e5\u8be2\u5230\u4e4b\u540e\uff0c\u4f1a\u5c06\u67e5\u8be2\u6570\u636e\u5b58\u50a8\u5230\u4e8c\u7ea7\u7f13\u5b58\u4e2d\u3002"),(0,r.kt)("p",null,"\u5982\u679csqlsession3\u53bb\u6267\u884c\u76f8\u540cmapper\u4e0bsql\uff0c\u6267\u884ccommit\u63d0\u4ea4\uff0c\u4f1a\u6e05\u7a7a\u8be5mapper\u4e0b\u7684\u4e8c\u7ea7\u7f13\u5b58\u533a\u57df\u7684\u6570\u636e"),(0,r.kt)("p",null,"sqlsession2\u67e5\u8be2\u7528\u6237id\u4e3a1\u7684\u4fe1\u606f\uff0c \u53bb\u7f13\u5b58\u627e\u662f\u5426\u5b58\u5728\u7f13\u5b58\uff0c\u5982\u679c\u5b58\u5728\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u53d6\u6570\u636e"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u7981\u7528\u4e8c\u7ea7\u7f13\u5b58\uff1a")),(0,r.kt)("p",null,"\u5728statement\u4e2d\u53ef\u4ee5\u8bbe\u7f6euseCache=false\uff0c\u7981\u7528\u5f53\u524dselect\u8bed\u53e5\u7684\u4e8c\u7ea7\u7f13\u5b58\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e3atrue"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="getStudentById" parameterType="java.lang.Integer" resultType="Student" useCache="false">\n')),(0,r.kt)("p",null,'\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u9488\u5bf9\u6bcf\u6b21\u67e5\u8be2\u90fd\u9700\u8981\u6700\u65b0\u7684\u6570\u636esql\uff0c\u8981\u8bbe\u7f6e\u4e3auseCache="false" \uff0c\u7981\u7528\u4e8c\u7ea7\u7f13\u5b58'),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"flushCache\u6807\u7b7e\uff1a\u5237\u65b0\u7f13\u5b58\uff08\u6e05\u7a7a\u7f13\u5b58\uff09")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="getStudentById" parameterType="java.lang.Integer" resultType="Student" flushCache="true">\n')),(0,r.kt)("p",null,'\u4e00\u822c\u4e0b\u6267\u884c\u5b8ccommit\u64cd\u4f5c\u90fd\u9700\u8981\u5237\u65b0\u7f13\u5b58\uff0cflushCache="true \u8868\u793a\u5237\u65b0\u7f13\u5b58\uff0c\u53ef\u4ee5\u907f\u514d\u810f\u8bfb'),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e8c\u7ea7\u7f13\u5b58\u5e94\u7528\u573a\u666f")),(0,r.kt)("p",null,"\u5bf9\u4e8e\u8bbf\u95ee\u591a\u7684\u67e5\u8be2\u8bf7\u6c42\u5e76\u4e14\u7528\u6237\u5bf9\u67e5\u8be2\u7ed3\u679c\u5b9e\u65f6\u6027\u8981\u6c42\u4e0d\u9ad8\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u91c7\u7528MyBatis\u4e8c\u7ea7\u7f13\u5b58\uff0c\u964d\u4f4e\u6570\u636e\u5e93\u8bbf\u95ee\u91cf\uff0c\u63d0\u9ad8\u8bbf\u95ee\u901f\u5ea6\uff0c\u5982\u7535\u8bdd\u8d26\u5355\u67e5\u8be2"),(0,r.kt)("p",null,"\u6839\u636e\u9700\u6c42\u8bbe\u7f6e\u76f8\u5e94\u7684",(0,r.kt)("strong",{parentName:"p"},"flushInterval"),"\uff1a\u5237\u65b0\u95f4\u9694\u65f6\u95f4\uff0c\u6bd4\u5982\u4e09\u5341\u5206\u949f\uff0c24\u5c0f\u65f6\u7b49\u3002"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e8c\u7ea7\u7f13\u5b58\u5c40\u9650\u6027\uff1a")),(0,r.kt)("p",null,"MyBatis\u4e8c\u7ea7\u7f13\u5b58\u5bf9\u7ec6\u7c92\u5ea6\u7684\u6570\u636e\u7ea7\u522b\u7684\u7f13\u5b58\u5b9e\u73b0\u4e0d\u597d\uff0c\u6bd4\u5982\u5982\u4e0b\u9700\u6c42\uff1a\u5bf9\u5546\u54c1\u4fe1\u606f\u8fdb\u884c\u7f13\u5b58\uff0c\u7531\u4e8e\u5546\u54c1\u4fe1\u606f\u67e5\u8be2\u8bbf\u95ee\u91cf\u5927\uff0c\u4f46\u662f\u8981\u6c42\u7528\u6237\u6bcf\u6b21\u90fd\u80fd\u67e5\u8be2\u6700\u65b0\u7684\u5546\u54c1\u4fe1\u606f\uff0c\u6b64\u65f6\u5982\u679c\u4f7f\u7528MyBatis\u7684\u4e8c\u7ea7\u7f13\u5b58\u5c31\u65e0\u6cd5\u5b9e\u73b0\u5f53\u4e00\u4e2a\u5546\u54c1\u53d8\u5316\u65f6\u53ea\u5237\u65b0\u8be5\u5546\u54c1\u7684\u7f13\u5b58\u4fe1\u606f\u800c\u4e0d\u5237\u65b0\u5176\u5b83\u5546\u54c1\u7684\u4fe1\u606f\uff0c\u56e0\u4e3aMyBatis\u7684\u4e8c\u7ea7\u7f13\u5b58\u533a\u57df\u4ee5mapper\u4e3a\u5355\u4f4d\u5212\u5206\uff0c\u5f53\u4e00\u4e2a\u5546\u54c1\u4fe1\u606f\u53d8\u5316\u4f1a\u5c06\u6240\u6709\u5546\u54c1\u4fe1\u606f\u7684\u7f13\u5b58\u6570\u636e\u5168\u90e8\u6e05\u7a7a\u3002\u89e3\u51b3\u6b64\u7c7b\u95ee\u9898\u9700\u8981\u5728\u4e1a\u52a1\u5c42\u6839\u636e\u9700\u6c42\u5bf9\u6570\u636e\u6709\u9488\u5bf9\u6027\u7f13\u5b58\u3002"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e8c\u7ea7\u7f13\u5b58\u6f14\u793a")),(0,r.kt)("p",null,"\u5148\u4e0d\u8fdb\u884c\u914d\u7f6e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"@Test\npublic void testFindUserCache() throws Exception {\n\n    //\u4f7f\u7528\u4e0d\u540c\u7684mapper\n    UserMapper mapper1 = session.getMapper(UserMapper.class);\n    User user1 = mapper1.findUserById(1);\n    System.out.println(user1);\n    //\u63d0\u4ea4\u4e86\u5c31\u4f1a\u5237\u5230\u4e8c\u7ea7\u7f13\u5b58\uff0c\u8981\u4e0d\u8fd8\u5728\u4e00\u7ea7\u7f13\u5b58\uff0c\u4e00\u5b9a\u8981\u6ce8\u610f\n    session.commit();\n    UserMapper mapper2 = session.getMapper(UserMapper.class);\n    User user2 = mapper2.findUserById(1);\n    System.out.println(user2);\n    System.out.println(user1 == user2);\n}\n")),(0,r.kt)("p",null,"\u7ed3\u679c\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"[com.ydlclass.dao.UserMapper.findUserById]-==>  Preparing: select id,username,password from user where id = ? \n[com.ydlclass.dao.UserMapper.findUserById]-==> Parameters: 1(Integer)\n[com.ydlclass.dao.UserMapper.findUserById]-<==      Total: 1\nUser{id=1, username='\u6960\u54e5', password='123456'}\n[com.ydlclass.dao.UserMapper.findUserById]-==>  Preparing: select id,username,password from user where id = ? \n[com.ydlclass.dao.UserMapper.findUserById]-==> Parameters: 1(Integer)\n[com.ydlclass.dao.UserMapper.findUserById]-<==      Total: 1\nUser{id=1, username='\u6960\u54e5', password='123456'}\nfalse               ----\x3e\u4e24\u4e2a\u5bf9\u8c61\u4e0d\u662f\u4e00\u4e2a\uff0c\u53d1\u4e86\u4e24\u4e2asql\uff0c\u8bf4\u660e\u7f13\u5b58\u6ca1\u6709\u8d77\u4f5c\u7528\n")),(0,r.kt)("p",null,"\u53ef\u4ee5\u770b\u89c1\u4e24\u6b21\u540c\u6837\u7684sql\uff0c\u5374\u90fd\u8fdb\u5e93\u8fdb\u884c\u4e86\u67e5\u8be2\u3002\u8bf4\u660e\u4e8c\u7ea7\u7f13\u5b58\u6ca1\u5f00\u3002"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u914d\u7f6e\u4e8c\u7ea7\u7f13\u5b58")),(0,r.kt)("p",null,"1\u3001\u5f00\u542f\u5168\u5c40\u7f13\u5b58"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'<setting name="cacheEnabled" value="true"/>\n')),(0,r.kt)("p",null,"2\u3001\u4f7f\u7528\u4e8c\u7ea7\u7f13\u5b58\uff0c\u8fd9\u4e2a\u5199\u5728mapper\u91cc"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'\x3c!--\u5f00\u542f\u672cMapper\u7684namespace\u4e0b\u7684\u4e8c\u7ea7\u7f13\u5b58--\x3e\n<cache eviction="LRU" flushInterval="100000" size="512" readOnly="true"></cache>\n\x3c!--\n\u521b\u5efa\u4e86\u4e00\u4e2a LRU \u6700\u5c11\u4f7f\u7528\u6e05\u9664\u7f13\u5b58\uff0c\u6bcf\u9694 100 \u79d2\u5237\u65b0\uff0c\u6700\u591a\u53ef\u4ee5\u5b58\u50a8 512 \u4e2a\u5bf9\u8c61\uff0c\u8fd4\u56de\u7684\u5bf9\u8c61\u662f\u53ea\u8bfb\u7684\u3002\n--\x3e\n')),(0,r.kt)("p",null,"3\u3001\u6d4b\u8bd5\u6267\u884c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"[com.ydlclass.dao.UserMapper.findUserById]-==>  Preparing: select id,username,password from user where id = ? \n[com.ydlclass.dao.UserMapper.findUserById]-==> Parameters: 1(Integer)\n[com.ydlclass.dao.UserMapper.findUserById]-<==      Total: 1\nUser{id=1, username='\u6960\u54e5', password='123456'}\n[com.ydlclass.dao.UserMapper]-Cache Hit Ratio [com.ydlclass.dao.UserMapper]: 0.5\nUser{id=1, username='\u6960\u54e5', password='123456'}\ntrue                  ----\x3e\u4e24\u4e2a\u5bf9\u8c61\u4e00\u6837\u4e86\uff0c\u5c31\u53d1\u4e86\u4e00\u4e2asql\uff0c\u8bf4\u660e\u7f13\u5b58\u8d77\u4e86\u4f5c\u7528\n")),(0,r.kt)("h3",{id:"4\u7b2c\u4e09\u65b9\u7f13\u5b58--ehcache\u5145\u5f53\u4e8c\u7ea7\u7f13\u5b58"},"4\u3001\u7b2c\u4e09\u65b9\u7f13\u5b58--EhCache\u5145\u5f53\u4e8c\u7ea7\u7f13\u5b58"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u6b64\u5916\u8fd8\u6709\u5f88\u591a\u7b2c\u4e09\u65b9\u7f13\u5b58\u7ec4\u4ef6\uff0c\u6700\u5e38\u7528\u7684\u6bd4\u5982ehcache\uff0cMemcached\u3001redis\u7b49\uff0c\u6211\u4eec\u4ee5\u6bd4\u8f83\u7b80\u5355\u7684ehcache\u4e3a\u4f8b\u3002")),(0,r.kt)("p",null,"1\u3001\u5f15\u5165\u4f9d\u8d56"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- https://mvnrepository.com/artifact/org.mybatis.caches/mybatis-ehcache --\x3e\n<dependency>\n   <groupId>org.mybatis.caches</groupId>\n   <artifactId>mybatis-ehcache</artifactId>\n   <version>1.2.1</version>\n</dependency>\n")),(0,r.kt)("p",null,"2\u3001\u4fee\u6539mapper.xml\u4e2d\u4f7f\u7528\u5bf9\u5e94\u7684\u7f13\u5b58"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<mapper namespace = \u201ccom.ydlclass.entity.User\u201d > \n       <cache type="org.mybatis.caches.ehcache.EhcacheCache" eviction="LRU" flushInterval="10000" size="1024" readOnly="true"/>\n</mapper>\n')),(0,r.kt)("p",null,"3\u3001\u6dfb\u52a0ehcache.xml\u6587\u4ef6\uff0cehcache\u914d\u7f6e\u6587\u4ef6\uff0c\u5177\u4f53\u914d\u7f6e\u81ea\u884c\u767e\u5ea6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n        xsi:noNamespaceSchemaLocation="http://ehcache.org/ehcache.xsd"\n        updateCheck="false">\n   \x3c!--\n      diskStore\uff1a\u4e3a\u7f13\u5b58\u8def\u5f84\uff0cehcache\u5206\u4e3a\u5185\u5b58\u548c\u78c1\u76d8\u4e24\u7ea7\uff0c\u6b64\u5c5e\u6027\u5b9a\u4e49\u78c1\u76d8\u7684\u7f13\u5b58\u4f4d\u7f6e\u3002\u53c2\u6570\u89e3\u91ca\u5982\u4e0b\uff1a\n      user.home \u2013 \u7528\u6237\u4e3b\u76ee\u5f55\n      user.dir \u2013 \u7528\u6237\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\n      java.io.tmpdir \u2013 \u9ed8\u8ba4\u4e34\u65f6\u6587\u4ef6\u8def\u5f84\n    --\x3e\n   <diskStore path="./tmpdir/Tmp_EhCache"/>\n   \n   <defaultCache\n           eternal="false"\n           maxElementsInMemory="10000"\n           overflowToDisk="false"\n           diskPersistent="false"\n           timeToIdleSeconds="1800"\n           timeToLiveSeconds="259200"\n           memoryStoreEvictionPolicy="LRU"/>\n\n</ehcache>\n\n\x3c!--     \n       name:\u7f13\u5b58\u540d\u79f0\u3002     \n       maxElementsInMemory\uff1a\u7f13\u5b58\u6700\u5927\u4e2a\u6570\u3002     \n       eternal:\u5bf9\u8c61\u662f\u5426\u6c38\u4e45\u6709\u6548\uff0c\u4e00\u4f46\u8bbe\u7f6e\u4e86\uff0ctimeout\u5c06\u4e0d\u8d77\u4f5c\u7528\u3002     \n       timeToIdleSeconds\uff1a\u8bbe\u7f6e\u5bf9\u8c61\u5728\u5931\u6548\u524d\u7684\u5141\u8bb8\u95f2\u7f6e\u65f6\u95f4\uff08\u5355\u4f4d\uff1a\u79d2\uff09\u3002\u4ec5\u5f53eternal=false\u5bf9\u8c61\u4e0d\u662f\u6c38\u4e45\u6709\u6548\u65f6\u4f7f\u7528\uff0c\u53ef\u9009\u5c5e\u6027\uff0c\u9ed8\u8ba4\u503c\u662f0\uff0c\u4e5f\u5c31\u662f\u53ef\u95f2\u7f6e\u65f6\u95f4\u65e0\u7a77\u5927\u3002     \n       timeToLiveSeconds\uff1a\u8bbe\u7f6e\u5bf9\u8c61\u5728\u5931\u6548\u524d\u5141\u8bb8\u5b58\u6d3b\u65f6\u95f4\uff08\u5355\u4f4d\uff1a\u79d2\uff09\u3002\u6700\u5927\u65f6\u95f4\u4ecb\u4e8e\u521b\u5efa\u65f6\u95f4\u548c\u5931\u6548\u65f6\u95f4\u4e4b\u95f4\u3002\u4ec5\u5f53eternal=false\u5bf9\u8c61\u4e0d\u662f\u6c38\u4e45\u6709\u6548\u65f6\u4f7f\u7528\uff0c\u9ed8\u8ba4\u662f0.\uff0c\u4e5f\u5c31\u662f\u5bf9\u8c61\u5b58\u6d3b\u65f6\u95f4\u65e0\u7a77\u5927\u3002     \n       overflowToDisk\uff1a\u5f53\u5185\u5b58\u4e2d\u5bf9\u8c61\u6570\u91cf\u8fbe\u5230maxElementsInMemory\u65f6\uff0cEhcache\u5c06\u4f1a\u5bf9\u8c61\u5199\u5230\u78c1\u76d8\u4e2d\u3002     \n       diskSpoolBufferSizeMB\uff1a\u8fd9\u4e2a\u53c2\u6570\u8bbe\u7f6eDiskStore\uff08\u78c1\u76d8\u7f13\u5b58\uff09\u7684\u7f13\u5b58\u533a\u5927\u5c0f\u3002\u9ed8\u8ba4\u662f30MB\u3002\u6bcf\u4e2aCache\u90fd\u5e94\u8be5\u6709\u81ea\u5df1\u7684\u4e00\u4e2a\u7f13\u51b2\u533a\u3002     \n       maxElementsOnDisk\uff1a\u786c\u76d8\u6700\u5927\u7f13\u5b58\u4e2a\u6570\u3002     \n       diskPersistent\uff1a\u662f\u5426\u5728\u78c1\u76d8\u4e0a\u6301\u4e45\u5316\u3002\u6307\u91cd\u542fjvm\u540e\uff0c\u6570\u636e\u662f\u5426\u6709\u6548\u3002\u9ed8\u8ba4\u4e3afalse\u3002   \n       memoryStoreEvictionPolicy\uff1a\u5f53\u8fbe\u5230maxElementsInMemory\u9650\u5236\u65f6\uff0cEhcache\u5c06\u4f1a\u6839\u636e\u6307\u5b9a\u7684\u7b56\u7565\u53bb\u6e05\u7406\u5185\u5b58\u3002\u9ed8\u8ba4\u7b56\u7565\u662fLRU\uff08\u6700\u8fd1\u6700\u5c11\u4f7f\u7528\uff09\u3002\u4f60\u53ef\u4ee5\u8bbe\u7f6e\u4e3aFIFO\uff08\u5148\u8fdb\u5148\u51fa\uff09\u6216\u662fLFU\uff08\u8f83\u5c11\u4f7f\u7528\uff09\u3002     \n       clearOnFlush\uff1a\u5185\u5b58\u6570\u91cf\u6700\u5927\u65f6\u662f\u5426\u6e05\u9664\u3002     \n    --\x3e \n')),(0,r.kt)("p",null,"3\u3001\u6d4b\u8bd5"),(0,r.kt)("h3",{id:"5\u4f7f\u7528\u7f13\u5b58\u72ec\u7acb\u63a7\u5236"},"5\u3001\u4f7f\u7528\u7f13\u5b58\u72ec\u7acb\u63a7\u5236"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5176\u5b9e\u6211\u4eec\u66f4\u52a0\u5e38\u89c1\u7684\u662f\u4f7f\u7528\u7b2c\u4e09\u65b9\u7684\u7f13\u5b58\u8fdb\u884c\u5b58\u50a8\uff0c\u5e76\u4e14\u81ea\u7531\u63a7\u5236")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>net.sf.ehcache</groupId>\n    <artifactId>ehcache</artifactId>\n    <version>2.10.3</version>\n</dependency>  \n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u6d4b\u8bd5\u4e00\u4e0b")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'final CacheManager cacheManager = new CacheManager(this.getClass().getClassLoader().getResourceAsStream("ehcache.xml"));\n\n// create the cache called "hello-world"\nString[] cacheNames = cacheManager.getCacheNames();\nfor (String cacheName : cacheNames) {\n    System.out.println(cacheName);\n}\nCache userDao = cacheManager.getCache("userDao");\nElement element = new Element("testFindUserById_1",new User(1,"q","d"));\nuserDao.put(element);\n\nElement element1 = userDao.get("testFindUserById_1");\nUser user = (User)element1.getObjectValue();\nSystem.out.println(user);\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u521b\u5efa\u5de5\u5177\u7c7b")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * @author zn\n * @date 2021/1/28\n */\npublic class CacheUtil {\n\n    private static CacheManager cacheManager = new CacheManager(CacheUtil.class.getClassLoader().getResourceAsStream("ehcache.xml"));\n\n    public static void put(String cacheName,String key,Object value){\n        Cache cache = cacheManager.getCache(cacheName);\n        Element element = new Element(key,value);\n        cache.put(element);\n    }\n\n    public static Object get(String cacheName,String key){\n        Cache cache = cacheManager.getCache(cacheName);\n        return cache.get(key).getObjectValue();\n\n    }\n\n    public static boolean  delete(String cacheName,String key){\n        Cache cache = cacheManager.getCache(cacheName);\n        return cache.remove(key);\n    }\n\n}\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u6d4b\u8bd5")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void selectDeptsTest(){\n\n    Map<String,Object> cache = new HashMap<>(8);\n    // \u6267\u884c\u65b9\u6cd5\n    List<Dept> depts = deptMapper.selectDepts();\n    CacheUtil.put("dept","selectUserByIdTest",depts);\n    System.out.println(depts);\n    session.commit();\n\n    session = sqlSessionFactory.openSession();\n    // \u53bb\u7f13\u5b58\u62ff\uff0c\u5982\u679c\u6709\u5c31\u62ff\u51fa\u6765\n    List<Dept> newDepts = null;\n    Object object = CacheUtil.get("dept", "selectUserByIdTest");\n    if(object == null){\n        // \u53bb\u6570\u636e\u5e93\u67e5\u8be2\n        DeptMapper mapper = session.getMapper(DeptMapper.class);\n        newDepts = mapper.selectDepts();\n    } else {\n        newDepts = (List<Dept>) object;\n    }\n\n    System.out.println(newDepts);\n}\n')),(0,r.kt)("h2",{id:"\u5341\u4e00\u914d\u7f6e\u6587\u4ef6"},"\u5341\u4e00\u3001\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"MyBatis\u7684\u914d\u7f6e\u6587\u4ef6\u5206\u4e3a\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u548cmapper\u914d\u7f6e\u6587\u4ef6")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"mybatis-config.xml \u7cfb\u7edf\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("li",{parentName:"ul"},"\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u4e3b\u8981\u914d\u7f6eMybatis\u4e00\u4e9b",(0,r.kt)("strong",{parentName:"li"},"\u57fa\u7840\u7ec4\u4ef6\u548c\u52a0\u8f7d\u8d44\u6e90"),"\uff0c\u6838\u5fc3\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u5143\u7d20\u5e38\u5e38\u80fd\u5f71\u54cdMybatis\u7684\u6574\u4e2a\u8fd0\u884c\u8fc7\u7a0b\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u80fd\u914d\u7f6e\u7684\u5185\u5bb9\u5982\u4e0b\uff0c",(0,r.kt)("strong",{parentName:"li"},"\u987a\u5e8f\u4e0d\u80fd\u4e71"),"\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"1.properties\u662f\u4e00\u4e2a\u914d\u7f6e\u5c5e\u6027\u7684\u5143\u7d20\n2.settings\u8bbe\u7f6e\uff0cmybatis\u6700\u4e3a\u590d\u6742\u7684\u914d\u7f6e\u4e5f\u662f\u6700\u91cd\u8981\u7684\uff0c\u4f1a\u6539\u53d8mybatis\u8fd0\u884c\u65f6\u5019\u7684\u884c\u4e3a\n3.typeAliases\u522b\u540d\uff08\u5728TypeAliasRegistry\u4e2d\u53ef\u4ee5\u770b\u5230mybatis\u63d0\u4f9b\u4e86\u8bb8\u591a\u7684\u7cfb\u7edf\u522b\u540d\uff09\n4.typeHandlers \u7c7b\u578b\u5904\u7406\u5668\uff08\u6bd4\u5982\u5728\u9884\u5904\u7406\u8bed\u53e5\u4e2d\u8bbe\u7f6e\u4e00\u4e2a\u53c2\u6570\u6216\u8005\u4ece\u7ed3\u679c\u96c6\u4e2d\u83b7\u53d6\u4e00\u4e2a\u53c2\u6570\u65f6\u5019\uff0c\u90fd\u4f1a\u7528\u5230\u7c7b\u578b\u5904\u7406\u5668\uff0c\u5728TypeHandlerRegistry\u4e2d\u5b9a\u4e49\u4e86\u5f88\u591a\u7684\u7c7b\u578b\u5904\u7406\u5668\uff09\n5.objectFactory \u5bf9\u8c61\u5de5\u5382\uff08myabtis\u5728\u6784\u5efa\u4e00\u4e2a\u7ed3\u679c\u8fd4\u56de\u7684\u65f6\u5019\uff0c\u4f1a\u4f7f\u7528\u4e00\u4e2aObjectFactory\u53bb\u6784\u5efapojo)\n6.plugins \u63d2\u4ef6\n7.environments \u73af\u5883\u53d8\u91cf\n\u2003\u2003environment \u73af\u5883\u53d8\u91cf\n\u2003\u2003\u2003transactionManager \u4e8b\u52a1\u7ba1\u7406\u5668\n\u2003\u2003\u2003dataSource \u6570\u636e\u6e90\n\u2003\u2003\u2003databaseIdProvider \u6570\u636e\u5e93\u5382\u5546\u6807\u8bc6\n8.mappers \u6620\u5c04\u5668\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"\u627e\u51e0\u4e2a\u91cd\u8981\u7684\u8bb2\u89e3\u4e00\u4e0b"))),(0,r.kt)("h3",{id:"1environments\u5143\u7d20"},"1\u3001environments\u5143\u7d20"),(0,r.kt)("p",null,"environments\u53ef\u4ee5\u4e3amybatis\u914d\u7f6e\u591a\u73af\u5883\u8fd0\u884c\uff0c\u5c06SQL\u6620\u5c04\u5230\u591a\u4e2a\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4e0a\uff0c\u5fc5\u987b\u6307\u5b9a\u5176\u4e2d\u4e00\u4e2a\u4e3a\u9ed8\u8ba4\u8fd0\u884c\u73af\u5883\uff08\u901a\u8fc7default\u6307\u5b9a\uff09\uff0c\u5982\u679c\u60f3\u5207\u6362\u73af\u5883\u4fee\u6539default\u7684\u503c\u5373\u53ef\u3002"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u6700\u5e38\u89c1\u7684\u5c31\u662f\uff0c\u751f\u4ea7\u73af\u5883\u548c\u5f00\u53d1\u73af\u5883\uff0c\u4e24\u4e2a\u73af\u5883\u5207\u6362\u5fc5\u5c06\u5bfc\u81f4\u6570\u636e\u5e93\u7684\u5207\u6362\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<environments default="development">\n <environment id="development">\n   <transactionManager type="JDBC">\n     <property name="..." value="..."/>\n   </transactionManager>\n   <dataSource type="POOLED">\n     <property name="driver" value="${driver}"/>\n     <property name="url" value="${url}"/>\n     <property name="username" value="${username}"/>\n     <property name="password" value="${password}"/>\n   </dataSource>\n </environment>\n    \n  <environment id="product">\n       <transactionManager type="JDBC">\n         <property name="..." value="..."/>\n       </transactionManager>\n       <dataSource type="POOLED">\n         <property name="driver" value="${driver}"/>\n         <property name="url" value="${url}"/>\n         <property name="username" value="${username}"/>\n         <property name="password" value="${password}"/>\n       </dataSource>\n </environment>\n</environments>\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"dataSource \u5143\u7d20\u4f7f\u7528\u6807\u51c6\u7684 JDBC \u6570\u636e\u6e90\u63a5\u53e3\u6765\u914d\u7f6e JDBC \u8fde\u63a5\u5bf9\u8c61\u7684\u8d44\u6e90\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u6570\u636e\u6e90\u662f\u5fc5\u987b\u914d\u7f6e\u7684\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u6709\u4e09\u79cd\u5185\u5efa\u7684\u6570\u636e\u6e90\u7c7b\u578b"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```text\ntype="[UNPOOLED|POOLED|JNDI]"\uff09\n- unpooled\uff1a\u8fd9\u4e2a\u6570\u636e\u6e90\u7684\u5b9e\u73b0\u53ea\u662f\u6bcf\u6b21\u88ab\u8bf7\u6c42\u65f6\u6253\u5f00\u548c\u5173\u95ed\u8fde\u63a5\u3002\n- pooled\uff1a\u8fd9\u79cd\u6570\u636e\u6e90\u7684\u5b9e\u73b0\u5229\u7528\u201c\u6c60\u201d\u7684\u6982\u5ff5\u5c06 JDBC \u8fde\u63a5\u5bf9\u8c61\u7ec4\u7ec7\u8d77\u6765 , \u8fd9\u662f\u4e00\u79cd\u4f7f\u5f97\u5e76\u53d1 Web \u5e94\u7528\u5feb\u901f\u54cd\u5e94\u8bf7\u6c42\u7684\u6d41\u884c\u5904\u7406\u65b9\u5f0f\u3002\n- jndi\uff1a\u8fd9\u4e2a\u6570\u636e\u6e90\u7684\u5b9e\u73b0\u662f\u4e3a\u4e86\u80fd\u5728\u5982 Spring \u6216\u5e94\u7528\u670d\u52a1\u5668\u8fd9\u7c7b\u5bb9\u5668\u4e2d\u4f7f\u7528\uff0c\u5bb9\u5668\u53ef\u4ee5\u96c6\u4e2d\u6216\u5728\u5916\u90e8\u914d\u7f6e\u6570\u636e\u6e90\uff0c\u7136\u540e\u653e\u7f6e\u4e00\u4e2a JNDI \u4e0a\u4e0b\u6587\u7684\u5f15\u7528\u3002\n```\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u6570\u636e\u6e90\u4e5f\u6709\u5f88\u591a\u7b2c\u4e09\u65b9\u7684\u5b9e\u73b0\uff0c\u6bd4\u5982druid\uff0chikari\uff0cdbcp\uff0cc3p0\u7b49\u7b49....")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u8fd9\u4e24\u79cd\u4e8b\u52a1\u7ba1\u7406\u5668\u7c7b\u578b\u90fd\u4e0d\u9700\u8981\u8bbe\u7f6e\u4efb\u4f55\u5c5e\u6027\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5177\u4f53\u7684\u4e00\u5957\u73af\u5883\uff0c\u901a\u8fc7\u8bbe\u7f6eid\u8fdb\u884c\u533a\u522b\uff0cid\u4fdd\u8bc1\u552f\u4e00\uff01")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5b50\u5143\u7d20\u8282\u70b9\uff1atransactionManager - ","[ \u4e8b\u52a1\u7ba1\u7406\u5668 ]"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```text\n\x3c!-- \u8bed\u6cd5 --\x3e\n<transactionManager type="[ JDBC | MANAGED ]"/>\n```\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5b50\u5143\u7d20\u8282\u70b9\uff1a",(0,r.kt)("strong",{parentName:"li"},"\u6570\u636e\u6e90\uff08dataSource\uff09"))),(0,r.kt)("h3",{id:"2mappers\u5143\u7d20"},"2\u3001mappers\u5143\u7d20"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"mappers\u7684\u5b58\u5728\u5c31\u662f\u8981\u5bf9\u5199\u597d\u7684mapper\u548cxml\u8fdb\u884c\u7edf\u4e00\u7ba1\u7406"),(0,r.kt)("p",{parentName:"blockquote"},"\u8981\u4e0d\u7136\u7cfb\u7edf\u600e\u4e48\u77e5\u9053\u6211\u5199\u4e86\u54ea\u4e9bmapper")),(0,r.kt)("p",null,"\u901a\u5e38\u8fd9\u4e48\u5f15\u5165"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<mappers>\n    \x3c!-- \u4f7f\u7528\u76f8\u5bf9\u4e8e\u7c7b\u8def\u5f84\u7684\u8d44\u6e90\u5f15\u7528 --\x3e\n    <mapper resource="com/ydlclass/dao/userMapper.xml"/>\n    \x3c!-- \u9762\u5411\u6ce8\u89e3\u65f6\u4f7f\u7528\u5168\u7c7b\u540d --\x3e\n    <mapper class="com.ydlclass.dao.AdminMapper"/>\n</mappers>\n\n\u3002\u3002\u3002\u8fd8\u6709\u5176\u4ed6\u7684\u65b9\u5f0f\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Mapper\u6587\u4ef6")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper\n       PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"\n       "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n<mapper namespace="com.ydlclass.mapper.UserMapper">\n   \n</mapper>\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"namespace\u4e2d\u6587\u610f\u601d\uff1a\u547d\u540d\u7a7a\u95f4\uff0c\u4f5c\u7528\u5982\u4e0b\uff1a"),(0,r.kt)("li",{parentName:"ul"},"namespace\u7684\u547d\u540d\u5fc5\u987b\u8ddf\u67d0\u4e2a\u63a5\u53e3\u540c\u540d\uff0c\u8fd9\u624d\u80fd\u627e\u7684\u5230\u554a\uff01")),(0,r.kt)("h3",{id:"3properties\u5143\u7d20"},"3\u3001Properties\u5143\u7d20"),(0,r.kt)("p",null,"\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f\u6211\u4eec\u6700\u597d\u653e\u5728\u4e00\u4e2a\u5355\u72ec\u7684\u6587\u4ef6\u4e2d\u3002"),(0,r.kt)("p",null,"1\u3001 \u5728\u8d44\u6e90\u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2adb.properties"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"driver=com.mysql.jdbc.Driver\nurl=jdbc:mysql://localhost:3306/ssm?useSSL=true&useUnicode=true&characterEncoding=utf8\nusername=root\npassword=root\n")),(0,r.kt)("p",null,"2\u3001 \u5c06\u6587\u4ef6\u5bfc\u5165properties \u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<configuration>\n   \x3c!--\u5bfc\u5165properties\u6587\u4ef6--\x3e\n   <properties resource="db.properties"/>\n\n   <environments default="development">\n       <environment id="development">\n           <transactionManager type="JDBC"/>\n           <dataSource type="POOLED">\n               <property name="driver" value="${driver}"/>\n               <property name="url" value="${url}"/>\n               <property name="username" value="${username}"/>\n               <property name="password" value="${password}"/>\n           </dataSource>\n       </environment>\n   </environments>\n   <mappers>\n       <mapper resource="mapper/UserMapper.xml"/>\n   </mappers>\n</configuration>\n')),(0,r.kt)("h3",{id:"4\u5176\u4ed6\u914d\u7f6e\u6d4f\u89c8"},"4\u3001\u5176\u4ed6\u914d\u7f6e\u6d4f\u89c8"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"settings\u80fd\u5bf9\u6211\u7684\u4e00\u4e9b\u6838\u5fc3\u529f\u80fd\u8fdb\u884c\u914d\u7f6e\uff0c\u5982\u61d2\u52a0\u8f7d\u3001\u65e5\u5fd7\u5b9e\u73b0\u3001\u7f13\u5b58\u5f00\u542f\u5173\u95ed\u7b49")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u7b80\u5355\u53c2\u6570\u8bf4\u660e")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"th"},"\u8bbe\u7f6e\u53c2\u6570")),(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"th"},"\u63cf\u8ff0")),(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"th"},"\u6709\u6548\u503c")),(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"th"},"\u9ed8\u8ba4\u503c")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cacheEnabled"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8be5\u914d\u7f6e\u5f71\u54cd\u7684\u6240\u6709\u6620\u5c04\u5668\u4e2d\u914d\u7f6e\u7684\u7f13\u5b58\u7684\u5168\u5c40\u5f00\u5173\u3002"),(0,r.kt)("td",{parentName:"tr",align:null},"true ","|"," false"),(0,r.kt)("td",{parentName:"tr",align:null},"true")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"lazyLoadingEnabled"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5ef6\u8fdf\u52a0\u8f7d\u7684\u5168\u5c40\u5f00\u5173\u3002\u5f53\u5f00\u542f\u65f6\uff0c\u6240\u6709\u5173\u8054\u5bf9\u8c61\u90fd\u4f1a\u5ef6\u8fdf\u52a0\u8f7d\u3002\u7279\u5b9a\u5173\u8054\u5173\u7cfb\u4e2d\u53ef\u901a\u8fc7\u8bbe\u7f6efetchType\u5c5e\u6027\u6765\u8986\u76d6\u8be5\u9879\u7684\u5f00\u5173\u72b6\u6001\u3002"),(0,r.kt)("td",{parentName:"tr",align:null},"true ","|"," false"),(0,r.kt)("td",{parentName:"tr",align:null},"false")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"useColumnLabel"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4f7f\u7528\u5217\u6807\u7b7e\u4ee3\u66ff\u5217\u540d\u3002\u4e0d\u540c\u7684\u9a71\u52a8\u5728\u8fd9\u65b9\u9762\u4f1a\u6709\u4e0d\u540c\u7684\u8868\u73b0\uff0c\u5177\u4f53\u53ef\u53c2\u8003\u76f8\u5173\u9a71\u52a8\u6587\u6863\u6216\u901a\u8fc7\u6d4b\u8bd5\u8fd9\u4e24\u79cd\u4e0d\u540c\u7684\u6a21\u5f0f\u6765\u89c2\u5bdf\u6240\u7528\u9a71\u52a8\u7684\u7ed3\u679c\u3002"),(0,r.kt)("td",{parentName:"tr",align:null},"true ","|"," false"),(0,r.kt)("td",{parentName:"tr",align:null},"true")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"useGeneratedKeys"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5141\u8bb8 JDBC \u652f\u6301\u81ea\u52a8\u751f\u6210\u4e3b\u952e\uff0c\u9700\u8981\u9a71\u52a8\u517c\u5bb9\u3002\u5982\u679c\u8bbe\u7f6e\u4e3a true \u5219\u8fd9\u4e2a\u8bbe\u7f6e\u5f3a\u5236\u4f7f\u7528\u81ea\u52a8\u751f\u6210\u4e3b\u952e\uff0c\u5c3d\u7ba1\u4e00\u4e9b\u9a71\u52a8\u4e0d\u80fd\u517c\u5bb9\u4f46\u4ecd\u53ef\u6b63\u5e38\u5de5\u4f5c\uff08\u6bd4\u5982 Derby\uff09\u3002"),(0,r.kt)("td",{parentName:"tr",align:null},"true ","|"," false"),(0,r.kt)("td",{parentName:"tr",align:null},"False")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"defaultStatementTimeout"),(0,r.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\uff0c\u5b83\u51b3\u5b9a\u9a71\u52a8\u7b49\u5f85\u6570\u636e\u5e93\u54cd\u5e94\u7684\u79d2\u6570\u3002"),(0,r.kt)("td",{parentName:"tr",align:null},"Any positive integer"),(0,r.kt)("td",{parentName:"tr",align:null},"Not Set (null)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"mapUnderscoreToCamelCase"),(0,r.kt)("td",{parentName:"tr",align:null},"\u662f\u5426\u5f00\u542f\u81ea\u52a8\u9a7c\u5cf0\u547d\u540d\u89c4\u5219\uff08camel case\uff09\u6620\u5c04\uff0c\u5373\u4ece\u7ecf\u5178\u6570\u636e\u5e93\u5217\u540d A_COLUMN \u5230\u7ecf\u5178 Java \u5c5e\u6027\u540d aColumn \u7684\u7c7b\u4f3c\u6620\u5c04\u3002"),(0,r.kt)("td",{parentName:"tr",align:null},"true ","|"," false"),(0,r.kt)("td",{parentName:"tr",align:null},"False")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"logPrefix"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6307\u5b9a MyBatis \u589e\u52a0\u5230\u65e5\u5fd7\u540d\u79f0\u7684\u524d\u7f00\u3002"),(0,r.kt)("td",{parentName:"tr",align:null},"Any String"),(0,r.kt)("td",{parentName:"tr",align:null},"Not set")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"logImpl"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6307\u5b9a MyBatis \u6240\u7528\u65e5\u5fd7\u7684\u5177\u4f53\u5b9e\u73b0\uff0c\u672a\u6307\u5b9a\u65f6\u5c06\u81ea\u52a8\u67e5\u627e\u3002"),(0,r.kt)("td",{parentName:"tr",align:null},"SLF4J ","|"," LOG4J ","|"," LOG4J2 ","|"," JDK_LOGGING ","|"," COMMONS_LOGGING ","|"," STDOUT_LOGGING ","|"," NO_LOGGING"),(0,r.kt)("td",{parentName:"tr",align:null},"Not set")))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5b8c\u6574\u7684 settings \u5143\u7d20\uff0c\u6709\u5f88\u591a\u53ef\u4ee5\u914d\u7f6e\u7684\u9009\u9879\uff0c\u9700\u8981\u5927\u5bb6\u6162\u6162\u81ea\u5df1\u5b66\u4e60\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<settings>\n    \x3c!----\x3e\n     <setting name="cacheEnabled" value="true"/>\n    \x3c!----\x3e\n     <setting name="lazyLoadingEnabled" value="true"/>\n    \x3c!----\x3e\n     <setting name="multipleResultSetsEnabled" value="true"/>\n     <setting name="useColumnLabel" value="true"/>\n     <setting name="useGeneratedKeys" value="false"/>\n     <setting name="autoMappingBehavior" value="PARTIAL"/>\n     <setting name="autoMappingUnknownColumnBehavior" value="WARNING"/>\n     <setting name="defaultExecutorType" value="SIMPLE"/>\n     <setting name="defaultStatementTimeout" value="25"/>\n     <setting name="defaultFetchSize" value="100"/>\n     <setting name="safeRowBoundsEnabled" value="false"/>\n     <setting name="mapUnderscoreToCamelCase" value="false"/>\n     <setting name="localCacheScope" value="SESSION"/>\n     <setting name="jdbcTypeForNull" value="OTHER"/>\n     <setting name="lazyLoadTriggerMethods" value="equals,clone,hashCode,toString"/>\n</settings>\n')))}c.isMDXComponent=!0}}]);