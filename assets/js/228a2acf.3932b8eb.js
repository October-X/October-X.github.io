"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7621],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>g});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=r.createContext({}),p=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=p(e.components);return r.createElement(i.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(t),m=a,g=u["".concat(i,".").concat(m)]||u[m]||d[m]||s;return t?r.createElement(g,o(o({ref:n},c),{},{components:t})):r.createElement(g,o({ref:n},c))}));function g(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,o=new Array(s);o[0]=m;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l[u]="string"==typeof e?e:a,o[1]=l;for(var p=2;p<s;p++)o[p]=t[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},5477:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>p});var r=t(7462),a=(t(7294),t(3905));const s={},o="5.SSM\u9879\u76ee",l={unversionedId:"Java/\u6846\u67b6/SSM\u9879\u76ee",id:"Java/\u6846\u67b6/SSM\u9879\u76ee",title:"5.SSM\u9879\u76ee",description:"\u4e00\u3001\u521b\u5efa\u7801\u4e91\u4ed3\u5e93",source:"@site/docs/Java/6.\u6846\u67b6/5.SSM\u9879\u76ee.md",sourceDirName:"Java/6.\u6846\u67b6",slug:"/Java/\u6846\u67b6/SSM\u9879\u76ee",permalink:"/docs/Java/\u6846\u67b6/SSM\u9879\u76ee",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Java/6.\u6846\u67b6/5.SSM\u9879\u76ee.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{},sidebar:"Java",previous:{title:"4.Redis",permalink:"/docs/Java/\u6846\u67b6/Redis"},next:{title:"6.SpringBoot",permalink:"/docs/Java/\u6846\u67b6/SpringBoot"}},i={},p=[{value:"\u4e00\u3001\u521b\u5efa\u7801\u4e91\u4ed3\u5e93",id:"\u4e00\u521b\u5efa\u7801\u4e91\u4ed3\u5e93",level:2},{value:"\u4e8c\u3001\u521b\u5efa\u524d\u7aef\u9879\u76ee",id:"\u4e8c\u521b\u5efa\u524d\u7aef\u9879\u76ee",level:2},{value:"1\u3001\u521b\u5efavue3.0\u811a\u624b\u67b6\u5de5\u7a0b",id:"1\u521b\u5efavue30\u811a\u624b\u67b6\u5de5\u7a0b",level:3},{value:"2\u3001\u914d\u7f6evue-router",id:"2\u914d\u7f6evue-router",level:3},{value:"\uff081\uff09\u5b89\u88c5\u4f9d\u8d56",id:"1\u5b89\u88c5\u4f9d\u8d56",level:4},{value:"\uff082\uff09\u521b\u5efarouter\u76ee\u5f55\u7ed3\u6784",id:"2\u521b\u5efarouter\u76ee\u5f55\u7ed3\u6784",level:4},{value:"\uff083\uff09\u5168\u5c40\u5b89\u88c5",id:"3\u5168\u5c40\u5b89\u88c5",level:4},{value:"3\u3001\u914d\u7f6evuex",id:"3\u914d\u7f6evuex",level:3},{value:"\uff081\uff09\u5b89\u88c5\u4f9d\u8d56",id:"1\u5b89\u88c5\u4f9d\u8d56-1",level:4},{value:"\uff082\uff09\u521b\u5efa\u76ee\u5f55\u7ed3\u6784",id:"2\u521b\u5efa\u76ee\u5f55\u7ed3\u6784",level:4},{value:"\uff083\uff09\u5168\u5c40\u5f15\u5165",id:"3\u5168\u5c40\u5f15\u5165",level:4},{value:"4\u3001\u914d\u7f6eaxios",id:"4\u914d\u7f6eaxios",level:3},{value:"5\u3001\u5b89\u88c5ui\u7ec4\u4ef6",id:"5\u5b89\u88c5ui\u7ec4\u4ef6",level:3},{value:"\u4e09\u3001\u521b\u5efa\u540e\u7aef\u9879\u76ee",id:"\u4e09\u521b\u5efa\u540e\u7aef\u9879\u76ee",level:2},{value:"1\u3001\u642d\u5efamaven\u5de5\u7a0b",id:"1\u642d\u5efamaven\u5de5\u7a0b",level:3},{value:"2\u3001\u8c03\u6574\u5de5\u7a0b\u7ed3\u6784",id:"2\u8c03\u6574\u5de5\u7a0b\u7ed3\u6784",level:3},{value:"3\u3001\u914d\u7f6etomcat",id:"3\u914d\u7f6etomcat",level:3},{value:"4\u3001\u52a0\u5165\u4ee5\u4e0b\u4f9d\u8d56",id:"4\u52a0\u5165\u4ee5\u4e0b\u4f9d\u8d56",level:3},{value:"5\u3001\u6784\u5efa\u76ee\u5f55\u7ed3\u6784\u5e76\u6d4b\u8bd5\uff1a",id:"5\u6784\u5efa\u76ee\u5f55\u7ed3\u6784\u5e76\u6d4b\u8bd5",level:3},{value:"\u56db\u3001\u524d\u540e\u7aef\u8054\u8c03",id:"\u56db\u524d\u540e\u7aef\u8054\u8c03",level:2},{value:"1\u3001\u8de8\u57df\u95ee\u9898",id:"1\u8de8\u57df\u95ee\u9898",level:3},{value:"2\u3001\u670d\u52a1\u7aef\u89e3\u51b3\u8de8\u57df",id:"2\u670d\u52a1\u7aef\u89e3\u51b3\u8de8\u57df",level:3},{value:"3\u3001\u524d\u7aef\u914d\u7f6e\u4ee3\u7406",id:"3\u524d\u7aef\u914d\u7f6e\u4ee3\u7406",level:3},{value:"\uff081\uff09\u4fee\u6539vue\u7684\u7aef\u53e3\uff0c\u5e76\u914d\u7f6e\u4ee3\u7406",id:"1\u4fee\u6539vue\u7684\u7aef\u53e3\u5e76\u914d\u7f6e\u4ee3\u7406",level:4},{value:"\uff082\uff09\u4fee\u6539axios\u7684\u914d\u7f6e",id:"2\u4fee\u6539axios\u7684\u914d\u7f6e",level:4},{value:"\u4e94\u3001\u5173\u4e8e\u8ba4\u8bc1\u7684\u65b0\u8ba8\u8bba",id:"\u4e94\u5173\u4e8e\u8ba4\u8bc1\u7684\u65b0\u8ba8\u8bba",level:2},{value:"1\u3001\u5b8c\u6210\u7684\u767b\u9646\u9875\u9762",id:"1\u5b8c\u6210\u7684\u767b\u9646\u9875\u9762",level:3},{value:"2\u3001\u4f20\u7edf\u7684\u767b\u9646\u903b\u8f91",id:"2\u4f20\u7edf\u7684\u767b\u9646\u903b\u8f91",level:3},{value:"3\u3001\u6a21\u62df\u5347\u7ea7",id:"3\u6a21\u62df\u5347\u7ea7",level:3},{value:"\u516d\u3001RBAC\u6743\u9650\u7cfb\u7edf",id:"\u516drbac\u6743\u9650\u7cfb\u7edf",level:2},{value:"1\u3001\u6982\u8ff0",id:"1\u6982\u8ff0",level:3},{value:"\uff081\uff09RBAC\u6a21\u578b\u6982\u8ff0",id:"1rbac\u6a21\u578b\u6982\u8ff0",level:4},{value:"\uff082\uff09RBAC\u7684\u7ec4\u6210",id:"2rbac\u7684\u7ec4\u6210",level:4},{value:"2\u3001\u8ba4\u8bc1",id:"2\u8ba4\u8bc1",level:3},{value:"\uff081\uff09redis\u7684\u642d\u5efa",id:"1redis\u7684\u642d\u5efa",level:4},{value:"\uff082\uff09\u540e\u7aef\u7684\u767b\u9646\u903b\u8f91",id:"2\u540e\u7aef\u7684\u767b\u9646\u903b\u8f91",level:4},{value:"\uff083\uff09\u524d\u7aefstore\u7684\u5904\u7406",id:"3\u524d\u7aefstore\u7684\u5904\u7406",level:4},{value:"\uff084\uff09\u6570\u636e\u6821\u9a8c",id:"4\u6570\u636e\u6821\u9a8c",level:4},{value:"3\u3001\u9274\u6743",id:"3\u9274\u6743",level:3},{value:"\uff081\uff09\u540e\u7aef\u5904\u7406\u9274\u6743",id:"1\u540e\u7aef\u5904\u7406\u9274\u6743",level:4},{value:"\uff082\uff09\u524d\u7aef\u5904\u7406\u9274\u6743",id:"2\u524d\u7aef\u5904\u7406\u9274\u6743",level:4},{value:"\u4e03\u3001\u65e5\u5fd7\u7684\u5904\u7406",id:"\u4e03\u65e5\u5fd7\u7684\u5904\u7406",level:2},{value:"1\u3001\u666e\u901a\u65e5\u5fd7",id:"1\u666e\u901a\u65e5\u5fd7",level:3},{value:"2\u3001\u6570\u636e\u5e93\u65e5\u5fd7",id:"2\u6570\u636e\u5e93\u65e5\u5fd7",level:3},{value:"\u516b\u3001\u8868\u5355\u91cd\u590d\u63d0\u4ea4",id:"\u516b\u8868\u5355\u91cd\u590d\u63d0\u4ea4",level:2},{value:"\u4e5d\u3001\u9632\u6b62xss\u653b\u51fb",id:"\u4e5d\u9632\u6b62xss\u653b\u51fb",level:2}],c={toc:p};function u(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"5ssm\u9879\u76ee"},"5.SSM\u9879\u76ee"),(0,a.kt)("h2",{id:"\u4e00\u521b\u5efa\u7801\u4e91\u4ed3\u5e93"},"\u4e00\u3001\u521b\u5efa\u7801\u4e91\u4ed3\u5e93"),(0,a.kt)("p",null,"1\u3001\u767b\u9646\u7801\u4e91\uff0c\u9009\u62e9\u53f3\u4e0a\u89d2\u7684\u201c+\u201d\u6309\u94ae\uff0c\u9009\u62e9\u65b0\u5efa\u4ed3\u5e93\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220119183623974-4020a0f0.png",alt:"image-20220119183623974"}),"image-20220119183623974"),(0,a.kt)("p",null,"2\u3001\u65b0\u5efa\u4ed3\u5e93\u7684\u5177\u4f53\u4fe1\u606f\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220119184029717-d791009d.png",alt:"image-20220119184029717"}),"image-20220119184029717"),(0,a.kt)("p",null,"3\u3001\u4f7f\u7528git\u547d\u4ee4\u514b\u9686\u6211\u4eec\u7684\u4ed3\u5e93\u81f3\u672c\u5730\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220119184130735-f8dbdc03.png",alt:"image-20220119184130735"}),"image-20220119184130735"),(0,a.kt)("p",null,"\u6211\u7684\u4ed3\u5e93\u547d\u4ee4\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://gitee.com/zhangnan716/ydl-ssm-pro.git\n")),(0,a.kt)("p",null,"\u53ef\u4ee5\u65b0\u589e\u4e00\u4e2a.gitignore\u6587\u4ef6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"HELP.md\ntarget/\n!.mvn/wrapper/maven-wrapper.jar\n!**/src/main/**\n!**/src/test/**\n\n### STS ###\n.apt_generated\n.classpath\n.factorypath\n.project\n.settings\n.springBeans\n.sts4-cache\n\n### IntelliJ IDEA ###\n.idea\n*.iws\n*.iml\n*.ipr\n\n### NetBeans ###\n/nbproject/private/\n/nbbuild/\n/dist/\n/nbdist/\n/.nb-gradle/\nbuild/\n\n### VS Code ###\n.vscode/\n\n\nmvnw\nmvnw.cmd\n.mvn/\n\n*.log\n")),(0,a.kt)("h2",{id:"\u4e8c\u521b\u5efa\u524d\u7aef\u9879\u76ee"},"\u4e8c\u3001\u521b\u5efa\u524d\u7aef\u9879\u76ee"),(0,a.kt)("h3",{id:"1\u521b\u5efavue30\u811a\u624b\u67b6\u5de5\u7a0b"},"1\u3001\u521b\u5efavue3.0\u811a\u624b\u67b6\u5de5\u7a0b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"vue create ydl-ui\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u9009\u62e9vue3.0\u7248\uff0c\u5c06\u9879\u76ee\u76f4\u63a5\u5efa\u7acb\u5728\u4ed3\u5e93\u7684\u6839\u76ee\u5f55\u4e2d")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220119184559911-22db70df.png",alt:"image-20220119184559911"}),"image-20220119184559911"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u4f7f\u7528vscode\u6253\u5f00\u9879\u76ee\u5de5\u7a0b\uff0c\u5e76\u542f\u52a8\uff1a")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220120104527841-f686373d.png",alt:"image-20220120104527841"}),"image-20220120104527841"),(0,a.kt)("h3",{id:"2\u914d\u7f6evue-router"},"2\u3001\u914d\u7f6evue-router"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://next.router.vuejs.org/zh/index.html"},"https://next.router.vuejs.org/zh/index.htmlopen in new window")),(0,a.kt)("h4",{id:"1\u5b89\u88c5\u4f9d\u8d56"},"\uff081\uff09\u5b89\u88c5\u4f9d\u8d56"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add vue-router@4\n")),(0,a.kt)("h4",{id:"2\u521b\u5efarouter\u76ee\u5f55\u7ed3\u6784"},"\uff082\uff09\u521b\u5efarouter\u76ee\u5f55\u7ed3\u6784"),(0,a.kt)("p",null,"\u521b\u5efarouter\u76ee\u5f55\uff0c\u5e76\u521b\u5efaindex.js\u6587\u4ef6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"// \u5bfc\u5165\u7528\u6765\u521b\u5efa\u8def\u7531\u548c\u786e\u5b9a\u8def\u7531\u6a21\u5f0f\u7684\u4e24\u4e2a\u65b9\u6cd5\nimport {\n    createRouter,\n    createWebHistory\n} from 'vue-router'\n\n/**\n * \u5b9a\u4e49\u8def\u7531\u4fe1\u606f\n * \n */\nconst routes = []\n\n// \u521b\u5efa\u8def\u7531\u5b9e\u4f8b\u5e76\u4f20\u9012 `routes` \u914d\u7f6e\n// \u6211\u4eec\u5728\u8fd9\u91cc\u4f7f\u7528 html5 \u7684\u8def\u7531\u6a21\u5f0f\uff0curl\u4e2d\u4e0d\u5e26\u6709#\uff0c\u90e8\u7f72\u9879\u76ee\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u3002\nconst router = createRouter({\n    history: createWebHistory(),\n    routes, \n})\n\n\n// \u5168\u5c40\u7684\u8def\u7531\u5b88\u536b\nrouter.beforeEach((to, from) => {\n    console.log(to)\n    console.log(from)\n    return true\n})\n\n// \u8bb2\u8def\u7531\u5b9e\u4f8b\u5bfc\u51fa\nexport default router\n")),(0,a.kt)("h4",{id:"3\u5168\u5c40\u5b89\u88c5"},"\uff083\uff09\u5168\u5c40\u5b89\u88c5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"import router from '@/router'\ncreateApp(App).use(router).mount('#app')\n")),(0,a.kt)("h3",{id:"3\u914d\u7f6evuex"},"3\u3001\u914d\u7f6evuex"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://next.vuex.vuejs.org/zh/"},"https://next.vuex.vuejs.org/zh/open in new window")),(0,a.kt)("h4",{id:"1\u5b89\u88c5\u4f9d\u8d56-1"},"\uff081\uff09\u5b89\u88c5\u4f9d\u8d56"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"yarn add vuex@next\n")),(0,a.kt)("h4",{id:"2\u521b\u5efa\u76ee\u5f55\u7ed3\u6784"},"\uff082\uff09\u521b\u5efa\u76ee\u5f55\u7ed3\u6784"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220120111557385-c2c45e7e.png",alt:"image-20220120111557385"}),"image-20220120111557385"),(0,a.kt)("p",null,"user\u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const user = {\n    state: {\n    },\n    getters:{   \n    },\n    mutations: {\n    },\n    actions: {\n    }\n}\n\nexport default user\n")),(0,a.kt)("p",null,"index.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"import { createStore } from 'vuex'\nimport user from '@/store/modules/user'\nimport actions from '@/store/actions'\nimport mutations from '@/store/mutations'\n\n\nconst store = createStore({\n    modules: {\n        user\n    },\n    actions,\n    mutations\n})\n\nexport default store\n")),(0,a.kt)("h4",{id:"3\u5168\u5c40\u5f15\u5165"},"\uff083\uff09\u5168\u5c40\u5f15\u5165"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"import store from '@/store'\n\ncreateApp(App).use(router).use(store).mount('#app')\n")),(0,a.kt)("h3",{id:"4\u914d\u7f6eaxios"},"4\u3001\u914d\u7f6eaxios"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://www.axios-js.com/"},"http://www.axios-js.com/open in new window")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add axios\n")),(0,a.kt)("p",null,"\u521b\u5efa\u6587\u4ef6\u76ee\u5f55"),(0,a.kt)("p",null,"\u65b0\u5efa\u6587\u4ef6\u5939api\uff0c\u4ee5\u540e\u6240\u6709\u548c\u540e\u7aefapi\u4ea4\u4e92\u7684\u5185\u5bb9\u5168\u90e8\u653e\u5728\u6b64\u6587\u4ef6\u5939\u4e2d\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZIAAAAvCAYAAADJoUzlAAAIV0lEQVR4nO3df0zU9x3H8accHBw/ClhMHdDTI2KZ2Gpo0bmi2LEZlsbVeE4NqbObcW4azYx2VhuzpnNV0zZtaiD+yKLGxZFF6ZqmalysdvHHgIjodKIYsHqoRAQE8eAQ3B+HVA8OTu4HV309/jq+n88b3vcP77w/38/n+x2Smjr6PiIiAWKxWDyaV1Fx3s+Z+E/Cq3lYx8b0PtjpoK58H3tLax+5HPejPOaMcxPzMNs3bPmqwgdZeiYlJYWqqqo+54QGKBcRkadaR2sjddWVlJwq41pzz/FQQ+Bz8pUhY158SR2JiATMCLPZo3nn/nvGz5mIJzzpSEIClIuIiDyhVEhERMQrKiQiIuIVFRIREfGKComIiHhFhURERLyicyQiMiCx0RFYEuOJi44A7tNwp5WqmgaaW9oGOzUJsB6FxBT/DDQ0YXcbYuKZeGhqcD9DRJ5sw+KjSLcMw2Qydl8zmYzERkVwrqqWW7f1/+Fp4lJIxvPrP/6G5EuF/Pmvx3spJiayFv2JPPMFtr27nVNufql1kZWFY6OdP9iOk7ux0nktzkZ5fBrjo65zYOlBPmUoGzZMZ3yUc2rL2S+xbqn33bcTEZ8zhhkwPxeLKcLYYyzKZMQ8PJ6mFgft9zoGITsZDC6FpJyC9wtZ9t5c1i7ApZg4i8hs8wV2r3NfRJg5jYUWG9uWFrPXdSw5GXbtJLcE6CoiqdVfkrulHkhlwyJffS0R8ZcIYyhRkUYY0svgEIiONBIRHqpC8hTpebPdfpzP3ivkxui5rF3wY0wAmMhasIbZ5gv8Y912jvbVtdpu0xIVy/O9jp3hnZKuzxNSSaWC3d0dSCXvqBsRCXr3gfv9PFipv3F5svS+a6urmNhGzWLtgqm8tmANs1Oq+i8iACXFWA9D7qb5HNg0jT+4m5ccS1RDfc+uRUSCWmvbPe7cdTgriqv7cOeugzbHvYDnJYPH/fZf+3EK3t+DbdQcfulpEXmg6CC5S3eSexhyN0zE6m5e/FD3YyISlNrvdXDlRgMtdkePsRa7gys3GrSs9ZTp+xyJ/TgFq3/P4ncfo4g8rK9lrqJqrkalkbdoaNeFVDZ0fxaRYHbrtp3yi9e5drMJu92B3e7g2s0myi9e146tp5Dvz5HMnMaB137Q9cMdynft5VPopfOoZOFS2LZpOgc2Oa9cPbzT5+mIiH80tbRx+uKNwU5DgoDeRyIiAaX3kXy/6A2JIiKDwkBMSgZZGWkkxUdiCAE6O3A01VJ5+gQnKuro7S6SIdZCxqQM0hITiAxzXutwNFJ78TQnSiqoaw/kd/CcnrUlIuJrwyYx/WcZmJ/tKiIAIQaMcYmkZ1v5Ve4oeh7nTGDS69PIGPFdEQEwGONIHJuNNe/njOoZFBTUkYiI+Fwbd29doqL4JGdrGnF0AsY4LJk5TB2bgHHEy4yLuUSpy7vb21rquHS+lJPnrtDoAEKMxI2cQE52OgkRZl4eF8Ml16AgoEIiIuJrN0v55x6Xa45Gqo8dJWnkDNKjDYRHAI/UhDpKv3A5WdfpoLHqKEcTLcxIj8RgDHcNCgpa2hIRCZSQcMJDATpoa/U8LNwZRIcjOJ+sHBoTGdvrgMWSRHV1TYDTEZEnXYTRNNgpDApjnJlxk3MYFQHNZ4/0WNZyE4R5/GRyUoxw+xxHTgZfNwJa2hIR8Zu01xeRnfzQhY5mqv/9OQfPN7oP+uF0Fk1JfDiI5svf8Pm/Kmjs9Fem3tHSlohIoBhisGTNYs4UM5GeBxEzMptZ1mzMngcF1JCJEyf3eiBRS1si4g+JicM9mnfyZLGfMwksQ2QCSS9kkv2KmcgQaD69l93/qes7KCyShOFpZE7JxBwN3D7D3sIT9BPlU54cSFRHIiISAB1367hyaj+7DlfTAcSMycDSX1D7XequlrH/74eobgdi08lI8X+uj0uFREQkkL6tcXYUYeGEexrTWU3NLQAD4R4HBc7AC8kYK6vWzGNiADdgzFz9Cfmr3wjcHxQR8bURSSQA1N/A45sHIRaSngVo5IbNX4kN3MB3bf3vK45MWIH17Xnw4S6KA/Dk6KL1yyny/58REfE5Y3QCw1MzyXrFjAEHV8pP93+00BhJwnNpZE7OxBwGjm9PcjoIdwB7sf23leIdH8NbK/jFirnwcWFAiomISLBLeDUP69iY3gc7HdSV7WN/pcuLwYZlkTczHTdROG6Wse/gJXq+TmzweXmOpKuYvLnssYpJ5u8+4K0XH6yJ1XBoyUcUPbgeX8whppLTtffa9vVy1nc9NWDm6k+Y1LCLtzeXeZe2iEiAdbQ2UlddScmpMq552lW0O2hsqKKyuIwyj4MCzwcHElsp/ttn3cWkfV0hff+bzyAz/jI7lmylFGdxyFn9BkXrv3AOJ0/lha+Xs2Q9MOG3fDj/AxZfXUNBifeZiogEQt2x3Ww59phBN4+ye8tRv+Tjb77dtRUS1v8cyihY7ywiAEUXXW432Y50dyCUbOWEzYQlI8OHSYqIiC/5oCOJYOKby7COusnejbv66Ua6WFeS/5Ok7362VbqderXBziSvcxQREX/xspA8XES2e3az3bqS/AlN7FjykbMrsa4kf7T76c/Hm6i/qHsiIiLByoulrQEUESBz2FBorO1e2po5OunRCckTWTyh67N1JTnJNVxweUS/iIgEj4F3JC/N4Kcpj1dEAEo37yFz4zzy86cCYLO53iO5DNZPyJ8PYOfczjU6OyIiEsQGXkjOFPKXMwMJLKNgVV9LVbUUrNra64gOJIqIBB89a0tERLyiQiIiIl4Jqjcklm5e030TXkREvh/UkYiIiFdUSERExCuh9fW1vQ5YLEm4GxMRGajY2CB98bgM2P8BK6ac4Fda+AwAAAAASUVORK5CYII=",alt:"image-20220215115102142"}),"image-20220215115102142"),(0,a.kt)("p",null,"\u65b0\u5efaindex.js\uff0c\u8be5\u6587\u4ef6\u7528\u6765\u5b9a\u4e49\u5168\u5c40\u7684axios\u914d\u7f6e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"/**\n * axios\u7684\u57fa\u672capi\n * // \u53d1\u9001 POST \u8bf7\u6c42\n * axios({\n *  method: 'post',\n *  url: '/user/12345',\n *  data: {\n *    firstName: 'Fred',\n *    lastName: 'Flintstone'\n *  }\n *});\n * \n */\n\nimport axios from 'axios'\n\n// \u521b\u5efaaxios\u5b9e\u4f8b\nconst request = axios.create({\n    // axios\u4e2d\u8bf7\u6c42\u914d\u7f6e\u6709baseURL\u9009\u9879\uff0c\u8868\u793a\u8bf7\u6c42URL\u516c\u5171\u90e8\u5206\n    baseURL: 'http://localhost:8080/ydl/',\n    // \u8d85\u65f6\n    timeout: 10000,\n    // \u8bbe\u7f6eContent-Type\uff0c\u89c4\u5b9a\u4e86\u524d\u540e\u7aef\u7684\u4ea4\u4e92\u4f7f\u7528json\n    headers: {'Content-Type': 'application/json;charset=utf-8'}\n})\nexport default request\n")),(0,a.kt)("p",null,"\u73b0\u5728\u6211\u4eec\u4e0d\u59a8\u5199\u51e0\u4e2auser\u76f8\u5173\u7684\u63a5\u53e3\uff0c\u611f\u53d7\u4e00\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"import request from \"@/api\";\n\n// \u65b0\u589e\u7528\u6237\n// \u67e5\u8be2\u7528\u6237\u5217\u8868\nexport function listUser(query) {\n    return request({\n        url: '/user',\n        method: 'get',\n        params: query\n    })\n}\n\n// \u65b0\u589e\u7528\u6237\nexport function addUser(data) {\n    return request({\n        url: '/user',\n        method: 'post',\n        data: data\n    })\n}\n")),(0,a.kt)("h3",{id:"5\u5b89\u88c5ui\u7ec4\u4ef6"},"5\u3001\u5b89\u88c5ui\u7ec4\u4ef6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"yarn add element-plus\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"import ElementPlus from 'element-plus'\nimport 'element-plus/dist/index.css'\n\ncreateApp(App).use(router).use(vuex).use(ElementPlus).mount('#app')\n")),(0,a.kt)("p",null,"\u524d\u7aef\u9879\u76ee\u57fa\u672c\u642d\u5efa\u5b8c\u6210\u3002"),(0,a.kt)("h2",{id:"\u4e09\u521b\u5efa\u540e\u7aef\u9879\u76ee"},"\u4e09\u3001\u521b\u5efa\u540e\u7aef\u9879\u76ee"),(0,a.kt)("h3",{id:"1\u642d\u5efamaven\u5de5\u7a0b"},"1\u3001\u642d\u5efamaven\u5de5\u7a0b"),(0,a.kt)("p",null,"\u76f4\u63a5\u628a\u9879\u76ee\u5efa\u7acb\u5728\u4ed3\u5e93\u7684\u6839\u76ee\u5f55\u5373\u53ef\uff0c\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u521b\u5efa\u4e24\u4e2a\u4ed3\u5e93\uff0c\u4e00\u4e2a\u524d\u7aef\u9879\u76ee\u4ed3\u5e93\uff0c\u4e00\u4e2a\u540e\u7aef\u9879\u76ee\u4ed3\u5e93\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220119190222325-ac8428c7.png",alt:"image-20220119190222325"}),"image-20220119190222325"),(0,a.kt)("h3",{id:"2\u8c03\u6574\u5de5\u7a0b\u7ed3\u6784"},"2\u3001\u8c03\u6574\u5de5\u7a0b\u7ed3\u6784"),(0,a.kt)("p",null,"\u521b\u5efa\u5b50\u5de5\u7a0bydl-backend\uff0c\u5220\u9664\u6389\u7236\u5de5\u7a0b\u7684src\uff0c\u5c06\u7236\u5de5\u7a0b\u7684pom\u6587\u4ef6\u4e2d\u7684packaging\u6539\u4e3apom\uff0c\u58f0\u660e\u4e3a\u4e00\u4e2a\u7236\u5de5\u7a0b\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220119190449118-4aa64251.png",alt:"image-20220119190449118"}),"image-20220119190449118"),(0,a.kt)("h3",{id:"3\u914d\u7f6etomcat"},"3\u3001\u914d\u7f6etomcat"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220120132636690-2f2f655f.png",alt:"image-20220120132636690"}),"image-20220120132636690"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220120132719105-ce6ac706.png",alt:"image-20220120132719105"}),"image-20220120132719105"),(0,a.kt)("h3",{id:"4\u52a0\u5165\u4ee5\u4e0b\u4f9d\u8d56"},"4\u3001\u52a0\u5165\u4ee5\u4e0b\u4f9d\u8d56"),(0,a.kt)("p",null,"\u5728\u7236\u5de5\u7a0b\u4e2d\u52a0\u5165\u4ee5\u4e0b\u4f9d\u8d56\uff0c\u8fdb\u884c\u4f9d\u8d56\u7ba1\u7406\uff0c\u6bcf\u4e00\u4e2a\u4f9d\u8d56\u7684\u4f5c\u7528\u4e0d\u5728\u8d58\u8ff0\uff0c\u8fd9\u662f\u57fa\u672c\u7684ssm\u9879\u76ee\u642d\u5efa\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.ydl</groupId>\n    <artifactId>ydl-back</artifactId>\n    <packaging>pom</packaging>\n    <version>1.0-SNAPSHOT</version>\n    <modules>\n        <module>ydl-backend</module>\n    </modules>\n\n    <name>ruoyi</name>\n    <url>http://www.ydlclass.com</url>\n    <description>\u5143\u52a8\u529b\u7ba1\u7406\u7cfb\u7edf</description>\n\n    <properties>\n        <maven.compiler.source>11</maven.compiler.source>\n        <maven.compiler.target>11</maven.compiler.target>\n        <project.build.sourceEncoding>utf-8</project.build.sourceEncoding>\n        <javax.servlet.version>4.0.1</javax.servlet.version>\n        <spring.version>5.2.18.RELEASE</spring.version>\n        <spring-data-commons.version>2.6.0</spring-data-commons.version>\n        <aspectjweaver.version>1.9.6</aspectjweaver.version>\n        <lombok.version>1.18.22</lombok.version>\n        <jackson.version>2.13.1</jackson.version>\n        <validation-api.version>2.0.1.Final</validation-api.version>\n        <hibernate-validator>6.0.9.Final</hibernate-validator>\n        <logback-classic.version>1.2.6</logback-classic.version>\n        <commons-fileupload.version>1.3.3</commons-fileupload.version>\n        <druid.version>1.2.8</druid.version>\n        <mysql-connector-java.version>8.0.26</mysql-connector-java.version>\n        <mybatis.version>3.5.5</mybatis.version>\n        <mybatis-spring.version>2.0.6</mybatis-spring.version>\n    </properties>\n\n    \x3c!--\u4f9d\u8d56\u7ba1\u7406--\x3e\n    <dependencyManagement>\n        <dependencies>\n            \x3c!--servlet-api--\x3e\n            <dependency>\n                <groupId>javax.servlet</groupId>\n                <artifactId>javax.servlet-api</artifactId>\n                <version>${javax.servlet.version}</version>\n            </dependency>\n\n            \x3c!--spring-webmvc--\x3e\n            <dependency>\n                <groupId>org.springframework</groupId>\n                <artifactId>spring-webmvc</artifactId>\n                <version>${spring.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>org.springframework</groupId>\n                <artifactId>spring-jdbc</artifactId>\n                <version>${spring.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>org.springframework.data</groupId>\n                <artifactId>spring-data-commons</artifactId>\n                <version>${spring-data-commons.version}</version>\n            </dependency>\n\n            <dependency>\n                <groupId>org.aspectj</groupId>\n                <artifactId>aspectjweaver</artifactId>\n                <version>${aspectjweaver.version}</version>\n            </dependency>\n            \x3c!--lombok--\x3e\n            <dependency>\n                <groupId>org.projectlombok</groupId>\n                <artifactId>lombok</artifactId>\n                <version>${lombok.version}</version>\n            </dependency>\n\n            \x3c!--jackson--\x3e\n            <dependency>\n                <groupId>com.fasterxml.jackson.core</groupId>\n                <artifactId>jackson-core</artifactId>\n                <version>${jackson.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.fasterxml.jackson.core</groupId>\n                <artifactId>jackson-annotations</artifactId>\n                <version>${jackson.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.fasterxml.jackson.core</groupId>\n                <artifactId>jackson-databind</artifactId>\n                <version>${jackson.version}</version>\n            </dependency>\n\n            \x3c!--\u6570\u636e\u6821\u9a8c--\x3e\n            <dependency>\n                <groupId>javax.validation</groupId>\n                <artifactId>validation-api</artifactId>\n                <version>${validation-api.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>org.hibernate</groupId>\n                <artifactId>hibernate-validator</artifactId>\n                <version>${hibernate-validator}</version>\n            </dependency>\n\n            \x3c!--logback\u65e5\u5fd7--\x3e\n            <dependency>\n                <groupId>ch.qos.logback</groupId>\n                <artifactId>logback-classic</artifactId>\n                <version>${logback-classic.version}</version>\n            </dependency>\n\n\n            \x3c!--\u6587\u4ef6\u4e0a\u4f20--\x3e\n            <dependency>\n                <groupId>commons-fileupload</groupId>\n                <artifactId>commons-fileupload</artifactId>\n                <version>${commons-fileupload.version}</version>\n            </dependency>\n\n            \x3c!-- \u6570\u636e\u6e90--\x3e\n            <dependency>\n                <groupId>com.alibaba</groupId>\n                <artifactId>druid</artifactId>\n                <version>${druid.version}</version>\n            </dependency>\n            \x3c!-- \u6570\u636e\u533a\u9a71\u52a8--\x3e\n            <dependency>\n                <groupId>mysql</groupId>\n                <artifactId>mysql-connector-java</artifactId>\n                <version>${mysql-connector-java.version}</version>\n            </dependency>\n\n            \x3c!-- mybatis--\x3e\n            <dependency>\n                <groupId>org.mybatis</groupId>\n                <artifactId>mybatis</artifactId>\n                <version>${mybatis.version}</version>\n            </dependency>\n\n            \x3c!-- \u6574\u5408spring\u548cmybatis --\x3e\n            <dependency>\n                <groupId>org.mybatis</groupId>\n                <artifactId>mybatis-spring</artifactId>\n                <version>${mybatis-spring.version}</version>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.1</version>\n                <configuration>\n                    <source>${java.version}</source>\n                    <target>${java.version}</target>\n                    <encoding>${project.build.sourceEncoding}</encoding>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n\n    <repositories>\n        <repository>\n            <id>public</id>\n            <name>aliyun nexus</name>\n            <url>https://maven.aliyun.com/repository/public</url>\n            <releases>\n                <enabled>true</enabled>\n            </releases>\n        </repository>\n    </repositories>\n\n</project>\n')),(0,a.kt)("p",null,"\u5728\u5b50\u5de5\u7a0b\u4e2d\u52a0\u5165\u4ee5\u4e0b\u4f9d\u8d56\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <artifactId>ydl-back</artifactId>\n        <groupId>com.ydl</groupId>\n        <version>1.0-SNAPSHOT</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>ydl-backend</artifactId>\n\n    <properties>\n        <maven.compiler.source>11</maven.compiler.source>\n        <maven.compiler.target>11</maven.compiler.target>\n    </properties>\n\n    <dependencies>\n        \x3c!--servlet-api--\x3e\n        <dependency>\n            <groupId>javax.servlet</groupId>\n            <artifactId>javax.servlet-api</artifactId>\n        </dependency>\n\n        \x3c!--spring-webmvc--\x3e\n        <dependency>\n            <groupId>org.springframework</groupId>\n            <artifactId>spring-webmvc</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework</groupId>\n            <artifactId>spring-jdbc</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.data</groupId>\n            <artifactId>spring-data-commons</artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId>org.aspectj</groupId>\n            <artifactId>aspectjweaver</artifactId>\n        </dependency>\n        \x3c!--lombok--\x3e\n        <dependency>\n            <groupId>org.projectlombok</groupId>\n            <artifactId>lombok</artifactId>\n        </dependency>\n\n        \x3c!--jackson--\x3e\n        <dependency>\n            <groupId>com.fasterxml.jackson.core</groupId>\n            <artifactId>jackson-core</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>com.fasterxml.jackson.core</groupId>\n            <artifactId>jackson-annotations</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>com.fasterxml.jackson.core</groupId>\n            <artifactId>jackson-databind</artifactId>\n        </dependency>\n\n        \x3c!--\u6570\u636e\u6821\u9a8c--\x3e\n        <dependency>\n            <groupId>javax.validation</groupId>\n            <artifactId>validation-api</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.hibernate</groupId>\n            <artifactId>hibernate-validator</artifactId>\n        </dependency>\n\n        \x3c!--logback\u65e5\u5fd7--\x3e\n        <dependency>\n            <groupId>ch.qos.logback</groupId>\n            <artifactId>logback-classic</artifactId>\n        </dependency>\n\n\n        \x3c!--\u6587\u4ef6\u4e0a\u4f20--\x3e\n        <dependency>\n            <groupId>commons-fileupload</groupId>\n            <artifactId>commons-fileupload</artifactId>\n        </dependency>\n\n        \x3c!-- \u6570\u636e\u6e90--\x3e\n        <dependency>\n            <groupId>com.alibaba</groupId>\n            <artifactId>druid</artifactId>\n        </dependency>\n        \x3c!-- \u6570\u636e\u533a\u9a71\u52a8--\x3e\n        <dependency>\n            <groupId>mysql</groupId>\n            <artifactId>mysql-connector-java</artifactId>\n        </dependency>\n\n        \x3c!-- mybatis--\x3e\n        <dependency>\n            <groupId>org.mybatis</groupId>\n            <artifactId>mybatis</artifactId>\n        </dependency>\n\n        \x3c!-- \u6574\u5408spring\u548cmybatis --\x3e\n        <dependency>\n            <groupId>org.mybatis</groupId>\n            <artifactId>mybatis-spring</artifactId>\n        </dependency>\n    </dependencies>\n\n</project>\n')),(0,a.kt)("p",null,"web.xml\u7684\u5185\u5bb9"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"\n         version="4.0">\n    \n    \x3c!--\u5bb9\u5668\u521d\u59cb\u5316\u65f6\uff0c\u8d1f\u8d23\u542f\u52a8spring\u5bb9\u5668--\x3e\n    <listener>\n        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\n    </listener>\n\n    <context-param>\n        <param-name>contextConfigLocation</param-name>\n        <param-value>classpath:application.xml</param-value>\n    </context-param>\n\n    \x3c!--\u6ce8\u518cDispatcherServlet\uff0c\u8fd9\u662fspringmvc\u7684\u6838\u5fc3\uff0c\u5c31\u662f\u4e2aservlet--\x3e\n    <servlet>\n        <servlet-name>springmvc</servlet-name>\n        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>\n        <init-param>\n            <param-name>contextConfigLocation</param-name>\n            <param-value>classpath:application.xml</param-value>\n        </init-param>\n        \x3c!--\u52a0\u8f7d\u65f6\u5148\u542f\u52a8--\x3e\n        <load-on-startup>1</load-on-startup>\n    </servlet>\n    \x3c!--/ \u5339\u914d\u6240\u6709\u7684\u8bf7\u6c42\uff1b\uff08\u4e0d\u5305\u62ec.jsp\uff09--\x3e\n    \x3c!--/* \u5339\u914d\u6240\u6709\u7684\u8bf7\u6c42\uff1b\uff08\u5305\u62ec.jsp\uff09--\x3e\n    <servlet-mapping>\n        <servlet-name>springmvc</servlet-name>\n        <url-pattern>/</url-pattern>\n    </servlet-mapping>\n</web-app>\n')),(0,a.kt)("p",null,"jdbc.properties"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-properties"},"user=root\npassword=root\nurl=jdbc:mysql://127.0.0.1:3306/ydlclass?characterEncoding=utf8&serverTimezone=Asia/Shanghai\ndriverName=com.mysql.cj.jdbc.Driver\n")),(0,a.kt)("p",null,"application.xml\uff0c\u6211\u4eec\u5c06spring\u548cspringmvc\u7684\u914d\u7f6e\u7edf\u4e00\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5206\u5f00\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xmlns:mvc="http://www.springframework.org/schema/mvc"\n       xmlns:tx="http://www.springframework.org/schema/tx"\n       xmlns:mybatis="http://mybatis.org/schema/mybatis-spring"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans.xsd\n       http://www.springframework.org/schema/context\n       https://www.springframework.org/schema/context/spring-context.xsd\n       http://www.springframework.org/schema/tx\n       https://www.springframework.org/schema/tx/spring-tx.xsd\n       http://mybatis.org/schema/mybatis-spring\n       https://mybatis.org/schema/mybatis-spring.xsd\n       http://www.springframework.org/schema/mvc\n       https://www.springframework.org/schema/mvc/spring-mvc.xsd">\n    \x3c!-- \u81ea\u52a8\u626b\u5305 --\x3e\n    <context:component-scan base-package="com.ydlclass"/>\n    \n\n    \x3c!--\u6587\u4ef6\u4e0a\u4f20\u914d\u7f6e--\x3e\n    <bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver">\n        \x3c!-- \u8bf7\u6c42\u7684\u7f16\u7801\u683c\u5f0f\uff0c\u5fc5\u987b\u548cjSP\u7684pageEncoding\u5c5e\u6027\u4e00\u81f4\uff0c\u4ee5\u4fbf\u6b63\u786e\u8bfb\u53d6\u8868\u5355\u7684\u5185\u5bb9\uff0c\u9ed8\u8ba4\u4e3aISO-8859-1 --\x3e\n        <property name="defaultEncoding" value="utf-8"/>\n        \x3c!-- \u4e0a\u4f20\u6587\u4ef6\u5927\u5c0f\u4e0a\u9650\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\uff0810485760=10M\uff09 --\x3e\n        <property name="maxUploadSize" value="10485760"/>\n        <property name="maxInMemorySize" value="40960"/>\n    </bean>\n\n    \x3c!-- \u5904\u7406\u6620\u5c04\u5668 --\x3e\n    <bean class="org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping"/>\n    \x3c!-- \u5904\u7406\u5668\u9002\u914d\u5668 --\x3e\n    <bean class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"/>\n    \x3c!-- \u89c6\u56fe\u89e3\u6790\u5668,\u672c\u9879\u76ee\u53ef\u4ee5\u4e0d\u4f7f\u7528\u89c6\u56fe\u89e3\u6790\u5668--\x3e\n    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver" id="internalResourceViewResolver">\n        \x3c!-- \u524d\u7f00 --\x3e\n        <property name="prefix" value="/WEB-INF/page/"/>\n        \x3c!-- \u540e\u7f00 --\x3e\n        <property name="suffix" value=".jsp"/>\n        <property name="order" value="10"/>\n    </bean>\n\n    <bean id="customObjectMapper" class="com.ydlclass.configuration.CustomObjectMapper"/>\n    \n    \x3c!--\u5168\u5c40\u5f02\u5e38\u5904\u7406--\x3e\n    \x3c!--    <bean class="com.ydlclass.handler.GlobalExceptionResolver"/>--\x3e\n\n    <mvc:annotation-driven>\n        <mvc:message-converters>\n            <bean class="org.springframework.http.converter.json.MappingJackson2HttpMessageConverter">\n                \x3c!-- \u81ea\u5b9a\u4e49Jackson\u7684objectMapper --\x3e\n                <property name="objectMapper" ref="customObjectMapper"/>\n                \x3c!-- \u81ea\u5b9a\u4e49Jackson\u7684objectMapper --\x3e\n                <property name="supportedMediaTypes">\n                    <list>\n                        <value>text/plain;charset=UTF-8</value>\n                        <value>application/json;charset=UTF-8</value>\n                    </list>\n                </property>\n            </bean>\n        </mvc:message-converters>\n    </mvc:annotation-driven>\n\n    \x3c!--\u5904\u7406\u9759\u6001\u8d44\u6e90\uff0c\u524d\u540e\u5206\u79bb\u9879\u76ee\u4e0d\u9700\u8981\u5904\u7406\u9759\u6001\u8d44\u6e90--\x3e\n    \n\n    \x3c!--\u626b\u63cfmapper\u6587\u4ef6--\x3e\n    \x3c!--  \u8ba9springmvc\u81ea\u5e26\u7684\u6ce8\u89e3\u751f\u6548  --\x3e\n    <context:property-placeholder location="classpath:jdbc.properties"/>\n    <mybatis:scan base-package="com.ydlclass.dao"/>\n\n    \x3c!--\u6570\u636e\u6e90--\x3e\n    <bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource">\n        <property name="url" value="${url}"/>\n        <property name="driverClassName" value="${driverName}"/>\n        <property name="username" value="${user}"/>\n        <property name="password" value="${password}"/>\n    </bean>\n\n    \x3c!-- \u6574\u4e2a\u6574\u5408\u5c31\u662f\u5728\u56f4\u7ed5sqlSessionFactory --\x3e\n    <bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">\n        <property name="dataSource" ref="dataSource"/>\n        <property name="mapperLocations" value="classpath:mapper/**/*.xml"/>\n        <property name="configuration">\n            <bean class="org.apache.ibatis.session.Configuration">\n                <property name="mapUnderscoreToCamelCase" value="true"/>\n                <property name="logPrefix" value="ydlclass_"/>\n            </bean>\n        </property>\n    </bean>\n    \n    \x3c!-- \u6ce8\u5165\u4e8b\u52a1\u7ba1\u7406\u5668 --\x3e\n    <bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">\n        <property name="dataSource" ref="dataSource"/>\n    </bean>\n    \n    \x3c!-- \u58f0\u660e\u5f0f\u4e8b\u52a1 --\x3e\n    <tx:advice id="txAdvice" transaction-manager="transactionManager">\n        \x3c!-- the transactional semantics... --\x3e\n        <tx:attributes>\n            \x3c!-- all methods starting with \'get\' are read-only --\x3e\n            <tx:method name="get*" read-only="true" propagation="SUPPORTS"/>\n            <tx:method name="select*" read-only="true" propagation="SUPPORTS"/>\n            \x3c!-- other methods use the default transaction settings (see below) --\x3e\n            <tx:method name="update*" read-only="false" propagation="REQUIRED"/>\n            <tx:method name="delete*" read-only="false" propagation="REQUIRED"/>\n            <tx:method name="insert*" read-only="false" propagation="REQUIRED"/>\n        </tx:attributes>\n    </tx:advice>\n\n</beans>\n')),(0,a.kt)("p",null,"logback\u65e5\u5fd7\u7684\u914d\u7f6e\u6587\u4ef6 logback.xml\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<configuration>\n    \x3c!-- \u65e5\u5fd7\u5b58\u653e\u8def\u5f84 --\x3e\n    <property name="log.path" value="D://ydl/logs" />\n    \x3c!-- \u65e5\u5fd7\u8f93\u51fa\u683c\u5f0f --\x3e\n    <property name="log.pattern" value="%d{HH:mm:ss.SSS} [%thread] %-5level %logger{20} - [%method,%line] - %msg%n" />\n\n    \x3c!-- \u63a7\u5236\u53f0\u8f93\u51fa --\x3e\n    <appender name="console" class="ch.qos.logback.core.ConsoleAppender">\n        <encoder>\n            <pattern>${log.pattern}</pattern>\n        </encoder>\n    </appender>\n    \n    \x3c!-- \u7cfb\u7edf\u65e5\u5fd7\u8f93\u51fa --\x3e\n    <appender name="file_info" class="ch.qos.logback.core.rolling.RollingFileAppender">\n        <file>${log.path}/sys-info.log</file>\n        \x3c!-- \u5faa\u73af\u653f\u7b56\uff1a\u57fa\u4e8e\u65f6\u95f4\u521b\u5efa\u65e5\u5fd7\u6587\u4ef6 --\x3e\n        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\n            \x3c!-- \u65e5\u5fd7\u6587\u4ef6\u540d\u683c\u5f0f --\x3e\n            <fileNamePattern>${log.path}/sys-info.%d{yyyy-MM-dd}.log</fileNamePattern>\n            \x3c!-- \u65e5\u5fd7\u6700\u5927\u7684\u5386\u53f2 60\u5929 --\x3e\n            <maxHistory>60</maxHistory>\n        </rollingPolicy>\n        <encoder>\n            <pattern>${log.pattern}</pattern>\n        </encoder>\n        <filter class="ch.qos.logback.classic.filter.LevelFilter">\n            \x3c!-- \u8fc7\u6ee4\u7684\u7ea7\u522b --\x3e\n            <level>INFO</level>\n            \x3c!-- \u5339\u914d\u65f6\u7684\u64cd\u4f5c\uff1a\u63a5\u6536\uff08\u8bb0\u5f55\uff09 --\x3e\n            <onMatch>ACCEPT</onMatch>\n            \x3c!-- \u4e0d\u5339\u914d\u65f6\u7684\u64cd\u4f5c\uff1a\u62d2\u7edd\uff08\u4e0d\u8bb0\u5f55\uff09 --\x3e\n            <onMismatch>DENY</onMismatch>\n        </filter>\n    </appender>\n    \n    <appender name="file_error" class="ch.qos.logback.core.rolling.RollingFileAppender">\n        <file>${log.path}/sys-error.log</file>\n        \x3c!-- \u5faa\u73af\u653f\u7b56\uff1a\u57fa\u4e8e\u65f6\u95f4\u521b\u5efa\u65e5\u5fd7\u6587\u4ef6 --\x3e\n        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\n            \x3c!-- \u65e5\u5fd7\u6587\u4ef6\u540d\u683c\u5f0f --\x3e\n            <fileNamePattern>${log.path}/sys-error.%d{yyyy-MM-dd}.log</fileNamePattern>\n            \x3c!-- \u65e5\u5fd7\u6700\u5927\u7684\u5386\u53f2 60\u5929 --\x3e\n            <maxHistory>60</maxHistory>\n        </rollingPolicy>\n        <encoder>\n            <pattern>${log.pattern}</pattern>\n        </encoder>\n        <filter class="ch.qos.logback.classic.filter.LevelFilter">\n            \x3c!-- \u8fc7\u6ee4\u7684\u7ea7\u522b --\x3e\n            <level>ERROR</level>\n            \x3c!-- \u5339\u914d\u65f6\u7684\u64cd\u4f5c\uff1a\u63a5\u6536\uff08\u8bb0\u5f55\uff09 --\x3e\n            <onMatch>ACCEPT</onMatch>\n            \x3c!-- \u4e0d\u5339\u914d\u65f6\u7684\u64cd\u4f5c\uff1a\u62d2\u7edd\uff08\u4e0d\u8bb0\u5f55\uff09 --\x3e\n            <onMismatch>DENY</onMismatch>\n        </filter>\n    </appender>\n    \n    \x3c!-- \u7cfb\u7edf\u6a21\u5757\u65e5\u5fd7\u7ea7\u522b\u63a7\u5236  --\x3e\n    <logger name="com.ydl" level="info" />\n    \x3c!-- Spring\u65e5\u5fd7\u7ea7\u522b\u63a7\u5236  --\x3e\n    <logger name="org.springframework" level="warn" />\n\n    <root level="info">\n        <appender-ref ref="console" />\n        <appender-ref ref="file_info" />\n        <appender-ref ref="file_error" />\n    </root>\n    \n</configuration> \n')),(0,a.kt)("p",null,"\u521b\u5efaCustomObjectMapper\u6765\u914d\u7f6ejackson\u7684\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'public class CustomObjectMapper extends ObjectMapper {\n\n    public CustomObjectMapper() {\n        super();\n        //\u53bb\u6389\u9ed8\u8ba4\u7684\u65f6\u95f4\u6233\u683c\u5f0f\n        configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, false);\n        //\u8bbe\u7f6e\u4e3a\u4e1c\u516b\u533a\n        setTimeZone(TimeZone.getTimeZone("GMT+8"));\n        //\u8bbe\u7f6e\u65e5\u671f\u8f6c\u6362yyyy-MM-dd HH:mm:ss\n        setDateFormat(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"));\n        // \u8bbe\u7f6e\u8f93\u5165:\u7981\u6b62\u628aPOJO\u4e2d\u503c\u4e3anull\u7684\u5b57\u6bb5\u6620\u5c04\u5230json\u5b57\u7b26\u4e32\u4e2d\n        configure(SerializationFeature.WRITE_NULL_MAP_VALUES, false);\n        // \u7a7a\u503c\u4e0d\u5e8f\u5217\u5316\n        setSerializationInclusion(JsonInclude.Include.NON_NULL);\n        // \u53cd\u5e8f\u5217\u5316\u65f6\uff0c\u5c5e\u6027\u4e0d\u5b58\u5728\u7684\u517c\u5bb9\u5904\u7406\n        getDeserializationConfig().withoutFeatures(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES);\n        // \u5e8f\u5217\u5316\u679a\u4e3e\u662f\u4ee5toString()\u6765\u8f93\u51fa\uff0c\u9ed8\u8ba4false\uff0c\u5373\u9ed8\u8ba4\u4ee5name()\u6765\u8f93\u51fa\n        configure(SerializationFeature.WRITE_ENUMS_USING_TO_STRING, true);\n    }\n}\n')),(0,a.kt)("h3",{id:"5\u6784\u5efa\u76ee\u5f55\u7ed3\u6784\u5e76\u6d4b\u8bd5"},"5\u3001\u6784\u5efa\u76ee\u5f55\u7ed3\u6784\u5e76\u6d4b\u8bd5\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220120132303260-c2ce361e.png",alt:"image-20220120132303260"}),"image-20220120132303260"),(0,a.kt)("p",null,"\u6d4b\u8bd5controller"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Controller\npublic class TestController {\n\n    @GetMapping("user")\n    @ResponseBody\n    public User test(){\n        return new User("tom",12);\n    }\n    @ResponseBody\n    public User test(){\n        return new User("tom",12);\n    }\n\n    static class User{\n\n        String username;\n        Integer age;\n\n        public User(String username, Integer age) {\n            this.username = username;\n            this.age = age;\n        }\n\n        public String getUsername() {\n            return username;\n        }\n\n        public void setUsername(String username) {\n            this.username = username;\n        }\n\n        public Integer getAge() {\n            return age;\n        }\n\n        public void setAge(Integer age) {\n            this.age = age;\n        }\n    }\n}\n')),(0,a.kt)("p",null,"\u542f\u52a8\u6210\u529f\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220120133909069-d49b2319.png",alt:"image-20220120133909069"}),"image-20220120133909069"),(0,a.kt)("h2",{id:"\u56db\u524d\u540e\u7aef\u8054\u8c03"},"\u56db\u3001\u524d\u540e\u7aef\u8054\u8c03"),(0,a.kt)("h3",{id:"1\u8de8\u57df\u95ee\u9898"},"1\u3001\u8de8\u57df\u95ee\u9898"),(0,a.kt)("p",null,"\u5728\u524d\u7aefapp.vue\u4e2d\u4f7f\u7528mounted\u5c1d\u8bd5\u53d1\u9001\u4e00\u4e2a\u6d4b\u8bd5\u8bf7\u6c42\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"import {listUser} from '@/api/system/user'\n\nmounted(){\n    listUser().then(res => {\n        console.log(res)\n    }).catch(err => {\n        console.log(\"error\"+err)\n    })\n}\n")),(0,a.kt)("p",null,"\u8bf7\u6c42\u662f\u53d1\u9001\u4e86\uff0c\u4f46\u662f\u4e0d\u80fd\u6210\u529f\u8bf7\u6c42\uff0c\u5f88\u660e\u663e\u4ea7\u751f\u4e86\u8de8\u8d8a\u95ee\u9898\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220120135041384-2dc5f319.png",alt:"image-20220120135041384"}),"image-20220120135041384"),(0,a.kt)("h3",{id:"2\u670d\u52a1\u7aef\u89e3\u51b3\u8de8\u57df"},"2\u3001\u670d\u52a1\u7aef\u89e3\u51b3\u8de8\u57df"),(0,a.kt)("p",null,"\uff081\uff09\u5728controller\u6216\u65b9\u6cd5\u4e0a\u52a0\u5982\u4e0b\u6ce8\u89e3"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"@CrossOrigin\n")),(0,a.kt)("p",null,"\uff082\uff09\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u8fdb\u884c\u5168\u5c40\u914d\u7f6e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<mvc:cors>\n    <mvc:mapping path="/*" allowed-methods="*" allowed-origins="*"/>\n</mvc:cors>\n')),(0,a.kt)("p",null,"\u6d4b\u8bd5\uff0c\u5b8c\u6210"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220120135214717-ccb28ed9.png",alt:"image-20220120135214717"}),"image-20220120135214717"),(0,a.kt)("h3",{id:"3\u524d\u7aef\u914d\u7f6e\u4ee3\u7406"},"3\u3001\u524d\u7aef\u914d\u7f6e\u4ee3\u7406"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5c06\u670d\u52a1\u7aef\u7684api\u5168\u90e8\u5141\u8bb8\u8de8\u57df\u8bbf\u95ee\u5176\u5b9e\u5e76\u4e0d\u662f\u4e00\u4e2a\u597d\u7684\u9009\u62e9\uff0c\u6211\u4eec\u66f4\u591a\u7684\u65f6\u5019\u53ef\u4ee5\u9009\u62e9\u5728\u524d\u7aef\u670d\u52a1\u5668\u4e2d\u914d\u7f6e\u53cd\u5411\u4ee3\u7406\u5b9e\u73b0\u8de8\u57df\u3002")),(0,a.kt)("p",null,"\u5f88\u660e\u663e\uff0c\u6211\u4eec\u7684\u524d\u7aef\u5de5\u7a0b\u4e5f\u53ef\u4ee5\u5728\u4e00\u4e2a\u72ec\u7acb\u7684\u7aef\u53e3\u542f\u52a8\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u7684\u524d\u7aef\u5de5\u7a0b\u9ed8\u8ba4\u542f\u52a8\u4e86\u4e00\u4e2aweb\u9759\u6001\u670d\u52a1\u5668\u3002\u6709\u4e86\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u6211\u4eec\u7684\u601d\u8def\u4e5f\u5c31\u6709\u4e86\u3002\u5982\u4e0b\u56fe\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220215142433095-8a587e63.png",alt:"image-20220215142433095"}),"image-20220215142433095"),(0,a.kt)("p",null,"\u67e5\u9605vue-cli\u7684\u76f8\u5173\u914d\u7f6e\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://cli.vuejs.org/zh/config/%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%91%E7%8E%B0%EF%BC%8C%E5%8F%AF%E4%BB%A5vue-cli%E7%9A%84%E9%85%8D%E7%BD%AE%E6%98%AF%E5%8F%AF%E4%BB%A5%E4%BF%AE%E6%94%B9%E7%9A%84%EF%BC%8C%E5%8F%AA%E9%9C%80%E8%A6%81%E6%88%91%E4%BB%AC%E5%BB%BA%E7%AB%8B%E4%B8%80%E4%B8%AA"},"https://cli.vuejs.org/zh/config/\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u53ef\u4ee5vue-cli\u7684\u914d\u7f6e\u662f\u53ef\u4ee5\u4fee\u6539\u7684\uff0c\u53ea\u9700\u8981\u6211\u4eec\u5efa\u7acb\u4e00\u4e2aopen in new window")," vue.config.js \u914d\u7f6e\u6587\u4ef6\u6587\u4ef6\u3002"),(0,a.kt)("h4",{id:"1\u4fee\u6539vue\u7684\u7aef\u53e3\u5e76\u914d\u7f6e\u4ee3\u7406"},"\uff081\uff09\u4fee\u6539vue\u7684\u7aef\u53e3\uff0c\u5e76\u914d\u7f6e\u4ee3\u7406"),(0,a.kt)("p",null,"\u5728\u5de5\u7a0b\u7684\u6839\u76ee\u5f55\u4e0b\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\u3010vue.config.js\u3011\uff0c\u914d\u7f6e\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5c06\u6240\u6709\u7684\u8bf7\u6c42\u4ea4\u7531\u4ee3\u7406\u53d1\u9001\u5230\u540e\u7aef\u670d\u52a1\u5668\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"module.exports = {\n    devServer: {\n        port: 8088,\n        proxy: 'http://localhost:8080/ydl'\n    }\n  }\n")),(0,a.kt)("h4",{id:"2\u4fee\u6539axios\u7684\u914d\u7f6e"},"\uff082\uff09\u4fee\u6539axios\u7684\u914d\u7f6e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"// \u521b\u5efaaxios\u5b9e\u4f8b\nconst request = axios.create({\n    // axios\u4e2d\u8bf7\u6c42\u914d\u7f6e\u6709baseURL\u9009\u9879\uff0c\u8868\u793a\u8bf7\u6c42URL\u516c\u5171\u90e8\u5206\n    baseURL: 'http://localhost:8088',\n    // \u8d85\u65f6\u53d6\u6d88\n    timeout: 10000,\n    // \u8bbe\u7f6eContent-Type\uff0c\u89c4\u5b9a\u4e86\u524d\u540e\u7aef\u7684\u4ea4\u4e92\u4f7f\u7528json\n    headers: {'Content-Type': 'application/json;charset=utf-8'}\n})\n")),(0,a.kt)("p",null,"\u6d4b\u8bd5\uff0c\u6210\u529f\u3002"),(0,a.kt)("h2",{id:"\u4e94\u5173\u4e8e\u8ba4\u8bc1\u7684\u65b0\u8ba8\u8bba"},"\u4e94\u3001\u5173\u4e8e\u8ba4\u8bc1\u7684\u65b0\u8ba8\u8bba"),(0,a.kt)("p",null,"\u8ba4\u8bc1\u5c31\u662f\u6211\u4eec\u901a\u5e38\u6240\u8bf4\u7684\u767b\u9646\uff0c\u4f46\u662f\u968f\u7740\u9879\u76ee\u7ed3\u6784\u7684\u53d8\u5316\uff0c\u8ba4\u8bc1\u7684\u6a21\u5f0f\u4e5f\u4f1a\u6709\u6240\u6539\u53d8\u3002"),(0,a.kt)("h3",{id:"1\u5b8c\u6210\u7684\u767b\u9646\u9875\u9762"},"1\u3001\u5b8c\u6210\u7684\u767b\u9646\u9875\u9762"),(0,a.kt)("p",null,"\u5c06App.vue\u4fee\u6539\u5982\u4e0b\uff0c\u5c06\u7a0b\u5e8f\u7684\u5165\u53e3\u4ec5\u4ec5\u4fdd\u7559\u4e00\u4e2a",(0,a.kt)("inlineCode",{parentName:"p"},"<router-view/>"),"\uff0c\u4ee5\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528\u5355\u9875\u9762\u7684\u65b9\u5f0f\u901a\u8fc7\u8def\u7531\u8fdb\u884c\u9875\u9762\u8df3\u8f6c\u4e86\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vue"},"<template>\n  <router-view/>\n</template>\n\n<script>\n\n<\/script>\n\n<style>\n\n</style>\n")),(0,a.kt)("p",null,"\u65b0\u589e\u767b\u9646\u7ec4\u4ef6\uff0c\u5728src\u4e0b\u7684compoment\u76ee\u5f55\u65b0\u5efalogin.vue"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vue"},'<template>\n  <el-container>\n    <el-aside width="790px"\n      ><el-image\n        fit="fill"\n        :src="require(\'@/assets/image/login_left.png\')"\n      ></el-image\n    ></el-aside>\n    <el-main>\n      <el-card class="box-card login-card">\n        <span class="login-title">\u5143\u52a8\u529b\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf</span>\n        <span class="login-tip">welcome \u6b22\u8fce\u767b\u9646</span>\n        <el-form\n          ref="user"\n          :model="user"\n          label-width="80px"\n        >\n          <el-form-item label="\u7528\u6237\u540d" prop="username">\n            <el-input\n              v-model="user.username"\n              placeholder="\u8bf7\u8f93\u5165\u7528\u6237"\n            ></el-input>\n          </el-form-item>\n          <el-form-item label="\u5bc6\u7801" prop="password">\n            <el-input\n              v-model="user.password"\n              type="password"\n              placeholder="\u8bf7\u8f93\u5165\u5bc6\u7801"\n              show-password\n            ></el-input>\n          </el-form-item>\n          <el-form-item>\n            <el-button type="primary" @click="login">\u767b\u9646</el-button>\n          </el-form-item>\n        </el-form>\n      </el-card>\n    </el-main>\n  </el-container>\n</template>\n\n<script>\nexport default {\n  name: "login",\n  data() {\n    return {\n      // \u7528\u6237\u4fe1\u606f\n      url: "../../assets/image/login_left.png",\n      user: {\n        username: "admin",\n        password: "123456",\n      },\n    };\n  }\n};\n<\/script>\n\n<style scope>\n.el-image {\n  height: 885px;\n  width: 750px;\n}\n.el-main {\n  position: relative;\n}\n.login-card {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  margin: auto;\n  width: 480px;\n  height: 400px;\n  padding: 50px;\n}\n.login-title {\n  width: 459px;\n  height: 70px;\n  font-size: 40px;\n  font-family: AlibabaPuHuiTiB;\n  color: #333333;\n  line-height: 90px;\n  letter-spacing: 1px;\n  font-weight: 800;\n  display: block;\n  text-align: left;\n}\n.login-tip {\n  width: 319px;\n  height: 70px;\n  font-size: 30px;\n  font-family: PingFangSC-Regular, PingFang SC;\n  font-weight: 400;\n  color: #999999;\n  line-height: 90px;\n  letter-spacing: 1px;\n  display: block;\n  text-align: left;\n  margin-bottom: 30px;\n}\n</style>\n')),(0,a.kt)("p",null,"\u6211\u4eec\u65b0\u589e\u4e00\u4e2a\u516c\u5171\u7684css\uff0c\u5e76\u5bfc\u5165\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-css"},"html,body{\n    width: 100%;\n    height: 100%;\n    padding: 0;\n    margin: 0;\n}\n#app {\n    height: 100%;\n}\n")),(0,a.kt)("p",null,"\u5728main.js\u5bfc\u5165\u5373\u53ef\uff0c\u5bfc\u5165\u540e\u4f1a\u81ea\u52a8\u5728\u6a21\u677f\u4e2d\u5f15\u5165\u8be5css\uff0c\u4ee5\u540e\u5982\u679c\u6709\u516c\u5171\u7684css\u6837\u5f0f\uff0c\u5c31\u5728\u8fd9\u91cc\u5199\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"import '@/assets/style/common.css'\n")),(0,a.kt)("p",null,"\u6211\u4eec\u8fd8\u9700\u8981\u65b0\u589e\u4e00\u4e2a\u4e3b\u9875\u7ec4\u4ef6\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vue"},'<template>\n  <el-container>\n \n      <el-aside width="200px">\n        <el-row>\n          <el-col :span="24">\n            <el-image\n              style="\n                width: 120px;\n                height: 60px;\n                display: block;\n                margin: 40px auto;\n              "\n              fit="fill"\n              :src="require(\'@/assets/image/main_logo.png\')"\n            ></el-image>\n            <el-menu\n              active-text-color="#ffd04b"\n              background-color="#191A22"\n              class="el-menu-vertical-demo"\n              default-active="2"\n              text-color="#fff"\n            >\n              <el-sub-menu index="1">\n                <template #title>\n                  <el-icon></el-icon>\n                  <span>\u7cfb\u7edf\u7ba1\u7406</span>\n                </template>\n\n                <el-menu-item index="1-1" @click="open(\'user\')">\n                  \u7528\u6237\u7ba1\u7406</el-menu-item\n                >\n                <el-menu-item index="1-2" @click="open(\'role\')">\n                  \u89d2\u8272\u7ba1\u7406</el-menu-item\n                >\n              </el-sub-menu>\n              <el-menu-item index="2">\n                <el-icon></el-icon>\n                <span>\u5ba2\u6237\u7ba1\u7406</span>\n              </el-menu-item>\n            </el-menu>\n          </el-col>\n        </el-row>\n      </el-aside>\n      <el-container>\n        <el-header v-html="\'<button onclick=\\\'alert(1)\\\'>\u6211\u662f\u653b\u51fb\u8005\u7684\u6309\u94ae</button>\'"></el-header>\n        \x3c!--\u8fdb\u884c\u8def\u7531\u8df3\u8f6c--\x3e\n        <el-main>\n          <router-view />\n        </el-main>\n      </el-container>\n  </el-container>\n</template>\n<script setup>\n<\/script>\n\n<style scoped>\n.el-container {\n  height: 100%;\n}\n\n.el-header {\n  margin-bottom: 20px;\n  background: #e9eef3;\n}\n\n.el-footer {\n  line-height: 60px;\n}\n\n.el-aside {\n  background-color: #191a22;\n  color: var(--el-text-color-primary);\n  text-align: center;\n  line-height: 200px;\n}\n\n.el-main {\n  background-color: #fcfcfc;\n  color: var(--el-text-color-primary);\n  text-align: center;\n}\n</style>\n')),(0,a.kt)("p",null,"\u65b0\u589e\u8def\u7531\u4fe1\u606f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const routes = [{\n    name: 'login',\n    path: '/login',\n    component: () => import('@/components/login'),\n}, {\n    name: 'main',\n    alias: '/',\n    path: '/main',\n    component: () => import('@/components/main')\n}]\n")),(0,a.kt)("p",null,"\u65b0\u589eapi"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"// \u7528\u6237\u767b\u9646\nexport function login(data) {\n    return request({\n        url: '/login',\n        method: 'post',\n        data: data\n    })\n}\n")),(0,a.kt)("h3",{id:"2\u4f20\u7edf\u7684\u767b\u9646\u903b\u8f91"},"2\u3001\u4f20\u7edf\u7684\u767b\u9646\u903b\u8f91"),(0,a.kt)("p",null,"\u6839\u636e\u4f20\u7edf\u7684\u767b\u9646\u903b\u8f91\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5b9e\u73b0\uff0c\u867d\u7136\u524d\u540e\u5206\u79bb\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4ed6\u662f\u6709\u95ee\u9898\u7684\uff0c\u4f46\u6211\u4eec\u8fd8\u662f\u8981\u56de\u987e\u4e00\u4e0b\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220121163451108-77682ae2.png",alt:"image-20220121163451108"}),"image-20220121163451108"),(0,a.kt)("p",null,"\u5bf9\u4e8e\u524d\u7aef\u800c\u8a00\uff0c\u767b\u9646\u7684\u903b\u8f91\u4e0d\u5916\u4e4e\u5c31\u662f\u53d1\u9001\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u540e\u7aef\u63a5\u6536\u7528\u6237\u540d\u548c\u5bc6\u7801\u5904\u7406\u767b\u9646\u4e1a\u52a1\uff0c\u4e00\u65e6\u767b\u9646\u6210\u529f\u5c31\u8df3\u8f6c\u5230\u4e3b\u9875\u3002"),(0,a.kt)("p",null,"\u5728\u767b\u9646\u6210\u529f\u540e\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u5b58\u4e00\u4e9b\u7528\u6237\u4fe1\u606f\uff0c\u6211\u4eec\u4e0d\u59a8\u5c06\u767b\u9646\u7684\u903b\u8f91\u5b9a\u4e49\u5728vuex\u4e2d\u7684actions\u5f53\u4e2d\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"mutations: {\n    SAVE_USER(state, data) {\n        state.user = data;\n    }\n\n},\nactions: {\n    /**\n      * \u6b64\u5904\u7528\u6765\u5904\u7406\u767b\u9646\u7684\u903b\u8f91\uff0c\u5982\u679c\u767b\u9646\u6210\u529f\u4f1a\u5728vuex\u4e2d\u4fdd\u5b58\u7528\u6237\u7684\u4fe1\u606f\n      * vuex\u4e2d\u7684\u7528\u6237\u4fe1\u606f\u7528\u6765\u62a5\u7eb8\u7528\u6237\u662f\u5426\u5df2\u7ecf\u767b\u5f55\n      * @param {*} param0 \n      * @param {*} user \n      */\n    LOGIN({ commit }, user) {\n        login(user).then((res) => {\n            if (res.data.code === 200) {\n                commit('SAVE_USER', user);\n                router.push({\n                    name: \"main\"\n                });\n            }\n        });\n    }\n}\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u6ce8\u610f\u601d\u8003\uff1a"),"\u4f20\u7edf\u7684\u767b\u9646\u65b9\u5f0f\u5728\u8fd9\u91cc\u5176\u5b9e\u662f\u7ecf\u4e0d\u8d77\u63a8\u6572\uff0c\u56e0\u4e3a\u5728\u524d\u540e\u5206\u79bb\u7684\u9879\u76ee\u5f53\u4e2d\uff0c\u6211\u4eec\u7684\u524d\u7aef\u9879\u76ee\u548c\u540e\u7aef\u9879\u76ee\uff0c\u5f80\u5f80\u4e0d\u5728\u7528\u4e00\u4e2a\u57df\u5f53\u4e2d\uff08\u524d\u540e\u7aef\u7684\u9879\u76ee\u90fd\u662f\u5728\u5404\u81ea\u7684\u670d\u52a1\u5668\u4e2d\u90e8\u7f72\uff09\u3002\u6240\u4ee5\uff0c\u5728\u5f53\u524d\u7684\u73af\u5883\u4e2d\uff0ccookie\u4f1a\u5931\u6548\uff0c\u8fd9\u6837\u4f1a\u5bfc\u81f4http\u65e0\u6cd5\u901a\u8fc7session+cookie\u7684\u65b9\u5f0f\u8fdb\u884c\u4fdd\u6301\u4f1a\u8bdd\u72b6\u6001\u3002"),(0,a.kt)("h3",{id:"3\u6a21\u62df\u5347\u7ea7"},"3\u3001\u6a21\u62df\u5347\u7ea7"),(0,a.kt)("p",null,"\u5176\u5b9e\uff0c\u672c\u8d28\u4e0a\u5c31\u662f\u6bcf\u6b21\u8bf7\u6c42\u643a\u5e26\u4e00\u4e2a\u4ee4\u724c\u5c31\u597d\uff0c\u65e2\u7136cookie+session\u7684\u65b9\u5f0f\u4e0d\u5408\u9002\u4e86\uff0c\u6211\u4eec\u4e0d\u59a8\u81ea\u5df1\u6a21\u62df\u4e00\u5957\u81ea\u5df1\u7684\u767b\u5f55\u903b\u8f91\uff0c\u4f7f\u7528header+redis\u6765\u5b9e\u73b0\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220215154322742-cb23e806.png",alt:"image-20220215154322742"}),"image-20220215154322742"),(0,a.kt)("p",null,"\u76ee\u524d\u601d\u8def\u5df2\u7ecf\u57fa\u672c\u786e\u5b9a\u4e86\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u7ed9\u5927\u5bb6\u5f15\u5165\u4e00\u4e2a\u65b0\u7684\u6982\u5ff5\u3002"),(0,a.kt)("h2",{id:"\u516drbac\u6743\u9650\u7cfb\u7edf"},"\u516d\u3001RBAC\u6743\u9650\u7cfb\u7edf"),(0,a.kt)("p",null,"\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2a\u7cfb\u7edf\uff0c\u9664\u4e86\u767b\u9646\u4e5f\u5c31\u662f\u8ba4\u8bc1\u4e4b\u5916\uff0c\u8fd8\u5e94\u8be5\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u529f\u80fd\uff0c\u5c31\u662f\u9274\u6743\uff0c\u4f7f\u7528rbac\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u4e0a\u8ff0\u7684\u95ee\u9898\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u8ba4\u8bc1-\u89c4\u5b9a\u4e86\u8c01\u80fd\u591f\u767b\u9646"),(0,a.kt)("li",{parentName:"ul"},"\u9274\u6743-\u89c4\u5b9a\u4e86\u8c01\u80fd\u8bbf\u95ee\u90a3\u4e9b\u63a5\u53e3\uff0c\u6d4f\u89c8\u90a3\u4e9b\u9875\u9762\uff0c\u4f7f\u7528\u54ea\u4e9b\u529f\u80fd\uff0c")),(0,a.kt)("h3",{id:"1\u6982\u8ff0"},"1\u3001\u6982\u8ff0"),(0,a.kt)("h4",{id:"1rbac\u6a21\u578b\u6982\u8ff0"},"\uff081\uff09RBAC\u6a21\u578b\u6982\u8ff0"),(0,a.kt)("p",null,"RBAC\u6a21\u578b\uff08Role-Based Access Control\uff1a\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236\uff09\uff1a\u5176\u9274\u6743\u7684\u8fc7\u7a0b\u53ef\u4ee5\u62bd\u8c61\u5730\u6982\u62ec\u4e3a\uff1a\u8c01 \u662f \u4ec0\u4e48\u89d2\u8272 \u6709\u90a3\u4e9b\u6743\u9650"),(0,a.kt)("h4",{id:"2rbac\u7684\u7ec4\u6210"},"\uff082\uff09RBAC\u7684\u7ec4\u6210"),(0,a.kt)("p",null,"\u5728RBAC\u6a21\u578b\u91cc\u9762\uff0c\u67093\u4e2a\u57fa\u7840\u7ec4\u6210\u90e8\u5206\uff0c\u5206\u522b\u662f\uff1a",(0,a.kt)("strong",{parentName:"p"},"\u7528\u6237\u3001\u89d2\u8272\u548c\u6743\u9650\u3002")),(0,a.kt)("p",null,"RBAC\u901a\u8fc7\u5b9a\u4e49\u89d2\u8272\u7684\u6743\u9650\uff0c\u5e76\u5bf9\u7528\u6237",(0,a.kt)("strong",{parentName:"p"},"\u6388\u4e88\u67d0\u4e2a\u89d2\u8272"),"\u4ece\u800c\u6765",(0,a.kt)("strong",{parentName:"p"},"\u63a7\u5236\u7528\u6237\u7684\u6743\u9650"),"\uff0c\u5b9e\u73b0\u4e86\u7528\u6237\u548c\u6743\u9650\u7684\u903b\u8f91\u5206\u79bb\uff08\u533a\u522b\u4e8eACL\u6a21\u578b\uff09\uff0c\u6781\u5927\u5730\u65b9\u4fbf\u4e86\u6743\u9650\u7684\u7ba1\u7406"),(0,a.kt)("p",null,"\u5728\u8bb2\u89e3\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u4ecb\u7ecd\u4e00\u4e9b\u540d\u8bcd\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"User\uff08\u7528\u6237\uff09"),"\uff1a\u6bcf\u4e2a\u7528\u6237\u90fd\u6709\u552f\u4e00\u7684UID\u8bc6\u522b\uff0c\u5e76\u88ab\u6388\u4e88\u4e0d\u540c\u7684\u89d2\u8272"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Role\uff08\u89d2\u8272\uff09"),"\uff1a\u4e0d\u540c\u89d2\u8272\u5177\u6709\u4e0d\u540c\u7684\u6743\u9650\uff0c\u6bd4\u5982\uff1a\u4eba\u4e8b\u3001\u4f1a\u8ba1\u7b49"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Permission\uff08\u6743\u9650"),"\uff09\uff1a\u8bbf\u95ee\u6743\u9650\uff0c\u6bd4\u5982"),(0,a.kt)("li",{parentName:"ul"},"\u7528\u6237-\u89d2\u8272\u6620\u5c04\uff1a\u7528\u6237\u548c\u89d2\u8272\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb"),(0,a.kt)("li",{parentName:"ul"},"\u89d2\u8272-\u6743\u9650\u6620\u5c04\uff1a\u89d2\u8272\u548c\u6743\u9650\u4e4b\u95f4\u7684\u6620\u5c04")),(0,a.kt)("p",null,"\u5b83\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb\u5982\u4e0b\u56fe\u6240\u793a\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/rbacrole-based-access-control-1-cf627d72.png",alt:"img"}),"img"),(0,a.kt)("p",null,"\u4f8b\u5982\u4e0b\u56fe\uff0c\u7ba1\u7406\u5458\u548c\u666e\u901a\u7528\u6237\u88ab\u6388\u4e88\u4e0d\u540c\u7684\u6743\u9650\uff0c\u666e\u901a\u7528\u6237\u53ea\u80fd\u53bb\u4fee\u6539\u548c\u67e5\u770b\u4e2a\u4eba\u4fe1\u606f\uff0c\u800c\u4e0d\u80fd\u521b\u5efa\u7528\u6237\u548c\u51bb\u7ed3\u7528\u6237\uff0c\u800c\u7ba1\u7406\u5458\u7531\u4e8e\u88ab\u6388\u4e88\u6240\u6709\u6743\u9650\uff0c\u6240\u4ee5\u53ef\u4ee5\u505a\u6240\u6709\u64cd\u4f5c\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/rbac-demo-e1a34431.png",alt:"rbac\u8bf4\u660e\u56fe"}),"rbac\u8bf4\u660e\u56fe"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5b8c\u6210RBAC\u6a21\u578b\uff0c\u6211\u4eec\u9700\u8981\u8bbe\u8ba1\u4e94\u5f20\u8868\uff0c\u5982\u4e0b\uff1a")),(0,a.kt)("p",null,"\u7528\u6237\u8868\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- ----------------------------\n-- \u521b\u5efa\u7528\u6237\u8868\n-- ----------------------------\nDROP TABLE IF EXISTS `ydl_user`;\nCREATE TABLE `ydl_user`  (\n  `user_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '\u7528\u6237ID',\n  `user_name` varchar(30) NOT NULL COMMENT '\u7528\u6237\u8d26\u53f7',\n  `nick_name` varchar(30)  NOT NULL COMMENT '\u7528\u6237\u6635\u79f0',\n  `email` varchar(50)  NULL DEFAULT '' COMMENT '\u7528\u6237\u90ae\u7bb1',\n  `phonenumber` varchar(11)  NULL DEFAULT '' COMMENT '\u624b\u673a\u53f7\u7801',\n  `sex` char(1)  NULL DEFAULT '0' COMMENT '\u7528\u6237\u6027\u522b\uff080\u7537 1\u5973 2\u672a\u77e5\uff09',\n  `avatar` varchar(100)  NULL DEFAULT '' COMMENT '\u5934\u50cf\u5730\u5740',\n  `password` varchar(100)  NULL DEFAULT '' COMMENT '\u5bc6\u7801',\n  `status` char(1)  NULL DEFAULT '0' COMMENT '\u5e10\u53f7\u72b6\u6001\uff080\u6b63\u5e38 1\u505c\u7528\uff09',\n  `del_flag` char(1)  NULL DEFAULT '0' COMMENT '\u5220\u9664\u6807\u5fd7\uff080\u4ee3\u8868\u5b58\u5728 2\u4ee3\u8868\u5220\u9664\uff09',\n  `login_ip` varchar(128)  NULL DEFAULT '' COMMENT '\u6700\u540e\u767b\u5f55IP',\n  `login_date` datetime NULL DEFAULT NULL COMMENT '\u6700\u540e\u767b\u5f55\u65f6\u95f4',\n  `create_by` varchar(64)  NULL DEFAULT '' COMMENT '\u521b\u5efa\u8005',\n  `create_time` datetime NULL DEFAULT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `update_by` varchar(64)  NULL DEFAULT '' COMMENT '\u66f4\u65b0\u8005',\n  `update_time` datetime NULL DEFAULT NULL COMMENT '\u66f4\u65b0\u65f6\u95f4',\n  PRIMARY KEY (`user_id`) USING BTREE\n) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci COMMENT = '\u7528\u6237\u4fe1\u606f\u8868';\n\n-- ----------------------------\n-- \u589e\u52a0\u51e0\u6761\u7528\u6237\u4fe1\u606f\n-- ----------------------------\nINSERT INTO `ydl_user` VALUES (1, 'ydl_admin', '\u7ba1\u7406\u5458', '253546544@qq.com', '18888888888', '0', '', 'xxxxxx', '0', '0', '10.25.245.45', '2022-01-23 15:50:27', 'admin', '2022-01-23 15:50:48', 'ydl', '2022-01-26 15:50:53');\n")),(0,a.kt)("p",null,"\u89d2\u8272\u8868\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- ----------------------------\n-- Table structure for ydl_role\n-- ----------------------------\nDROP TABLE IF EXISTS `ydl_role`;\nCREATE TABLE `ydl_role`  (\n  `role_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '\u89d2\u8272ID',\n  `role_name` varchar(30)  NOT NULL COMMENT '\u89d2\u8272\u540d\u79f0',\n  `role_tag` varchar(30)  NULL DEFAULT NULL COMMENT '\u89d2\u8272\u6807\u7b7e',\n  `role_sort` int(4) NOT NULL COMMENT '\u663e\u793a\u987a\u5e8f',\n  `status` char(1)  NOT NULL COMMENT '\u89d2\u8272\u72b6\u6001\uff080\u6b63\u5e38 1\u505c\u7528\uff09',\n  `del_flag` char(1)  NULL DEFAULT '0' COMMENT '\u5220\u9664\u6807\u5fd7\uff080\u4ee3\u8868\u5b58\u5728 1\u4ee3\u8868\u5220\u9664\uff09',\n  `create_by` varchar(64)  NULL DEFAULT '' COMMENT '\u521b\u5efa\u8005',\n  `create_time` datetime NULL DEFAULT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `update_by` varchar(64)  NULL DEFAULT '' COMMENT '\u66f4\u65b0\u8005',\n  `update_time` datetime NULL DEFAULT NULL COMMENT '\u66f4\u65b0\u65f6\u95f4',\n  PRIMARY KEY (`role_id`) USING BTREE\n) ENGINE = InnoDB AUTO_INCREMENT = 2 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci COMMENT = '\u89d2\u8272\u4fe1\u606f\u8868' ;\n\n-- ----------------------------\n-- Records of ydl_role\n-- ----------------------------\nINSERT INTO `ydl_role` VALUES (1, '\u7ba1\u7406\u5458', NULL, 1, '0', '0', 'admin', '2022-01-28 15:57:57', 'admin', '2022-01-29 15:58:04');\n")),(0,a.kt)("p",null,"\u7528\u6237-\u89d2\u8272\u4e2d\u95f4\u8868"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- ----------------------------\n-- Table structure for sys_user_role\n-- ----------------------------\nDROP TABLE IF EXISTS `ydl_user_role`;\nCREATE TABLE `ydl_user_role`  (\n  `user_id` bigint(20) NOT NULL COMMENT '\u7528\u6237ID',\n  `role_id` bigint(20) NOT NULL COMMENT '\u89d2\u8272ID',\n  PRIMARY KEY (`user_id`, `role_id`) USING BTREE\n) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci COMMENT = '\u7528\u6237\u548c\u89d2\u8272\u5173\u8054\u8868';\n\n-- ----------------------------\n-- Records of sys_user_role\n-- ----------------------------\nINSERT INTO `ydl_user_role` VALUES (1, 1);\n")),(0,a.kt)("p",null,"\u6743\u9650\u8868\uff0c\u8fd9\u4e2a\u6743\u9650\u8868\u662f\u4e00\u4e2a\u5347\u7ea7\u540e\u6743\u9650\u8868\uff08\u6700\u7b80\u5355\u7684\u5b9e\u73b0\u6709id\u548c\u6743\u9650\u6807\u8bc6\u5c31\u53ef\u4ee5\u4e86\uff09"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- ----------------------------\n-- Table structure for ydl_menu\n-- ----------------------------\nDROP TABLE IF EXISTS `ydl_menu`;\nCREATE TABLE `ydl_menu`  (\n  `menu_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '\u83dc\u5355ID',\n  `menu_name` varchar(50)  NOT NULL COMMENT '\u83dc\u5355\u540d\u79f0',\n  `perms` varchar(50)  NULL DEFAULT NULL COMMENT '\u6743\u9650\u6807\u8bc6',\n  `parent_id` bigint(20) NULL DEFAULT 0 COMMENT '\u7236\u83dc\u5355ID',\n  `order_num` int(4) NULL DEFAULT 0 COMMENT '\u663e\u793a\u987a\u5e8f',\n  `path` varchar(200)  NULL DEFAULT '' COMMENT '\u8def\u7531\u5730\u5740',\n  `component` varchar(255)  NULL DEFAULT NULL COMMENT '\u7ec4\u4ef6\u8def\u5f84',\n  `menu_type` char(1)  NULL DEFAULT '' COMMENT '\u83dc\u5355\u7c7b\u578b\uff08M\u76ee\u5f55 C\u83dc\u5355 F\u6309\u94ae\uff09',\n  `visible` char(1)  NULL DEFAULT '0' COMMENT '\u83dc\u5355\u72b6\u6001\uff080\u663e\u793a 1\u9690\u85cf\uff09',\n  `icon` varchar(100)  NULL DEFAULT '#' COMMENT '\u83dc\u5355\u56fe\u6807',\n  `create_by` varchar(64)  NULL DEFAULT '' COMMENT '\u521b\u5efa\u8005',\n  `create_time` datetime NULL DEFAULT NULL COMMENT '\u521b\u5efa\u65f6\u95f4',\n  `update_by` varchar(64)  NULL DEFAULT '' COMMENT '\u66f4\u65b0\u8005',\n  `update_time` datetime NULL DEFAULT NULL COMMENT '\u66f4\u65b0\u65f6\u95f4',\n  PRIMARY KEY (`menu_id`) USING BTREE\n) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci COMMENT = '\u83dc\u5355\u6743\u9650\u8868' ;\n\n-- ----------------------------\n-- Records of ydl_menu\n-- ----------------------------\nINSERT INTO `ydl_menu` VALUES (1, '\u7cfb\u7edf\u7ba1\u7406', 'system', 0, 0, 'system', 'null', '1', '0', '#', '', NULL, '', NULL);\nINSERT INTO `ydl_menu` VALUES (2, '\u7528\u6237\u7ba1\u7406', 'system:user', 1, 1, 'system/user/index', NULL, '', '0', '#', '', NULL, '', NULL);\nINSERT INTO `ydl_menu` VALUES (3, '\u89d2\u8272\u7ba1\u7406', 'system:role', 1, 2, 'system/role/index', NULL, '', '0', '#', '', NULL, '', NULL);\nINSERT INTO `ydl_menu` VALUES (4, '\u83dc\u5355\u7ba1\u7406', 'system:menu', 1, 3, 'system/menu/index', NULL, '', '0', '#', '', NULL, '', NULL);\n")),(0,a.kt)("p",null,"\u89d2\u8272\u548c\u6743\u9650\u7684\u4e2d\u95f4\u8868"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"-- ----------------------------\n-- Table structure for sys_role_menu\n-- ----------------------------\nDROP TABLE IF EXISTS `ydl_role_menu`;\nCREATE TABLE `ydl_role_menu`  (\n  `role_id` bigint(20) NOT NULL COMMENT '\u89d2\u8272ID',\n  `menu_id` bigint(20) NOT NULL COMMENT '\u83dc\u5355ID',\n  PRIMARY KEY (`role_id`, `menu_id`) USING BTREE\n) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci COMMENT = '\u89d2\u8272\u548c\u83dc\u5355\u5173\u8054\u8868';\n\n-- ----------------------------\n-- Records of sys_role_menu\n-- ----------------------------\nINSERT INTO `ydl_role_menu` VALUES (1, 1);\nINSERT INTO `ydl_role_menu` VALUES (1, 2);\nINSERT INTO `ydl_role_menu` VALUES (1, 3);\nINSERT INTO `ydl_role_menu` VALUES (1, 4);\n")),(0,a.kt)("p",null,"\u518d\u672c\u5de5\u7a0b\u4e2d\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u4e00\u5f20\u8bb0\u5f55\u64cd\u4f5c\u65e5\u5fd7\u7684\u8868\uff0c\u6211\u4eec\u4e00\u8d77\u8bbe\u8ba1\u597d\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"DROP TABLE IF EXISTS `ydl_oper_log`;\nCREATE TABLE `ydl_oper_log`  (\n  `oper_id` int(11) NOT NULL AUTO_INCREMENT COMMENT '\u65e5\u5fd7\u4e3b\u952e',\n  `title` varchar(255)  COMMENT '\u64cd\u4f5c\u6a21\u5757',\n  `business_type` varchar(255)  COMMENT '\u4e1a\u52a1\u7c7b\u578b',\n  `method` varchar(255)  COMMENT 'api\u65b9\u6cd5',\n  `request_method` varchar(255)  COMMENT '\u8bf7\u6c42\u65b9\u5f0f',\n  `oper_name` varchar(255)  COMMENT '\u64cd\u4f5c\u4eba\u5458',\n  `oper_url` varchar(255)  COMMENT '\u8bf7\u6c42url',\n  `oper_ip` varchar(255)  COMMENT '\u64cd\u4f5c\u5730\u5740',\n  `status` int(11) NULL DEFAULT NULL COMMENT '\u64cd\u4f5c\u72b6\u6001',\n  `errorMsg` varchar(255)  COMMENT '\u9519\u8bef\u6d88\u606f',\n  `operTime` datetime(0) NULL DEFAULT NULL COMMENT '\u64cd\u4f5c\u65f6\u95f4',\n  PRIMARY KEY (`oper_id`) USING BTREE\n) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci COMMENT = '\u64cd\u4f5c\u65e5\u5fd7';\n")),(0,a.kt)("p",null,"\u8868\u8bbe\u8ba1\u597d\u4e4b\u540e\u4f7f\u7528\u9006\u5411\u5de5\u7a0b\uff0c\u6211\u4eec\u8fd9\u91cc\u4f7f\u7528easycode\u53cd\u5411\u751f\u6210\u57fa\u7840\u4ee3\u7801\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220303150043345-4db288fe.png",alt:"image-20220303150043345"}),"image-20220303150043345"),(0,a.kt)("h3",{id:"2\u8ba4\u8bc1"},"2\u3001\u8ba4\u8bc1"),(0,a.kt)("h4",{id:"1redis\u7684\u642d\u5efa"},"\uff081\uff09redis\u7684\u642d\u5efa"),(0,a.kt)("p",null,"\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528windows\u7248\u672c\u7684redis\uff0c\u542f\u52a8\u5373\u53ef\uff0c\u5982\u679c\u4ee5\u540e\u60f3\u4e00\u52b3\u6c38\u9038\uff0c\u53ef\u4ee5\u76f4\u63a5\u5c06redis\u8bbe\u7f6e\u6210\u4e00\u4e2a\u542f\u52a8\u670d\u52a1\u5373\u53ef\u3002"),(0,a.kt)("p",null,"\u5f00\u542f\u670d\u52a1\u7684\u547d\u4ee4\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"\u5b89\u88c5\u547d\u4ee4\uff1aredis-server.exe --service-install redis.windows.conf --loglevel verbose\n\u542f\u52a8\u670d\u52a1\u547d\u4ee4\uff1aredis-server.exe --service-start\n\u5173\u95ed\u670d\u52a1\u547d\u4ee4\uff1aredis-server.exe --service-stop\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5f15\u5165\u4f9d\u8d56")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>redis.clients</groupId>\n    <artifactId>jedis</artifactId>\n    <version>4.0.1</version>\n</dependency>\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5411\u5bb9\u5668\u6ce8\u5165\u4e00\u4e2a\u6a21\u677fbean\uff0c\u7528\u6765\u64cd\u4f5credis\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<bean id="jedisPool" class="redis.clients.jedis.JedisPool">\n    <constructor-arg name="host" value="127.0.0.1"/>\n    <constructor-arg name="port" value="6379"/>\n    <property name="minIdle" value="20" />\n    <property name="maxIdle" value="30" />\n    <property name="maxTotal" value="200"/>\n</bean>\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u7f16\u5199\u4e00\u4e2aRedisTemplate\uff0c\u7528\u6765\u5bf9redis\u8fdb\u884c\u57fa\u672c\u64cd\u4f5c\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Slf4j\npublic class  RedisTemplate {\n\n    @Resource\n    private JedisPool jedisPool;\n\n    @Resource\n    private CustomObjectMapper objectMapper;\n\n    /**\n     * \u5b58\u50a8\u666e\u901a\u5b57\u7b26\u4e32\n     * @param key\n     * @param value\n     * @param expire\n     */\n    public String set(String key, String value, Long expire) {\n        Jedis jedis = jedisPool.getResource();\n        String returnValue = null;\n        try{\n            // \u5982\u679c\u64cd\u4f5c\u6210\u529f\u4f1a\u8fd4\u56de\u201cok\u201d\u5b57\u7b26\u4e32\uff0c\n            returnValue = jedis.setex(key, expire, value);\n        }catch (JedisException e) {\n            jedisPool.returnBrokenResource(jedis);\n            log.error("Redis execution error !",e);\n        } finally {\n            jedisPool.returnResource(jedis);\n        }\n        return returnValue;\n    }\n\n    /**\n     * \u6839\u636ekey\u83b7\u5f97\u4e00\u4e2a\u5b57\u7b26\u4e32\u6570\u636e\n     * @param key\n     * @return\n     */\n    public String get(String key) {\n        Jedis jedis = jedisPool.getResource();\n        String returnValue = null;\n        try{\n            returnValue = jedis.get(key);\n        }catch (JedisException e) {\n            jedisPool.returnBrokenResource(jedis);\n            log.error("Redis execution error !",e);\n        } finally {\n            jedisPool.returnResource(jedis);\n        }\n        return returnValue;\n    }\n\n    /**\n     * \u5b58\u50a8\u5bf9\u8c61\u7c7b\u578b\u7684\u6570\u636e\n     * @param key\n     * @param object\n     * @param expire\n     * @return\n     */\n    public String setObject(String key, Object object, Long expire) {\n        Jedis jedis = jedisPool.getResource();\n        String returnValue = null;\n        try{\n            // \u8bb2object\u8fdb\u884c\u5e8f\u5217\u5316\n            String objValue = objectMapper.writeValueAsString(object);\n            // \u5982\u679c\u64cd\u4f5c\u6210\u529f\u4f1a\u8fd4\u56de\u201cok\u201d\u5b57\u7b26\u4e32\uff0c\n            returnValue = jedis.setex(key, expire, objValue);\n        }catch (JedisException | JsonProcessingException e ) {\n            jedisPool.returnBrokenResource(jedis);\n            log.error("Redis execution error !",e);\n        } finally {\n            jedisPool.returnResource(jedis);\n        }\n        return returnValue;\n    }\n\n    /**\n     * \u83b7\u53d6\u5bf9\u8c61\u7c7b\u578b\u7684\u6570\u636e\n     * @param key\n     * @param valueType\n     * @param <T>\n     * @return\n     */\n    public <T> Optional<T> getObject(String key,Class<T> valueType) {\n\n\n        Jedis jedis = jedisPool.getResource();\n        String returnValue = null;\n        try{\n            // \u5982\u679c\u64cd\u4f5c\u6210\u529f\u4f1a\u8fd4\u56de\u201cok\u201d\u5b57\u7b26\u4e32\uff0c\n            String objectValue = jedis.get(key);\n\n            return objectValue == null ? Optional.empty() : Optional.of(objectMapper.readValue(objectValue, valueType));\n        }catch (JedisException | JsonProcessingException e ) {\n            jedisPool.returnBrokenResource(jedis);\n            log.error("Redis execution error !",e);\n        } finally {\n            jedisPool.returnResource(jedis);\n        }\n        return Optional.empty();\n    }\n\n    public <T> Optional<T> getObject(String key, TypeReference<T> typeReference) {\n\n        Jedis jedis = jedisPool.getResource();\n        String returnValue = null;\n        try{\n            // \u5982\u679c\u64cd\u4f5c\u6210\u529f\u4f1a\u8fd4\u56de\u201cok\u201d\u5b57\u7b26\u4e32\uff0c\n            String objectValue = jedis.get(key);\n\n            return objectValue == null ? Optional.empty() : Optional.of(objectMapper.readValue(objectValue, typeReference));\n        }catch (JedisException | JsonProcessingException e ) {\n            jedisPool.returnBrokenResource(jedis);\n            log.error("Redis execution error !",e);\n        } finally {\n            jedisPool.returnResource(jedis);\n        }\n        return Optional.empty();\n    }\n\n\n    /**\n     * \u5220\u9664\u591a\u4e2akey\n     * @param key\n     * @return\n     */\n    public Long remove(String ...key) {\n        Jedis jedis = jedisPool.getResource();\n        String returnValue = null;\n        try{\n            // \u5982\u679c\u64cd\u4f5c\u6210\u529f\u4f1a\u8fd4\u56de\u201cok\u201d\u5b57\u7b26\u4e32\uff0c\n            return jedis.del(key);\n        }catch (JedisException e) {\n            jedisPool.returnBrokenResource(jedis);\n            log.error("Redis execution error !",e);\n        } finally {\n            jedisPool.returnResource(jedis);\n        }\n        return -1L;\n    }\n\n    public Long lpush(String key, String ...value) {\n        Jedis jedis = jedisPool.getResource();\n        long pos = -1;\n        try{\n            // \u5982\u679c\u64cd\u4f5c\u6210\u529f\u4f1a\u8fd4\u56de\u201cok\u201d\u5b57\u7b26\u4e32\uff0c\n            pos = jedis.lpush(key, value);\n        }catch (JedisException e) {\n            jedisPool.returnBrokenResource(jedis);\n            log.error("Redis execution error !",e);\n        } finally {\n            jedisPool.returnResource(jedis);\n        }\n        return pos;\n    }\n\n    public Optional<String> rpop(String key) {\n        Jedis jedis = jedisPool.getResource();\n        Optional<String> returnValue = Optional.empty();\n        try{\n            // \u5982\u679c\u64cd\u4f5c\u6210\u529f\u4f1a\u8fd4\u56de\u201cok\u201d\u5b57\u7b26\u4e32\uff0c\n            String value = jedis.rpop(key);\n            System.out.println("---------"+value);\n            returnValue = value == null ? Optional.empty() : Optional.of(value);\n        }catch (JedisException e) {\n            jedisPool.returnBrokenResource(jedis);\n            log.error("Redis execution error !",e);\n        } finally {\n            jedisPool.returnResource(jedis);\n        }\n        return returnValue;\n    }\n\n    public long llen(String key) {\n        Jedis jedis = jedisPool.getResource();\n        long llen = -1;\n        try{\n            // \u5982\u679c\u64cd\u4f5c\u6210\u529f\u4f1a\u8fd4\u56de\u201cok\u201d\u5b57\u7b26\u4e32\uff0c\n            llen = jedis.llen(key);\n        }catch (JedisException e) {\n            jedisPool.returnBrokenResource(jedis);\n            log.error("Redis execution error !",e);\n        } finally {\n            jedisPool.returnResource(jedis);\n        }\n        return llen;\n    }\n}\n')),(0,a.kt)("h4",{id:"2\u540e\u7aef\u7684\u767b\u9646\u903b\u8f91"},"\uff082\uff09\u540e\u7aef\u7684\u767b\u9646\u903b\u8f91"),(0,a.kt)("p",null,"\u5728\u767b\u9646\u903b\u8f91\u4e2d\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5c01\u88c5\u4e00\u4e2a\u767b\u9646\u7528\u6237\u7684\u5b9e\u4f53\u7c7b\uff0c\u7528\u6765\u4fdd\u5b58\u5f53\u524d\u767b\u9646\u7528\u6237\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8fd9\u4e2a\u7c7b\u53ef\u4ee5\u5c06\u6765\u7528\u6765\u505a\u767b\u9646\u65e5\u5fd7\uff0c\u9002\u5f53\u7684\u65f6\u5019\u4e5f\u53ef\u4ee5\u89c1\u5efa\u8868\uff0c\u6211\u4eec\u8fd9\u91cc\u5c31\u4e0d\u5efa\u8868\u4e86\uff0c\u4ed6\u548cuser\u8868\u4e0d\u540c\uff0cuser\u4fdd\u5b58\u7684\u662f\u4e00\u4e2a\u7528\u6237\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u770b\u5176\u4e2d\u7684\u533a\u522b\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"@Data\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\npublic class YdlLoginUser implements Serializable {\n    private static final long serialVersionUID = 1L;\n\n    /**\n     * \u7528\u6237ID\n     */\n    private Long userId;\n    /**\n     * \u7528\u6237\u552f\u4e00\u6807\u8bc6\n     */\n    private String token;\n    /**\n     * \u767b\u5f55\u65f6\u95f4\n     */\n    private Date loginTime;\n    /**\n     * \u767b\u5f55IP\u5730\u5740\n     */\n    private String ipaddr;\n\n    /**\n     * \u767b\u5f55\u5730\u70b9\n     */\n    private String loginLocation;\n    /**\n     * \u6d4f\u89c8\u5668\u7c7b\u578b\n     */\n    private String browser;\n    /**\n     * \u64cd\u4f5c\u7cfb\u7edf\n     */\n    private String os;\n    /**\n     * \u7528\u6237\u4fe1\u606f\n     */\n    private YdlUser ydlUser;\n}\n")),(0,a.kt)("p",null,"\u7f16\u5199\u767b\u9646\u76f8\u5173\u7684controller\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@PostMapping("login")\npublic ResponseEntity<YdlLoginUser> login(@RequestBody @Validated YdlUser ydlUser,BindingResult bindingResult){\n    ydlLoginUser = userService.login(ydlUser.getUserName(),ydlUser.getPassword());\n    return ResponseEntity.ok().body(ydlLoginUser);\n}\n')),(0,a.kt)("p",null,"\u5728\u5904\u7406\u767b\u9646\u903b\u8f91\u7684service\u4e2d\u4e86\uff0c\u6b64\u5904\u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u4f9d\u8d56\uff0c\u8be5\u4f9d\u8d56\u80fd\u5f88\u8f7b\u677e\u7684\u83b7\u53d6\u6d4f\u89c8\u5668\u548c\u7528\u6237\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u6bd4\u5982\u4f60\u7684\u6d4f\u89c8\u5668\u7248\u672c\uff0c\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>eu.bitwalker</groupId>\n    <artifactId>UserAgentUtils</artifactId>\n    <version>1.21</version>\n</dependency>\n")),(0,a.kt)("p",null,"\u6211\u4eec\u8fd8\u9700\u8981\u4e00\u4e2a\u53d1\u9001http\u8bf7\u6c42\u7684\u5de5\u5177\u7c7b\uff0c\u8fd9\u4e2a\u5de5\u5177\u7c7b\u53ef\u4ee5\u5f88\u8f7b\u677e\u7684\u53d1\u9001\u8bf7\u6c42\uff0c\u4ed6\u662fspring\u81ea\u5e26\u7684\uff0c\u76f4\u63a5\u6ce8\u5165\u5bb9\u5668\u5373\u53ef\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"@Configuration\npublic class RestConfiguration {\n    @Bean\n    public RestTemplate restTemplate(){\n        return new RestTemplate();\n    }\n}\n")),(0,a.kt)("p",null,"\u5177\u4f53\u7684\u767b\u9646\u903b\u8f91\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Override\npublic YdlLoginUser login(String userName, String password) throws JsonProcessingException {\n\n    // 1\u3001\u767b\u9646\uff0c\u4f7f\u7528\u7528\u6237\u540d\u67e5\u8be2\u7528\u6237\uff0c\u6ca1\u6709\u67e5\u8be2\u5230\uff0c\u8bf4\u660e\u6ca1\u6709\u8be5\u8d26\u6237\n    YdlUser ydlUser = ydlUserDao.queryByUserName(userName);\n    if(ydlUser == null) throw new UserNotFoundException("\u6267\u884c\u767b\u9646\u64cd\u4f5c\uff1a\u3010"+ userName +"\u3011\u8be5\u7528\u6237\u4e0d\u5b58\u5728");\n\n    // 2\u3001\u5982\u679c\u67e5\u5230\u4e86\uff0c\u6bd4\u8f83\u6bd4\u8f83\u5bc6\u7801\uff0c\u5bc6\u7801\u5982\u679c\u4e0d\u6b63\u786e\uff0c\u767b\u9646\u5931\u8d25\n    if(!password.equals(ydlUser.getPassword())){\n        log.info("\u6267\u884c\u767b\u9646\u64cd\u4f5c\uff1a\u3010"+ userName +"\u3011\u8be5\u7528\u6237\u5bc6\u7801\u8f93\u5165\u9519\u8bef");\n        throw new PasswordIncorrectException("\u6267\u884c\u767b\u9646\u64cd\u4f5c\uff1a\u3010"+ userName +"\u3011\u8be5\u7528\u6237\u5bc6\u7801\u8f93\u5165\u9519\u8bef");\n    }\n\n    // 3\u3001\u5982\u679c\u9a8c\u8bc1\u6210\u529f\u4e86\n\n    // (1) \u751f\u6210token\n    String token = UUID.randomUUID().toString();\n\n    HttpServletRequest request = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder.getRequestAttributes())).getRequest();\n    UserAgent userAgent = new UserAgent(request.getHeader("User-Agent"));\n\n    // \u901a\u8fc7ip\u83b7\u53d6\u5176\u6240\u5c5e\u7684\u5730\u5740\n    ResponseEntity<String> result = restTemplate.getForEntity("https://whois.pconline.com.cn/ipJson.jsp?ip="+request.getRemoteHost()+"&json=true", String.class);\n    String body = result.getBody();\n    Map<String,String> map = objectMapper.readValue(body, new TypeReference<>() {});\n\n    String location = map.get("addr")+map.get("pro")+map.get("city")+map.get("region");\n\n    // (2) \u5c01\u88c5\u4e00\u4e2aYdlLoginUser\uff0c\u4fdd\u5b58\u5728redis\n    YdlLoginUser ydlLoginUser = YdlLoginUser.builder()\n        .userId(ydlUser.getUserId())\n        .token(token)\n        .ipaddr(request.getRemoteAddr())\n        .loginTime(new Date())\n        .os(userAgent.getOperatingSystem().getName())\n        .browser(userAgent.getBrowser().getName())\n        .loginLocation(location)\n        .ydlUser(ydlUser)\n        .build();\n\n    //key\u8fdb\u884c\u5904\u7406  token:username:uuid\n\n    // 1\u3001\u6839\u636e\u7528\u6237\u540d\u751f\u6210\u4e00\u4e2akey\u524d\u7f00token:username:\n    String keyPrefix =  Constants.TOKEN_PREFIX + userName +":";\n    // 2\u3001\u67e5\u8be2token:username:\u524d\u7f00\u7684\u6570\u636e\n    Set<String> keys = redisTemplate.keys(keyPrefix + "*");\n    // 3\u3001\u5220\u9664\u539f\u6765\u7684\u6570\u636e\n    keys.forEach(key -> redisTemplate.remove(key));\n    // 4\u3001\u628a\u65b0\u7684\u6570\u636e\u52a0\u5165redis\n    redisTemplate.setObject(keyPrefix + token,ydlLoginUser,Constants.TOKEN_TIME);\n\n    return ydlLoginUser;\n}\n')),(0,a.kt)("h4",{id:"3\u524d\u7aefstore\u7684\u5904\u7406"},"\uff083\uff09\u524d\u7aefstore\u7684\u5904\u7406"),(0,a.kt)("p",null,"\u601d\u8003\uff0c\u524d\u7aef\u7684\u6570\u636e\u53ef\u4ee5\u5b58\u50a8\u5728vuex\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u5b58\u5728cookie\u4e2d\u6216\u8005storage\u5f53\u4e2d\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"vuex\uff1a\u6570\u636e\u662f\u54cd\u5e94\u5f0f\u7684\uff0c\u4f46\u662f\u5237\u65b0\u4f1a\u6e05\u7a7a\u3002"),(0,a.kt)("li",{parentName:"ul"},"cookie\u4e2d\u6216\u8005storage\uff1a\u6570\u636e\u4e0d\u662f\u54cd\u5e94\u5f0f\u7684\uff0c\u5237\u65b0\u4e0d\u5f71\u54cd\u3002")),(0,a.kt)("p",null,"\u6240\u4ee5\u4e3a\u4e86\u517c\u987e\u4e24\u8005\u7684\u4f18\u52bf\uff0c\u6211\u4eec\u90fd\u4f7f\u7528\u3002"),(0,a.kt)("p",null,"\u4e3a\u4e86\u65b9\u4fbf\u4f7f\u7528\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u5de5\u5177\u7c7b\uff0c\u8fd9\u91cc\u53ea\u5199\u4e86sessionStorage\uff0c\u4f60\u4e5f\u53ef\u4ee5\u52a0\u4e0alocalStorage:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"export default {\n    saveSessionString(key,value){\n        window.sessionStorage.setItem(key,value);\n    },\n    getSessionString(key){\n        return window.sessionStorage.getItem(key);\n    },\n    saveSessionObject(key,value){\n        window.sessionStorage.setItem(key,JSON.stringify(value));\n    },\n    getSessionObject(key){\n        return JSON.parse(window.sessionStorage.getItem(key));\n    },\n    remove(key){\n        return window.sessionStorage.removeItem(key);\n    }\n\n}\n")),(0,a.kt)("p",null,"\u5177\u4f53\u7684\u4e1a\u52a1\u903b\u8f91\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const user = {\n    state: {\n        username: '',\n        token: '',\n    },\n    getters: {\n        userIsLogin(state) {\n            return state.username !== '' && state.token !== ''\n        },\n        permissions(state) {\n            return state.permissions;\n        }\n\n    },\n    mutations: {\n        SAVE_USER(state, username) {\n            state.username = username.trim();\n        },\n        SAVE_TOKEN(state, token) {\n            state.token = token.trim();\n        },\n        SAVE_ROLES(state, roles) {\n            state.roles = roles;\n        },\n        SAVE_PERMISSIONS(state, permissions) {\n            state.permissions = permissions;\n        }\n    },\n    actions: {\n        /**\n         * \u6b64\u5904\u7528\u6765\u5904\u7406\u767b\u9646\u7684\u903b\u8f91\uff0c\u5982\u679c\u767b\u9646\u6210\u529f\u4f1a\u5728vuex\u4e2d\u4fdd\u5b58\u7528\u6237\u7684\u4fe1\u606f\n         * vuex\u4e2d\u7684\u7528\u6237\u4fe1\u606f\u7528\u6765\u62a5\u7eb8\u7528\u6237\u662f\u5426\u5df2\u7ecf\u767b\u5f55\n         * @param {*} param0 \n         * @param {*} user \n         */\n        LOGIN({commit}, user) {\n\n            login(user).then((res) => {\n                if (res.data.code === 200) {\n                    // vuex\u7684\u4f7f\u7528\u662f\u4e3a\u4e86\u4fdd\u969c\u6570\u636e\u7684\u54cd\u5e94\u5f0f\n                    commit('SAVE_USER', res.data.data.user.username);\n                    storage.saveSessionString(\"username\", res.data.data.user.username)\n                    commit('SAVE_TOKEN', res.data.data.token);\n                    storage.saveSessionString(\"token\", res.data.data.token)\n                    router.push({\n                        name: \"main\"\n                    });\n                    return new Promise(reslove => reslove(), () => { })\n                }\n            });\n        }\n}\n\nexport default user\n")),(0,a.kt)("p",null,"\u5728login.vue\u4e2d\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'methods: {\n    login() {\n        this.$store.dispatch("LOGIN", this.user).then(() => {\n            this.$store.dispatch("GET_INFO");\n        });\n    },\n},\n')),(0,a.kt)("p",null,"\u5173\u952e\u70b9\u6765\u4e86\uff0c\u767b\u9646\u4e4b\u540e\u6211\u4eec\u53ef\u4ee5\u83b7\u5f97\u767b\u9646\u7684\u6570\u636e\u8fd8\u6709\u4e00\u4e2atoken\uff0c\u6211\u4eec\u5176\u5b9e\u60f3\u7684\u662f\u6bcf\u6b21\u7684\u8bbf\u95ee\u643a\u5e26\u4e0a\u8fd9\u4e2atoken\u8fd9\u4e2a\u5e94\u8be5\u600e\u4e48\u5904\u7406\u5462\uff1f"),(0,a.kt)("p",null,"\u6211\u4eec\u9700\u8981\u4f7f\u7528axios\u7684\u62e6\u622a\u5668\uff0c\u62e6\u622a\u8bf7\u6c42\uff0c\u7ed9\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u52a0\u4e00\u4e2aheader\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"// \u6dfb\u52a0\u8bf7\u6c42\u62e6\u622a\u5668\nrequest.interceptors.request.use(function (config) {\n  // \u5728\u53d1\u9001\u8bf7\u6c42\u4e4b\u524d\u505a\u4e9b\u4ec0\u4e48\n  if (store.state.user.token) {\n    //'Bearer '\n    config.headers['Authorization'] = store.state.user.token // \u8ba9\u6bcf\u4e2a\u8bf7\u6c42\u643a\u5e26\u81ea\u5b9a\u4e49token \u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u81ea\u884c\u4fee\u6539\n  }\n  return config;\n}, function (error) {\n  // \u5bf9\u8bf7\u6c42\u9519\u8bef\u505a\u4e9b\u4ec0\u4e48\n  return Promise.reject(error);\n});\n")),(0,a.kt)("p",null,"\u8fd9\u6837\u5c31\u597d\u4e86\u5440\uff01"),(0,a.kt)("p",null,"\u90a3\u540e\u7aef\u600e\u4e48\u5224\u65ad\u5f53\u524d\u8bf7\u6c42\u7684\u7528\u6237\u662f\u5426\u5df2\u7ecf\u767b\u9646\u4e86\u5462\uff1f\u5f53\u7136\u662f\u62e6\u622a\u5668\u4e86\uff0c\u53ea\u662f\u903b\u8f91\u6709\u4e9b\u53d8\u5316\u5440\uff01"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'public class LoginInterceptor implements HandlerInterceptor {\n\n    @Resource\n    private RedisTemplate redisTemplate;\n\n    @Resource\n    private CustomObjectMapper objectMapper;\n\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        \n        // \u5224\u65ad\u6709\u6ca1\u6709Authorization\u8fd9\u4e2a\u8bf7\u6c42\u5934\uff0c\u62ff\u5230\u9996\u90e8\u4fe1\u606f\u7684Authorization\u7684\u503c\n        ResponseEntity<String> res = ResponseEntity.status(401).body("Bad Credentials!");\n        String token = request.getHeader(Constants.HEAD_AUTHORIZATION);\n\n        if (token == null) {\n            response.setStatus(401);\n            response.getWriter().write(objectMapper.writeValueAsString(res));\n            return false;\n        }\n        //        String tokenKey = Constants.TOKEN_PREFIX + request.getHeader("username")+":"+token;\n        Set<String> keys = redisTemplate.keys(Constants.TOKEN_PREFIX + "*" + token);\n        if (keys== null || keys.size() == 0){\n            response.setStatus(401);\n            response.getWriter().write(objectMapper.writeValueAsString(res));\n            return false;\n        }\n        String tokenKey = (String)keys.toArray()[0];\n        // 3\u3001\u4f7f\u7528token\u53bbredis\u4e2d\u67e5\u770b\uff0c\u6709\u6ca1\u6709\u5bf9\u5e94\u7684loginUser\n        YdlLoginUser ydlLoginUser = redisTemplate.getObject(tokenKey, new TypeReference<>() {\n        });\n        if (ydlLoginUser == null) {\n            response.setStatus(401);\n            response.getWriter().write(objectMapper.writeValueAsString(res));\n            return false;\n        }\n        // \u7ed9token\u7eed\u547d\n        redisTemplate.expire(tokenKey,Constants.TOKEN_TIME);\n\n        return true;\n    }\n}\n')),(0,a.kt)("p",null,"\u76ee\u524d\uff0c\u6211\u4eec\u7684\u524d\u540e\u7aef\u7684\u6838\u5fc3\u5185\u5bb9\u5c31\u5df2\u7ecf\u5904\u7406\u5b8c\u4e86\u3002"),(0,a.kt)("h4",{id:"4\u6570\u636e\u6821\u9a8c"},"\uff084\uff09\u6570\u636e\u6821\u9a8c"),(0,a.kt)("p",null,"1\u3001\u5728\u524d\u7aef\u5904\u7406\u8868\u5355\u6570\u636e\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220221163325047-d029903e.png",alt:"image-20220221163325047"}),"image-20220221163325047"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u9009\u9879\u5f0fapi\u7684\u5199\u6cd5\uff1a")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<el-form ref="formRef" :rules="loginRules" :model="user" label-width="60px">\n')),(0,a.kt)("p",null,"\u5b9a\u4e49\u89c4\u5219\uff0c\u5b9a\u4e49\u5728data\u4e2d\u5373\u53ef\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'loginRules: {\n    username: [\n        { required: true, trigger: "blur", message: "\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a" }\n    ],\n        password: [\n            { required: true, trigger: "blur", message: "\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a" }\n        ],\n            code: [{ required: true, trigger: "change", message: "\u9a8c\u8bc1\u7801\u4e0d\u80fd\u4e3a\u7a7a" }]\n},\n')),(0,a.kt)("p",null,"\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u5305\u88f9\u767b\u9646\u7684\u65b9\u6cd5\u8c03\u7528\u5373\u53ef\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'login() {\n    this.$$refs.formRef.validate((validate) => {\n        if (validate) {\n            // \u767b\u9646\u5b8c\u6210\u540e\u7acb\u523b\u83b7\u53d6\u7528\u6237\u7684\u4fe1\u606f\n            this.$store.dispatch("LOGIN", this.user).then(() => {\n                this.$store.dispatch("GET_INFO");\n            });\n        }\n    });\n},\n')),(0,a.kt)("p",null,"\u540e\u7aef\u7684\u6570\u636e\u6821\u9a8c"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class YdlUser extends YdlBaseEntity implements Serializable {\n    private static final long serialVersionUID = 636710183710512845L;\n    /**\n     * \u7528\u6237ID\n     */\n    private Long userId;\n    /**\n     * \u7528\u6237\u8d26\u53f7\n     */\n    @NotNull\n    @Size(min = 5,max = 15,message = "\u7528\u6237\u540d\u7684\u957f\u5ea6\u5e94\u8be5\u57285\u523015\u4e4b\u95f4")\n    private String userName;\n    /**\n     * \u7528\u6237\u6635\u79f0\n     */\n    @NotNull\n    private String nickName;\n    ....\n}\n')),(0,a.kt)("p",null,"\u4f7f\u7528BindingResult\u5bf9\u540e\u7aef\u7684\u6570\u636e\u8fdb\u884c\u6821\u9a8c\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@PostMapping("login")\npublic ResponseEntity<YdlLoginUser> login(@RequestBody @Validated YdlUser ydlUser,BindingResult bindingResult){\n    // 1\u3001\u5904\u7406\u4e0d\u5408\u6cd5\u7684\u6570\u636e\n    System.out.println(ydlUser.getUserName()+"< > \uff1c\uff1e");\n    List<ObjectError> allErrors = bindingResult.getAllErrors();\n    allErrors.forEach( error -> log.error("\u767b\u9646\u65f6\u7528\u6237\u6821\u9a8c\u5931\u8d25\uff1a{}",error.getDefaultMessage()));\n    if(allErrors.size() > 0){\n        return ResponseEntity.status(500).build();\n    }\n\n    // 2\u3001 \u6267\u884c\u767b\u9646\u903b\u8f91\n    YdlLoginUser ydlLoginUser = null;\n    try {\n        ydlLoginUser = userService.login(ydlUser.getUserName(),ydlUser.getPassword());\n    } catch (JsonProcessingException e) {\n        e.printStackTrace();\n        return ResponseEntity.status(500).build();\n    }\n    return ResponseEntity.ok().body(ydlLoginUser);\n}\n')),(0,a.kt)("h3",{id:"3\u9274\u6743"},"3\u3001\u9274\u6743"),(0,a.kt)("h4",{id:"1\u540e\u7aef\u5904\u7406\u9274\u6743"},"\uff081\uff09\u540e\u7aef\u5904\u7406\u9274\u6743"),(0,a.kt)("p",null,"\u5b9a\u4e49\u83b7\u53d6\u6743\u9650\u4fe1\u606f\u7684\u63a5\u53e3\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@GetMapping("getInfo")\npublic ResponseEntity<HashMap<String, List<String>>> getInfo() {\n    return ResponseEntity.ok(this.ydlUserService.getInfo());\n}\n')),(0,a.kt)("p",null,"\u4e09\u8868\u8054\u67e5\u67e5\u8be2\u67d0\u4e2a\u7528\u6237\u7684\u6743\u9650\u4fe1\u606f\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},'<select id="getInfo" resultMap="UserMap">\n    SELECT\n    u.user_id user_id,\n    username,\n    nick_name,\n    r.role_id,\n    r.role_name,\n    r.role_tag,\n    m.menu_id,\n    m.menu_name,\n    m.perms\n    FROM\n    ydl_user u\n    LEFT JOIN `ydl_user_role` ur ON u.user_id = ur.user_id\n    LEFT JOIN ydl_role r ON ur.role_id = r.role_id\n    LEFT JOIN ydl_role_menu rm ON r.role_id = rm.role_id\n    LEFT JOIN ydl_menu m ON rm.menu_id = m.menu_id\n    where u.del_flag = 0 and r.del_flag = 0 and u.user_id = #{userId}\n</select>\n')),(0,a.kt)("p",null,"\u5904\u7406\u83b7\u53d6\u6743\u9650\u4fe1\u606f\u7684\u4e1a\u52a1\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"@Override\npublic HashMap<String,List<String>> getInfo() {\n    // 1\u3001\u83b7\u53d6\u5f53\u524d\u767b\u9646\u7684\u5bf9\u8c61\n    YdlLoginUser loginUser = getLoginUser();\n\n    // 2\u3001\u67e5\u8be2\u5f53\u524d\u7528\u6237\u7684\u89d2\u8272\u548c\u6743\u9650\n    YdlUser info = ydlUserDao.getInfo(loginUser.getUserId());\n\n    // 3\u3001\u5904\u7406\u6743\u9650\u548c\u89d2\u8272\u7684\u76f8\u5173\u4fe1\u606f\n    // (1) roles:token : [admin,xxx,yyy]   perms:token: [system:user:add,system:user:update]\n    List<String> roleTags = info.getYdlRoles().stream().map(YdlRole::getRoleTag).collect(Collectors.toList());\n    redisTemplate.setObject(Constants.ROLE_PREFIX + loginUser.getToken(),roleTags,Constants.TOKEN_TIME);\n\n    List<String> prems = new ArrayList<>();\n    // [{roleName:cc,roleTag:xxx,perms:[{id,'xxx',perm:'system'},{id,'xxx',perm:'system'}]},{}]\n    // [[{id,'xxx',perm:'system'},{id,'xxx',perm:'system'}],[{id,'xxx',perm:'system'},{id,'xxx',perm:'system'}]]\n    // ['system','system:user:add']\n    info.getYdlRoles().stream().map(YdlRole::getYdlMenus).forEach(menus -> {\n        prems.addAll(menus.stream().map(YdlMenu::getPerms).collect(Collectors.toList()));\n    });\n    redisTemplate.setObject(Constants.PERM_PREFIX + loginUser.getToken(),prems,Constants.TOKEN_TIME);\n\n    // \u6574\u5408\u6570\u636e\n    HashMap<String,List<String>> data = new HashMap<>();\n    data.put(\"roles\",roleTags);\n    data.put(\"perms\",prems);\n\n    return data;\n}\n\n\n// \u83b7\u53d6\u5f53\u524d\u767b\u9646\u7528\u6237\u7684\u65b9\u6cd5\nprivate YdlLoginUser getLoginUser(){\n\n    HttpServletRequest request = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder.getRequestAttributes())).getRequest();\n    // \u83b7\u53d6\u9996\u90e8\u4fe1\u606f\u7684token\n    String token = request.getHeader(Constants.HEAD_AUTHORIZATION);\n\n    if (token == null) {\n        throw new RuntimeException(\"\u5f53\u524d\u7528\u6237\u672a\u767b\u5f55\uff01\");\n    }\n    Set<String> keys = redisTemplate.keys(Constants.TOKEN_PREFIX + \"*\" + token);\n    if (keys== null || keys.size() == 0){\n        throw new RuntimeException(\"\u5f53\u524d\u7528\u6237\u672a\u767b\u5f55\uff01\");\n    }\n    String tokenKey = (String)keys.toArray()[0];\n    // 3\u3001\u4f7f\u7528token\u53bbredis\u4e2d\u67e5\u770b\uff0c\u6709\u6ca1\u6709\u5bf9\u5e94\u7684loginUser\n    return redisTemplate.getObject(tokenKey, new TypeReference<>() {});\n}\n")),(0,a.kt)("p",null,"java\u5728\u5904\u7406\u6743\u9650\u4e0a\u7684\u6280\u5de7\uff1a"),(0,a.kt)("p",null,"\u6211\u4eec\u5df2\u7ecf\u83b7\u53d6\u4e86\u5f53\u524d\u767b\u9646\u7528\u6237\u7684\u6240\u6709\u6743\u9650\uff0c\u4f46\u662f\u600e\u4e48\u624d\u80fd\u4fdd\u969c\u5176\u4ed6\u6ca1\u6709\u8be5\u6743\u9650\u7684\u7528\u6237\u5c31\u4e0d\u80fd\u8bbf\u95ee\u8fd9\u4e2a\u63a5\u53e3\u5462\uff1f\u6211\u4eec\u5f53\u7136\u53ef\u4ee5\u5728\u6bcf\u4e2a\u65b9\u6cd5\u91cc\u5199\u4e0a\u5224\u65ad\u903b\u8f91\uff0c\u4f46\u662f\u663e\u7136\u662f\u6bd4\u8f83\u9ebb\u70e6\u7684\u3002"),(0,a.kt)("p",null,"\u8fd9\u91cc\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528",(0,a.kt)("strong",{parentName:"p"},"\u5207\u9762"),"\u4e86\uff0c\u5207\u9762\u7684\u6838\u5fc3\u529f\u80fd\u4e4b\u4e00\u5c31\u662f\u62bd\u79bb\u5171\u540c\u903b\u8f91\u7684\u4ee3\u7801\uff0c\u7136\u540e\u5bf9\u76ee\u6807\u65b9\u6cd5\u8fdb\u884c\u589e\u5f3a\u3002\u4e3a\u4e86\u80fd\u591f\u66f4\u52a0\u7075\u6d3b\u7684\u786e\u5b9a\u54ea\u4e9b\u63a5\u53e3\u9700\u8981\u8bbe\u7f6e\u6743\u9650\uff0c\u9700\u8981\u4ec0\u4e48\u6743\u9650\uff0c\u6211\u4eec\u4f7f\u7528\u6ce8\u89e3\u8fdb\u884c\u6807\u7684\u3002"),(0,a.kt)("p",null,"\u5b9a\u4e49\u4ee5\u4e0b\u4e24\u4e2a\u6ce8\u89e3\uff1a"),(0,a.kt)("p",null,"\u8fd9\u4e2a\u6ce8\u89e3\u7528\u6765\u6807\u8bc6\u4e00\u4e2a\u63a5\u53e3\u9700\u8981\u62e5\u6709\u4ec0\u4e48\u6743\u9650\u7684\u4eba\u624d\u80fd\u8bbf\u95ee\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface HasPermission {\n    String[] value();\n}\n")),(0,a.kt)("p",null,"\u8fd9\u4e2a\u6ce8\u89e3\u7528\u6765\u6807\u8bc6\u4e00\u4e2a\u63a5\u53e3\u9700\u8981\u62e5\u6709\u4ec0\u4e48\u89d2\u8272\u7684\u4eba\u624d\u80fd\u8bbf\u95ee\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface HasRole {\n    String[] value();\n}\n")),(0,a.kt)("p",null,"\u4f7f\u7528aop\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u5f00\u542f\u81ea\u52a8\u4ee3\u7406\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"}," <aop:aspectj-autoproxy/>\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class PermissionAspect {\n\n    @Resource\n    private RedisTemplate redisTemplate;\n\n    /**\n     * \u6267\u884c\u63a5\u53e3\u6240\u9700\u89d2\u8272\u7684\u5207\u9762\n     * @param joinPoint\n     * @param hasRole\n     */\n    @Before("@annotation(hasRole)")\n    public void roleBefore(JoinPoint joinPoint, HasRole hasRole){\n        // \u83b7\u5f97\u5f53\u524d\u65b9\u6cd5\u6240\u9700\u8981\u7684\u89d2\u8272\n        String[] needRoles = hasRole.value();\n        // \u83b7\u5f97\u62e5\u6709\u7684\u89d2\u8272\n        HttpServletRequest request = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder.getRequestAttributes())).getRequest();\n        String token = request.getHeader(Constants.HEAD_AUTHORIZATION);\n        List<String> hasRoles = redisTemplate.getObject(Constants.ROLE_PREFIX + token, new TypeReference<>() {\n        });\n        // \u53ea\u8981\u6240\u9700\u7684\u89d2\u8272\u6709\u4e00\u4e2a\u5728\u4f60\u62e5\u6709\u7684\u89d2\u8272\u4e2d\u5c31\u653e\u884c\n        boolean flag = false;\n        for (String needRole : needRoles) {\n            if (hasRoles.contains(needRole)) {\n                flag = true;\n                break;\n            }\n        }\n        if(!flag) throw new RoleNeedHasException("\u60a8\u6ca1\u6709\u8be5\u63a5\u53e3\u6240\u9700\u8981\u7684\u89d2\u8272");\n    }\n\n    @Before("@annotation(hasPermission)")\n    public void roleBefore(JoinPoint joinPoint, HasPermission hasPermission){\n        // \u83b7\u5f97\u5f53\u524d\u65b9\u6cd5\u6240\u9700\u8981\u7684\u6743\u9650\n        String[] needPermissions = hasPermission.value();\n        // \u83b7\u5f97\u62e5\u6709\u7684\u6743\u9650\n        HttpServletRequest request = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder.getRequestAttributes())).getRequest();\n        String token = request.getHeader(Constants.HEAD_AUTHORIZATION);\n        List<String> hasPermissions = redisTemplate.getObject(Constants.PERM_PREFIX + token, new TypeReference<>() {\n        });\n        // \u53ea\u8981\u6240\u9700\u7684\u89d2\u8272\u6709\u4e00\u4e2a\u5728\u4f60\u62e5\u6709\u7684\u89d2\u8272\u4e2d\u5c31\u653e\u884c\n        boolean flag = false;\n        for (String needPermission : needPermissions) {\n            if (hasPermissions.contains(needPermission)) {\n                flag = true;\n                break;\n            }\n        }\n        if(!flag) throw new PermissionNeedHasException("\u60a8\u6ca1\u6709\u8be5\u63a5\u53e3\u6240\u9700\u8981\u7684\u89d2\u8272");\n    }\n\n}\n')),(0,a.kt)("h4",{id:"2\u524d\u7aef\u5904\u7406\u9274\u6743"},"\uff082\uff09\u524d\u7aef\u5904\u7406\u9274\u6743"),(0,a.kt)("p",null,"\u524d\u7aef\u4e5f\u662f\u8981\u4fdd\u5b58\u6743\u9650\u4fe1\u606f\u7684\u3002\u524d\u7aef\u7684\u5904\u7406\u903b\u8f91\u5176\u5b9e\u5e76\u4e0d\u96be\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7v-if\u6765\u8fdb\u884c\u5224\u65ad\uff0c\u4f46\u662fv-if\u4f7f\u7528\u8d77\u6765\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6211\u4eec\u91c7\u7528\u4e00\u79cd\u65b0\u7684\u6280\u672f-\u81ea\u5b9a\u4e49\u6307\u4ee4\u3002"),(0,a.kt)("p",null,"\u9996\u5148\uff0c\u5c06\u83b7\u53d6\u7684\u6743\u9650\u4fe1\u606f\u4fdd\u5b58\u5728vuex"),(0,a.kt)("p",null,"\u5b8c\u5584\u4e00\u4e0bstore\u7684\u4ee3\u7801"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'const user = {\n    state: {\n        username: \'\',\n        token: \'\',\n        roles: [],\n        permissions: []\n    },\n    getters: {\n        userIsLogin(state) {\n            return state.username !== \'\' && state.token !== \'\'\n        },\n        permissions(state) {\n            return state.permissions;\n        }\n\n    },\n    mutations: {\n        SAVE_USER(state, username) {\n            state.username = username.trim();\n        },\n        SAVE_TOKEN(state, token) {\n            state.token = token.trim();\n        },\n        SAVE_ROLES(state, roles) {\n            state.roles = roles;\n        },\n        SAVE_PERMISSIONS(state, permissions) {\n            state.permissions = permissions;\n        }\n    },\n    actions: {\n       LOGIN({ commit }, user) {\n            return new Promise(function (resolve) {\n                login(user).then(res => {\n                    // \u9700\u8981\u5c06\u83b7\u53d6\u7684\u6570\u636e\uff0c\u4fdd\u5b58\u8d77\u6765\n                    commit("SAVE_USERNAME", res.data.ydlUser.userName);\n                    commit("SAVE_NICKNAME", res.data.ydlUser.nickName);\n                    commit("SAVE_TOKEN", res.data.token);\n                    storage.saveSessionObject("loginUser", res.data);\n                    resolve(res);\n                })\n            })\n        },\n        GET_INFO({ commit }) {\n            return new Promise(resolve => {\n                getInfo().then(res => {\n                    commit("SAVE_ROLES", res.data.roles);\n                    commit("SAVE_PERMISSIONS", res.data.perms);\n                    resolve();\n                })\n            })\n        },\n        LOGOUT({ commit }) {\n            return new Promise(function (resolve) {\n                logout().then(res => {\n                    // \u9700\u8981\u5c06\u83b7\u53d6\u7684\u6570\u636e\uff0c\u4fdd\u5b58\u8d77\u6765\n                    commit("SAVE_USERNAME", \'\');\n                    commit("SAVE_NICKNAME", \'\');\n                    commit("SAVE_TOKEN", \'\');\n                    storage.remove("loginUser");\n                    resolve(res);\n                })\n            })\n        },\n    }\n}\n\nexport default user\n')),(0,a.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u81ea\u5b9a\u4e49\u6307\u4ee4\uff0c\u5efa\u7acbdirective\u76ee\u5f55\u7528\u6765\u5b58\u653e\u65b0\u589e\u7684\u6307\u4ee4\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'import store from \'@/store\'\n\nexport default {\n    // v-hasPermissions="system:user:add,system:user:query"\n    hasPermission: {\n        mounted(el, binding) {\n            const { value } = binding\n            console.log(value)\n            const all_permission = "*:*:*";\n            const permissions = store.getters && store.getters.permissions\n            if (value && value instanceof Array && value.length > 0) {\n                const hasPermissions = permissions.some(permission => {\n                    return all_permission === permission || value.includes(permission)\n                })\n                if (!hasPermissions) {\n                    // \u79fb\u9664\u6389\u5f53\u524d\u7684element\n                    el.parentNode && el.parentNode.removeChild(el)\n                }\n            } else {\n                throw new Error(`\u8bf7\u8bbe\u7f6e\u64cd\u4f5c\u6743\u9650\u6807\u7b7e\u503c`)\n            }\n        }\n    },\n    hasRole: {\n        mounted(el, binding) {\n            const { value } = binding\n            \n            // const all_permission = "admin";\n            const permissions = store.getters && store.getters.roles\n            if (value && value instanceof Array && value.length > 0) {\n                console.log(value)\n                console.log("p--"+permissions)\n                const hasRoles = permissions.some(role => {\n                    return value.includes(role)\n                })\n                if (!hasRoles) {\n                    // \u79fb\u9664\u6389\u5f53\u524d\u7684element\n                    el.parentNode && el.parentNode.removeChild(el)\n                }\n            } else {\n                throw new Error(`\u8bf7\u8bbe\u7f6e\u64cd\u4f5c\u6743\u9650\u6807\u7b7e\u503c`)\n            }\n        }\n    }\n\n}\n')),(0,a.kt)("p",null,"\u5728main.js\u4e2d\u4fdd\u5b58"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"// \u5b89\u88c5\u6240\u6709\u7684\u81ea\u5b9a\u4e49\u6307\u4ee4\nfor(let key in directives ){\n    console.log(key)\n    app.directive(key,directives[key]);\n}\n")),(0,a.kt)("p",null,"\u4ee5\u540e\u6240\u6709\u7684\u7ec4\u4ef6\u90fd\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<el-button v-hasPermi="[\'system:user:edit\']" type="primary" :icon="Edit" >\u7f16\u8f91</el-button>\n')),(0,a.kt)("h2",{id:"\u4e03\u65e5\u5fd7\u7684\u5904\u7406"},"\u4e03\u3001\u65e5\u5fd7\u7684\u5904\u7406"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u65e5\u5fd7\u662f\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u6bd4\u8f83\u91cd\u8981\u7684\u90e8\u5206\uff0c\u7528\u6765\u8bb0\u5f55\u4e0e\u4e1a\u52a1\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u4f46\u662f\u53c8\u548c\u4e1a\u52a1\u672c\u8eab\u65e0\u5173\uff0c\u9700\u8981\u548c\u4e1a\u52a1\u4e3b\u4f53\u677e\u8026\u5408\u3002\u65e5\u5fd7\u6211\u4eec\u53ef\u4ee5\u8f93\u51fa\u5728\u63a7\u5236\u53f0\uff0c\u65e5\u5fd7\u6587\u4ef6\u4ee5\u53ca\u6570\u636e\u5e93\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u65e5\u5fd7\u7684\u8f93\u51fa\u901a\u5e38\u4f34\u968f\u7740IO\uff0c\u5176\u4e2d\u5927\u91cf\u7684\u65e5\u5fd7\u8f93\u51fa\u53ef\u80fd\u4f1a\u5bfc\u81f4\u963b\u585e\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6211\u4eec\u6709\u4e00\u5f20\u65e5\u5fd7\u8868\uff0c\u5f53\u6240\u6709\u7684\u63a5\u53e3\u90fd\u5411\u8fd9\u5f20\u8868\u63d2\u5165\u64cd\u4f5c\u6570\u636e\u7684\u65f6\u5019\u4f1a\u56e0\u4e3aupdate\u8bed\u53e5\u9891\u7e41\u9501\u8868\uff0c\u800c\u5bfc\u81f4\u4e1a\u52a1\u63a5\u53e3\u6267\u884c\u7f13\u6162\u3002\u6240\u4ee5\u6211\u4eec\u7684\u65e5\u5fd7\u8f93\u51fa\u901a\u5e38\u662f\u8981\u4f7f\u7528\u5f02\u6b65\u64cd\u4f5c\u7684\uff0c\u4f7f\u7528\u72ec\u7acb\u7684\u7ebf\u7a0b\u6c60\u6765\u5b8c\u6210\u5f02\u6b65\u65e5\u5fd7\u7684\u5904\u7406\uff0c\u8fd9\u6837\u65e5\u5fd7\u7684\u963b\u585e\u4e0d\u4f1a\u5f71\u54cd\u5176\u4ed6\u7684\u4e1a\u52a1\u3002")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220221102631555-8367ac95.png",alt:"image-20220221102631555"}),"image-20220221102631555"),(0,a.kt)("h3",{id:"1\u666e\u901a\u65e5\u5fd7"},"1\u3001\u666e\u901a\u65e5\u5fd7"),(0,a.kt)("p",null,"\u6211\u4eec\u5df2\u7ecf\u914d\u7f6e\u4e86\u65e5\u5fd7\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u901a\u7528\u7684\u65e5\u5fd7\u6211\u4eec\u9009\u62e9\u4e86slf4j+logback\u3002logback\u7684\u914d\u7f6e\u6211\u4eec\u4e0d\u518d\u8be6\u7ec6\u4ecb\u7ecd\uff0c\u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u67e5\u770b\u6211\u524d\u8fb9\u7684\u65e5\u5fd7\u76f8\u5173\u7684\u6559\u7a0b\u3002\u5f53\u7136logback\u4e5f\u662f\u652f\u6301",(0,a.kt)("strong",{parentName:"p"},"\u5f02\u6b65\u65e5\u5fd7"),"\u7684\uff0c\u5982\u679c\u9700\u8981\u53ef\u4ee5\u8fdb\u884c\u914d\u7f6e\u3002\u4f46\u662f\u6587\u4ef6\u7684\u65e5\u5fd7\u4e0d\u4f1a\u6709\u7c7b\u4f3c\u9501\u8868\u7684\u60c5\u51b5\uff0c\u4ec5\u4ec5\u5b58\u5728\u4e00\u4e9biO\uff0c\u6240\u4ee5\u6309\u7167\u516c\u53f8\u8981\u6c42\u914d\u7f6e\u5373\u53ef\u3002"),(0,a.kt)("h3",{id:"2\u6570\u636e\u5e93\u65e5\u5fd7"},"2\u3001\u6570\u636e\u5e93\u65e5\u5fd7"),(0,a.kt)("p",null,"\u6709\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u540c\u6837\u9700\u8981\u5c06\u4e00\u4e9b\u65e5\u5fd7\u8bb0\u5f55\u5728\u6570\u636e\u5e93\uff0c\u6bd4\u5982\u4e00\u4e9b\u63a5\u53e3\u8c03\u7528\u7684\u65e5\u5fd7\uff0c\u7528\u6237\u767b\u9646\u7684\u65e5\u5fd7\u7b49\u3002\u8fd9\u79cd\u65e5\u5fd7\u901a\u5e38\u6709\u4ee5\u4e0b\u51e0\u4e2a\u7279\u70b9\uff1a"),(0,a.kt)("p",null,"\uff081\uff09\u65e5\u5fd7\u7684\u6253\u5370\u65b9\u5f0f\u96f7\u540c\uff0c\u6570\u636e\u683c\u5f0f\u96f7\u540c"),(0,a.kt)("p",null,"\uff082\uff09\u65e5\u5fd7\u901a\u5e38\u65e0\u9700\u548c\u4e1a\u52a1\u8026\u5408"),(0,a.kt)("p",null,"\uff083\uff09\u65e5\u901a\u901a\u5e38\u4f34\u968fIO\uff0c\u9501\u8868\u7b49\u95ee\u9898\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u6838\u5fc3\u4e1a\u52a1\u7684\u6267\u884c"),(0,a.kt)("p",null,"\u9488\u5bf9\u4ee5\u4e0a\u7684\u95ee\u9898\uff0c\u6211\u4eec\u7684\u5904\u7406\u903b\u8f91\u901a\u5e38\u662f\u5982\u4e0b\uff0c\u8fd9\u91cc\u6211\u4eec\u4ee5\u64cd\u4f5c\u65e5\u5fd7\u4e3a\u4f8b\uff1a"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5b9a\u4e49\u5982\u4e0b\u7684\u5b9e\u4f53\u7c7b\uff0c\u6211\u4eec\u4f7f\u7528\u9006\u5411\u5de5\u7a0b\u751f\u6210\u5bf9\u5e94\u4ee3\u7801")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class OperLog implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n\n    /**\n     * \u65e5\u5fd7\u4e3b\u952e\n     */\n    private Long operId;\n\n    /**\n     * \u65e5\u5fd7\u5185\u5bb9\n     */\n    private String content;\n\n    /**\n     * \u4e1a\u52a1\u7c7b\u578b\uff080\u5176\u5b83 1\u65b0\u589e 2\u4fee\u6539 3\u5220\u9664\uff09\n     */\n    private Integer businessType;\n\n\n    /**\n     * api\u65b9\u6cd5\n     */\n    private String method;\n\n    /**\n     * \u8bf7\u6c42\u65b9\u5f0f\n     */\n    private String requestMethod;\n\n\n    /**\n     * \u64cd\u4f5c\u4eba\u5458\n     */\n    private String operName;\n\n\n    /**\n     * \u8bf7\u6c42url\n     */\n    private String operUrl;\n\n    /**\n     * \u64cd\u4f5c\u5730\u5740\n     */\n    private String operIp;\n\n    /**\n     * \u64cd\u4f5c\u72b6\u6001\uff080\u6b63\u5e38 1\u5f02\u5e38\uff09\n     */\n    private Integer status;\n\n    /**\n     * \u9519\u8bef\u6d88\u606f\n     */\n    private String errorMsg;\n\n    /**\n     * \u64cd\u4f5c\u65f6\u95f4\n     */\n    @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")\n    private Date operTime;\n\n}\n')),(0,a.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u5982\u4e0b\u6ce8\u89e3\uff0c\u7528\u6765\u8bb0\u5f55\u65e5\u5fd7\u6240\u5c5e\u7684\u6a21\u5757\uff0c\u529f\u80fd\uff0c"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface Log {\n    /**\n     * \u65e5\u5fd7\u5185\u5bb9\n     */\n    String content() default "";\n\n    /**\n     * \u529f\u80fd\n     */\n    String businessType() default "" ;\n\n}\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Slf4j\n@Aspect\n@Component\npublic class LogAspect implements BeanFactoryAware {\n\n    @Resource\n    RedisTemplate redisTemplate;\n\n    @Resource\n    CustomObjectMapper objectMapper;\n\n    @Resource\n    YdlOperLogService ydlOperLogService;\n\n    // \u4f7f\u7528BeanFactoryAware\u6ce8\u5165\u4e00\u4e2aBeanFactory\uff0c\u540e\u7eed\u6211\u4eec\u9700\u8981\u83b7\u53d6\u81ea\u8eab\u7684bean\u65f6\u4f7f\u7528\n    private BeanFactory beanFactory;\n\n    @Override\n    public void setBeanFactory(BeanFactory beanFactory) throws BeansException {\n        this.beanFactory = beanFactory;\n    }\n\n\n    /**\n     * \u5904\u7406\u5b8c\u8bf7\u6c42\u540e\u6267\u884c\n     *\n     * @param joinPoint \u5207\u70b9\n     */\n    @AfterReturning(pointcut = "@annotation(controllerLog)", returning = "result")\n    public void doAfterReturning(JoinPoint joinPoint, Log controllerLog, Object result) {\n        HttpServletRequest request = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder.getRequestAttributes())).getRequest();\n        // === handleLog\u662f\u7ecf\u8fc7\u4ee3\u7406\u7684\u5f02\u6b65\u65b9\u6cd5\uff0c\u4e0d\u80fd\u76f4\u63a5\u7b80\u5355\u7684\u8fdb\u884c\u65b9\u6cd5\u8c03\u7528\n        // === \u6b63\u786e\u7684\u8c03\u7528\u65b9\u6cd5\u662f\uff0c\u83b7\u53d6bean\u5bf9\u8c61\uff08\u8fd9\u662f\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff09\u8c03\u7528\n        LogAspect logAspect = beanFactory.getBean(LogAspect.class);\n        logAspect.handleLog(joinPoint, controllerLog, null, result, request);\n    }\n\n    /**\n     * \u62e6\u622a\u5f02\u5e38\u64cd\u4f5c\n     *\n     * @param joinPoint \u5207\u70b9\n     * @param e         \u5f02\u5e38\n     */\n    @AfterThrowing(value = "@annotation(controllerLog)", throwing = "e")\n    public void doAfterThrowing(JoinPoint joinPoint, Log controllerLog, Exception e) {\n        HttpServletRequest request = ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder.getRequestAttributes())).getRequest();\n        LogAspect logAspect = beanFactory.getBean(LogAspect.class);\n        logAspect.handleLog(joinPoint, controllerLog, e, null, request);\n    }\n\n\n    /**\n     * \u5904\u7406\u65e5\u5fd7\u7684\u903b\u8f91\n     *\n     * @param joinPoint\n     * @param controllerLog\n     * @param e\n     * @param result\n     */\n    @Async("ydlExecutor")\n    public void handleLog(final JoinPoint joinPoint, Log controllerLog, final Exception e, Object result, HttpServletRequest request) {\n        try {\n            // \u83b7\u53d6\u5f53\u524d\u7684\u7528\u6237\n            Optional<LoginUser> loginUser = redisTemplate.getObject(Constants.TOKEN_PREFIX + request.getHeader(Constants.HEADER_AUTH), LoginUser.class);\n\n            loginUser.ifPresent(user -> {\n                // ========\u6570\u636e\u5e93\u65e5\u5fd7=========//\n                YdlOperLog ydlOperLog = new YdlOperLog();\n                // \u8bbe\u7f6e\u4e00\u4e9b\u57fa\u672c\u4fe1\u606f\n                ydlOperLog.setStatus(500);\n                ydlOperLog.setOperIp(user.getIpaddr());\n                ydlOperLog.setOperUrl(request.getRequestURI());\n                ydlOperLog.setOperName(user.getUser().getUsername());\n\n                if (e != null) {\n                    ydlOperLog.setStatus(200);\n                    ydlOperLog.setErrorMsg(e.getMessage().substring(0, 2000));\n                }\n                // \u8bbe\u7f6e\u65b9\u6cd5\u540d\u79f0\n                String className = joinPoint.getTarget().getClass().getName();\n                String methodName = joinPoint.getSignature().getName();\n                ydlOperLog.setMethod(className + "." + methodName + "()");\n                // \u8bbe\u7f6e\u8bf7\u6c42\u65b9\u5f0f\n                ydlOperLog.setRequestMethod(request.getMethod());\n                // \u5904\u7406\u8bbe\u7f6e\u6ce8\u89e3\u4e0a\u7684\u53c2\u6570\n                // \u8bbe\u7f6eaction\u52a8\u4f5c\n                ydlOperLog.setBusinessType(controllerLog.businessType());\n                // \u8bbe\u7f6e\u6807\u9898\n                ydlOperLog.setContent(controllerLog.content());\n                ydlOperLog.setOperTime(new Date());\n                // \u4fdd\u5b58\u6570\u636e\u5e93\n                ydlOperLogService.insert(ydlOperLog);\n            });\n        } catch (Exception exp) {\n            // \u8bb0\u5f55\u672c\u5730\u5f02\u5e38\u65e5\u5fd7\n            log.error("==\u524d\u7f6e\u901a\u77e5\u5f02\u5e38==");\n            log.error("\u5f02\u5e38\u4fe1\u606f:{}", exp.getMessage());\n            exp.printStackTrace();\n        }\n    }\n}\n')),(0,a.kt)("p",null,"\u5f53\u7136\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u81ea\u5df1\u521b\u5efa\u7ebf\u7a0b\u6c60\uff0c\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * \u7ebf\u7a0b\u6c60\u914d\u7f6e\n **/\n@Configuration\npublic class ThreadPoolConfig\n{\n    // \u6838\u5fc3\u7ebf\u7a0b\u6c60\u5927\u5c0f\n    private int corePoolSize = 50;\n\n    // \u6700\u5927\u53ef\u521b\u5efa\u7684\u7ebf\u7a0b\u6570\n    private int maxPoolSize = 200;\n\n    // \u961f\u5217\u6700\u5927\u957f\u5ea6\n    private int queueCapacity = 1000;\n\n    // \u7ebf\u7a0b\u6c60\u7ef4\u62a4\u7ebf\u7a0b\u6240\u5141\u8bb8\u7684\u7a7a\u95f2\u65f6\u95f4\n    private int keepAliveSeconds = 300;\n\n    @Bean(name = "threadPoolTaskExecutor")\n    public ThreadPoolExecutor threadPoolExecutor()\n    {\n        xxxxxx;\n        return executor;\n    }\n}\n')),(0,a.kt)("h2",{id:"\u516b\u8868\u5355\u91cd\u590d\u63d0\u4ea4"},"\u516b\u3001\u8868\u5355\u91cd\u590d\u63d0\u4ea4"),(0,a.kt)("p",null,"\u8fd9\u4e2a\u95ee\u9898\u901a\u5e38\u4e5f\u53eb\u505a",(0,a.kt)("strong",{parentName:"p"},"\u5e42\u7b49\u6027\u95ee\u9898"),"\uff0c\u5c31\u662f\u540c\u4e00\u4e2a\u8bf7\u6c42\u3010\u591a\u6b21\u63d0\u4ea4\u3011\u7684\u6548\u679c\u548c\u3010\u4e00\u6b21\u63d0\u4ea4\u3011\u7684\u6548\u679c\u4e00\u6837\uff0c\u4ea7\u751f\u8fd9\u79cd\u95ee\u9898\u7684\u539f\u56e0\u53ef\u80fd\u662f\u56e0\u4e3a\u7f51\u7edc\u6296\u52a8\uff0c\u7528\u6237\u591a\u6b21\u63d0\u4ea4\uff0c\u7528\u6237\u9519\u8bef\u64cd\u4f5c\uff0c\u5982\u75af\u72c2\u5237\u65b0\u6d4f\u89c8\u5668\uff0c\u6216\u8005\u6709\u4eba\u6545\u610f\u4e3a\u4e4b\u7b49\u3002"),(0,a.kt)("p",null,"\u89e3\u51b3\u8868\u5355\u91cd\u590d\u63d0\u4ea4\u7684\u65b9\u5f0f\u5176\u5b9e\u6709\u5f88\u591a\uff0c\u5728\u8fd9\u4e2a\u95ee\u9898\u4e0a\uff0c\u6211\u4eec\u5176\u5b9e\u6709\u5f88\u591a\u53ef\u4ee5\u601d\u8003\u7684\u5730\u65b9\uff1a"),(0,a.kt)("p",null,"1\u3001\u5982\u679c\u662f\u524d\u7aef\u8868\u5355\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u6210\u8fd9\u4e2a\u6837\u5b50\uff1a\u63d0\u4ea4\u6309\u94ae\u70b9\u51fb\u540e\u53d8\u4e3adisable\u7684\uff08\u65e0\u6cd5\u91cd\u590d\u70b9\u51fb\uff0c\u4f46\u8fd9\u662f\u4e00\u4e2a\u6cbb\u6807\u4e0d\u6cbb\u672c\u7684\u65b9\u6848\uff09\uff0c\u4fdd\u8bc1\u8868\u5355\u53ea\u80fd\u63d0\u4ea4\u4e00\u6b21\uff0c\u4f46\u662f\u6c38\u8fdc\u8981\u8bb0\u4f4f\u524d\u7aef\u7684\u4e00\u5207\u90fd\u662f\u7ed9\u666e\u901a\u4eba\u8bbe\u8ba1\u7684\uff0c\u662f\u65e0\u6cd5\u9632\u6b62\u6076\u610f\u653b\u51fb\u8005\u7684\u3002"),(0,a.kt)("p",null,"2\u3001\u540e\u7aef\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u6700\u7b80\u5355\u7684\u5c31\u662f\u5728\u6570\u636e\u5e93\u8bbe\u7f6e\u552f\u4e00\u7ea6\u675f\uff0c\u5982\u679c\u662f\u91cd\u590d\u7684\u63d0\u4ea4\uff0c\u6570\u636e\u5e93\u5c42\u9762\u5c31\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u65e0\u6cd5\u4fdd\u5b58\u3002"),(0,a.kt)("p",null,"3\u3001\u6709\u6ca1\u6709\u66f4\u9ad8\u7ea7\uff0c\u666e\u9002\u4e00\u70b9\u7684\u60f3\u6cd5\uff1f\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u62ff\u4e2a\u672c\u5b50\u8bb0\u5f55\u4e00\u4e0b\uff0c\u6700\u8fd15\u79d2\u5185\u6709\u54ea\u4e9b\u63a5\u53e3\u88ab\u8c03\u7528\u8fc7\uff0c\u63a5\u53e3\u88ab\u8c03\u7528\u65f6\uff0c\u5148\u53bb\u672c\u5b50\u91cc\u67e5\u4e00\u4e0b\uff0c\u6709\u7684\u8bdd\u5c31\u963b\u6b62\u7ee7\u7eed\u6267\u884c\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u4eca\u5929\u6211\u4eec\u5c31\u9009\u53d6\u8fd9\u4e2d\u65b9\u6848\uff1a")),(0,a.kt)("p",null,"\uff081\uff09\u6211\u4eec\u9996\u5148\u5b9a\u4e49\u4e00\u4e2a\u6ce8\u89e3\uff0c\u4ee5\u540e\u7684controller\u4e2d\u7684\u63a5\u53e3\u5982\u679c\u9700\u8981\u9632\u91cd\u590d\u63d0\u4ea4\u5c31\u52a0\u4e0a\u8fd9\u4e2a\u6ce8\u89e3\uff1a"),(0,a.kt)("p",null,"\u6ce8\u89e3\u4e2d\u7684value\u4ee3\u8868\u6211\u4eec\u9632\u6b62\u91cd\u590d\u63d0\u4ea4\u7684\u9ed8\u8ba4\u65f6\u95f4\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface Repeat {\n    long value() default 10;\n}\n")),(0,a.kt)("p",null,"\u6ce8\u89e3\u901a\u5e38\u53ef\u4ee5\u4f7f\u7528\u5728add\uff0cupdate\u8fd9\u4e00\u7c7b\u63a5\u53e3\u4e0a\uff0cdelete\u548cquery\u662f\u6ca1\u6709\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a\u8fd9\u4e24\u79cd\u63a5\u53e3\u672c\u8eab\u5c31\u662f\u5e42\u7b49\u6027\u7684\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"@Repeat(5)\npublic ResponseEntity<YdlUser> add(@RequestBody YdlUser ydlUser)\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * @author itnanls(\u5fae\u4fe1)\n * \u6211\u4eec\u7684\u670d\u52a1\uff1a \u4e00\u8def\u966a\u8dd1\uff0c\u987a\u5229\u5c31\u4e1a\n */\npublic class RepeatSubmitInterceptor implements HandlerInterceptor {\n    @Resource\n    private RedisTemplate redisTemplate;\n\n    @Resource\n    private CustomObjectMapper customObjectMapper;\n\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        if (handler instanceof HandlerMethod) {\n            // \u83b7\u53d6\u6211\u4eec\u7684controller\u65b9\u6cd5\n            HandlerMethod handlerMethod = (HandlerMethod) handler;\n            Method method = handlerMethod.getMethod();\n            // \u5224\u65ad\u662f\u5426\u6709\u9632\u6b62\u91cd\u590d\u63d0\u4ea4\u7684\u6ce8\u89e3\n            Repeat annotation = method.getAnnotation(Repeat.class);\n            if (annotation != null) {\n                if (this.isRepeatSubmit(request, annotation)) {\n                    // \u5982\u679c\u786e\u5b9a\u662f\u91cd\u590d\u63d0\u4ea4\uff0c\u76f4\u63a5\u54cd\u5e94\u5931\u8d25\n                    ResponseEntity<String> body = ResponseEntity.status(500).body("\u60a8\u91cd\u590d\u63d0\u4ea4\u4e86\u5f53\u524d\u7684\u8bf7\u6c42\uff01");\n                    response.setStatus(500);\n                    response.setContentType("application/json;charset=utf-8");\n                    response.getWriter().write(customObjectMapper.writeValueAsString(body));\n                    return false;\n                }\n            }\n            return true;\n        } else {\n            return true;\n        }\n    }\n\n    public boolean isRepeatSubmit(HttpServletRequest request, Repeat annotation) throws IOException {\n        // \u83b7\u53d6\u53c2\u6570\u5217\u8868\uff0c\u5e76\u5e8f\u5217\u5316\n        String nowParams = customObjectMapper.writeValueAsString(request.getParameterMap());\n\n        // \u8bf7\u6c42\u5730\u5740\uff08\u4f5c\u4e3a\u5b58\u653ecache\u7684key\u503c\uff09\n        String url = request.getRequestURI();\n\n        // \u552f\u4e00\u503c\uff08\u6ca1\u6709\u6d88\u606f\u5934\u5219\u4f7f\u7528\u8bf7\u6c42\u5730\u5740\uff09\n        String token = request.getHeader(Constants.HEAD_AUTHORIZATION);\n\n        // \u83b7\u5f97body\u7684\u6570\u636e\n\n        // \u552f\u4e00\u6807\u8bc6\uff08\u6307\u5b9akey + url + \u6d88\u606f\u5934\uff09\n        String cacheRepeatKey = Constants.REPEAT_SUBMIT_KEY  + token + ":" + url;\n        // \u5982\u679credis\u4e2d\u6ca1\u6709\u5b58\u5728\u8fd9\u4e2akey\uff0c\u8bf4\u660e\u8fd9\u4e2a\u8bf7\u6c42\u662f\u91cd\u590d\u63d0\u4ea4\n        String preParams = redisTemplate.get(cacheRepeatKey);\n\n        if (preParams != null && preParams.equals(nowParams)) {\n            return true;\n        }\n        // \u5426\u5219\u6211\u5c31\u5b58\u5165redis\uff0c\u6ce8\u610f\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\n        redisTemplate.set(cacheRepeatKey, nowParams, annotation.value());\n        return false;\n    }\n}\n')),(0,a.kt)("h2",{id:"\u4e5d\u9632\u6b62xss\u653b\u51fb"},"\u4e5d\u3001\u9632\u6b62xss\u653b\u51fb"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"XSS\u653b\u51fb\u901a\u5e38\u6307\u7684\u662f\u901a\u8fc7\u5229\u7528\u7f51\u9875\u5f00\u53d1\u65f6\u7559\u4e0b\u7684\u6f0f\u6d1e\uff0c\u6ce8\u5165\u6076\u610f\u6307\u4ee4\u4ee3\u7801\u5230\u7f51\u9875\uff0c\u4f7f\u7528\u6237\u52a0\u8f7d\u5e76\u6267\u884c\u653b\u51fb\u8005\u6076\u610f\u5236\u9020\u7684\u7f51\u9875\u7a0b\u5e8f\u3002\u8fd9\u4e9b\u6076\u610f\u7f51\u9875\u7a0b\u5e8f\u901a\u5e38\u662fJavaScript\uff0c\u653b\u51fb\u6210\u529f\u540e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u5f97\u5230\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u66f4\u9ad8\u7684\u6743\u9650\uff08\u5982\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\uff09\u3001\u79c1\u5bc6\u7f51\u9875\u5185\u5bb9\u3001\u4f1a\u8bdd\u548ccookie\u7b49\u5404\u79cd\u5185\u5bb9\u3002 ","[1]"),(0,a.kt)("li",{parentName:"ul"},"\u4f8b\u5982\u5728\u6ce8\u518c\u7528\u6237\u7684\u65f6\u5019\uff0c\u6216\u8005\u4e00\u4e9b\u6587\u7ae0\u4e2d\uff0c\u52a0\u5165\u4e00\u4e9bscript\u811a\u672c",(0,a.kt)("inlineCode",{parentName:"li"},"<a href=\"javascript:alert(\\'ydl\\')\" />http://www.ydlclass.com</a>"),"\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u9632\u4e0d\u80dc\u9632\uff0c\u6216\u8005\u662f\u4e00\u4e9b\u5176\u4ed6\u7684\u6807\u7b7e\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u76ee\u524d\uff0c\u5f88\u591a\u7ec4\u4ef6\u6216\u8005\u6846\u67b6\u5176\u5b9e\u5df2\u7ecf\u5bf9\u5927\u90e8\u5206\u7684xss\u653b\u51fb\u505a\u4e86\u9632\u5fa1\u63aa\u65bd\uff0c\u4f8b\u5982\u5728vue\u4e2d\u9664\u975e\u6211\u4eec\u4f7f\u7528v-hmtl\u8fd9\u7c7b\u6807\u7b7e\uff0c\u5426\u8fd9\u4e00\u8fb9\u7684xss\u653b\u51fb\u662f\u6ca1\u6709\u6548\u679c\u7684\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u7684\u9879\u76ee\u6ca1\u6709\u4f7f\u7528vue\uff0c\u800c\u662f\u4f7f\u7528\u539f\u751f\u7684html\u90a3\u4e48\u5c31\u53ef\u80fd\u4ea7\u751f\u95ee\u9898\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u89e3\u51b3xss\u653b\u51fb\u7684\u6838\u5fc3\u65b9\u6cd5\u5c31\u662f\u5904\u7406\u6389\u90a3\u4e9b\u53ef\u80fd\u4ea7\u751f\u95ee\u9898\u7684\u6807\u7b7e\uff0c\u6216\u8005\u901a\u8fc7",(0,a.kt)("strong",{parentName:"li"},"\u8f6c\u4e49"),"\uff0c\u6216\u8005\u5c06",(0,a.kt)("strong",{parentName:"li"},"\u534a\u89d2\u7684\u5c16\u62ec\u53f7\u8f6c\u5316\u4e3a\u5168\u89d2"),"\uff0c\u5728\u6216\u8005\u76f4\u63a5\u5e72\u6389\u4e00\u4e9b\u7279\u6b8a\u6807\u7b7e\u3002")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a"),"\u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u600e\u4e48\u4fdd\u8bc1\u6bcf\u4e00\u4e2a\u8bf7\u6c42\u4e2d\u643a\u5e26\u7684\u6570\u636e\u90fd\u8fdb\u884c\u4e00\u4e2a\u8f6c\u5316\uff0c\u4e0b\u8fb9\u662f\u4e00\u4e2a\u8bf7\u6c42\u7684\u6d41\u8f6c\u8fc7\u7a0b\uff1f"),(0,a.kt)("p",null,"\u4e00\u4e2a\u8bf7\u6c42\u62a5\u6587\u5230\u8fbetomcat\u4e4b\u540e\u4f1a\u88ab\u5c01\u88c5\u6210\u4e00\u4e2arequest\u5bf9\u8c61"),(0,a.kt)("p",null,"1\u3001\u8bf7\u6c42\u5230\u8fbe\u8fc7\u6ee4\u5668\u80fd\u4e0d\u80fd\u66ff\u6362\uff1f\u53ef\u4ee5\uff0c\u800c\u4e14\u65b9\u4fbf\uff0c\u6539\u5934\u6362\u9762\u6700\u597d\u5728\u95e8\u53e3\u5c31\u5904\u7406\u597d\u4e86\u3002"),(0,a.kt)("p",null,"2\u3001\u8bf7\u6c42\u5230\u8fbedispatcherServlet\u540e\u80fd\u4e0d\u80fd\u66ff\u6362\uff1f\u4e0d\u597d\u66ff\u6362\uff0c\u4e8b\u5b9e\u4e0a\u4e5f\u884c\uff0c\u6211\u4eec\u7ee7\u627fdispatcherServlet\u7136\u540e\u91cd\u5199\u4ed6\u7684\u4e00\u4e9b\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u4e86\uff0c\u4e0d\u5efa\u8bae\uff1f"),(0,a.kt)("p",null,"3\u3001\u8bf7\u6c42\u5230\u8fbecontroller\u540e\u80fd\u4e0d\u80fd\u66ff\u6362\uff1f\u80fd\uff0c\u4f46\u662f\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u8981\u6267\u884c\u5904\u7406\u903b\u8f91\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220221132911696-3472019b.png",alt:"image-20220221132911696"}),"image-20220221132911696"),(0,a.kt)("p",null,"\u9996\u5148\uff0c\u6211\u4eec\u5148\u7f16\u5199\u4e00\u4e2a\u5de5\u5177\u7c7b\u7528\u6765\u5904\u7406\u5b57\u7b26\u4e32\u4e2d\u7684\u6807\u7b7e\uff0c\u6211\u4eec\u53ea\u505a\u7b80\u5355\u5904\u7406\uff0c\u5c06\u534a\u89d2\u7684\u5c16\u62ec\u53f7\u8f6c\u5316\u4e3a\u5168\u89d2\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"public class XssUtil {\n    /**\n     * \u5c06\u5bb9\u6613\u5f15\u8d77xss\u6f0f\u6d1e\u7684\u534a\u89d2\u5b57\u7b26\u76f4\u63a5\u66ff\u6362\u6210\u5168\u89d2\u5b57\u7b26\n     * @param s\n     * @return\n     */\n    public static String xssEncode(String s) {\n        if (s == null || \"\".equals(s)) {\n            return s;\n        }\n        StringBuilder sb = new StringBuilder(s.length() + 16);\n        for (int i = 0; i < s.length(); i++) {\n            char c = s.charAt(i);\n            switch (c) {\n                case '>':\n                    sb.append('\uff1e');//\u5168\u89d2\u5927\u4e8e\u53f7\n                    break;\n                case '<':\n                    sb.append('\uff1c');//\u5168\u89d2\u5c0f\u4e8e\u53f7\n                    break;\n                case '\\'':\n                    sb.append('\u2018');//\u5168\u89d2\u5355\u5f15\u53f7\n                    break;\n                case '\\\"':\n                    sb.append('\u201c');//\u5168\u89d2\u53cc\u5f15\u53f7\n                    break;\n                case '&':\n                    sb.append('\uff06');//\u5168\u89d2\n                    break;\n                case '\\\\':\n                    sb.append('\uff3c');//\u5168\u89d2\u659c\u7ebf\n                    break;\n                case '#':\n                    sb.append('\uff03');//\u5168\u89d2\u4e95\u53f7\n                    break;\n                default:\n                    sb.append(c);\n                    break;\n            }\n        }\n        return sb.toString();\n    }\n\n}\n")),(0,a.kt)("p",null,"\u6211\u4eec\u5bf9request\u8fdb\u884c\u4e00\u4e2a\u5305\u88c5\uff0c\u5728\u5305\u88c5\u7684request\u4e2d\u5c06\u53c2\u6570\u7edf\u4e00\u8fdb\u884c\u5904\u7406\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"public class XssHttpServletRequestWrapper extends HttpServletRequestWrapper {\n\n    private final HttpServletRequest orgRequest;\n\n    public XssHttpServletRequestWrapper(HttpServletRequest request) {\n        super(request);\n        orgRequest = request;\n    }\n\n    // \u91cd\u5199\u8fd9\u51e0\u4e2a\u65b9\u6cd5\uff0c\u5e76\u4e14\u5904\u7406xss\n    @Override\n    public String getParameter(String name) {\n        return XssUtil.xssEncode(super.getParameter(XssUtil.xssEncode(name)));\n    }\n\n    @Override\n    public Map<String, String[]> getParameterMap() {\n        Map<String, String[]> parameterMap = super.getParameterMap();\n        Map<String, String[]> newParameterMap = new HashMap<>(8);\n        for(Map.Entry<String, String[]> entry : parameterMap.entrySet()){\n            // \u5904\u7406key\u7684\u6807\u7b7e\n            String newKey = XssUtil.xssEncode(entry.getKey());\n            // \u5904\u7406value\u7684\u6807\u7b7e\n            String[] params = entry.getValue();\n            String[] newParams = new String[params.length];\n            for (int i = 0; i < params.length; i++) {\n                newParams[i] = XssUtil.xssEncode(params[i]);\n            }\n            newParameterMap.put(newKey,newParams);\n        }\n        return newParameterMap;\n    }\n\n    @Override\n    public String[] getParameterValues(String name) {\n        String[] parameterValues = super.getParameterValues(XssUtil.xssEncode(name));\n        String[] newParams = new String[parameterValues.length];\n        for (int i = 0; i < parameterValues.length; i++) {\n            newParams[i] = XssUtil.xssEncode(parameterValues[i]);\n        }\n        return newParams;\n    }\n\n    // \u5982\u679c\u5c06\u6765\u60f3\u7ee7\u7eed\u4f7f\u7528\u539f\u59cb\u7684request\uff0c\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u65b9\u6cd5\u83b7\u53d6\n    public HttpServletRequest getOrgRequest() {\n        return orgRequest;\n    }\n}\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5199\u4e00\u4e2a\u8fc7\u6ee4\u5668\uff0c\u5c06\u539f\u751f\u7684request\u7ed9\u7f6e\u6362\u6389")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"public class XssFilter implements Filter {\n    @Override\n    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\n        // \u8fd9\u4e2a\u8fc7\u6ee4\u5668\u7684\u5de6\u53f3\uff0c\u4ec5\u4ec5\u662f\u8bb2\u539f\u59cb\u7684request\u8fdb\u884c\u4e00\u4e2a\u5305\u88c5\uff0c\u901a\u8fc7\u5b50\u7c7b\u53bb\u5904\u7406\u6076\u610f\u6807\u7b7e\n        filterChain.doFilter(new XssHttpServletRequestWrapper((HttpServletRequest) servletRequest),servletResponse);\n    }\n}\n")))}u.isMDXComponent=!0}}]);