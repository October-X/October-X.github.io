"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1562],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>g});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var i=a.createContext({}),o=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=o(e.components);return a.createElement(i.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,i=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),u=o(n),m=l,g=u["".concat(i,".").concat(m)]||u[m]||d[m]||r;return n?a.createElement(g,s(s({ref:t},c),{},{components:n})):a.createElement(g,s({ref:t},c))}));function g(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,s=new Array(r);s[0]=m;var p={};for(var i in t)hasOwnProperty.call(t,i)&&(p[i]=t[i]);p.originalType=e,p[u]="string"==typeof e?e:l,s[1]=p;for(var o=2;o<r;o++)s[o]=n[o];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8450:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>p,toc:()=>o});var a=n(7462),l=(n(7294),n(3905));const r={},s="2.2 \u4e8c\u5962\u4ea4\u6613",p={unversionedId:"Java/\u9879\u76ee/2.2 \u4e8c\u5962\u4ea4\u6613",id:"Java/\u9879\u76ee/2.2 \u4e8c\u5962\u4ea4\u6613",title:"2.2 \u4e8c\u5962\u4ea4\u6613",description:"\u89d2\u8272\uff1a\u6570\u636e\u76d1\u63a7\u540c\u6b65\u7ec4\u3002\u540e\u7aef\u5f00\u53d1\u4eba\u5458\u3002",source:"@site/docs/Java/10.\u9879\u76ee/2.2 \u4e8c\u5962\u4ea4\u6613.md",sourceDirName:"Java/10.\u9879\u76ee",slug:"/Java/\u9879\u76ee/2.2 \u4e8c\u5962\u4ea4\u6613",permalink:"/docs/Java/\u9879\u76ee/2.2 \u4e8c\u5962\u4ea4\u6613",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Java/10.\u9879\u76ee/2.2 \u4e8c\u5962\u4ea4\u6613.md",tags:[],version:"current",frontMatter:{},sidebar:"Java",previous:{title:"2.1 \u4e8c\u5962\u4ea4\u6613",permalink:"/docs/Java/\u9879\u76ee/2.1 \u4e8c\u5962\u4ea4\u6613"},next:{title:"2.3 \u4e8c\u5962\u4ea4\u6613",permalink:"/docs/Java/\u9879\u76ee/2.3 \u4e8c\u5962\u4ea4\u6613"}},i={},o=[{value:"#\u5b66\u4e60\u76ee\u6807",id:"\u5b66\u4e60\u76ee\u6807",level:2},{value:"#1. canal",id:"1-canal",level:2},{value:"#1.1 canal\u7b80\u4ecb",id:"11-canal\u7b80\u4ecb",level:3},{value:"#1.2 \u73af\u5883\u90e8\u7f72",id:"12-\u73af\u5883\u90e8\u7f72",level:3},{value:"#1.2.1 mysql\u5f00\u542fbinlog\u6a21\u5f0f",id:"121-mysql\u5f00\u542fbinlog\u6a21\u5f0f",level:4},{value:"#1.2.2 canal\u670d\u52a1\u7aef\u5b89\u88c5\u914d\u7f6e",id:"122-canal\u670d\u52a1\u7aef\u5b89\u88c5\u914d\u7f6e",level:4},{value:"#1.3 \u6570\u636e\u76d1\u63a7\u5fae\u670d\u52a1",id:"13-\u6570\u636e\u76d1\u63a7\u5fae\u670d\u52a1",level:3},{value:"#1.3.1 \u5fae\u670d\u52a1\u642d\u5efa",id:"131-\u5fae\u670d\u52a1\u642d\u5efa",level:4},{value:"#2. \u9996\u9875\u5e7f\u544a\u7f13\u5b58\u66f4\u65b0",id:"2-\u9996\u9875\u5e7f\u544a\u7f13\u5b58\u66f4\u65b0",level:2},{value:"#2.1 \u9700\u6c42\u5206\u6790",id:"21-\u9700\u6c42\u5206\u6790",level:3},{value:"#2.2 \u5b9e\u73b0\u601d\u8def",id:"22-\u5b9e\u73b0\u601d\u8def",level:3},{value:"#2.3 \u4ee3\u7801\u5b9e\u73b0",id:"23-\u4ee3\u7801\u5b9e\u73b0",level:3},{value:"#2.3.1 \u53d1\u9001\u6d88\u606f\u5230mq",id:"231-\u53d1\u9001\u6d88\u606f\u5230mq",level:4},{value:"#2.3.2 \u4ecemq\u4e2d\u63d0\u53d6\u6d88\u606f\u6267\u884c\u66f4\u65b0",id:"232-\u4ecemq\u4e2d\u63d0\u53d6\u6d88\u606f\u6267\u884c\u66f4\u65b0",level:4},{value:"#3. \u5546\u54c1\u4e0a\u67b6\u7d22\u5f15\u5e93\u5bfc\u5165\u6570\u636e",id:"3-\u5546\u54c1\u4e0a\u67b6\u7d22\u5f15\u5e93\u5bfc\u5165\u6570\u636e",level:2},{value:"#3.1 \u9700\u6c42\u5206\u6790",id:"31-\u9700\u6c42\u5206\u6790",level:3},{value:"#3.2 \u5b9e\u73b0\u601d\u8def",id:"32-\u5b9e\u73b0\u601d\u8def",level:3},{value:"#3.3 \u4ee3\u7801\u5b9e\u73b0",id:"33-\u4ee3\u7801\u5b9e\u73b0",level:3},{value:"#3.3.1 \u53d1\u9001\u6d88\u606f\u5230mq",id:"331-\u53d1\u9001\u6d88\u606f\u5230mq",level:4},{value:"#3.3.2 \u7d22\u5f15\u5e93\u73af\u5883\u51c6\u5907",id:"332-\u7d22\u5f15\u5e93\u73af\u5883\u51c6\u5907",level:4},{value:"#3.3.3 \u521b\u5efa\u7d22\u5f15\u7ed3\u6784",id:"333-\u521b\u5efa\u7d22\u5f15\u7ed3\u6784",level:4},{value:"#3.3.4 \u641c\u7d22\u5fae\u670d\u52a1\u642d\u5efa",id:"334-\u641c\u7d22\u5fae\u670d\u52a1\u642d\u5efa",level:4},{value:"#3.3.5 \u5546\u54c1\u670d\u52a1\u67e5\u8be2\u5546\u54c1\u4fe1\u606f",id:"335-\u5546\u54c1\u670d\u52a1\u67e5\u8be2\u5546\u54c1\u4fe1\u606f",level:4},{value:"#3.3.6 \u641c\u7d22\u5fae\u670d\u52a1\u6279\u91cf\u5bfc\u5165\u6570\u636e\u903b\u8f91",id:"336-\u641c\u7d22\u5fae\u670d\u52a1\u6279\u91cf\u5bfc\u5165\u6570\u636e\u903b\u8f91",level:4},{value:"#3.3.7 \u63a5\u6536mq\u6d88\u606f\u6267\u884c\u5bfc\u5165",id:"337-\u63a5\u6536mq\u6d88\u606f\u6267\u884c\u5bfc\u5165",level:4},{value:"#3.3.8 \u6d4b\u8bd5",id:"338-\u6d4b\u8bd5",level:4},{value:"#4. \u5546\u54c1\u4e0b\u67b6\u7d22\u5f15\u5e93\u5220\u9664\u6570\u636e",id:"4-\u5546\u54c1\u4e0b\u67b6\u7d22\u5f15\u5e93\u5220\u9664\u6570\u636e",level:2},{value:"#4.1 \u9700\u6c42\u5206\u6790",id:"41-\u9700\u6c42\u5206\u6790",level:3},{value:"#4.2 \u5b9e\u73b0\u601d\u8def",id:"42-\u5b9e\u73b0\u601d\u8def",level:3},{value:"#4.3 \u4ee3\u7801\u5b9e\u73b0",id:"43-\u4ee3\u7801\u5b9e\u73b0",level:3},{value:"#4.3.1 \u521b\u5efa\u4ea4\u6362\u5668\u4e0e\u961f\u5217",id:"431-\u521b\u5efa\u4ea4\u6362\u5668\u4e0e\u961f\u5217",level:4},{value:"#4.3.2 canal\u76d1\u542c\u4e0b\u67b6",id:"432-canal\u76d1\u542c\u4e0b\u67b6",level:4},{value:"#4.3.3 \u6839\u636espuId\u5220\u9664\u7d22\u5f15\u6570\u636e",id:"433-\u6839\u636espuid\u5220\u9664\u7d22\u5f15\u6570\u636e",level:4},{value:"#4.3.4 \u63a5\u6536mq\u6d88\u606f\uff0c\u6267\u884c\u7d22\u5f15\u5e93\u5220\u9664",id:"434-\u63a5\u6536mq\u6d88\u606f\u6267\u884c\u7d22\u5f15\u5e93\u5220\u9664",level:4},{value:"#1\u8bfe\u7a0b\u76ee\u6807",id:"1\u8bfe\u7a0b\u76ee\u6807",level:2},{value:"#2\u642d\u5efa\u6846\u67b6",id:"2\u642d\u5efa\u6846\u67b6",level:2},{value:"#2.1\u5173\u952e\u5b57\u67e5\u8be2-\u6784\u5efa\u641c\u7d22\u6761\u4ef6",id:"21\u5173\u952e\u5b57\u67e5\u8be2-\u6784\u5efa\u641c\u7d22\u6761\u4ef6",level:3},{value:"#2.2\u5c01\u88c5\u67e5\u8be2\u7ed3\u679c",id:"22\u5c01\u88c5\u67e5\u8be2\u7ed3\u679c",level:3},{value:"#2.3\u8868\u73b0\u5c42\u5b9a\u4e49",id:"23\u8868\u73b0\u5c42\u5b9a\u4e49",level:3},{value:"#2.4\u6d4b\u8bd5",id:"24\u6d4b\u8bd5",level:3},{value:"#3\u5404\u79cd\u67e5\u8be2",id:"3\u5404\u79cd\u67e5\u8be2",level:2},{value:"#3.1\u6761\u4ef6\u67e5\u8be2\u9700\u6c42",id:"31\u6761\u4ef6\u67e5\u8be2\u9700\u6c42",level:3},{value:"#3.2\u54c1\u724c\u8fc7\u6ee4\u67e5\u8be2",id:"32\u54c1\u724c\u8fc7\u6ee4\u67e5\u8be2",level:3},{value:"#3.3\u54c1\u724c\u805a\u5408\u67e5\u8be2",id:"33\u54c1\u724c\u805a\u5408\u67e5\u8be2",level:3},{value:"#3.4\u6309\u7167\u89c4\u683c\u8fc7\u6ee4",id:"34\u6309\u7167\u89c4\u683c\u8fc7\u6ee4",level:3},{value:"#3.5\u6309\u7167\u89c4\u683c\u805a\u5408",id:"35\u6309\u7167\u89c4\u683c\u805a\u5408",level:3},{value:"#3.6\u4ef7\u683c\u533a\u95f4\u67e5\u8be2",id:"36\u4ef7\u683c\u533a\u95f4\u67e5\u8be2",level:3},{value:"#3.7\u5206\u9875",id:"37\u5206\u9875",level:3},{value:"#3.8\u6392\u5e8f",id:"38\u6392\u5e8f",level:3},{value:"#3.9\u9ad8\u4eae\u4ecb\u7ecd",id:"39\u9ad8\u4eae\u4ecb\u7ecd",level:3},{value:"#3.10\u9ad8\u4eae\u5b9e\u73b0",id:"310\u9ad8\u4eae\u5b9e\u73b0",level:3},{value:"#\u5b66\u4e60\u76ee\u6807",id:"\u5b66\u4e60\u76ee\u6807-1",level:2},{value:"#1.Thymeleaf\u4ecb\u7ecd",id:"1thymeleaf\u4ecb\u7ecd",level:2},{value:"#1\u52a8\u6001\u9875\u9762\uff1a",id:"1\u52a8\u6001\u9875\u9762",level:3},{value:"#2\u9759\u6001\u9875\u9762\uff1a",id:"2\u9759\u6001\u9875\u9762",level:3},{value:"#3\u4e3a\u4ec0\u4e48\u9700\u8981\u52a8\u6001\u9875\u9762\u9759\u6001\u5316\uff1a",id:"3\u4e3a\u4ec0\u4e48\u9700\u8981\u52a8\u6001\u9875\u9762\u9759\u6001\u5316",level:3},{value:"#4Thymeleaf\u4ecb\u7ecd",id:"4thymeleaf\u4ecb\u7ecd",level:3},{value:"#2.Springboot\u6574\u5408thymeleaf",id:"2springboot\u6574\u5408thymeleaf",level:2},{value:"#3 Thymeleaf\u57fa\u672c\u8bed\u6cd5",id:"3-thymeleaf\u57fa\u672c\u8bed\u6cd5",level:2},{value:"#4 \u641c\u7d22\u9875\u9762\u6e32\u67d3",id:"4-\u641c\u7d22\u9875\u9762\u6e32\u67d3",level:2},{value:"#4.1 \u641c\u7d22\u5206\u6790",id:"41-\u641c\u7d22\u5206\u6790",level:3},{value:"#4.2 \u641c\u7d22\u5b9e\u73b0",id:"42-\u641c\u7d22\u5b9e\u73b0",level:3},{value:"#4.2.1 \u641c\u7d22\u5de5\u7a0b\u642d\u5efa",id:"421-\u641c\u7d22\u5de5\u7a0b\u642d\u5efa",level:4},{value:"#4.2.1 \u57fa\u7840\u6570\u636e\u6e32\u67d3",id:"421-\u57fa\u7840\u6570\u636e\u6e32\u67d3",level:4},{value:"#4.3 \u5173\u952e\u5b57\u641c\u7d22",id:"43-\u5173\u952e\u5b57\u641c\u7d22",level:3},{value:"#4.4 \u6761\u4ef6\u641c\u7d22\u5b9e\u73b0",id:"44-\u6761\u4ef6\u641c\u7d22\u5b9e\u73b0",level:3},{value:"#4.5 \u79fb\u9664\u641c\u7d22\u6761\u4ef6",id:"45-\u79fb\u9664\u641c\u7d22\u6761\u4ef6",level:3},{value:"#4.6 \u6392\u5e8f",id:"46-\u6392\u5e8f",level:3},{value:"#4.7 \u5206\u9875",id:"47-\u5206\u9875",level:3},{value:"#5.\u5143\u52a8\u529b\u4e8c\u5962\u5546\u54c1\u8be6\u60c5\u9875",id:"5\u5143\u52a8\u529b\u4e8c\u5962\u5546\u54c1\u8be6\u60c5\u9875",level:2},{value:"#5.1 \u9700\u6c42\u5206\u6790",id:"51-\u9700\u6c42\u5206\u6790",level:3},{value:"#5.2 \u5546\u54c1\u9759\u6001\u5316\u5fae\u670d\u52a1\u521b\u5efa",id:"52-\u5546\u54c1\u9759\u6001\u5316\u5fae\u670d\u52a1\u521b\u5efa",level:3},{value:"#5.2.1 \u9700\u6c42\u5206\u6790",id:"521-\u9700\u6c42\u5206\u6790",level:4},{value:"#5.2.2 \u642d\u5efa\u9879\u76ee",id:"522-\u642d\u5efa\u9879\u76ee",level:4},{value:"#5.3 \u751f\u6210\u9759\u6001\u9875",id:"53-\u751f\u6210\u9759\u6001\u9875",level:3},{value:"#5.3.1 \u9700\u6c42\u5206\u6790",id:"531-\u9700\u6c42\u5206\u6790",level:4},{value:"#5.3.2 Feign\u521b\u5efa",id:"532-feign\u521b\u5efa",level:4},{value:"#5.3.3 \u9759\u6001\u9875\u751f\u6210\u4ee3\u7801-\u91cd\u70b9\u638c\u63e1",id:"533-\u9759\u6001\u9875\u751f\u6210\u4ee3\u7801-\u91cd\u70b9\u638c\u63e1",level:4},{value:"#5.3.4 \u6a21\u677f\u586b\u5145",id:"534-\u6a21\u677f\u586b\u5145",level:4},{value:"#5.3.5 \u542f\u52a8\u6d4b\u8bd5",id:"535-\u542f\u52a8\u6d4b\u8bd5",level:4},{value:"#5.3.6 \u57fa\u4e8enginx\u5b8c\u6210\u9759\u6001\u9875\u8bbf\u95ee",id:"536-\u57fa\u4e8enginx\u5b8c\u6210\u9759\u6001\u9875\u8bbf\u95ee",level:4},{value:"#1 \u7528\u6237\u8ba4\u8bc1\u5206\u6790",id:"1-\u7528\u6237\u8ba4\u8bc1\u5206\u6790",level:2},{value:"#1\u7528\u6237\u8ba4\u8bc1\u4e0e\u6388\u6743",id:"1\u7528\u6237\u8ba4\u8bc1\u4e0e\u6388\u6743",level:3},{value:"#2\u5355\u70b9\u767b\u5f55\u9700\u6c42 SSO",id:"2\u5355\u70b9\u767b\u5f55\u9700\u6c42-sso",level:3},{value:"#3\u7b2c\u4e09\u65b9\u8d26\u53f7\u767b\u5f55",id:"3\u7b2c\u4e09\u65b9\u8d26\u53f7\u767b\u5f55",level:3},{value:"#2 \u8ba4\u8bc1\u89e3\u51b3\u65b9\u6848",id:"2-\u8ba4\u8bc1\u89e3\u51b3\u65b9\u6848",level:2},{value:"#2.1 \u5355\u70b9\u767b\u5f55\u6280\u672f\u65b9\u6848",id:"21-\u5355\u70b9\u767b\u5f55\u6280\u672f\u65b9\u6848",level:3},{value:"#2.2 \u7b2c\u4e09\u65b9\u767b\u5f55\u6280\u672f\u65b9\u6848-\u91cd\u70b9\u638c\u63e1 Oauth2",id:"22-\u7b2c\u4e09\u65b9\u767b\u5f55\u6280\u672f\u65b9\u6848-\u91cd\u70b9\u638c\u63e1-oauth2",level:3},{value:"#2.2.1 Oauth2\u8ba4\u8bc1\u6d41\u7a0b",id:"221-oauth2\u8ba4\u8bc1\u6d41\u7a0b",level:4},{value:"#2.2.2 Oauth2\u5728\u9879\u76ee\u7684\u5e94\u7528",id:"222-oauth2\u5728\u9879\u76ee\u7684\u5e94\u7528",level:4},{value:"#2.3 Spring security Oauth2\u8ba4\u8bc1\u89e3\u51b3\u65b9\u6848-\u4e86\u89e3",id:"23-spring-security-oauth2\u8ba4\u8bc1\u89e3\u51b3\u65b9\u6848-\u4e86\u89e3",level:3},{value:"#3 Jwt\u4ee4\u724c\u56de\u987e",id:"3-jwt\u4ee4\u724c\u56de\u987e",level:2},{value:"#3.1 \u4ee4\u724c\u7ed3\u6784",id:"31-\u4ee4\u724c\u7ed3\u6784",level:3},{value:"#3.2 \u751f\u6210\u79c1\u94a5\u516c\u94a5-\u8fd0\u7ef4",id:"32-\u751f\u6210\u79c1\u94a5\u516c\u94a5-\u8fd0\u7ef4",level:3},{value:"#3.3 \u57fa\u4e8e\u79c1\u94a5\u751f\u6210jwt\u4ee4\u724c-\u4e86\u89e3",id:"33-\u57fa\u4e8e\u79c1\u94a5\u751f\u6210jwt\u4ee4\u724c-\u4e86\u89e3",level:3},{value:"#3.3.1\u5bfc\u5165\u8ba4\u8bc1\u670d\u52a1",id:"331\u5bfc\u5165\u8ba4\u8bc1\u670d\u52a1",level:4},{value:"#3.3.2 \u8ba4\u8bc1\u670d\u52a1\u4e2d\u521b\u5efa\u6d4b\u8bd5\u7c7b",id:"332-\u8ba4\u8bc1\u670d\u52a1\u4e2d\u521b\u5efa\u6d4b\u8bd5\u7c7b",level:4},{value:"#3.4 \u57fa\u4e8e\u516c\u94a5\u89e3\u6790jwt\u4ee4\u724c",id:"34-\u57fa\u4e8e\u516c\u94a5\u89e3\u6790jwt\u4ee4\u724c",level:3},{value:"#4 Oauth2.0\u5165\u95e8",id:"4-oauth20\u5165\u95e8",level:2},{value:"#4.1 \u51c6\u5907\u5de5\u4f5c",id:"41-\u51c6\u5907\u5de5\u4f5c",level:3},{value:"#4.2 Oauth2\u6388\u6743\u6a21\u5f0f\u4ecb\u7ecd",id:"42-oauth2\u6388\u6743\u6a21\u5f0f\u4ecb\u7ecd",level:3},{value:"#4.2.1 \u6388\u6743\u7801\u6a21\u5f0f",id:"421-\u6388\u6743\u7801\u6a21\u5f0f",level:4},{value:"#4.2.1.1 \u6388\u6743\u7801\u6388\u6743\u6d41\u7a0b\uff08\u7ed3\u5408\u6d41\u7a0b\u56fe\uff09",id:"4211-\u6388\u6743\u7801\u6388\u6743\u6d41\u7a0b\u7ed3\u5408\u6d41\u7a0b\u56fe",level:5},{value:"#4.2.1.2 \u7533\u8bf7\u6388\u6743\u7801",id:"4212-\u7533\u8bf7\u6388\u6743\u7801",level:5},{value:"#4.2.1.3 \u7533\u8bf7\u4ee4\u724c",id:"4213-\u7533\u8bf7\u4ee4\u724c",level:5},{value:"#4.2.1.4 \u4ee4\u724c\u6821\u9a8c-\u4e86\u89e3",id:"4214-\u4ee4\u724c\u6821\u9a8c-\u4e86\u89e3",level:5},{value:"#4.2.1.5 \u5237\u65b0\u4ee4\u724c",id:"4215-\u5237\u65b0\u4ee4\u724c",level:5},{value:"#4.2.2 \u5bc6\u7801\u6a21\u5f0f",id:"422-\u5bc6\u7801\u6a21\u5f0f",level:4},{value:"#4.2.2.1 \u7533\u8bf7\u4ee4\u724c",id:"4221-\u7533\u8bf7\u4ee4\u724c",level:5},{value:"#4.3 \u8d44\u6e90\u670d\u52a1\u6388\u6743",id:"43-\u8d44\u6e90\u670d\u52a1\u6388\u6743",level:3},{value:"#4.3.1 \u6539\u9020\u7528\u6237\u670d\u52a1 \u5bf9\u63a5Oauth2",id:"431-\u6539\u9020\u7528\u6237\u670d\u52a1-\u5bf9\u63a5oauth2",level:4},{value:"#4.3.2 \u8d44\u6e90\u670d\u52a1\u6388\u6743\u6d4b\u8bd5",id:"432-\u8d44\u6e90\u670d\u52a1\u6388\u6743\u6d4b\u8bd5",level:4},{value:"#5 \u8ba4\u8bc1\u5f00\u53d1",id:"5-\u8ba4\u8bc1\u5f00\u53d1",level:2},{value:"#5.1 \u9700\u6c42\u5206\u6790",id:"51-\u9700\u6c42\u5206\u6790-1",level:3},{value:"#5.2 Redis\u914d\u7f6e",id:"52-redis\u914d\u7f6e",level:3},{value:"#5.3 \u8ba4\u8bc1\u670d\u52a1",id:"53-\u8ba4\u8bc1\u670d\u52a1",level:3},{value:"#5.3.1 \u8ba4\u8bc1\u9700\u6c42\u5206\u6790",id:"531-\u8ba4\u8bc1\u9700\u6c42\u5206\u6790",level:4},{value:"#5.3.2 \u6388\u6743\u53c2\u6570\u914d\u7f6e",id:"532-\u6388\u6743\u53c2\u6570\u914d\u7f6e",level:4},{value:"#5.3.3 \u7533\u8bf7\u4ee4\u724c\u6d4b\u8bd5",id:"533-\u7533\u8bf7\u4ee4\u724c\u6d4b\u8bd5",level:4},{value:"#5.3.4 \u4e1a\u52a1\u5c42",id:"534-\u4e1a\u52a1\u5c42",level:4},{value:"#5.3.5 \u63a7\u5236\u5c42",id:"535-\u63a7\u5236\u5c42",level:4},{value:"#5.3.6 \u767b\u5f55\u8bf7\u6c42\u653e\u884c",id:"536-\u767b\u5f55\u8bf7\u6c42\u653e\u884c",level:4},{value:"#5.3.7 \u6d4b\u8bd5\u8ba4\u8bc1\u63a5\u53e3",id:"537-\u6d4b\u8bd5\u8ba4\u8bc1\u63a5\u53e3",level:4},{value:"#5.3.8 \u52a8\u6001\u83b7\u53d6\u7528\u6237\u4fe1\u606f",id:"538-\u52a8\u6001\u83b7\u53d6\u7528\u6237\u4fe1\u606f",level:4},{value:"#6 \u8ba4\u8bc1\u670d\u52a1\u5bf9\u63a5\u7f51\u5173",id:"6-\u8ba4\u8bc1\u670d\u52a1\u5bf9\u63a5\u7f51\u5173",level:2},{value:"#6.1 \u65b0\u5efa\u7f51\u5173\u5de5\u7a0bydles_gateway_web",id:"61-\u65b0\u5efa\u7f51\u5173\u5de5\u7a0bydles_gateway_web",level:3},{value:"#6.2 \u7f51\u5173\u5168\u5c40\u8fc7\u6ee4\u5668",id:"62-\u7f51\u5173\u5168\u5c40\u8fc7\u6ee4\u5668",level:3},{value:"#7 \u81ea\u5b9a\u4e49\u767b\u5f55\u9875\u9762",id:"7-\u81ea\u5b9a\u4e49\u767b\u5f55\u9875\u9762",level:2},{value:"#<strong>8\u81ea\u5b9a\u4e49\u8def\u5f84\u8fc7\u6ee4\u5668</strong>",id:"8\u81ea\u5b9a\u4e49\u8def\u5f84\u8fc7\u6ee4\u5668",level:2},{value:"#\u5b66\u4e60\u76ee\u6807",id:"\u5b66\u4e60\u76ee\u6807-2",level:2},{value:"#1 SpringSecurity\u6743\u9650\u63a7\u5236 \u9274\u6743",id:"1-springsecurity\u6743\u9650\u63a7\u5236-\u9274\u6743",level:2},{value:"#1.1 \u89d2\u8272\u6743\u9650\u52a0\u8f7d",id:"11-\u89d2\u8272\u6743\u9650\u52a0\u8f7d",level:3},{value:"#1.2 \u89d2\u8272\u6743\u9650\u63a7\u5236",id:"12-\u89d2\u8272\u6743\u9650\u63a7\u5236",level:3},{value:"#1.3 \u5c0f\u7ed3",id:"13-\u5c0f\u7ed3",level:3},{value:"#2 \u8d2d\u7269\u8f66",id:"2-\u8d2d\u7269\u8f66",level:2},{value:"#2.1 \u8d2d\u7269\u8f66\u4e1a\u52a1\u5206\u6790",id:"21-\u8d2d\u7269\u8f66\u4e1a\u52a1\u5206\u6790",level:3},{value:"#2.2 \u6dfb\u52a0\u8d2d\u7269\u8f66",id:"22-\u6dfb\u52a0\u8d2d\u7269\u8f66",level:3},{value:"#\u6dfb\u52a0\u8d2d\u7269\u8f66 \u4e1a\u52a1\u5c42\u5b9e\u73b0-\u91cd\u70b9",id:"\u6dfb\u52a0\u8d2d\u7269\u8f66-\u4e1a\u52a1\u5c42\u5b9e\u73b0-\u91cd\u70b9",level:4},{value:"#\u8ba2\u5355\u670d\u52a1\u6dfb\u52a0cartService\uff0c\u5b9e\u73b0\u6dfb\u52a0\u8d2d\u7269\u8f66",id:"\u8ba2\u5355\u670d\u52a1\u6dfb\u52a0cartservice\u5b9e\u73b0\u6dfb\u52a0\u8d2d\u7269\u8f66",level:4},{value:"#2.4 \u8d2d\u7269\u8f66\u5217\u8868",id:"24-\u8d2d\u7269\u8f66\u5217\u8868",level:3},{value:"#2.4.1 \u601d\u8def\u5206\u6790",id:"241-\u601d\u8def\u5206\u6790",level:4},{value:"#3.4.2 \u4ee3\u7801\u5b9e\u73b0",id:"342-\u4ee3\u7801\u5b9e\u73b0",level:4},{value:"#3 \u8d2d\u7269\u8f66\u6e32\u67d3",id:"3-\u8d2d\u7269\u8f66\u6e32\u67d3",level:2},{value:"#3.1 \u8d2d\u7269\u8f66\u6e32\u67d3\u670d\u52a1\u642d\u5efa",id:"31-\u8d2d\u7269\u8f66\u6e32\u67d3\u670d\u52a1\u642d\u5efa",level:3},{value:"#3.2 \u8d2d\u7269\u8f66\u5217\u8868\u6e32\u67d3",id:"32-\u8d2d\u7269\u8f66\u5217\u8868\u6e32\u67d3",level:3},{value:"#3.2.1 Feign\u521b\u5efa",id:"321-feign\u521b\u5efa",level:4},{value:"#3.2.3 \u524d\u7aef\u9875\u9762",id:"323-\u524d\u7aef\u9875\u9762",level:4},{value:"#3.2.4 \u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u8ba4\u8bc1\u8bbf\u95ee \u8d2d\u7269\u8f66\u6e32\u67d3\u670d\u52a1\u3001\u8ba2\u5355\u670d\u52a1\u5bf9\u63a5\u7f51\u5173",id:"324-\u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u8ba4\u8bc1\u8bbf\u95ee-\u8d2d\u7269\u8f66\u6e32\u67d3\u670d\u52a1\u8ba2\u5355\u670d\u52a1\u5bf9\u63a5\u7f51\u5173",level:4},{value:"#3.3 \u5fae\u670d\u52a1\u95f4\u8ba4\u8bc1-\u9762\u8bd5\u91cd\u70b9",id:"33-\u5fae\u670d\u52a1\u95f4\u8ba4\u8bc1-\u9762\u8bd5\u91cd\u70b9",level:3},{value:"#3.4 \u52a8\u6001\u83b7\u53d6\u5f53\u524d\u767b\u9646\u4eba",id:"34-\u52a8\u6001\u83b7\u53d6\u5f53\u524d\u767b\u9646\u4eba",level:3},{value:"#3.5 \u9875\u9762\u914d\u7f6e",id:"35-\u9875\u9762\u914d\u7f6e",level:3},{value:"#3.5.1 \u672a\u767b\u5f55\u65f6\u767b\u5f55\u8df3\u8f6c",id:"351-\u672a\u767b\u5f55\u65f6\u767b\u5f55\u8df3\u8f6c",level:4},{value:"#3.5.2 \u767b\u5f55\u6210\u529f\u8df3\u8f6c\u539f\u5730\u5740",id:"352-\u767b\u5f55\u6210\u529f\u8df3\u8f6c\u539f\u5730\u5740",level:4}],c={toc:o};function u(e){let{components:t,...n}=e;return(0,l.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"22-\u4e8c\u5962\u4ea4\u6613"},"2.2 \u4e8c\u5962\u4ea4\u6613"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u89d2\u8272"),"\uff1a\u6570\u636e\u76d1\u63a7\u540c\u6b65\u7ec4\u3002\u540e\u7aef\u5f00\u53d1\u4eba\u5458\u3002"),(0,l.kt)("h2",{id:"\u5b66\u4e60\u76ee\u6807"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87"},"#"),"\u5b66\u4e60\u76ee\u6807"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u80fd\u591f\u5b8c\u6210\u6570\u636e\u76d1\u63a7\u5fae\u670d\u52a1\u7684\u5f00\u53d1"),(0,l.kt)("li",{parentName:"ul"},"\u80fd\u591f\u5b8c\u6210\u9996\u9875\u5e7f\u544a\u7f13\u5b58\u66f4\u65b0\u7684\u529f\u80fd"),(0,l.kt)("li",{parentName:"ul"},"\u80fd\u591f\u5b8c\u6210\u5546\u54c1\u4e0a\u67b6\u7d22\u5f15\u5e93\u5bfc\u5165\u6570\u636e\u529f\u80fd\uff0c\u80fd\u591f\u753b\u51fa\u6d41\u7a0b\u56fe\u548c\u8bf4\u51fa\u5b9e\u73b0\u601d\u8def"),(0,l.kt)("li",{parentName:"ul"},"\u80fd\u591f\u5b8c\u6210\u5546\u54c1\u4e0b\u67b6\u7d22\u5f15\u5e93\u5220\u9664\u6570\u636e\u529f\u80fd\uff0c\u80fd\u591f\u753b\u51fa\u6d41\u7a0b\u56fe\u548c\u8bf4\u51fa\u5b9e\u73b0\u601d\u8def")),(0,l.kt)("h2",{id:"1-canal"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-canal"},"#"),"1. canal"),(0,l.kt)("p",null,"\u62d3\u5c55\uff1amysql \u4e3b\u5907"),(0,l.kt)("h3",{id:"11-canal\u7b80\u4ecb"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-1-canal%E7%AE%80%E4%BB%8B"},"#"),"1.1 canal\u7b80\u4ecb"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u80cc\u666f\uff1a"),(0,l.kt)("p",{parentName:"li"},"\u65e9\u671f\u963f\u91cc\u5df4\u5df4\u56e0\u4e3a\u676d\u5dde\u548c\u7f8e\u56fd\u53cc\u673a\u623f\u90e8\u7f72\uff0c\u5b58\u5728\u8de8\u673a\u623f\u540c\u6b65\u7684\u4e1a\u52a1\u9700\u6c42\uff0c\u5b9e\u73b0\u65b9\u5f0f\u4e3b\u8981\u662f\u57fa\u4e8e\u4e1a\u52a1 trigger \u83b7\u53d6\u589e\u91cf\u53d8\u66f4\u3002\u4ece 2010 \u5e74\u5f00\u59cb\uff0c\u4e1a\u52a1\u9010\u6b65\u5c1d\u8bd5\u6570\u636e\u5e93\u65e5\u5fd7\u89e3\u6790\u83b7\u53d6\u589e\u91cf\u53d8\u66f4\u8fdb\u884c\u540c\u6b65\uff0c\u7531\u6b64\u884d\u751f\u51fa\u4e86\u5927\u91cf\u7684\u6570\u636e\u5e93\u589e\u91cf\u8ba2\u9605\u548c\u6d88\u8d39\u4e1a\u52a1\u3002"),(0,l.kt)("p",{parentName:"li"},"\u539f\u7406\uff1a"),(0,l.kt)("p",{parentName:"li"},"\u4e00\u3001MySQL\u4e3b\u5907\u590d\u5236\u539f\u7406: \u62d3\u5c55\u8d44\u6599\uff08mysql\u4e3b\u4ece\u5907\u4efd\u539f\u7406\uff09"),(0,l.kt)("p",{parentName:"li"}," binlog\u5173\u952e"),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20191210153213237-3acaac46.png",alt:"image-20191210153213237"}),"image-20191210153213237"),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211028111415755-02115355.png",alt:"image-20211028111415755"}),"image-20211028111415755"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"MySQL master \u5c06\u6570\u636e\u53d8\u66f4\u5199\u5165\u4e8c\u8fdb\u5236\u65e5\u5fd7( binary log, \u5176\u4e2d\u8bb0\u5f55\u53eb\u505a\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e8b\u4ef6binary log events\uff0c\u53ef\u4ee5\u901a\u8fc7 show binlog events \u8fdb\u884c\u67e5\u770b) binlog")))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"MySQL slave \u5c06 master \u7684 binary log events \u62f7\u8d1d\u5230\u5b83\u7684\u4e2d\u7ee7\u65e5\u5fd7(relay log)"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"MySQL slave \u91cd\u653e relay log \u4e2d\u4e8b\u4ef6\uff0c\u5c06\u6570\u636e\u53d8\u66f4\u53cd\u6620\u5b83\u81ea\u5df1\u7684\u6570\u636e"),(0,l.kt)("p",{parentName:"li"},"\u4e8c\u3001canal \u5de5\u4f5c\u539f\u7406:")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"canal\u6a21\u62dfmysql slave\u7684\u4ea4\u4e92\u534f\u8bae\uff0c\u4f2a\u88c5\u81ea\u5df1\u4e3amysql slave\uff0c\u5411mysql master\u53d1\u9001dump\u534f\u8bae"))))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"mysql master\u6536\u5230dump\u8bf7\u6c42\uff0c\u5f00\u59cb\u63a8\u9001binary log\u7ed9slave(\u4e5f\u5c31\u662fcanal)")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"canal\u89e3\u6790binary log\u5bf9\u8c61(\u539f\u59cb\u4e3abyte\u6d41)")),(0,l.kt)("p",{parentName:"li"},"\u672c\u9879\u76ee\u865a\u62df\u673a\u5df2\u7ecf\u5b89\u88c5\u597dcanal\u3002\u5177\u4f53\u5b89\u88c5\u6587\u6863\u63a8\u8350\u770b\u5b98\u7f51\u6587\u6863\u3002 ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/alibaba/canal/wiki/QuickStart"},"https://github.com/alibaba/canal/wiki/QuickStartopen in new window")))))),(0,l.kt)("h3",{id:"12-\u73af\u5883\u90e8\u7f72"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-2-%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2"},"#"),"1.2 \u73af\u5883\u90e8\u7f72"),(0,l.kt)("h4",{id:"121-mysql\u5f00\u542fbinlog\u6a21\u5f0f"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-2-1-mysql%E5%BC%80%E5%90%AFbinlog%E6%A8%A1%E5%BC%8F"},"#"),"1.2.1 mysql\u5f00\u542fbinlog\u6a21\u5f0f"),(0,l.kt)("p",null,"\uff081\uff09\u67e5\u770b\u5f53\u524dmysql\u662f\u5426\u5f00\u542fbinlog\u6a21\u5f0f\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"SHOW VARIABLES LIKE '%log_bin%'\n")),(0,l.kt)("p",null,"\u5982\u679clog_bin\u7684\u503c\u4e3aOFF\u662f\u672a\u5f00\u542f\uff0c\u4e3aON\u662f\u5df2\u5f00\u542f\u3002"),(0,l.kt)("p",null,"\uff082\uff09\u4fee\u6539/etc/my.cnf \u9700\u8981\u5f00\u542fbinlog\u6a21\u5f0f\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"[mysqld]\nlog-bin=mysql-bin\nbinlog-format=ROW\nserver_id=1\n")),(0,l.kt)("p",null,"\u4fee\u6539\u5b8c\u6210\u4e4b\u540e\uff0c\u91cd\u542fmysqld\u7684\u670d\u52a1\u3002"),(0,l.kt)("p",null,"(3) \u8fdb\u5165mysql"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"mysql -h localhost -u root -p\n")),(0,l.kt)("p",null,"\uff084\uff09\u521b\u5efa\u8d26\u53f7 \u7528\u4e8e\u6d4b\u8bd5\u4f7f\u7528"),(0,l.kt)("p",null,"\u4f7f\u7528root\u8d26\u53f7\u521b\u5efa\u7528\u6237\u5e76\u6388\u4e88\u6743\u9650"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"create user canal@'%' IDENTIFIED by 'canal';\nGRANT SELECT, REPLICATION SLAVE, REPLICATION CLIENT,SUPER ON *.* TO 'canal'@'%';\nFLUSH PRIVILEGES;\n")),(0,l.kt)("h4",{id:"122-canal\u670d\u52a1\u7aef\u5b89\u88c5\u914d\u7f6e"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-2-2-canal%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE"},"#"),"1.2.2 canal\u670d\u52a1\u7aef\u5b89\u88c5\u914d\u7f6e"),(0,l.kt)("p",null,"\uff081\uff09\u4e0b\u8f7d\u5730\u5740canal"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"https://github.com/alibaba/canal/releases/tag/canal-1.0.24\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1559118907783-92366fbb.png",alt:"1559118907783"}),"1559118907783"),(0,l.kt)("p",null,"\uff082\uff09\u4e0b\u8f7d\u4e4b\u540e \u4e0a\u4f20\u5230linux\u7cfb\u7edf\u4e2d\uff0c\u89e3\u538b\u7f29\u5230\u6307\u5b9a\u7684\u76ee\u5f55/usr/local/canal"),(0,l.kt)("p",null,"\u89e3\u538b\u7f29\u4e4b\u540e\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1559119163725-63f79df8.png",alt:"1559119163725"}),"1559119163725"),(0,l.kt)("p",null,"\uff083\uff09\u4fee\u6539 exmaple\u4e0b\u7684\u5b9e\u4f8b\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"vi conf/example/instance.properties\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/6-7-2d74ff70.png",alt:"img"}),"img"),(0,l.kt)("p",null,"\u4fee\u6539\u5982\u56fe\u6240\u793a\u7684\u51e0\u4e2a\u53c2\u6570\u3002"),(0,l.kt)("p",null,"\uff083\uff09\u6307\u5b9a\u8bfb\u53d6\u4f4d\u7f6e"),(0,l.kt)("p",null,"\u8fdb\u5165mysql\u4e2d\u6267\u884c\u4e0b\u9762\u8bed\u53e5\u67e5\u770bbinlog\u6240\u5728\u4f4d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"mysql> show master status;\n\u663e\u793a\u5982\u4e0b:\n+------------------+----------+--------------+------------------+-------------------+\n| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |\n+------------------+----------+--------------+------------------+-------------------+\n| mysql-bin.000001 |      120 |              |                  |                   |\n+------------------+----------+--------------+------------------+-------------------+\n1 row in set (0.00 sec)\n")),(0,l.kt)("p",null,"\u5982\u679cfile\u4e2dbinlog\u6587\u4ef6\u4e0d\u4e3a mysql-bin.000001 \u53ef\u4ee5\u91cd\u7f6emysql"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"mysql> reset master;\n")),(0,l.kt)("p",null,"\u67e5\u770bcanal\u914d\u7f6e\u6587\u4ef6"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"vim /usr/local/canal/conf/example/meta.dat\n")),(0,l.kt)("p",null,"\u627e\u5230\u5bf9\u5e94\u7684binlog\u4fe1\u606f\u66f4\u6539\u4e00\u81f4\u5373\u53ef"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'"journalName":"mysql-bin.000001","position":120,"\n')),(0,l.kt)("p",null,"\u6ce8\u610f\uff1a\u5982\u679c\u4e0d\u4e00\u81f4\uff0c\u53ef\u80fd\u5bfc\u81f4\u4ee5\u4e0b\u9519\u8bef"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"2019-06-17 19:35:20.918 [New I/O server worker #1-2] ERROR c.a.otter.canal.server.netty.handler.SessionHandler - something goes wrong with channel:[id: 0x7f2e9be3, /192.168.200.56:52225 => /192.168.200.128:11111], exception=java.io.IOException: Connection reset by peer\n")),(0,l.kt)("p",null,"\uff084\uff09\u542f\u52a8\u670d\u52a1\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"[root@localhost canal]# ./bin/startup.sh\n")),(0,l.kt)("p",null,"\uff085\uff09\u67e5\u770b\u65e5\u5fd7\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"cat /usr/local/canal/logs/canal/canal.log\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1559119507451-2144b023.png",alt:"1559119507451"}),"1559119507451"),(0,l.kt)("p",null,"\u8fd9\u6837\u5c31\u8868\u793a\u542f\u52a8\u6210\u529f\u4e86\u3002"),(0,l.kt)("h3",{id:"13-\u6570\u636e\u76d1\u63a7\u5fae\u670d\u52a1"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-3-%E6%95%B0%E6%8D%AE%E7%9B%91%E6%8E%A7%E5%BE%AE%E6%9C%8D%E5%8A%A1"},"#"),"1.3 \u6570\u636e\u76d1\u63a7\u5fae\u670d\u52a1"),(0,l.kt)("p",null,"\u5f53\u7528\u6237\u6267\u884c\u6570\u636e\u5e93\u7684\u64cd\u4f5c\u7684\u65f6\u5019\uff0cbinlog \u65e5\u5fd7\u4f1a\u88abcanal\u6355\u83b7\u5230\uff0c\u5e76\u89e3\u6790\u51fa\u6570\u636e\u3002\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u89e3\u6790\u51fa\u6765\u7684\u6570\u636e\u8fdb\u884c\u76f8\u5e94\u7684\u903b\u8f91\u5904\u7406\u3002"),(0,l.kt)("p",null,"\u6211\u4eec\u8fd9\u91cc\u4f7f\u7528\u7684\u4e00\u4e2a\u5f00\u6e90\u7684\u9879\u76ee\uff0c\u5b83\u5b9e\u73b0\u4e86springboot\u4e0ecanal\u7684\u96c6\u6210\u3002\u6bd4\u539f\u751f\u7684canal\u66f4\u52a0\u4f18\u96c5\u3002"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/chenqian56131/spring-boot-starter-canal"},"https://github.com/chenqian56131/spring-boot-starter-canalopen in new window")),(0,l.kt)("p",null,"\u4f7f\u7528\u524d\u9700\u8981\u5c06starter-canal\u5b89\u88c5\u5230\u672c\u5730\u4ed3\u5e93\u3002"),(0,l.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u53c2\u7167\u5b83\u63d0\u4f9b\u7684canal-test\uff0c\u8fdb\u884c\u4ee3\u7801\u5b9e\u73b0\u3002"),(0,l.kt)("h4",{id:"131-\u5fae\u670d\u52a1\u642d\u5efa"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-3-1-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA"},"#"),"1.3.1 \u5fae\u670d\u52a1\u642d\u5efa"),(0,l.kt)("p",null,"\uff081\uff09\u521b\u5efa\u5de5\u7a0b\u6a21\u5757ydles_canal\uff0cpom\u5f15\u5165\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"        \x3c!--canal\u76f8\u5173--\x3e\n        <dependency>\n            <groupId>com.xpand</groupId>\n            <artifactId>starter-canal</artifactId>\n            <version>0.0.1-SNAPSHOT</version>\n        </dependency>\n        \x3c!--rabbitMq\u76f8\u5173--\x3e\n        <dependency>\n            <groupId>org.springframework.amqp</groupId>\n            <artifactId>spring-rabbit</artifactId>\n        </dependency>\n")),(0,l.kt)("p",null,"\uff082\uff09\u521b\u5efa\u5305com.ydles.canal \uff0c\u5305\u4e0b\u521b\u5efa\u542f\u52a8\u7c7b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@EnableCanalClient //\u6807\u6ce8\u4e3acanal\u5ba2\u6237\u7aef\n@SpringBootApplication\npublic class CanalApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(CanalApplication.class,args);\n    }\n}\n")),(0,l.kt)("p",null,"\uff083\uff09\u6dfb\u52a0\u914d\u7f6e\u6587\u4ef6application.properties"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"canal.client.instances.example.host=192.168.200.128\ncanal.client.instances.example.port=11111\ncanal.client.instances.example.batchSize=1000\nspring.rabbitmq.host=192.168.200.128\n")),(0,l.kt)("p",null,"\uff084\uff09\u521b\u5efacom.ydles.canal.listener\u5305\uff0c\u5305\u4e0b\u521b\u5efa\u7c7b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@CanalEventListener //\u8fd9\u4e2a\u7c7b\u662fcanal\u7684\u76d1\u542c\u7c7b\npublic class BusinessListener {\n    /**\n     *\n     * @param eventType \u6539\u53d8 insert update delete\n     * @param rowData\n     */\n    @ListenPoint(schema = "ydles_business",table = "tb_ad")\n    public void adUpdate(CanalEntry.EventType eventType,CanalEntry.RowData rowData){\n        System.out.println("EventType:"+eventType);\n\n        //\u6539\u53d8\u4e4b\u524d \u8fd9\u4e00\u884c\u6570\u636e\n        List<CanalEntry.Column> beforeColumnsList = rowData.getBeforeColumnsList();\n        for (CanalEntry.Column column : beforeColumnsList) {\n            System.out.println("\u6539\u53d8\u4e4b\u524d\uff0c\u5217\u540d\u5b57\uff1a"+column.getName()+"\u5217\u503c\uff1a"+column.getValue());\n        }\n\n        System.out.println("======================================");\n\n        //\u6539\u53d8\u4e4b\u540e \u8fd9\u4e00\u884c\u6570\u636e\n        rowData.getAfterColumnsList().forEach(c->System.out.println("\u6539\u53d8\u4e4b\u540e\uff0c\u5217\u540d\u5b57\uff1a"+c.getName()+"\u5217\u503c\uff1a"+c.getValue()));\n\n    }\n\n}\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a\u542f\u52a8\u6570\u636e\u76d1\u63a7\u5fae\u670d\u52a1\uff0c\u4fee\u6539ydles_business\u7684tb_ad\u8868\uff0c\u89c2\u5bdf\u63a7\u5236\u53f0\u8f93\u51fa\u3002"),(0,l.kt)("h2",{id:"2-\u9996\u9875\u5e7f\u544a\u7f13\u5b58\u66f4\u65b0"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-%E9%A6%96%E9%A1%B5%E5%B9%BF%E5%91%8A%E7%BC%93%E5%AD%98%E6%9B%B4%E6%96%B0"},"#"),"2. \u9996\u9875\u5e7f\u544a\u7f13\u5b58\u66f4\u65b0"),(0,l.kt)("h3",{id:"21-\u9700\u6c42\u5206\u6790"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"},"#"),"2.1 \u9700\u6c42\u5206\u6790"),(0,l.kt)("p",null,"\u5f53tb_ad\uff08\u5e7f\u544a\uff09\u8868\u7684\u6570\u636e\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u66f4\u65b0redis\u4e2d\u7684\u5e7f\u544a\u6570\u636e\u3002"),(0,l.kt)("h3",{id:"22-\u5b9e\u73b0\u601d\u8def"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-2-%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF"},"#"),"2.2 \u5b9e\u73b0\u601d\u8def"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a\u53cc11\u6765\u4e86\uff0c\u5e7f\u544a\u8981\u53d8\u4e86\uff01\u5982\u4f55\u66f4\u65b0"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"http://192.168.200.128/ad_update?position=web_index_lb"},"http://192.168.200.128/ad_update?position=web_index_lbopen in new window")),(0,l.kt)("p",null,"\u60f3\u4e00\u4e0b\uff1a\u600e\u4e48\u5b9e\u73b0\uff0c\u5fae\u670d\u52a1\u62c6\u5206\u3002\u5fae\u670d\u52a1\u4e4b\u95f4\u5982\u4f55\u901a\u8baf\uff1arabbitmq\u3002"),(0,l.kt)("p",null,"\u65b9\u6848\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211028152330037-14a83402.png",alt:"image-20211028152330037"}),"image-20211028152330037"),(0,l.kt)("p",null,"\uff081\uff09\u6570\u636e\u76d1\u63a7\u5fae\u670d\u52a1\uff0c\u76d1\u63a7tb_ad\u8868\uff0c\u5f53\u53d1\u751f\u589e\u5220\u6539\u64cd\u4f5c\u65f6\uff0c\u63d0\u53d6position\u503c\uff08\u5e7f\u544a\u4f4d\u7f6ekey\uff09\uff0c \u53d1\u9001\u5230rabbitmq"),(0,l.kt)("p",null,"\uff082\uff09\u8fd0\u8425\u5fae\u670d\u52a1\u4ecerabbitmq\u4e2d\u63d0\u53d6\u6d88\u606f\uff0c\u901a\u8fc7OkHttpClient\u8c03\u7528ad_update\u6765\u5b9e\u73b0\u5bf9\u5e7f\u544a\u7f13\u5b58\u6570\u636e\u7684\u66f4\u65b0\u3002"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"http://192.168.200.128/ad_update?position=web_index_lb"},"http://192.168.200.128/ad_update?position=web_index_lbopen in new window")),(0,l.kt)("h3",{id:"23-\u4ee3\u7801\u5b9e\u73b0"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-3-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"},"#"),"2.3 \u4ee3\u7801\u5b9e\u73b0"),(0,l.kt)("h4",{id:"231-\u53d1\u9001\u6d88\u606f\u5230mq"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-3-1-%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%E5%88%B0mq"},"#"),"2.3.1 \u53d1\u9001\u6d88\u606f\u5230mq"),(0,l.kt)("p",null,"\uff081\uff09\u5728rabbitmq\u7ba1\u7406\u540e\u53f0\u521b\u5efa\u961f\u5217 ad_update_queue \uff0c\u7528\u4e8e\u63a5\u6536\u5e7f\u544a\u66f4\u65b0\u901a\u77e5"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/5-1-a79d3d8f.png",alt:"img"}),"img"),(0,l.kt)("p",null,"\uff082\uff09\u5f15\u5165rabbitmq\u8d77\u6b65\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>org.springframework.amqp</groupId>\n    <artifactId>spring-rabbit</artifactId>\n</dependency>\n")),(0,l.kt)("p",null,"\uff083\uff09\u914d\u7f6e\u6587\u4ef6application.properties \u6dfb\u52a0\u5185\u5bb9"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"spring.rabbitmq.host=192.168.200.128\n")),(0,l.kt)("p",null,"\uff084\uff09\u65b0\u589erabbitMQ\u914d\u7f6e\u7c7b com.ydles.canal.config"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\npublic class RabbitMQConfig {\n\n    //\u5b9a\u4e49\u961f\u5217\u540d\u79f0\n    public static final String AD_UPDATE_QUEUE="ad_update_queue";\n   \n\n    //\u58f0\u660e\u961f\u5217\n    @Bean\n    public Queue queue(){\n        return new Queue(AD_UPDATE_QUEUE);\n    }\n\n}\n')),(0,l.kt)("p",null,"\uff084\uff09\u4fee\u6539BusinessListener\u7c7b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@CanalEventListener //\u58f0\u660e\u5f53\u524d\u7684\u7c7b\u662fcanal\u7684\u76d1\u542c\u7c7b\npublic class BusinessListener {\n    @Autowired\n    RabbitTemplate rabbitTemplate;\n    /**\n *\n * @param eventType \u5f53\u524d\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u7c7b\u578b\n * @param rowData \u5f53\u524d\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u6570\u636e\n */\n@ListenPoint(schema = "ydles_business",table = "tb_ad")\npublic void adUpdate(CanalEntry.EventType eventType,CanalEntry.RowData rowData){\n    System.out.println("\u5e7f\u544a\u8868\u6570\u636e\u53d1\u751f\u6539\u53d8");\n    //        rowData.getBeforeColumnsList().forEach((c)-> System.out.println("\u6539\u53d8\u524d\u7684\u6570\u636e\uff1a"+c.getName()+"::"+c.getValue()));\n//        System.out.println("========================================");\n//        rowData.getAfterColumnsList().forEach((c)-> System.out.println("\u6539\u53d8\u540e\u7684\u6570\u636e\uff1a"+c.getName()+"::"+c.getValue()));\nfor (CanalEntry.Column column : rowData.getAfterColumnsList()) {\n        if(column.getName().equals("position")){\n            System.out.println("\u53d1\u9001\u6570\u636e\u5230mq"+column.getValue());\n\n            //\u53d1\u9001\u6d88\u606f\n            rabbitTemplate.convertAndSend("", RabbitMQConfig.AD_UPDATE_QUEQU, column.getValue());\n        }\n    }\n}\n}\n')),(0,l.kt)("p",null,"\uff085\uff09\u6d4b\u8bd5\uff1a"),(0,l.kt)("p",null,"\u91cd\u542fcanal\u670d\u52a1"),(0,l.kt)("p",null,"\u6253\u5f00 ",(0,l.kt)("a",{parentName:"p",href:"http://192.168.200.128:15672/"},"http://192.168.200.128:15672/open in new window")," \u89c2\u5bdfmq"),(0,l.kt)("p",null,"\u4fee\u6539\u6570\u636e\u5e93\u4e00\u6761\u6570\u636e\uff0c\u67e5\u770b\u7a0b\u5e8f\u8f93\u51fa\u3001mq"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/5-6-3cf8f106.png",alt:"img"}),"img"),(0,l.kt)("h4",{id:"232-\u4ecemq\u4e2d\u63d0\u53d6\u6d88\u606f\u6267\u884c\u66f4\u65b0"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-3-2-%E4%BB%8Emq%E4%B8%AD%E6%8F%90%E5%8F%96%E6%B6%88%E6%81%AF%E6%89%A7%E8%A1%8C%E6%9B%B4%E6%96%B0"},"#"),"2.3.2 \u4ecemq\u4e2d\u63d0\u53d6\u6d88\u606f\u6267\u884c\u66f4\u65b0"),(0,l.kt)("p",null,"ydles_service_business\u5de5\u7a0b"),(0,l.kt)("p",null,"\uff081\uff09pom.xml\u5f15\u5165\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"    \x3c!-- mq\u4f9d\u8d56 --\x3e\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-amqp</artifactId>\n    </dependency>\n    \x3c!-- \u8fdc\u7a0b\u8c03\u7528\u4f9d\u8d56 --\x3e\n    <dependency>\n        <groupId>com.squareup.okhttp3</groupId>\n        <artifactId>okhttp</artifactId>\n        <version>3.9.0</version>\n    </dependency>\n")),(0,l.kt)("p",null,"\uff082\uff09\u5728spring\u8282\u70b9\u4e0b\u6dfb\u52a0rabbitmq\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"  rabbitmq:\n    host: 192.168.200.128\n")),(0,l.kt)("p",null,"\uff083\uff09com.ydles.business.listener\u4e0b\u6dfb\u52a0\u76d1\u542c\u7c7b"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a\u53d1\u9001",(0,l.kt)("a",{parentName:"p",href:"http://192.168.200.128/ad_update?position=web_index_lb"},"http://192.168.200.128/ad_update?position=web_index_lbopen in new window")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Component\npublic class AdListener {\n    @Autowired\n    RestTemplate restTemplate;\n\n    @RabbitListener(queues = "ad_update_queue")\n    public void reveiveMsg(String position) {\n        System.out.println("\u63a5\u53d7\u5230\u4e86\u5e7f\u544a\u6d88\u606f\uff0c\u4f4d\u7f6e:" + position);\n\n        //\u53d1\u8bf7\u6c42 http://192.168.200.128/ad_update?position=web_index_lb\n        String url = "http://192.168.200.128/ad_update?position=" + position;\n        restTemplate.getForObject(url, Map.class);\n\n        ////1,\u521b\u5efaokHttpClient\u5bf9\u8c61\n        //OkHttpClient okHttpClient = new OkHttpClient();\n        ////2,\u521b\u5efa\u4e00\u4e2aRequest\n        //String url = "http://192.168.200.128/ad_update?position=" + position;\n        //final Request request = new Request.Builder()\n        //        .url(url)\n        //        .build();\n        ////3,\u65b0\u5efa\u4e00\u4e2acall\u5bf9\u8c61\n        //Call call = okHttpClient.newCall(request);\n        ////4\uff0c\u8bf7\u6c42\u52a0\u5165\u8c03\u5ea6\uff0c\u8fd9\u91cc\u662f\u5f02\u6b65Get\u8bf7\u6c42\u56de\u8c03\n        //call.enqueue(new Callback() {\n        //    //\u5931\u8d25\u4e86\u600e\u4e48\u6837\n        //    @Override\n        //    public void onFailure(Call call, IOException e) {\n        //        System.out.println("\u53d1\u9001\u8bf7\u6c42\u5931\u8d25");\n        //    }\n        //\n        //    //\u6210\u529f\u4e86\u5e94\u8be5\u600e\u4e48\u6837\n        //    @Override\n        //    public void onResponse(Call call, Response response) throws IOException {\n        //        System.out.println("\u53d1\u9001\u8bf7\u6c42\u6210\u529f"+response.message());\n        //    }\n        //});\n\n\n    }\n}\n')),(0,l.kt)("p",null,"\uff087\uff09\u6d4b\u8bd5\uff0c\u542f\u52a8eureka\u548cbusiness\u5fae\u670d\u52a1\uff0c\u89c2\u5bdf\u63a7\u5236\u53f0\u8f93\u51fa\u548c\u6570\u636e\u540c\u6b65\u6548\u679c\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u62d3\u5c55"),"\uff1ajava \u53d1\u9001\u8bf7\u6c42 \u4e09\u4e2a\u539f\u751f\u5ba2\u6237\u7aef"),(0,l.kt)("p",null,"okhttp"),(0,l.kt)("p",null,"httpclient"),(0,l.kt)("p",null,"URLconnection"),(0,l.kt)("h2",{id:"3-\u5546\u54c1\u4e0a\u67b6\u7d22\u5f15\u5e93\u5bfc\u5165\u6570\u636e"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-%E5%95%86%E5%93%81%E4%B8%8A%E6%9E%B6%E7%B4%A2%E5%BC%95%E5%BA%93%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE"},"#"),"3. \u5546\u54c1\u4e0a\u67b6\u7d22\u5f15\u5e93\u5bfc\u5165\u6570\u636e"),(0,l.kt)("h3",{id:"31-\u9700\u6c42\u5206\u6790"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"},"#"),"3.1 \u9700\u6c42\u5206\u6790"),(0,l.kt)("p",null,"\u5546\u54c1\u4e0a\u67b6\u5c06\u5546\u54c1\u7684sku\u5217\u8868\u5bfc\u5165\u6216\u66f4\u65b0\u7d22\u5f15\u5e93\u3002"),(0,l.kt)("h3",{id:"32-\u5b9e\u73b0\u601d\u8def"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-2-%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF"},"#"),"3.2 \u5b9e\u73b0\u601d\u8def"),(0,l.kt)("p",null,"\uff081\uff09\u5546\u54c1\u4e0a\u67b6\uff08spu.is_marketable 0\u53d8\u4e3a1\uff09 --\x3ecanal\u76d1\u63a7--\x3emq\u53d1\u9001spuId\u3002"),(0,l.kt)("p",null,"\uff082\uff09\u5728rabbitmq\u7ba1\u7406\u540e\u53f0\u521b\u5efa\u5546\u54c1\u4e0a\u67b6\u4ea4\u6362\u673a\uff08fanout\u8ba2\u9605\u53d1\u5e03\u6a21\u5f0f\uff09\u3002",(0,l.kt)("strong",{parentName:"p"},"\u4e3a\u4ec0\u4e48"),"\uff1f"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5bfc\u5165\u7d22\u5f15\u5e93\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u8be6\u60c5\u9875\u9762\u9759\u6001\u5316\u3002")),(0,l.kt)("p",null,"\uff083\uff09spuId--\x3e\u641c\u7d22\u670d\u52a1--\x3efeign\u5546\u54c1\u670d\u52a1\u83b7\u53d6skulList--\x3e\u653e\u5165Es\u7d22\u5f15\u5e93\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030153926557-e895779b.png",alt:"image-20211030153926557"}),"image-20211030153926557"),(0,l.kt)("h3",{id:"33-\u4ee3\u7801\u5b9e\u73b0"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"},"#"),"3.3 \u4ee3\u7801\u5b9e\u73b0"),(0,l.kt)("h4",{id:"331-\u53d1\u9001\u6d88\u606f\u5230mq"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-1-%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%E5%88%B0mq"},"#"),"3.3.1 \u53d1\u9001\u6d88\u606f\u5230mq"),(0,l.kt)("p",null,"\uff081\uff09\u5728rabbitmq\u540e\u53f0\u521b\u5efa\u4ea4\u6362\u5668goods_up_exchange\uff08\u7c7b\u578b\u4e3afanout\uff09\uff0c\u521b\u5efa\u961f\u5217search_add_queue\u7ed1\u5b9a\u4ea4\u6362\u5668goods_up_exchange,\u66f4\u65b0rabbitmq\u914d\u7f6e\u7c7b"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030173218523-a9767a57.png",alt:"image-20211030173218523"}),"image-20211030173218523"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u56de\u987e"),"\uff1arabbitMq\u4e94\u79cd\u5de5\u4f5c\u6a21\u5f0f\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@Configuration\npublic class RabbitMQConfig {\n    //\u5b9a\u4e49\u961f\u5217\u540d\u79f0\n    public static final String AD_UPDATE_QUEUE="ad_update_queue";\n\n    @Bean\n    public Queue queue(){\n        return new Queue(AD_UPDATE_QUEUE,true);\n    }\n\n    //\u4e0a\u67b6\u4ea4\u6362\u673a\u540d\u79f0\n    public static final String GOODS_UP_EXCHANGE = "goods_up_exchange";\n    //\u5b9a\u4e49\u4e0a\u67b6\u961f\u5217\u540d\u79f0\n    public static final String SEARCH_ADD_QUEUE = "search_add_queue";\n\n    //\u5b9a\u4e49\u4e0a\u67b6\u961f\u5217\n    @Bean(SEARCH_ADD_QUEUE)\n    public Queue SEARCH_ADD_QUEUE(){\n        return new Queue(SEARCH_ADD_QUEUE);\n    }\n\n    //\u5b9a\u4e49\u4e0a\u67b6\u4ea4\u6362\u673a\n    @Bean(GOODS_UP_EXCHANGE)\n    public Exchange GOODS_UP_EXCHANGE(){\n        return ExchangeBuilder.fanoutExchange(GOODS_UP_EXCHANGE).durable(true)\n                .build();\n    }\n\n    //\u4e0a\u67b6\u961f\u5217\u548c\u4e0a\u67b6\u4ea4\u6362\u673a\u7ed1\u5b9a\u5173\u7cfb\u6784\u5efa\n    @Bean\n    public Binding GOODS_UP_EXCHANGE_SEARCH_ADD_QUEUE(\n            @Qualifier(SEARCH_ADD_QUEUE)Queue queue\n            ,@Qualifier(GOODS_UP_EXCHANGE)Exchange exchange ){\n        return BindingBuilder.bind(queue).to(exchange).with("").noargs();\n    }\n}\n')),(0,l.kt)("p",null,"\uff082\uff09\u6570\u636e\u76d1\u63a7\u5fae\u670d\u52a1\u65b0\u589ecom.ydles.canal.listener.SpuListener\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@CanalEventListener //\u8fd9\u4e2a\u7c7b\u662fcanal\u7684\u76d1\u542c\u7c7b\npublic class SpuListener {\n    @Autowired\n    RabbitTemplate rabbitTemplate;\n\n    @ListenPoint(schema = "ydles_goods",table = "tb_spu")\n    public void goodsUp(CanalEntry.EventType eventType, CanalEntry.RowData rowData){\n        System.out.println("\u76d1\u542c\u5230\u4e86spu\u6570\u636e\u53d8\u4e86\uff1a"+eventType);\n\n        //isMarketable 0->1\n        //\u6539\u53d8\u4e4b\u524d\u7684\u6570\u636e ---\x3emap  {id:123,name:prada}\n        Map<String, String> oldMap=new HashMap<>();\n        rowData.getBeforeColumnsList().forEach(column -> oldMap.put(column.getName(), column.getValue()));\n        //\u6539\u53d8\u4e4b\u540e\u7684\u6570\u636e ---\x3emap  {id:123,name:prada}\n        Map<String, String> newMap=new HashMap<>();\n        rowData.getAfterColumnsList().forEach(column -> newMap.put(column.getName(), column.getValue()));\n\n        if (oldMap.get("is_marketable").equals("0")&& newMap.get("is_marketable").equals("1")){\n            //mq\u53d1spuId\n            String spuId = newMap.get("id");\n            System.out.println("\u5546\u54c1\u4e0a\u67b6\u4e86\uff0c\u5f80mq\u53d1\u6d88\u606f"+spuId);\n            rabbitTemplate.convertAndSend(RabbitMQConfig.GOODS_UP_EXCHANGE,"",spuId);\n        }\n    }\n}\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a\u4fee\u6539\u4e00\u6761\u6570\u636e\uff0c\u67e5\u770bmq\u4e2d\u6d88\u606f\u3002"),(0,l.kt)("h4",{id:"332-\u7d22\u5f15\u5e93\u73af\u5883\u51c6\u5907"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-2-%E7%B4%A2%E5%BC%95%E5%BA%93%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"},"#"),"3.3.2 \u7d22\u5f15\u5e93\u73af\u5883\u51c6\u5907"),(0,l.kt)("p",null,"\u6211\u4eec\u63d0\u4f9b\u7684\u865a\u62df\u673a\u955c\u50cf\u4e2d\u5df2\u7ecf\u5305\u542b\u4e86elasticsearch\u7684\u76f8\u5173docker\u955c\u50cf"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030162259387-7052ea33.png",alt:"image-20211030162259387"}),"image-20211030162259387"),(0,l.kt)("h4",{id:"333-\u521b\u5efa\u7d22\u5f15\u7ed3\u6784"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-3-%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84"},"#"),"3.3.3 \u521b\u5efa\u7d22\u5f15\u7ed3\u6784"),(0,l.kt)("p",null,"\u65b0\u5efaydles_service_search_api\u6a21\u5757,\u5e76\u6dfb\u52a0\u7d22\u5f15\u5e93\u5b9e\u4f53\u7c7b"),(0,l.kt)("p",null,"(1) \u6dfb\u52a0\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"        \x3c!--\u516c\u5171\u5305--\x3e\n        <dependency>\n            <groupId>com.ydles</groupId>\n            <artifactId>ydles_common</artifactId>\n            <version>1.0-SNAPSHOT</version>\n        </dependency>\n        \x3c!--spring boot \u4e0ees \u7ed3\u5408\u5305--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-data-elasticsearch</artifactId>\n        </dependency>\n")),(0,l.kt)("p",null,"(2) \u521b\u5efa\u5b9e\u4f53\u7c7bcom.ydles.search.pojo"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Document(indexName = "skuinfo", type = "docs")\npublic class SkuInfo implements Serializable {\n    //\u5546\u54c1id\uff0c\u540c\u65f6\u4e5f\u662f\u5546\u54c1\u7f16\u53f7\n    @Id\n    @Field(index = true, store = true, type = FieldType.Keyword)\n    private Long id;\n\n    //SKU\u540d\u79f0\n    @Field(index = true, store = true, type = FieldType.Text, analyzer = "ik_smart")\n    private String name;\n\n    //\u5546\u54c1\u4ef7\u683c\uff0c\u5355\u4f4d\u4e3a\uff1a\u5143\n    @Field(index = true, store = true, type = FieldType.Double)\n    private Long price;\n\n    //\u5e93\u5b58\u6570\u91cf\n    @Field(index = true, store = true, type = FieldType.Integer)\n    private Integer num;\n\n    //\u5546\u54c1\u56fe\u7247\n    @Field(index = false, store = true, type = FieldType.Text)\n    private String image;\n\n    //\u5546\u54c1\u72b6\u6001\uff0c1-\u6b63\u5e38\uff0c2-\u4e0b\u67b6\uff0c3-\u5220\u9664\n    @Field(index = true, store = true, type = FieldType.Keyword)\n    private String status;\n\n    //\u521b\u5efa\u65f6\u95f4\n    private Date createTime;\n\n    //\u66f4\u65b0\u65f6\u95f4\n    private Date updateTime;\n\n    //\u662f\u5426\u9ed8\u8ba4\n    @Field(index = true, store = true, type = FieldType.Keyword)\n    private String isDefault;\n\n    //SPUID\n    @Field(index = true, store = true, type = FieldType.Long)\n    private Long spuId;\n\n    //\u7c7b\u76eeID\n    @Field(index = true, store = true, type = FieldType.Long)\n    private Long categoryId;\n\n    //\u7c7b\u76ee\u540d\u79f0\n    @Field(index = true, store = true, type = FieldType.Keyword)\n    private String categoryName;\n\n    //\u54c1\u724c\u540d\u79f0\n    @Field(index = true, store = true, type = FieldType.Keyword)\n    private String brandName;\n\n    //\u89c4\u683c\n    private String spec;\n\n    //\u89c4\u683c\u53c2\u6570\n    private Map<String, Object> specMap;\n    \n    //getter & setter\u7565\n}\n')),(0,l.kt)("h4",{id:"334-\u641c\u7d22\u5fae\u670d\u52a1\u642d\u5efa"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-4-%E6%90%9C%E7%B4%A2%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA"},"#"),"3.3.4 \u641c\u7d22\u5fae\u670d\u52a1\u642d\u5efa"),(0,l.kt)("p",null,"\uff081\uff09\u521b\u5efaydles_service_search\u6a21\u5757\uff0cpom.xml\u5f15\u5165\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"        \x3c!--\u516c\u5171\u5305--\x3e\n        <dependency>\n            <groupId>com.ydles</groupId>\n            <artifactId>ydles_common</artifactId>\n            <version>1.0-SNAPSHOT</version>\n        </dependency>\n        \x3c!--\u6ce8\u518c\u4e2d\u5fc3--\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n        </dependency>\n        \x3c!--spring boot \u4e0ees \u7ed3\u5408\u5305--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-data-elasticsearch</artifactId>\n        </dependency>\n        \x3c!--\u5546\u54c1\u5b9e\u4f53\u7c7b--\x3e\n        <dependency>\n            <groupId>com.ydles</groupId>\n            <artifactId>ydles_service_goods_api</artifactId>\n            <version>1.0-SNAPSHOT</version>\n        </dependency>\n        \x3c!--\u641c\u7d22\u5b9e\u4f53\u7c7b--\x3e\n        <dependency>\n            <groupId>com.ydles</groupId>\n            <artifactId>ydles_service_search_api</artifactId>\n            <version>1.0-SNAPSHOT</version>\n        </dependency>\n        \x3c!--rabbitmq\u4f9d\u8d56--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-amqp</artifactId>\n        </dependency>\n")),(0,l.kt)("p",null,"\uff082\uff09ydles_service_search\u7684application.yml"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 9009\nspring:\n  application:\n    name: search\n  rabbitmq:\n    host: 192.168.200.128\n  redis:\n    host: 192.168.200.128\n  main:\n    allow-bean-definition-overriding: true #\u5f53\u9047\u5230\u540c\u6837\u540d\u5b57\u7684\u65f6\u5019\uff0c\u662f\u5426\u5141\u8bb8\u8986\u76d6\u6ce8\u518c\n  data:\n    elasticsearch:\n      cluster-name: elasticsearch\n      cluster-nodes: 192.168.200.128:9300\neureka:\n  client:\n    service-url:\n      defaultZone: http://127.0.0.1:6868/eureka\n  instance:\n    prefer-ip-address: true\nfeign:\n  hystrix:\n    enabled: true\n  client:\n    config:\n      default:   #\u914d\u7f6e\u5168\u5c40\u7684feign\u7684\u8c03\u7528\u8d85\u65f6\u65f6\u95f4  \u5982\u679c \u6709\u6307\u5b9a\u7684\u670d\u52a1\u914d\u7f6e \u9ed8\u8ba4\u7684\u914d\u7f6e\u4e0d\u4f1a\u751f\u6548\n        connectTimeout: 600000 # \u6307\u5b9a\u7684\u662f \u6d88\u8d39\u8005 \u8fde\u63a5\u670d\u52a1\u63d0\u4f9b\u8005\u7684\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u662f\u5426\u80fd\u8fde\u63a5  \u5355\u4f4d\u662f\u6beb\u79d2\n        readTimeout: 600000  # \u6307\u5b9a\u7684\u662f\u8c03\u7528\u670d\u52a1\u63d0\u4f9b\u8005\u7684 \u670d\u52a1 \u7684\u8d85\u65f6\u65f6\u95f4\uff08\uff09  \u5355\u4f4d\u662f\u6beb\u79d2\n#hystrix \u914d\u7f6e\nhystrix:\n  command:\n    default:\n      execution:\n        timeout:\n          #\u5982\u679cenabled\u8bbe\u7f6e\u4e3afalse\uff0c\u5219\u8bf7\u6c42\u8d85\u65f6\u4ea4\u7ed9ribbon\u63a7\u5236\n          enabled: false\n        isolation:\n          strategy: SEMAPHORE\n")),(0,l.kt)("p",null,"\uff083\uff09\u521b\u5efacom.ydles.search\u5305\uff0c\u5305\u4e0b\u521b\u5efaSearchApplication"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@SpringBootApplication\n@EnableEurekaClient\n@EnableFeignClients(basePackages = {"com.ydles.goods.feign"})\npublic class SearchApplication {\npublic static void main(String[] args) {\n    SpringApplication.run(SearchApplication.class,args);\n}\n}\n')),(0,l.kt)("p",null,"(4) \u5c06rabbitmq\u914d\u7f6e\u7c7b\u653e\u5165\u8be5\u6a21\u5757\u4e0b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\npublic class RabbitMQConfig {\n    //\u4e0a\u67b6\u4ea4\u6362\u673a\u540d\u79f0\n    public static final String GOODS_UP_EXCHANGE = "goods_up_exchange";\n    //\u5b9a\u4e49\u961f\u5217\u540d\u79f0\npublic static final String AD_UPDATE_QUEQU = "ad_update_quequ";\n//\u5b9a\u4e49\u4e0a\u67b6\u961f\u5217\u540d\u79f0\npublic static final String SEARCH_ADD_QUEUE = "search_add_queue";\n//\u58f0\u660e\u961f\u5217\n@Bean(AD_UPDATE_QUEQU)\npublic Queue queue() {\n    return new Queue(AD_UPDATE_QUEQU);\n}\n\n//\u58f0\u660e\u4e0a\u67b6\u961f\u5217\n@Bean(SEARCH_ADD_QUEUE)\npublic Queue SEARCH_ADD_QUEUE() {\n    return new Queue(SEARCH_ADD_QUEUE);\n}\n\n//\u58f0\u660e\u4e0a\u67b6\u4ea4\u6362\u673a\n@Bean(GOODS_UP_EXCHANGE)\npublic Exchange GOODS_UP_EXCHANGE() {\n    return ExchangeBuilder.fanoutExchange(GOODS_UP_EXCHANGE).durable(true).build();\n}\n\n// \u961f\u5217\u548c\u4ea4\u6362\u673a\u7ed1\u5b9a\n@Bean\npublic Binding GOODS_UP_EXCHANGE_BINDING(\n        @Qualifier(SEARCH_ADD_QUEUE) Queue queue,\n        @Qualifier(GOODS_UP_EXCHANGE) Exchange exchange) {\n    return BindingBuilder.bind(queue).to(exchange).with("").noargs();\n}\n}\n')),(0,l.kt)("h4",{id:"335-\u5546\u54c1\u670d\u52a1\u67e5\u8be2\u5546\u54c1\u4fe1\u606f"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-5-%E5%95%86%E5%93%81%E6%9C%8D%E5%8A%A1%E6%9F%A5%E8%AF%A2%E5%95%86%E5%93%81%E4%BF%A1%E6%81%AF"},"#"),"3.3.5 \u5546\u54c1\u670d\u52a1\u67e5\u8be2\u5546\u54c1\u4fe1\u606f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030173302665-78390501.png",alt:"image-20211030173302665"}),"image-20211030173302665"),(0,l.kt)("p",null,"(1) SkuController\u65b0\u589e\u65b9\u6cd5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@GetMapping("/spu/{spuId}")\npublic List<Sku> findSkuListBySpuId(@PathVariable("spuId") String spuId){\n    Map<String,Object> searchMap =new HashMap<>();\n\n    //\u641c\u7d22\u5168\u90e8\uff0c\u4f20\u6765\u7684spuId\u4e3aall\n    if(!"all".equals(spuId)){\n        //spuId\u4f5c\u4e3a\u6761\u4ef6\u4f20\u5165\u641c\u7d22\u5217\u8868\n        searchMap.put("spuId", spuId);\n    }\n    //\u5ba1\u6838\u901a\u8fc7\u7684\n    searchMap.put("status", "1");\n\n    List<Sku> skuList = skuService.findList(searchMap);\n    return  skuList;\n}\n')),(0,l.kt)("p",null,"(2) ydles_service_goods_api\u65b0\u589ecommon\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"<dependencies>\n  <dependency>\n    <groupId>com.ydles</groupId>\n    <artifactId>ydles_common</artifactId>\n    <version>1.0-SNAPSHOT</version>\n  </dependency>\n</dependencies>\n")),(0,l.kt)("p",null,"(3) \u5b9a\u4e49skuFegin\u63a5\u53e3"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@FeignClient(name = "goods")\npublic interface SkuFeign {\n\n    //\u6839\u636espuId\u67e5\u8be2skuList\n    @GetMapping("/sku/spu/{spuId}")\n    public List<Sku> findSkuListBySpuId(@PathVariable("spuId")String spuId);\n}\n')),(0,l.kt)("p",null,"4\u6d4b\u8bd5 ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9001/sku/spu/1205332629172256768"},"http://localhost:9001/sku/spu/1205332629172256768open in new window")),(0,l.kt)("h4",{id:"336-\u641c\u7d22\u5fae\u670d\u52a1\u6279\u91cf\u5bfc\u5165\u6570\u636e\u903b\u8f91"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-6-%E6%90%9C%E7%B4%A2%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%89%B9%E9%87%8F%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E9%80%BB%E8%BE%91"},"#"),"3.3.6 \u641c\u7d22\u5fae\u670d\u52a1\u6279\u91cf\u5bfc\u5165\u6570\u636e\u903b\u8f91"),(0,l.kt)("p",null,"(1) \u521b\u5efa com.ydles.search.dao\u5305,\u5e76\u65b0\u589eESManagerMapper\u63a5\u53e3"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public interface ESManagerMapper extends ElasticsearchRepository<SkuInfo,Long> {}\n")),(0,l.kt)("p",null,"\uff082\uff09\u521b\u5efa com.ydles.search.service\u5305\uff0c\u5305\u4e0b\u521b\u5efa\u63a5\u53e3EsManagerService"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\npublic interface EsManagerService {\n\n    //1\u521b\u5efa\u7d22\u5f15\u5e93\uff0c\u6620\u5c04\n    public void createIndexAndMapping();\n\n    //2 \u73b0\u6709\u6240\u6709sku\u5bfc\u5165es\n    public void importData();\n\n    //3 \u6839\u636espuId,\u5c06\u4ed6\u7684skuList\u5bfc\u5165es\n    public void importDataBySpuId();\n\n}\n")),(0,l.kt)("p",null,"\uff082\uff09\u521b\u5efacom.ydles.search.service.impl\u5305\uff0c\u5305\u4e0b\u521b\u5efa\u670d\u52a1\u5b9e\u73b0\u7c7b"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Template"),":\u5e2e\u52a9\u6211\u4eec\u521b\u5efa\u8fde\u63a5\uff0c\u5173\u95ed\u8fde\u63a5\u3002\u7c7b\u6bd4rabbitTemplate redisTemplate jdbcTemplate"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Service\npublic class EsManagerServiceImpl implements EsManagerService {\n    @Autowired\n    ElasticsearchTemplate elasticsearchTemplate;\n    @Autowired\n    SkuFeign skuFeign;\n    @Autowired\n    ESManagerMapper esManagerMapper;\n\n    //1\u521b\u5efa\u7d22\u5f15\u5e93\uff0c\u6620\u5c04\n    @Override\n    public void createIndexAndMapping() {\n        //\u521b\u5efa\u7d22\u5f15\n        elasticsearchTemplate.createIndex(SkuInfo.class);\n        //\u521b\u5efa\u6620\u5c04\n        elasticsearchTemplate.putMapping(SkuInfo.class);\n    }\n\n    //2 \u73b0\u6709\u6240\u6709sku\u5bfc\u5165es\n    @Override\n    public void importData() {\n        //1 \u67e5\u5230\u73b0\u6709\u6240\u6709sku\n        List<Sku> skuList = skuFeign.findSkuListBySpuId("all");\n        System.out.println("\u67e5\u8be2\u51fa\u7684skulist\u591a\u5c11\uff1a"+skuList.size());\n\n        //2\u5bfc\u5165es\n        List<SkuInfo> skuinfoList = new ArrayList<>();\n        for (Sku sku : skuList) {\n            String skuStr = JSON.toJSONString(sku); //{id:12,name:asda}\n            SkuInfo skuInfo = JSON.parseObject(skuStr, SkuInfo.class);\n\n            //\u9700\u6c42 Sku.spec string ------\x3eSkuInfo.specMap Map\n            Map map = JSON.parseObject(sku.getSpec(), Map.class);\n            skuInfo.setSpecMap(map);\n\n            skuinfoList.add(skuInfo);\n        }\n        esManagerMapper.saveAll(skuinfoList);\n    }\n\n    @Override\n    public void importDataBySpuId() {\n\n    }\n}\n')),(0,l.kt)("p",null,"(3) \u521b\u5efacom.ydles.search.controller.\u5b9a\u4e49ESManagerController"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@RestController\n@RequestMapping("/manager")\npublic class ESManagerController {\n    @Autowired\n    EsManagerService esManagerService;\n\n    @GetMapping("/create")\n    public Result create(){\n        esManagerService.createIndexAndMapping();\n        return new Result(true, StatusCode.OK,"\u521b\u5efa\u7d22\u5f15\u5e93\u6210\u529f");\n    }\n\n    @GetMapping("/importData")\n    public Result importData(){\n        esManagerService.importData();\n        return new Result(true, StatusCode.OK,"\u5bfc\u5165\u6570\u636e\u6210\u529f");\n    }\n\n}\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5"),"\uff1a"),(0,l.kt)("p",null,"1head\u63d2\u4ef6\u67e5\u770bes\u4e2d\u7d22\u5f15\u72b6\u6001\u4e3a\u7a7a"),(0,l.kt)("p",null,"2\u542f\u52a8\u641c\u7d22\u670d\u52a1"),(0,l.kt)("p",null,"3postman\u6d4b\u8bd5 ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/manager/create"},"http://localhost:9009/manager/createopen in new window")),(0,l.kt)("p",null,"4\u7ed3\u679c es\u4e2d\u6dfb\u52a0skuinfo\u7d22\u5f15"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030183741103-ea662a6d.png",alt:"image-20211030183741103"}),"image-20211030183741103"),(0,l.kt)("p",null,"5postman\u6d4b\u8bd5 ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/manager/importData"},"http://localhost:9009/manager/importDataopen in new window")),(0,l.kt)("p",null,"6\u7ed3\u679c es\u4e2dskuinfo\u7d22\u5f15\u6dfb\u52a0\u4e86\u6570\u636e"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030183728380-6b89b562.png",alt:"image-20211030183728380"}),"image-20211030183728380"),(0,l.kt)("h4",{id:"337-\u63a5\u6536mq\u6d88\u606f\u6267\u884c\u5bfc\u5165"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-7-%E6%8E%A5%E6%94%B6mq%E6%B6%88%E6%81%AF%E6%89%A7%E8%A1%8C%E5%AF%BC%E5%85%A5"},"#"),"3.3.7 \u63a5\u6536mq\u6d88\u606f\u6267\u884c\u5bfc\u5165"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030184417465-cffb2546.png",alt:"image-20211030184417465"}),"image-20211030184417465"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u68b3\u7406\u903b\u8f91"),"\uff1acanal\u76d1\u542c\u5230\u67d0\u4e2aspu\u4e0a\u67b6\uff0c\u53d1\u9001\u5230mq\u4e4b\u540e\uff0c\u641c\u7d22\u670d\u52a1\u63a5\u53d7\u6d88\u606f\uff0c\u5c06\u6b64spu\u5bf9\u5e94\u7684sku\u67e5\u51fa\u6765\uff0c\u653e\u5230es\u7d22\u5f15\u5e93\u3002"),(0,l.kt)("p",null,"ydles_service_search\u5de5\u7a0b\u521b\u5efacom.ydles.search.listener\u5305\uff0c\u5305\u4e0b\u521b\u5efa\u7c7b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@Component\npublic class GoodUpListener {\n    @Autowired\n    EsManagerService esManagerService;\n\n    @RabbitListener(queues = RabbitMQConfig.SEARCH_ADD_QUEUE)\n    public void recieveMsg(String spuId){\n        System.out.println("\u76d1\u542c\u5230\u4e86\u5546\u54c1\u4e0a\u67b6\u4e86\uff01\uff1a"+spuId);\n\n        esManagerService.importDataBySpuId(spuId);\n    }\n}\n')),(0,l.kt)("h4",{id:"338-\u6d4b\u8bd5"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-8-%E6%B5%8B%E8%AF%95"},"#"),"3.3.8 \u6d4b\u8bd5"),(0,l.kt)("p",null,"1\u542f\u52a8canal\u3001search\u7b49\u5fae\u670d\u52a1"),(0,l.kt)("p",null,"2\u5c06\u6570\u636e\u5e93\u4e2dspu\u4e00\u6761\u6570\u636e\u7531\u4e0b\u67b6\u6539\u4e3a\u4e0a\u67b6"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030185406174-8d5981a0.png",alt:"image-20211030185406174"}),"image-20211030185406174"),(0,l.kt)("p",null,"3search\u8f93\u51fa\u6570\u636e"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030185418805-5f834ec6.png",alt:"image-20211030185418805"}),"image-20211030185418805"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"data:image/png;base64,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",alt:"image-20211030185424901"}),"image-20211030185424901"),(0,l.kt)("p",null,"4\u7d22\u5f15\u5e93\u4e2d\u6570\u636e\u6dfb\u52a0"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030185438761-3216308b.png",alt:"image-20211030185438761"}),"image-20211030185438761"),(0,l.kt)("h2",{id:"4-\u5546\u54c1\u4e0b\u67b6\u7d22\u5f15\u5e93\u5220\u9664\u6570\u636e"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-%E5%95%86%E5%93%81%E4%B8%8B%E6%9E%B6%E7%B4%A2%E5%BC%95%E5%BA%93%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"},"#"),"4. \u5546\u54c1\u4e0b\u67b6\u7d22\u5f15\u5e93\u5220\u9664\u6570\u636e"),(0,l.kt)("h3",{id:"41-\u9700\u6c42\u5206\u6790"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"},"#"),"4.1 \u9700\u6c42\u5206\u6790"),(0,l.kt)("p",null,"\u5546\u54c1\u4e0b\u67b6\u540e\u5c06\u5546\u54c1\u4ece\u7d22\u5f15\u5e93\u4e2d\u79fb\u9664\u3002"),(0,l.kt)("h3",{id:"42-\u5b9e\u73b0\u601d\u8def"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF"},"#"),"4.2 \u5b9e\u73b0\u601d\u8def"),(0,l.kt)("p",null,"\u4e0e\u5546\u54c1\u4e0a\u67b6\u7684\u5b9e\u73b0\u601d\u8def\u975e\u5e38\u7c7b\u4f3c\u3002"),(0,l.kt)("p",null,"\uff081\uff09\u5728\u6570\u636e\u76d1\u63a7\u5fae\u670d\u52a1\u4e2d\u76d1\u63a7tb_spu\u8868\u7684\u6570\u636e\uff0c\u5f53tb_spu\u53d1\u751f\u66f4\u6539\u4e14is_marketable\u4e3a0\u65f6\uff0c\u8868\u793a\u5546\u54c1\u4e0b\u67b6\uff0c\u5c06spu\u7684id\u53d1\u9001\u5230rabbitmq\u3002"),(0,l.kt)("p",null,"\uff082\uff09\u5728rabbitmq\u7ba1\u7406\u540e\u53f0\u521b\u5efa\u5546\u54c1\u4e0b\u67b6\u4ea4\u6362\u5668\uff08fanout\uff09\u3002\u4f7f\u7528\u5206\u5217\u6a21\u5f0f\u7684\u4ea4\u6362\u5668\u662f\u8003\u8651\u5546\u54c1\u4e0b\u67b6\u4f1a\u6709\u5f88\u591a\u79cd\u903b\u8f91\u9700\u8981\u5904\u7406\uff0c\u7d22\u5f15\u5e93\u5220\u9664\u6570\u636e\u53ea\u662f\u5176\u4e2d\u4e00\u9879\uff0c\u53e6\u5916\u8fd8\u6709\u5220\u9664\u5546\u54c1\u8be6\u7ec6\u9875\u7b49\u64cd\u4f5c\u3002"),(0,l.kt)("p",null,"\uff083\uff09\u641c\u7d22\u5fae\u670d\u52a1\u4ecerabbitmq\u7684\u7684\u961f\u5217\u4e2d\u63d0\u53d6spu\u7684id\uff0c\u901a\u8fc7\u8c03\u7528elasticsearch\u7684\u9ad8\u7ea7restAPI \u5c06\u76f8\u5173\u7684sku\u5217\u8868\u4ece\u7d22\u5f15\u5e93\u5220\u9664\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030222900601-a0efd50f.png",alt:"image-20211030222900601"}),"image-20211030222900601"),(0,l.kt)("h3",{id:"43-\u4ee3\u7801\u5b9e\u73b0"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-3-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"},"#"),"4.3 \u4ee3\u7801\u5b9e\u73b0"),(0,l.kt)("p",null,"\u6839\u636e\u4e0a\u8fb9\u8bb2\u89e3\u7684\u5b9e\u73b0\u601d\u8def\u5b8c\u6210\u5546\u54c1\u4e0b\u67b6\u7d22\u5f15\u5e93\u5220\u9664\u6570\u636e\u7684\u529f\u80fd"),(0,l.kt)("h4",{id:"431-\u521b\u5efa\u4ea4\u6362\u5668\u4e0e\u961f\u5217"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-3-1-%E5%88%9B%E5%BB%BA%E4%BA%A4%E6%8D%A2%E5%99%A8%E4%B8%8E%E9%98%9F%E5%88%97"},"#"),"4.3.1 \u521b\u5efa\u4ea4\u6362\u5668\u4e0e\u961f\u5217"),(0,l.kt)("p",null,"\u5b8c\u6210\u5546\u54c1\u4e0b\u67b6\u4ea4\u6362\u5668\u7684\u521b\u5efa\uff0c\u961f\u5217\u7684\u521b\u5efa\u4e0e\u7ed1\u5b9a\uff0c\u5c06spuId\u53d1\u9001\u6d88\u606f\u5230mq"),(0,l.kt)("p",null,"\u5546\u54c1\u4e0b\u67b6\u4ea4\u6362\u5668\uff1agoods_down_exchange"),(0,l.kt)("p",null,"\u961f\u5217\u540d\u79f0\uff1a search_delete_queue"),(0,l.kt)("p",null,"\u7ed1\u5b9a search_delete_queue\u5230goods_down_exchange"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},' //\u4e0b\u67b6\u4ea4\u6362\u673a\u540d\u79f0\n    public static final String GOODS_DOWN_EXCHANGE = "goods_down_exchange";\n    //\u5b9a\u4e49\u4e0b\u67b6\u961f\u5217\u540d\u79f0\n    public static final String SEARCH_DEL_QUEUE = "search_del_queue";\n\n    //\u5b9a\u4e49\u4e0b\u67b6\u961f\u5217\n    @Bean(SEARCH_DEL_QUEUE)\n    public Queue SEARCH_DEL_QUEUE(){\n        return new Queue(SEARCH_DEL_QUEUE);\n    }\n\n    //\u5b9a\u4e49\u4e0b\u67b6\u4ea4\u6362\u673a\n    @Bean(GOODS_DOWN_EXCHANGE)\n    public Exchange GOODS_DOWN_EXCHANGE(){\n        return ExchangeBuilder.fanoutExchange(GOODS_DOWN_EXCHANGE).durable(true)\n                .build();\n    }\n\n    //\u4e0b\u67b6\u961f\u5217\u548c\u4e0b\u67b6\u4ea4\u6362\u673a\u7ed1\u5b9a\u5173\u7cfb\u6784\u5efa\n    @Bean\n    public Binding GOODS_DOWN_EXCHANGE_SEARCH_DEL_QUEUE(\n            @Qualifier(SEARCH_DEL_QUEUE)Queue queue\n            ,@Qualifier(GOODS_DOWN_EXCHANGE)Exchange exchange ){\n        return BindingBuilder.bind(queue).to(exchange).with("").noargs();\n    }\n')),(0,l.kt)("p",null,"2\u5c06RabbitMQConfig \u590d\u5236\u5230\u641c\u7d22\u670d\u52a1"),(0,l.kt)("h4",{id:"432-canal\u76d1\u542c\u4e0b\u67b6"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-3-2-canal%E7%9B%91%E5%90%AC%E4%B8%8B%E6%9E%B6"},"#"),"4.3.2 canal\u76d1\u542c\u4e0b\u67b6"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030223121917-e735791b.png",alt:"image-20211030223121917"}),"image-20211030223121917"),(0,l.kt)("p",null,"\u4fee\u6539ydles_canal\u7684SpuListener\u7684spuUpdate\u65b9\u6cd5\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'//\u83b7\u53d6\u6700\u65b0\u4e0b\u67b6\u7684\u5546\u54c1 1->0\nif ("1".equals(oldData.get("is_marketable")) && "0".equals(newData.get("is_marketable"))){\n    //\u5c06\u5546\u54c1\u7684spuid\u53d1\u9001\u5230mq\n    rabbitTemplate.convertAndSend(RabbitMQConfig.GOODS_DOWN_EXCHANGE,"",newData.get("id"));\n}\n')),(0,l.kt)("h4",{id:"433-\u6839\u636espuid\u5220\u9664\u7d22\u5f15\u6570\u636e"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-3-3-%E6%A0%B9%E6%8D%AEspuid%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95%E6%95%B0%E6%8D%AE"},"#"),"4.3.3 \u6839\u636espuId\u5220\u9664\u7d22\u5f15\u6570\u636e"),(0,l.kt)("p",null,"\u7f16\u5199\u4e1a\u52a1\u903b\u8f91\uff0c\u5b9e\u73b0\u6839\u636espuId\u5220\u9664\u7d22\u5f15\u5e93\u6570\u636e\u7684\u65b9\u6cd5\u3002"),(0,l.kt)("p",null,"\uff081\uff09ESManagerService\u65b0\u589e\u65b9\u6cd5\u5b9a\u4e49"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"//\u6839\u636esouid\u5220\u9664es\u7d22\u5f15\u5e93\u4e2d\u76f8\u5173\u7684sku\u6570\u636e\nvoid delDataBySpuId(String spuId);\n")),(0,l.kt)("p",null,"\uff082\uff09ESManagerServiceImpl\u5b9e\u73b0\u65b9\u6cd5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Override\npublic void delDataBySpuId(String spuId) {\n    List<Sku> skuList = skuFeign.findSkuListBySpuId(spuId);\n    if (skuList == null || skuList.size()<=0){\n        throw new RuntimeException("\u5f53\u524d\u6ca1\u6709\u6570\u636e\u88ab\u67e5\u8be2\u5230,\u65e0\u6cd5\u5bfc\u5165\u7d22\u5f15\u5e93");\n    }\n    for (Sku sku : skuList) {\n        esManagerMapper.deleteById(Long.parseLong(sku.getId()));\n    }\n}\n')),(0,l.kt)("h4",{id:"434-\u63a5\u6536mq\u6d88\u606f\u6267\u884c\u7d22\u5f15\u5e93\u5220\u9664"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-3-4-%E6%8E%A5%E6%94%B6mq%E6%B6%88%E6%81%AF-%E6%89%A7%E8%A1%8C%E7%B4%A2%E5%BC%95%E5%BA%93%E5%88%A0%E9%99%A4"},"#"),"4.3.4 \u63a5\u6536mq\u6d88\u606f\uff0c\u6267\u884c\u7d22\u5f15\u5e93\u5220\u9664"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030223326342-d32131de.png",alt:"image-20211030223326342"}),"image-20211030223326342"),(0,l.kt)("p",null,"\u4ecerabbitmq\u4e2d\u63d0\u53d6\u6d88\u606f\uff0c\u8c03\u52a8\u6839\u636espuId\u5220\u9664\u7d22\u5f15\u5e93\u6570\u636e\u7684\u65b9\u6cd5 ydles_service_search\u65b0\u589e\u76d1\u542c\u7c7b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Component\npublic class GoodsDelListener {\n\n    @Autowired\n    private ESManagerService esManagerService;\n\n    @RabbitListener(queues = RabbitMQConfig.SEARCH_DEL_QUEUE)\n    public void receiveMessage(String spuId){\n        System.out.println("\u5220\u9664\u7d22\u5f15\u5e93\u76d1\u542c\u7c7b,\u63a5\u6536\u5230\u7684spuId:  "+spuId);\n\n        //\u8c03\u7528\u4e1a\u52a1\u5c42\u5b8c\u6210\u7d22\u5f15\u5e93\u6570\u636e\u5220\u9664\n        esManagerService.delDataBySpuId(spuId);\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5"),"\uff1a"),(0,l.kt)("p",null,"1\u91cd\u542fcanal\u3001\u641c\u7d22\u670d\u52a1"),(0,l.kt)("p",null,"2\u4fee\u6539\u6570\u636e\u5e93\u4e2d\u4e00\u6761\u6570\u636e\uff0c\u5c06\u4e0a\u67b6\u72b6\u6001\u6539\u4e3a\u67b6"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030224154522-2f211d56.png",alt:"image-20211030224154522"}),"image-20211030224154522"),(0,l.kt)("p",null,"3\u89c2\u5bdfcanal\u5e94\u7528\u8f93\u51fa"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030224202732-27a60f04.png",alt:"image-20211030224202732"}),"image-20211030224202732"),(0,l.kt)("p",null,"4\u89c2\u5bdfes\u8f93\u51fa"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030224218009-aac4cc08.png",alt:"image-20211030224218009"}),"image-20211030224218009"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030224223867-60d41aab.png",alt:"image-20211030224223867"}),"image-20211030224223867"),(0,l.kt)("p",null,"\u603b\u7ed3\uff1a"),(0,l.kt)("p",null,"1canal"),(0,l.kt)("p",null,"mysql \u4e3b\u4ece\u590d\u5236 binlog"),(0,l.kt)("p",null,"canal\u4f2a\u88c5slave"),(0,l.kt)("p",null,"\u4ee3\u7801"),(0,l.kt)("p",null,"2\u5e7f\u544a\u66f4\u65b0"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211028152330037-14a83402.png",alt:"image-20211028152330037"}),"image-20211028152330037"),(0,l.kt)("p",null,"3\u5546\u54c1\u4e0a\u67b6 \u540c\u6b65\u5230es\u5e93"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030153926557-e895779b.png",alt:"image-20211030153926557"}),"image-20211030153926557"),(0,l.kt)("p",null,"4\u5546\u54c1\u4e0b\u67b6 es\u5e93\u5220\u9664"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211030222900601-a0efd50f.png",alt:"image-20211030222900601"}),"image-20211030222900601"),(0,l.kt)("p",null,"\u77e5\u8bc6\u70b9\uff1aboot cloud(feign) rabbitmq(5\u79cd\u5de5\u4f5c\u6a21\u5f0f) es"),(0,l.kt)("h1",{id:"\u7b2c7\u7ae0-\u5546\u54c1\u641c\u7d22-elastaicsearch"},(0,l.kt)("a",{parentName:"h1",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#%E7%AC%AC7%E7%AB%A0-%E5%95%86%E5%93%81%E6%90%9C%E7%B4%A2-elastaicsearch"},"#"),"\u7b2c7\u7ae0 \u5546\u54c1\u641c\u7d22-elastaicSearch"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u89d2\u8272"),"\uff1a\u641c\u7d22\u540e\u7aef\u7ec4 search-service"),(0,l.kt)("p",null,"\u524d\u7f6e\u5185\u5bb9\uff1a2\u5929elasticsearch\u5165\u95e8 \u5012\u6392\u7d22\u5f15 \u5168\u6587\u68c0\u7d22"),(0,l.kt)("h2",{id:"1\u8bfe\u7a0b\u76ee\u6807"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1%E8%AF%BE%E7%A8%8B%E7%9B%AE%E6%A0%87"},"#"),"1\u8bfe\u7a0b\u76ee\u6807"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u6839\u636e\u641c\u7d22\u5173\u952e\u5b57\u67e5\u8be2"),(0,l.kt)("li",{parentName:"ul"},"\u6761\u4ef6\u7b5b\u9009"),(0,l.kt)("li",{parentName:"ul"},"\u89c4\u683c\u8fc7\u6ee4"),(0,l.kt)("li",{parentName:"ul"},"\u4ef7\u683c\u533a\u95f4\u641c\u7d22"),(0,l.kt)("li",{parentName:"ul"},"\u5206\u9875\u67e5\u8be2"),(0,l.kt)("li",{parentName:"ul"},"\u6392\u5e8f\u67e5\u8be2"),(0,l.kt)("li",{parentName:"ul"},"\u9ad8\u4eae\u67e5\u8be2")),(0,l.kt)("h2",{id:"2\u642d\u5efa\u6846\u67b6"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2%E6%90%AD%E5%BB%BA%E6%A1%86%E6%9E%B6"},"#"),"2\u642d\u5efa\u6846\u67b6"),(0,l.kt)("h3",{id:"21\u5173\u952e\u5b57\u67e5\u8be2-\u6784\u5efa\u641c\u7d22\u6761\u4ef6"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-1%E5%85%B3%E9%94%AE%E5%AD%97%E6%9F%A5%E8%AF%A2-%E6%9E%84%E5%BB%BA%E6%90%9C%E7%B4%A2%E6%9D%A1%E4%BB%B6"},"#"),"2.1\u5173\u952e\u5b57\u67e5\u8be2-\u6784\u5efa\u641c\u7d22\u6761\u4ef6"),(0,l.kt)("p",null,"\u9700\u6c42\uff1aday01\u9875\u9762\u539f\u578b-\u300bsearch.html"),(0,l.kt)("p",null,"1\u641c\u7d22\u670d\u52a1 com.ydles.search.service"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public interface SearchService {\n    //\u6309\u7167\u67e5\u8be2\u6761\u4ef6\u8fdb\u884c\u6570\u636e\u67e5\u8be2\n    Map search(Map<String,String> searchMap);\n}\n")),(0,l.kt)("p",null,"2com.ydles.search.service.impl"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Service\npublic class SearchServiceImpl implements SearchService {\n@Autowired\nElasticsearchTemplate elasticsearchTemplate;\n\n@Override\npublic Map search(Map<String, String> searchMap) {\n    //\u6784\u5efa\u67e5\u8be2\n    if(searchMap!=null){\n         //  \u6761\u4ef6\u6784\u5efa\u5bf9\u8c61\n        NativeSearchQueryBuilder nativeSearchQueryBuilder=new NativeSearchQueryBuilder();\n\n        BoolQueryBuilder boolQueryBuilder = QueryBuilders.boolQuery();\n        //\u5173\u952e\u5b57\u67e5\u8be2\n        if(StringUtils.isNotEmpty(searchMap.get("keywords"))){\n            boolQueryBuilder.must(QueryBuilders.matchQuery("name", searchMap.get("keywords")).operator(Operator.AND));\n        }\n        \n        nativeSearchQueryBuilder.withQuery(boolQueryBuilder);\n\n        //\u5f00\u542f\u67e5\u8be2\n        /**\n         * \u6761\u4ef6\u6784\u5efa\u5bf9\u8c61\n         * \u67e5\u8be2\u5b9e\u4f53\u7c7b\n         * \u67e5\u8be2\u7ed3\u679c\u5bf9\u8c61\n         */\n        AggregatedPage<SkuInfo> resultInfo = elasticsearchTemplate.queryForPage(nativeSearchQueryBuilder.build(), SkuInfo.class, new SearchResultMapper() {\n            @Override\n            public <T> AggregatedPage<T> mapResults(SearchResponse searchResponse, Class<T> aClass, Pageable pageable) {\n                            return null;\n            }\n        });\n\n    }\n    \n    return null;\n}\n}\n')),(0,l.kt)("h3",{id:"22\u5c01\u88c5\u67e5\u8be2\u7ed3\u679c"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-2%E5%B0%81%E8%A3%85%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C"},"#"),"2.2\u5c01\u88c5\u67e5\u8be2\u7ed3\u679c"),(0,l.kt)("p",null,"\u5b8c\u5584com.ydles.search.service.impl"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Service\npublic class SearchServiceImpl implements SearchService {\n@Autowired\nElasticsearchTemplate elasticsearchTemplate;\n\n@Override\npublic Map search(Map<String, String> searchMap) {\n    //\u7ed3\u679cmap\n    Map<String,Object> resultMap=new HashMap<>();\n\n    //\u6784\u5efa\u67e5\u8be2\n    if(searchMap!=null){\n         //  \u6761\u4ef6\u6784\u5efa\u5bf9\u8c61\n        NativeSearchQueryBuilder nativeSearchQueryBuilder=new NativeSearchQueryBuilder();\n\n        BoolQueryBuilder boolQueryBuilder = QueryBuilders.boolQuery();\n        //\u5173\u952e\u5b57\u67e5\u8be2\n        if(StringUtils.isNotEmpty(searchMap.get("keywords"))){\n            boolQueryBuilder.must(QueryBuilders.matchQuery("name", searchMap.get("keywords")).operator(Operator.AND));\n        }\n\n        nativeSearchQueryBuilder.withQuery(boolQueryBuilder);\n\n        //\u5f00\u542f\u67e5\u8be2\n        /**\n         * \u6761\u4ef6\u6784\u5efa\u5bf9\u8c61\n         * \u67e5\u8be2\u5b9e\u4f53\u7c7b\n         * \u67e5\u8be2\u7ed3\u679c\u5bf9\u8c61\n         */\n        //\u5c01\u88c5\u67e5\u8be2\u7ed3\u679c\n        AggregatedPage<SkuInfo> resultInfo = elasticsearchTemplate.queryForPage(nativeSearchQueryBuilder.build(), SkuInfo.class, new SearchResultMapper() {\n            @Override\n            public <T> AggregatedPage<T> mapResults(SearchResponse searchResponse, Class<T> aClass, Pageable pageable) {\n                // \u67e5\u8be2\u7ed3\u679c\u64cd\u4f5c\n                List<T> list=new ArrayList<>();\n\n                // \u83b7\u53d6\u7ed3\u679c\n                SearchHits hits = searchResponse.getHits();\n                if (hits!=null){\n                    for (SearchHit hit : hits) {\n                        // hit\u5bf9\u8c61\u8f6c\u4e3askuinfo\n                        SkuInfo skuInfo = JSON.parseObject(hit.getSourceAsString(), SkuInfo.class);\n\n                        list.add((T) skuInfo);\n                    }\n                }\n                //\u6784\u5efa\u8fd4\u56de\u5bf9\u8c61\n                return new AggregatedPageImpl<>(list,pageable,hits.getTotalHits(),searchResponse.getAggregations());\n            }\n        });\n                // \u5c01\u88c5\u6700\u7ec8\u8fd4\u56de\u7ed3\u679c\n        //\u603b\u8bb0\u5f55\u6570\n        resultMap.put("total", resultInfo.getTotalElements());\n        //\u603b\u9875\u6570\n        resultMap.put("totalPages",resultInfo.getTotalPages());\n        //\u6570\u636e\u96c6\u5408\n        resultMap.put("rows", resultInfo.getContent());\n    }\n    return resultMap;\n}\n}\n')),(0,l.kt)("h3",{id:"23\u8868\u73b0\u5c42\u5b9a\u4e49"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-3%E8%A1%A8%E7%8E%B0%E5%B1%82%E5%AE%9A%E4%B9%89"},"#"),"2.3\u8868\u73b0\u5c42\u5b9a\u4e49"),(0,l.kt)("p",null,"1 com.ydles.search.controller"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@RestController\n@RequestMapping("/search")\npublic class SearchController {\n    @Autowired\n    SearchService searchService;\n    @GetMapping\npublic  Map search(@RequestParam Map<String,String> searchMap){\n    //\u7279\u6b8a\u7b26\u53f7\u5904\u7406\n    this.handleSearchMap(searchMap);\n\n    Map searchResult = searchService.search(searchMap);\n    return searchResult;\n}\n\nprivate void handleSearchMap(Map<String, String> searchMap) {\n    Set<Map.Entry<String, String>> entries = searchMap.entrySet();\n    for (Map.Entry<String, String> entry : entries) {\n        if (entry.getKey().startsWith("spec_")){\n            searchMap.put(entry.getKey(), entry.getValue().replace("+", "%2B"));\n        }\n    }\n}\n}\n')),(0,l.kt)("h3",{id:"24\u6d4b\u8bd5"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-4%E6%B5%8B%E8%AF%95"},"#"),"2.4\u6d4b\u8bd5"),(0,l.kt)("p",null,"postman\u6d4b\u8bd5 ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,"\u7ed3\u679c\uff1a\u9ed8\u8ba4\u5206\u9875 \u6bcf\u987510\u6761"),(0,l.kt)("h2",{id:"3\u5404\u79cd\u67e5\u8be2"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3%E5%90%84%E7%A7%8D%E6%9F%A5%E8%AF%A2"},"#"),"3\u5404\u79cd\u67e5\u8be2"),(0,l.kt)("h3",{id:"31\u6761\u4ef6\u67e5\u8be2\u9700\u6c42"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-1%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2%E9%9C%80%E6%B1%82"},"#"),"3.1\u6761\u4ef6\u67e5\u8be2\u9700\u6c42"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211102225212890-8aa7e7c2.png",alt:"image-20211102225212890"}),"image-20211102225212890"),(0,l.kt)("h3",{id:"32\u54c1\u724c\u8fc7\u6ee4\u67e5\u8be2"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-2%E5%93%81%E7%89%8C%E8%BF%87%E6%BB%A4%E6%9F%A5%E8%AF%A2"},"#"),"3.2\u54c1\u724c\u8fc7\u6ee4\u67e5\u8be2"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://search.ydles.com/search?keywords=PRADA%E5%8C%85%E5%8C%85&brand=prada"},"search.ydles.com/search?keywords=PRADA\u5305\u5305&brand=pradaopen in new window")),(0,l.kt)("p",null,"1\u5b8c\u5584 SearchServiceImpl"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'//\u6309\u7167\u54c1\u724c\u67e5\u8be2       \nif(StringUtils.isNotEmpty(searchMap.get("brand"))){         \n    boolQueryBuilder.filter(QueryBuilders.termQuery("brandName", searchMap.get("brand")));\n}\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5 ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%85&brand=PRADA"},"http://localhost:9009/search?keywords=\u5305\u5305&brand=PRADAopen in new window")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%852019%E7%A7%8B%E5%AD%A3%E9%99%90%E9%87%8F%E7%89%88&brand=PRADA"},"http://localhost:9009/search?keywords=\u5305\u53052019\u79cb\u5b63\u9650\u91cf\u7248&brand=PRADAopen in new window")),(0,l.kt)("h3",{id:"33\u54c1\u724c\u805a\u5408\u67e5\u8be2"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3%E5%93%81%E7%89%8C%E8%81%9A%E5%90%88%E6%9F%A5%E8%AF%A2"},"#"),"3.3\u54c1\u724c\u805a\u5408\u67e5\u8be2"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a\u67e5\u770b\u9759\u6001\u9875\u9762\uff0c\u54c1\u724c\u7684\u663e\u793a\u8981\u6839\u636e\u641c\u7d22\u7ed3\u679c\u4e0d\u540c\u5c55\u73b0\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211102230717607-e564f23c.png",alt:"image-20211102230717607"}),"image-20211102230717607"),(0,l.kt)("p",null,"1\u5b8c\u5584 SearchServiceImpl"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'//\u6309\u7167\u54c1\u724c\u805a\u5408\nString skuBrand="skuBrand";        nativeSearchQueryBuilder.addAggregation(AggregationBuilders.terms(skuBrand).field("brandName"));\n//\u5c01\u88c5\u54c1\u724c\u5206\u7ec4\u7ed3\u679c\nStringTerms brandTerms = (StringTerms) resultInfo.getAggregation(skuBrand);\nList<String> brandList = brandTerms.getBuckets().stream().map(bucket -> bucket.getKeyAsString()).collect(Collectors.toList());\nresultMap.put("brandList", brandList);\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"data:image/png;base64,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",alt:"image-20211102234740360"}),"image-20211102234740360"),(0,l.kt)("h3",{id:"34\u6309\u7167\u89c4\u683c\u8fc7\u6ee4"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-4%E6%8C%89%E7%85%A7%E8%A7%84%E6%A0%BC%E8%BF%87%E6%BB%A4"},"#"),"3.4\u6309\u7167\u89c4\u683c\u8fc7\u6ee4"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211102173855296-19ad5acf.png",alt:"image-20211102173855296"}),"image-20211102173855296"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a"),(0,l.kt)("p",null,"\uff081\uff09\u524d\u7aef\u53d1\u6765\u89c4\u683c\u67e5\u8be2\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"}," http://localhost:9009/search?keywords=\u5305\u5305&spec_\u989c\u8272=\u9ed1\u8272&spec_\u4e8c\u624b\u7a0b\u5ea6=\u5d2d\u65b0\u51fa\u5382\n")),(0,l.kt)("p",null,"\uff082\uff09\u540e\u53f0\u63a5\u5230\u6570\u636e\u540e\uff0c\u53ef\u4ee5\u6839\u636e\u524d\u7f00spec_\u6765\u533a\u5206\u662f\u5426\u662f\u89c4\u683c\uff0c\u5982\u679c\u4ee5 spec_xxx \u5f00\u59cb\u7684\u6570\u636e \u5219\u4e3a\u89c4\u683c\u6570\u636e\uff0c\u9700\u8981\u6839\u636e\u6307\u5b9a\u89c4\u683c\u627e\u4fe1\u606f\u3002"),(0,l.kt)("p",null,"\uff083\uff09"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211102174007624-5f3f6f27.png",alt:"image-20211102174007624"}),"image-20211102174007624"),(0,l.kt)("p",null,'\u4e0a\u56fe\u662f\u89c4\u683c\u7684\u7d22\u5f15\u5b58\u50a8\u683c\u5f0f\uff0c\u771f\u5b9e\u6570\u636e\u5728 "specMap.\u4e8c\u624b\u7a0b\u5ea6.keyword" \u4e2d\uff0c\u6240\u4ee5\u627e\u6570\u636e \u4e5f\u662f\u6309\u7167\u5982\u4e0b\u683c\u5f0f\u53bb\u627e\u3002'),(0,l.kt)("p",null,"1\u5b8c\u5584 SearchServiceImpl"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'//\u6309\u7167\u89c4\u683c\u8fc7\u6ee4\u67e5\u8be2\n        for (String key : searchMap.keySet()) {\n            if(key.startsWith("spec_")){\n                String value = searchMap.get(key).replace("%2B", "+");                boolQueryBuilder.filter(QueryBuilders.termQuery("specMap."+key.substring(5)+".keyword", value));\n            }\n        }\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%85&spec_%E9%A2%9C%E8%89%B2=%E9%BB%91%E8%89%B2"},"http://localhost:9009/search?keywords=\u5305\u5305&spec_\u989c\u8272=\u9ed1\u8272open in new window")),(0,l.kt)("h3",{id:"35\u6309\u7167\u89c4\u683c\u805a\u5408"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-5%E6%8C%89%E7%85%A7%E8%A7%84%E6%A0%BC%E8%81%9A%E5%90%88"},"#"),"3.5\u6309\u7167\u89c4\u683c\u805a\u5408"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211102234249164-fed24d4b.png",alt:"image-20211102234249164"}),"image-20211102234249164"),(0,l.kt)("p",null,"1\u5b8c\u5584 SearchServiceImpl"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'//\u6309\u7167\u89c4\u683c\u805a\u5408\nString skuSpec="skuSpec";        nativeSearchQueryBuilder.addAggregation(AggregationBuilders.terms(skuSpec).field("spec.keyword"));\n//\u5c01\u88c5\u89c4\u683c\u5206\u7ec4\u7ed3\u679c\nStringTerms specTerms = (StringTerms) resultInfo.getAggregation(skuSpec);\nList<String> specList = specTerms.getBuckets().stream().map(bucket -> bucket.getKeyAsString()).collect(Collectors.toList());\nresultMap.put("specList", specList);\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"data:image/png;base64,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",alt:"image-20211102234642879"}),"image-20211102234642879"),(0,l.kt)("p",null,"text \u7c7b\u578b \u4e0d\u80fd\u8fdb\u884c\u805a\u5408\u548c\u6392\u5e8f"),(0,l.kt)("p",null,"keyword \u7c7b\u578b \u80fd\u8fdb\u884c\u805a\u5408\u548c\u6392\u5e8f"),(0,l.kt)("h3",{id:"36\u4ef7\u683c\u533a\u95f4\u67e5\u8be2"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-6%E4%BB%B7%E6%A0%BC%E5%8C%BA%E9%97%B4%E6%9F%A5%E8%AF%A2"},"#"),"3.6\u4ef7\u683c\u533a\u95f4\u67e5\u8be2"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"data:image/png;base64,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",alt:"image-20191216030113126"}),"image-20191216030113126"),(0,l.kt)("p",null,"price=0-5000 price=30000"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a\u4ef7\u683c\u533a\u95f4\u67e5\u8be2\uff0c\u6bcf\u6b21\u9700\u8981\u5c06\u4ef7\u683c\u4f20\u5165\u5230\u540e\u53f0\uff0c\u524d\u7aef\u4f20\u5165\u540e\u53f0\u7684\u4ef7\u683c\u5927\u6982\u662f price=0\u2010500 \u6216\u8005 price=500\u20101000 \u4f9d\u6b21\u7c7b\u63a8\uff0c\u6700\u540e\u4e00\u4e2a\u662f price=3000 ,\u540e\u53f0\u53ef\u4ee5\u6839\u636e-\u5206\u5272\uff0c\u5982\u679c\u5206\u5272 \u5f97\u5230\u7684\u7ed3\u679c\u6700\u591a\u67092\u4e2a\uff0c\u7b2c1\u4e2a\u8868\u793a x<price \uff0c\u7b2c2\u4e2a\u8868\u793a price<=y\u3002"),(0,l.kt)("p",null,"1\u5b8c\u5584 SearchServiceImpl"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'            //\u4ef7\u683c\u533a\u95f4\u67e5\u8be2  price=0-5000     price=30000\n            if(StringUtils.isNotEmpty(searchMap.get("price"))){\n                String price = searchMap.get("price");\n                String[] split = price.split("-");\n\n                //\u4ee3\u7801\u4f18\u5316 codeReview\n                RangeQueryBuilder rangeQueryBuilder = QueryBuilders.rangeQuery("price").gte(split[0]);\n                if(split.length==2){\n                    //price=0-5000\n                    rangeQueryBuilder.lte(split[1]);\n                }//else {\n                    //price=30000\n                //}\n                boolQueryBuilder.filter(rangeQueryBuilder);\n            }\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%85&price=0-500"},"http://localhost:9009/search?keywords=\u5305\u5305&price=0-500open in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211103001912295-d8c53705.png",alt:"image-20211103001912295"}),"image-20211103001912295"),(0,l.kt)("h3",{id:"37\u5206\u9875"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-7%E5%88%86%E9%A1%B5"},"#"),"3.7\u5206\u9875"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%85&pageNum=1&pageSize=30"},"http://localhost:9009/search?keywords=\u5305\u5305&pageNum=1&pageSize=30open in new window")),(0,l.kt)("p",null,"\u6ca1\u6709\u5e26\u5206\u9875\u53c2\u6570\uff0c\u4f60\u5f97\u7ed9\u6211\u9ed8\u8ba4\u67e5\u8be2\u7b2c\u4e00\u9875\uff0c\u6bcf\u987530\u6761\u6570\u636e\u3002"),(0,l.kt)("p",null,"es:",(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211103002507920-47d5c2de.png",alt:"image-20211103002507920"})),(0,l.kt)("p",null,"1\u5b8c\u5584 SearchServiceImpl"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'        //\u5206\u9875\u67e5\u8be2\n        String pageNum = searchMap.get("pageNum");\n        String pageSize = searchMap.get("pageSize");\n        if(StringUtils.isEmpty(pageNum)){\n            pageNum="1";\n        }\n        if(StringUtils.isEmpty(pageSize)){\n            pageSize="30";\n        }\n        nativeSearchQueryBuilder.withPageable(PageRequest.of(Integer.parseInt(pageNum)-1, Integer.parseInt(pageSize)));\n        \n        // \u5f53\u524d\u9875\n        resultMap.put("pageNum", pageNum);\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%85&pageNum=5&pageSize=20"},"http://localhost:9009/search?keywords=\u5305\u5305&pageNum=5&pageSize=20open in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211103003227039-9be97aa8.png",alt:"image-20211103003227039"}),"image-20211103003227039"),(0,l.kt)("h3",{id:"38\u6392\u5e8f"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-8%E6%8E%92%E5%BA%8F"},"#"),"3.8\u6392\u5e8f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"data:image/png;base64,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",alt:"image-20211103005340413"}),"image-20211103005340413"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u6392\u5e8f\u8fd9\u91cc\u603b\u5171\u6709\u6839\u636e\u4ef7\u683c\u6392\u5e8f\u3001\u6839\u636e\u8bc4\u4ef7\u6392\u5e8f\u3001\u6839\u636e\u65b0\u54c1\u6392\u5e8f\u3001\u6839\u636e\u9500\u91cf\u6392\u5e8f\uff0c\u6392\u5e8f\u8981 \u60f3\u5b9e\u73b0\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u8981\u544a\u77e5\u6392\u5e8f\u7684\u57df\u4ee5\u53ca\u6392\u5e8f\u65b9\u5f0f\u5373\u53ef\u5b9e\u73b0\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4ef7\u683c\u6392\u5e8f\uff1a\u53ea\u9700\u8981\u6839\u636e\u4ef7\u683c\u9ad8\u4f4e\u6392\u5e8f\u5373\u53ef\uff0c\u964d\u5e8f\u4ef7\u683c\u9ad8->\u4f4e\uff0c\u5347\u5e8f\u4ef7\u683c\u4f4e->\u9ad8 \u8bc4\u4ef7\u6392\u5e8f\uff1a\u8bc4\u4ef7\u5206\u4e3a\u597d\u8bc4\u3001\u4e2d\u8bc4\u3001\u5dee\u8bc4\uff0c\u53ef\u4ee5\u5728\u6570\u636e\u5e93\u4e2d\u8bbe\u8ba13\u4e2a\u5217\uff0c\u7528\u6765\u8bb0\u5f55\u597d\u8bc4\u3001\u4e2d \u8bc4\u3001\u5dee\u8bc4\u7684\u91cf\uff0c\u6bcf\u6b21\u6392\u5e8f\u7684\u65f6\u5019\uff0c\u597d\u8bc4\u7684\u6bd4\u4f8b\u6765\u6392\u5e8f\uff0c\u5f53\u7136\u8fd8\u8981\u6709")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u6761\u6570\u9650\u5236\uff0c\u8bc4\u4ef7\u6761\u6570 \u9700\u8981\u8d85\u8fc7N\u6761\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u65b0\u54c1\u6392\u5e8f\uff1a\u76f4\u63a5\u6839\u636e\u5546\u54c1\u7684\u53d1\u5e03\u65f6\u95f4\u6216\u8005\u66f4\u65b0\u65f6\u95f4\u6392\u5e8f\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u9500\u91cf\u6392\u5e8f\uff1a\u9500\u91cf\u6392\u5e8f\u9664\u4e86\u9500\u552e\u6570\u91cf\u5916\uff0c\u8fd8\u5e94\u8be5\u8981\u6709\u65f6\u95f4\u6bb5\u9650\u5236\u3002"),(0,l.kt)("p",{parentName:"li"},"  \u9700\u6c42\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%85&sortField=price&sortRule=Desc"},"http://localhost:9009/search?keywords=\u5305\u5305&sortField=price&sortRule=Descopen in new window")),(0,l.kt)("p",{parentName:"li"},"  ",(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211103004713364-32ade5b0.png",alt:"image-20211103004713364"}),"image-20211103004713364"),(0,l.kt)("p",{parentName:"li"},"  1\u5b8c\u5584 SearchServiceImpl"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'```java\n      //\u6392\u5e8f\n      //1\u5f53\u524d\u57df2\u5347\u5e8f\u964d\u5e8f\n      if (StringUtils.isNotEmpty(searchMap.get("sortField")) && StringUtils.isNotEmpty(searchMap.get("sortRule"))) {\n          if ("ASC".equals(searchMap.get("sortRule"))) {\n              //\u5347\u5e8f\n              nativeSearchQueryBuilder.withSort(SortBuilders.fieldSort(searchMap.get("sortField")).order(SortOrder.ASC));\n          } else {\n              //\u964d\u5e8f\n           nativeSearchQueryBuilder.withSort(SortBuilders.fieldSort(searchMap.get("sortField")).order(SortOrder.DESC));\n          }\n      }\n```\n\n\u6d4b\u8bd5\uff1a [http://localhost:9009/search?keywords=\u5305\u5305&pageSize=1000&sortField=price&sortRule=Descopen in new window](http://localhost:9009/search?keywords=\u5305\u5305&pageSize=1000&sortField=price&sortRule=Desc)\n\n![image-20211103005326846](https://www.ydlclass.com/doc21xnv/assets/image-20211103005326846-4c55a377.png)image-20211103005326846\n')),(0,l.kt)("h3",{id:"39\u9ad8\u4eae\u4ecb\u7ecd"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-9%E9%AB%98%E4%BA%AE%E4%BB%8B%E7%BB%8D"},"#"),"3.9\u9ad8\u4eae\u4ecb\u7ecd"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a\u4eac\u4e1c\u641c\u7d22\u7535\u8111"),(0,l.kt)("p",null,"\u4ec0\u4e48\u662f\u9ad8\u4eae\uff1a\u641c\u7d22\u7ed3\u679c\u6587\u5b57\u6837\u5f0f\u4e0d\u540c\u4e8e\u5176\u4ed6\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'<font class="skcolor_ljg">\u5305\u5305</font>\n')),(0,l.kt)("p",null,"\u5b9e\u73b0\u6b65\u9aa4\uff1a"),(0,l.kt)("p",null,"1.\u6307\u5b9a\u9ad8\u4eae\u5b57\u6bb5\uff1aname\u5b57\u6bb5\u3002\u5173\u952e\u8bcd\u524d\u540e\u52a0\u6807\u7b7e\u3002"),(0,l.kt)("p",null,"2.\u5c06\u9ad8\u4eae\u5b57\u6bb5\u63d0\u53d6\uff0c\u66ff\u6362\u9ad8\u4eae\u5b57\u6bb5:name\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211103012436922-74aa5a87.png",alt:"image-20211103012436922"}),"image-20211103012436922"),(0,l.kt)("h3",{id:"310\u9ad8\u4eae\u5b9e\u73b0"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-10%E9%AB%98%E4%BA%AE%E5%AE%9E%E7%8E%B0"},"#"),"3.10\u9ad8\u4eae\u5b9e\u73b0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'//1\u8bbe\u7f6e\u9ad8\u4eae\u57df\nHighlightBuilder.Field field = new HighlightBuilder.Field("name");\n//\u524d\u7f00\nfield.preTags("<span style=\'color:red\'>");\n//\u540e\u7f00\nfield.postTags("</span>");      \nnativeSearchQueryBuilder.withHighlightFields(field);\n\n\n//2\u83b7\u53d6\u9ad8\u4eae\u5b57\u6bb5\nMap<String, HighlightField> highlightFields = hit.getHighlightFields();\nif (highlightFields != null&&highlightFields.size()>0) {                            skuInfo.setName(highlightFields.get("name").getFragments()[0].toString());\n}\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211103013157887-3f9778e7.png",alt:"image-20211103013157887"}),"image-20211103013157887"),(0,l.kt)("p",null,"\u603b\u7ed3 \u641c\u7d22\u540e\u53f0\u5f00\u53d1\u5de5\u7a0b\u5e08"),(0,l.kt)("p",null,"1 estemplate.queryForPage(\u6784\u5efa\u641c\u7d22\u6761\u4ef6\uff0c\u5b9e\u4f53\u7c7b\uff0c\u7ed3\u679c\u6620\u5c04)"),(0,l.kt)("p",null,"2\u5404\u79cd\u67e5\u8be2"),(0,l.kt)("h1",{id:"\u7b2c8\u7ae0-thymeleaf"},(0,l.kt)("a",{parentName:"h1",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#%E7%AC%AC8%E7%AB%A0-thymeleaf"},"#"),"\u7b2c8\u7ae0 Thymeleaf"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u89d2\u8272"),"\uff1a \u524d\u7aef \u5c55\u73b0\u5230\u524d\u53f0\u3002"),(0,l.kt)("h2",{id:"\u5b66\u4e60\u76ee\u6807-1"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87-1"},"#"),"\u5b66\u4e60\u76ee\u6807"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Thymeleaf\u7684\u4ecb\u7ecd"),(0,l.kt)("li",{parentName:"ul"},"Thymeleaf\u7684\u5165\u95e8"),(0,l.kt)("li",{parentName:"ul"},"Thymeleaf\u7684\u8bed\u6cd5\u53ca\u6807\u7b7e"),(0,l.kt)("li",{parentName:"ul"},"\u641c\u7d22\u9875\u9762\u6e32\u67d3"),(0,l.kt)("li",{parentName:"ul"},"\u5546\u54c1\u8be6\u60c5\u9875\u9759\u6001\u5316\u529f\u80fd\u5b9e\u73b0")),(0,l.kt)("h2",{id:"1thymeleaf\u4ecb\u7ecd"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-thymeleaf%E4%BB%8B%E7%BB%8D"},"#"),"1.Thymeleaf\u4ecb\u7ecd"),(0,l.kt)("h3",{id:"1\u52a8\u6001\u9875\u9762"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1%E5%8A%A8%E6%80%81%E9%A1%B5%E9%9D%A2"},"#"),"1\u52a8\u6001\u9875\u9762\uff1a"),(0,l.kt)("p",null,"html+java"),(0,l.kt)("p",null,"\u901a\u8fc7\u6267\u884casp\u3001php\u3001jsp\u548c.net\u7b49\u7a0b\u5e8f\u751f\u6210\u5ba2\u6237\u7aef\u7f51\u9875\u4ee3\u7801\u7684\u7f51\u9875\u3002\u901a\u5e38\u53ef\u4ee5\u901a\u8fc7\u7f51\u7ad9\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u5bf9\u7f51\u7ad9\u7684\u5185\u5bb9\u8fdb\u884c\u66f4\u65b0\u7ba1\u7406\u3002\u53d1\u5e03\u65b0\u95fb\uff0c\u53d1\u5e03\u516c\u53f8\u4ea7\u54c1\uff0c\u4ea4\u6d41\u4e92\u52a8\uff0c\u535a\u5ba2\uff0c\u7f51\u4e0a\u8c03\u67e5\u7b49\uff0c\u8fd9\u90fd\u662f\u52a8\u6001\u7f51\u7ad9\u7684\u4e00\u4e9b\u529f\u80fd\u3002\u4e5f\u662f\u6211\u4eec\u5e38\u89c1\u7684\u3002 \u5e38\u89c1\u7684\u6269\u5c55\u540d\u6709\uff1a.asp\u3001php\u3001jsp\u3001cgi\u548caspx \u7b49\u3002 \u6ce8\u610f\uff1a\u52a8\u6001\u9875\u9762\u7684\u201c\u52a8\u6001\u201d\u662f\u7f51\u7ad9\u4e0e\u5ba2\u6237\u7aef\u7528\u6237\u4e92\u52a8\u7684\u610f\u601d\uff0c\u800c\u975e\u7f51\u9875\u4e0a\u6709\u52a8\u753b\u7684\u5c31\u662f\u52a8\u6001\u9875\u9762\u3002"),(0,l.kt)("p",null,"A\uff0e\u4ea4\u4e92\u6027\u597d\u3002"),(0,l.kt)("p",null,"B\uff0e\u52a8\u6001\u7f51\u9875\u7684\u4fe1\u606f\u90fd\u9700\u8981\u4ece\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\uff0c\u6bcf\u6253\u5f00\u4e00\u4e2a\u4e00\u9762\u5c31\u9700\u8981\u53bb\u83b7\u53d6\u4e00\u6b21\u6570\u636e\u5e93\uff0c\u5982\u679c\u8bbf\u95ee\u4eba\u6570\u5f88\u591a\uff0c\u4e5f\u5c31\u4f1a\u5bf9\u670d\u52a1\u5668\u589e\u52a0\u5f88\u5927\u7684\u8377\u8f7d\uff0c\u4ece\u800c\u5f71\u54cd\u8fd9\u4e2a\u7f51\u7ad9\u7684\u8fd0\u884c\u901f\u5ea6\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110150650096-45ed26a3.png",alt:"image-20211110150650096"}),"image-20211110150650096"),(0,l.kt)("h3",{id:"2\u9759\u6001\u9875\u9762"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2"},"#"),"2\u9759\u6001\u9875\u9762\uff1a"),(0,l.kt)("p",null,"\u6700\u65e9\u7684\u65f6\u5019\uff0c\u7f51\u7ad9\u5185\u5bb9\u662f\u901a\u8fc7\u5728\u4e3b\u673a\u7a7a\u95f4\u4e2d\u653e\u7f6e\u5927\u91cf\u7684\u9759\u6001\u7f51\u9875\u5b9e\u73b0\u7684\u3002\u4e3a\u4e86\u65b9\u4fbf\u5bf9\u8fd9\u4e9b\u5206\u6563\u5728\u4e0d\u540c\u76ee\u5f55\u7684\u9759\u6001\u7f51\u9875\u7684\u7ba1\u7406\uff0c\uff08\u4e00\u822c\u662f\u901a\u8fc7FTP)\uff0c\u8c61frontpage/dreamweaver\u8fd9\u6837\u8f6f\u4ef6\u751a\u81f3\u76f4\u63a5\u63d0\u4f9b\u4e86\u5411\u4e3b\u9875\u7a7a\u95f4\u4ee5FTP\u65b9\u5f0f\u76f4\u63a5\u8bbf\u95ee\u6587\u4ef6\u7684\u529f\u80fd\u3002\u4ee5\u9759\u6001\u7f51\u9875\u4e3a\u4e3b\u7684\u7f51\u7ad9\u6700\u5927\u7684\u56f0\u96be\u5728\u4e8e\u5bf9\u7f51\u9875\u7684\u7ba1\u7406\uff0c\u5728\u8fd9\u79cd\u6846\u67b6\u91cc\uff0c\u7f51\u9875\u6846\u67b6\u548c\u7f51\u9875\u4e2d\u7684\u5185\u5bb9\u6df7\u6742\u5728\u4e00\u8d77\uff0c\u5f88\u5927\u7a0b\u5ea6\u5730\u52a0\u5927\u4e86\u5185\u5bb9\u7ba1\u7406\u7684\u96be\u5ea6\u3002\u4e3a\u4e86\u51cf\u8f7b\u8fd9\u79cd\u7ba1\u7406\u7684\u6210\u672c\uff0c\u53d1\u5c55\u51fa\u4e86\u4e00\u7cfb\u5217\u7684\u6280\u672f\uff0c\u751a\u81f3\u8fdecss\u672c\u8eab\uff0c\u539f\u672c\u4e5f\u662f\u9488\u5bf9\u8fd9\u79cd\u4e71\u4e03\u516b\u7cdf\u7684\u7f51\u9875\u7ef4\u62a4\u800c\u8bbe\u8ba1\u7684\uff0c\u76ee\u7684\u5c31\u662f\u628a\u7f51\u9875\u8868\u8fbe\u7684\u6846\u67b6\u548c\u5185\u5bb9\u672c\u8eab\u62bd\u8c61\u5206\u79bb\u51fa\u6765\u3002"),(0,l.kt)("p",null,"A\uff0e\u9759\u6001\u7f51\u9875\u7684\u5185\u5bb9\u7a33\u5b9a\uff0c\u9875\u9762\u52a0\u8f7d\u901f\u5ea6\u5feb\u3002"),(0,l.kt)("p",null,"B\uff0e\u9759\u6001\u7f51\u9875\u7684\u6ca1\u6709\u6570\u636e\u5e93\u652f\u6301\uff0c\u5728\u7f51\u7ad9\u5236\u4f5c\u548c\u7ef4\u62a4\u65b9\u9762\u7684\u5de5\u4f5c\u91cf\u8f83\u5927\u3002"),(0,l.kt)("p",null,"C\uff0e\u9759\u6001\u7f51\u9875\u7684\u4ea4\u4e92\u6027\u5dee\uff0c\u6709\u5f88\u5927\u7684\u5c40\u9650\u6027\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110150711346-f8786698.png",alt:"image-20211110150711346"}),"image-20211110150711346"),(0,l.kt)("h3",{id:"3\u4e3a\u4ec0\u4e48\u9700\u8981\u52a8\u6001\u9875\u9762\u9759\u6001\u5316"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%8A%A8%E6%80%81%E9%A1%B5%E9%9D%A2%E9%9D%99%E6%80%81%E5%8C%96"},"#"),"3\u4e3a\u4ec0\u4e48\u9700\u8981\u52a8\u6001\u9875\u9762\u9759\u6001\u5316\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u641c\u7d22\u5f15\u64ce\u7684\u4f18\u5316")),(0,l.kt)("p",null,"\u5c3d\u7ba1\u641c\u7d22\u673a\u5668\u4eba\u6709\u70b9\u8ba8\u538c\uff0c\u5404\u4e2a\u7f51\u7ad9\u4e0d\u4f46\u4e0d\u4f1a\u518d\u8c61\u4ece\u524d\u4e00\u6837\u628a\u5b83\u5c01\u8d77\u6765\uff0c\u53cd\u800c\u70ed\u60c5\u65e0\u6bd4\u5730\u641e",(0,l.kt)("strong",{parentName:"p"},"SEO"),"\uff0c\u6240\u8c13\u7684\u9762\u5411\u641c\u7d22\u5f15\u64ce\u7684\u4f18\u5316\uff0c\u5176\u4e2d\u5c31\u5305\u62ec\u8bbf\u95ee\u5730\u5740\u7684\u6539\u5199\uff0c\u4ee4\u52a8\u6001\u7f51\u9875\u770b\u4e0a\u53bb\u662f\u9759\u6001\u7f51\u9875\uff0c\u4ee5\u4fbf\u66f4\u591a\u66f4\u5927\u91cf\u5730\u88ab\u641c\u7d22\u5f15\u64ce\u6536\u5f55\uff0c\u4ece\u800c\u6700\u5927\u9650\u5ea6\u5730\u63d0\u9ad8\u81ea\u5df2\u7684\u5185\u5bb9\u88ab\u76ee\u6807\u63a5\u6536\u7684\u673a\u4f1a\u3002\u4f46\u662f\uff0c\u5728\u5b8c\u5168\u4ee5\u52a8\u6001\u6280\u672f\u5f00\u53d1\u7684\u7f51\u7ad9\uff0c\u8f6c\u773c\u4e2d\u8981\u6c42\u53d8\u6362\u6210\u9759\u6001\u7f51\u9875\u63d0\u4f9b\uff0c\u540c\u65f6\uff0c\u65e0\u8bba\u5982\u4f55\uff0c\u52a8\u6001\u7f51\u9875\u7684\u5185\u5bb9\u7ba1\u7406\u529f\u80fd\u4e5f\u662f\u5fc5\u987b\u4fdd\u7559\u7684\uff1b\u5c31\u5982\u540c\u4e00\u8f86\u98de\u9a76\u7684\u5954\u9a70\u5ffd\u7136\u8981\u6c42180\u5ea6\u8f6c\u5f2f\uff0c\u8981\u4ed8\u51fa\u7684\u6210\u672c\u4ee3\u4ef7\u662f\u975e\u5e38\u5927\u7684\uff0c\u662f\u5426\u771f\u7684\u503c\u5f97\uff0c\u4e5f\u786e\u5b9e\u8ba9\u4eba\u6000\u7591\u3002"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u63d0\u9ad8\u7a0b\u5e8f\u6027\u80fd 10w/s")),(0,l.kt)("p",null,"\u5f88\u591a\u5927\u578b\u7f51\u7ad9\uff0c\u8fdb\u53bb\u7684\u65f6\u5019\u770b\u5b83\u5f88\u590d\u6742\u7684\u9875\u9762\uff0c\u4f46\u662f\u52a0\u8f7d\u4e5f\u6ca1\u6709\u8017\u8d39\u591a\u957f\u65f6\u95f4\uff0c\u9664\u4e86\u5176\u5b83\u5fc5\u8981\u539f\u56e0\u4ee5\u5916\uff0c\u9759\u6001\u5316\u4e5f\u662f\u5176\u4e2d\u5fc5\u9700\u8003\u8651\u7684\u6280\u672f\u4e4b\u4e00\u3002"),(0,l.kt)("p",null,"\u5148\u4e8e\u7528\u6237\u83b7\u53d6\u8d44\u6e90\u6216\u6570\u636e\u5e93\u6570\u636e\u8fdb\u800c\u901a\u8fc7\u9759\u6001\u5316\u5904\u7406\uff0c\u751f\u6210\u9759\u6001\u9875\u9762\uff0c\u6240\u6709\u4eba\u90fd\u8bbf\u95ee\u8fd9\u4e00\u4e2a\u9759\u6001\u9875\u9762\uff0c\u800c\u9759\u6001\u5316\u5904\u7406\u7684\u9875\u9762\u672c\u8eab\u7684\u8bbf\u95ee\u901f\u5ea6\u8981\u8f83\u52a8\u6001\u9875\u9762\u5feb\u5f88\u591a\u500d\uff0c\u56e0\u6b64\u7a0b\u5e8f\u6027\u80fd\u4f1a\u6709\u5927\u5927\u7684\u63d0\u5347\u3002"),(0,l.kt)("p",null,"\u9759\u6001\u5316\u5728\u9875\u9762\u4e0a\u7684\u4f53\u73b0\u4e3a\uff1a\u8bbf\u95ee\u901f\u5ea6\u52a0\u5feb\uff0c\u7528\u6237\u4f53\u9a8c\u6027\u660e\u663e\u63d0\u5347\uff1b\u5728\u540e\u53f0\u4f53\u73b0\u4e3a\uff1a\u8bbf\u95ee\u8131\u79bb\u6570\u636e\u5e93\uff0c\u51cf\u8f7b\u4e86\u6570\u636e\u5e93\u8bbf\u95ee\u538b\u529b\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6a21\u677f+\u6570\u636e=\u6587\u672c")),(0,l.kt)("p",null,"thymeleaf\u662f\u4e00\u4e2aXML/XHTML/HTML5\u6a21\u677f\u5f15\u64ce\uff0c\u53ef\u7528\u4e8eWeb\u4e0e\u975eWeb\u73af\u5883\u4e2d\u7684\u5e94\u7528\u5f00\u53d1\u3002\u5b83\u662f\u4e00\u4e2a\u5f00\u6e90\u7684Java\u5e93\uff0c\u57fa\u4e8eApache License 2.0\u8bb8\u53ef\uff0c\u7531Daniel Fern\xe1ndez\u521b\u5efa\uff0c\u8be5\u4f5c\u8005\u8fd8\u662fJava\u52a0\u5bc6\u5e93Jasypt\u7684\u4f5c\u8005\u3002"),(0,l.kt)("p",null,"Thymeleaf\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7528\u4e8e\u6574\u5408Spring MVC\u7684\u53ef\u9009\u6a21\u5757\uff0c\u5728\u5e94\u7528\u5f00\u53d1\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528Thymeleaf\u6765\u5b8c\u5168\u4ee3\u66ffJSP\u6216\u5176\u4ed6\u6a21\u677f\u5f15\u64ce\uff0c\u5982Velocity\u3001FreeMarker\u7b49\u3002Thymeleaf\u7684\u4e3b\u8981\u76ee\u6807\u5728\u4e8e\u63d0\u4f9b\u4e00\u79cd\u53ef\u88ab\u6d4f\u89c8\u5668\u6b63\u786e\u663e\u793a\u7684\u3001\u683c\u5f0f\u826f\u597d\u7684\u6a21\u677f\u521b\u5efa\u65b9\u5f0f\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u7528\u4f5c\u9759\u6001\u5efa\u6a21\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u5b83\u521b\u5efa\u7ecf\u8fc7\u9a8c\u8bc1\u7684XML\u4e0eHTML\u6a21\u677f\u3002\u76f8\u5bf9\u4e8e\u7f16\u5199\u903b\u8f91\u6216\u4ee3\u7801\uff0c\u5f00\u53d1\u8005\u53ea\u9700\u5c06\u6807\u7b7e\u5c5e\u6027\u6dfb\u52a0\u5230\u6a21\u677f\u4e2d\u5373\u53ef\u3002\u63a5\u4e0b\u6765\uff0c\u8fd9\u4e9b\u6807\u7b7e\u5c5e\u6027\u5c31\u4f1a\u5728DOM\uff08\u6587\u6863\u5bf9\u8c61\u6a21\u578b\uff09\u4e0a\u6267\u884c\u9884\u5148\u5236\u5b9a\u597d\u7684\u903b\u8f91\u3002"),(0,l.kt)("p",null,"\u5b83\u7684\u7279\u70b9\u4fbf\u662f\uff1a\u5f00\u7bb1\u5373\u7528\uff0cThymeleaf\u5141\u8bb8\u60a8\u5904\u7406\u516d\u79cd\u6a21\u677f\uff0c\u6bcf\u79cd\u6a21\u677f\u79f0\u4e3a\u6a21\u677f\u6a21\u5f0f\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"XML"),(0,l.kt)("li",{parentName:"ul"},"\u6709\u6548\u7684XML"),(0,l.kt)("li",{parentName:"ul"},"XHTML"),(0,l.kt)("li",{parentName:"ul"},"\u6709\u6548\u7684XHTML"),(0,l.kt)("li",{parentName:"ul"},"HTML5"),(0,l.kt)("li",{parentName:"ul"},"\u65e7\u7248HTML5")),(0,l.kt)("p",null,"\u6240\u6709\u8fd9\u4e9b\u6a21\u5f0f\u90fd\u6307\u7684\u662f\u683c\u5f0f\u826f\u597d\u7684XML\u6587\u4ef6\uff0c\u4f46",(0,l.kt)("em",{parentName:"p"},"Legacy HTML5"),"\u6a21\u5f0f\u9664\u5916\uff0c\u5b83\u5141\u8bb8\u60a8\u5904\u7406HTML5\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u72ec\u7acb\uff08\u975e\u5173\u95ed\uff09\u6807\u8bb0\uff0c\u6ca1\u6709\u503c\u7684\u6807\u8bb0\u5c5e\u6027\u6216\u4e0d\u5728\u5f15\u53f7\u4e4b\u95f4\u5199\u5165\u7684\u6807\u8bb0\u5c5e\u6027\u3002\u4e3a\u4e86\u5728\u8fd9\u79cd\u7279\u5b9a\u6a21\u5f0f\u4e0b\u5904\u7406\u6587\u4ef6\uff0cThymeleaf\u5c06\u9996\u5148\u6267\u884c\u8f6c\u6362\uff0c\u5c06\u60a8\u7684\u6587\u4ef6\u8f6c\u6362\u4e3a\u683c\u5f0f\u826f\u597d\u7684XML\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4ecd\u7136\u662f\u5b8c\u5168\u6709\u6548\u7684HTML5\uff08\u5b9e\u9645\u4e0a\u662f\u521b\u5efaHTML5\u4ee3\u7801\u7684\u63a8\u8350\u65b9\u6cd5\uff09",(0,l.kt)("a",{parentName:"p",href:"https://www.thymeleaf.org/doc/tutorials/2.1/usingthymeleaf.html#fn1"},"1open in new window"),"\u3002"),(0,l.kt)("p",null,"\u53e6\u8bf7\u6ce8\u610f\uff0c\u9a8c\u8bc1\u4ec5\u9002\u7528\u4e8eXML\u548cXHTML\u6a21\u677f\u3002"),(0,l.kt)("p",null,"\u7136\u800c\uff0c\u8fd9\u4e9b\u5e76\u4e0d\u662fThymeleaf\u53ef\u4ee5\u5904\u7406\u7684\u552f\u4e00\u6a21\u677f\u7c7b\u578b\uff0c\u5e76\u4e14\u7528\u6237\u59cb\u7ec8\u80fd\u591f\u901a\u8fc7\u6307\u5b9a\u5728\u6b64\u6a21\u5f0f\u4e0b",(0,l.kt)("em",{parentName:"p"},"\u89e3\u6790"),"\u6a21\u677f\u7684\u65b9\u6cd5\u548c",(0,l.kt)("em",{parentName:"p"},"\u7f16\u5199"),"\u7ed3\u679c\u7684\u65b9\u5f0f\u6765\u5b9a\u4e49\u4ed6/\u5979\u81ea\u5df1\u7684\u6a21\u5f0f\u3002\u8fd9\u6837\uff0c\u4efb\u4f55\u53ef\u4ee5\u5efa\u6a21\u4e3aDOM\u6811\uff08\u65e0\u8bba\u662f\u5426\u4e3aXML\uff09\u7684\u4e1c\u897f\u90fd\u53ef\u4ee5\u88abThymeleaf\u6709\u6548\u5730\u4f5c\u4e3a\u6a21\u677f\u5904\u7406\u3002"),(0,l.kt)("h3",{id:"4thymeleaf\u4ecb\u7ecd"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4thymeleaf%E4%BB%8B%E7%BB%8D"},"#"),"4Thymeleaf\u4ecb\u7ecd"),(0,l.kt)("p",null,"1\u6982\u5ff5\uff1aXML/XHTML/HTML5\u6a21\u677f\u5f15\u64ce\u3002"),(0,l.kt)("p",null,"2\u5176\u4ed6\u6a21\u677f\u5f15\u64ce\uff1aVelocity\u3001FreeMarker\u3001jsp"),(0,l.kt)("p",null,"3\u4e3a\u4ec0\u4e48\u4f7f\u7528\u5b83\uff1a",(0,l.kt)("strong",{parentName:"p"},"springboot\u5185\u7f6e\u652f\u6301")),(0,l.kt)("p",null,"4\u7279\u70b9\uff1a\u5f00\u7bb1\u5373\u7528\uff0cThymeleaf\u5141\u8bb8\u60a8\u5904\u7406\u516d\u79cd\u6a21\u677f\uff0c\u6bcf\u79cd\u6a21\u677f\u79f0\u4e3a\u6a21\u677f\u6a21\u5f0f\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"XML"),(0,l.kt)("li",{parentName:"ul"},"\u6709\u6548\u7684XML"),(0,l.kt)("li",{parentName:"ul"},"XHTML"),(0,l.kt)("li",{parentName:"ul"},"\u6709\u6548\u7684XHTML"),(0,l.kt)("li",{parentName:"ul"},"HTML5"),(0,l.kt)("li",{parentName:"ul"},"\u65e7\u7248HTML5")),(0,l.kt)("h2",{id:"2springboot\u6574\u5408thymeleaf"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-springboot%E6%95%B4%E5%90%88thymeleaf"},"#"),"2.Springboot\u6574\u5408thymeleaf"),(0,l.kt)("p",null,"\u4f7f\u7528springboot \u6765\u96c6\u6210\u4f7f\u7528Thymeleaf\u53ef\u4ee5\u5927\u5927\u51cf\u5c11\u5355\u7eaf\u4f7f\u7528thymleaf\u7684\u4ee3\u7801\u91cf\uff0c\u6240\u4ee5\u6211\u4eec\u63a5\u4e0b\u6765\u4f7f\u7528springboot\u96c6\u6210\u4f7f\u7528thymeleaf."),(0,l.kt)("p",null,"\u5b9e\u73b0\u7684\u6b65\u9aa4\u4e3a\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u521b\u5efa\u4e00\u4e2asprinboot\u9879\u76ee"),(0,l.kt)("li",{parentName:"ul"},"\u6dfb\u52a0thymeleaf\u7684\u8d77\u6b65\u4f9d\u8d56"),(0,l.kt)("li",{parentName:"ul"},"\u6dfb\u52a0spring web\u7684\u8d77\u6b65\u4f9d\u8d56"),(0,l.kt)("li",{parentName:"ul"},"\u7f16\u5199html \u4f7f\u7528thymleaf\u7684\u8bed\u6cd5\u83b7\u53d6\u53d8\u91cf\u5bf9\u5e94\u540e\u53f0\u4f20\u9012\u7684\u503c"),(0,l.kt)("li",{parentName:"ul"},"\u7f16\u5199controller \u8bbe\u7f6e\u53d8\u91cf\u7684\u503c\u5230model\u4e2d")),(0,l.kt)("p",null,"(1)\u521b\u5efa\u5de5\u7a0b"),(0,l.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a\u72ec\u7acb\u7684\u5de5\u7a0bspringboot-thymeleaf,\u8be5\u5de5\u7a0b\u4e3a\u6848\u4f8b\u5de5\u7a0b\uff0c\u4e0d\u9700\u8981\u653e\u5230ydles\u5de5\u7a0b\u4e2d\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"pom.xml\u4f9d\u8d56")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.ydles</groupId>\n    <artifactId>springboot-thymeleaf</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.1.4.RELEASE</version>\n    </parent>\n\n    <dependencies>\n        \x3c!--web\u8d77\u6b65\u4f9d\u8d56--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n        \x3c!--thymeleaf\u914d\u7f6e--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-thymeleaf</artifactId>\n        </dependency>\n    </dependencies>\n</project>\n')),(0,l.kt)("p",null,"(2)\u521b\u5efa\u5305com.ydles.thymeleaf.\u5e76\u521b\u5efa\u542f\u52a8\u7c7bThymeleafApplication"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@SpringBootApplication\npublic class ThymeleafApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(ThymeleafApplication.class,args);\n    }\n}\n")),(0,l.kt)("p",null,"(3)\u521b\u5efaapplication.yml"),(0,l.kt)("p",null,"\u8bbe\u7f6ethymeleaf\u7684\u7f13\u5b58\u8bbe\u7f6e\uff0c\u8bbe\u7f6e\u4e3afalse\u3002\u9ed8\u8ba4\u52a0\u7f13\u5b58\u7684\uff0c\u7528\u4e8e\u6d4b\u8bd5\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  thymeleaf:\n    cache: false\n")),(0,l.kt)("p",null,"(4)\u63a7\u5236\u5c42"),(0,l.kt)("p",null,"\u521b\u5efacontroller\u7528\u4e8e\u6d4b\u8bd5\u540e\u53f0 \u8bbe\u7f6e\u6570\u636e\u5230model\u4e2d\u3002"),(0,l.kt)("p",null,"\u521b\u5efacom.ydles.controller.TestController\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Controller\n@RequestMapping("/test")\npublic class TestController {\n\n    /***\n     * \u8bbf\u95ee/test/hello  \u8df3\u8f6c\u5230demo1\u9875\u9762\n     * @param model\n     * @return\n     */\n    @RequestMapping("/hello")\n    public String hello(Model model){\n        model.addAttribute("hello","hello welcome");\n        return "demo";\n    }\n}\n')),(0,l.kt)("p",null,"(2)\u521b\u5efahtml"),(0,l.kt)("p",null,"\u5728resources\u4e2d\u521b\u5efatemplates\u76ee\u5f55\uff0c\u5728templates\u76ee\u5f55\u521b\u5efa demo.html,\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<!DOCTYPE html>\n<html xmlns:th="http://www.thymeleaf.org">\n<head>\n    <title>Thymeleaf\u7684\u5165\u95e8</title>\n    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>\n</head>\n<body>\n\x3c!--\u8f93\u51fahello\u6570\u636e--\x3e\n<p th:text="${hello}"></p>\n</body>\n</html>\n')),(0,l.kt)("p",null,"\u89e3\u91ca\uff1a"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},'html xmlns:th="http://www.thymeleaf.org"'),":\u8fd9\u53e5\u58f0\u660e\u4f7f\u7528thymeleaf\u6807\u7b7e"),(0,l.kt)("p",null,':\u8fd9\u53e5\u4f7f\u7528 th:text="${\u53d8\u91cf\u540d}" \u8868\u793a \u4f7f\u7528thymeleaf\u83b7\u53d6\u6587\u672c\u6570\u636e\uff0c\u7c7b\u4f3c\u4e8eEL\u8868\u8fbe\u5f0f\u3002'),(0,l.kt)("p",null,"(5)\u6d4b\u8bd5"),(0,l.kt)("p",null,"\u542f\u52a8\u7cfb\u7edf\uff0c\u5e76\u5728\u6d4f\u89c8\u5668\u8bbf\u95ee"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"http://localhost:8080/test/hello\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110152322446-87380524.png",alt:"image-20211110152322446"}),"image-20211110152322446"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110152329656-fa56afc3.png",alt:"image-20211110152329656"}),"image-20211110152329656"),(0,l.kt)("h2",{id:"3-thymeleaf\u57fa\u672c\u8bed\u6cd5"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-thymeleaf%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"},"#"),"3 Thymeleaf\u57fa\u672c\u8bed\u6cd5"),(0,l.kt)("p",null,"(1)th:action"),(0,l.kt)("p",null,"\u5b9a\u4e49\u540e\u53f0\u63a7\u5236\u5668\u8def\u5f84\uff0c\u7c7b\u4f3c",(0,l.kt)("inlineCode",{parentName:"p"},"<form>"),"\u6807\u7b7e\u7684action\u5c5e\u6027\u3002"),(0,l.kt)("p",null,"\u4f8b\u5982\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<form th:action="@{/demo/test}">\n    <input th:type="text" th:name="id">\n    <button>\u63d0\u4ea4</button>\n</form>\n')),(0,l.kt)("p",null,"action"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public String test(Model model,String id){    \n    System.out.println(id);\n}\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"data:image/png;base64,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",alt:"image-20211110154323405"}),"image-20211110154323405"),(0,l.kt)("p",null,"(2)th:each"),(0,l.kt)("p",null,"\u5bf9\u8c61\u904d\u5386\uff0c\u529f\u80fd\u7c7b\u4f3cjstl\u4e2d\u7684<c:forEach>\u6807\u7b7e\u3002"),(0,l.kt)("p",null,"\u521b\u5efacom.ydles.model.User,\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public class User {\nprivate Integer id;\nprivate String name;\nprivate String address;\ngetter and settrt\n}\n")),(0,l.kt)("p",null,"Controller\u6dfb\u52a0\u6570\u636e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'    List<User> userList=new ArrayList<>();\n    userList.add(new User(1, "a", "bj"));\n    userList.add(new User(2, "b", "tj"));\n    userList.add(new User(3, "c", "nj"));\n    model.addAttribute("userList", userList);\n')),(0,l.kt)("p",null,"demo.html"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<table>\n    <tr>\n        <td>\u4e0b\u6807</td>\n        <td>\u7f16\u53f7</td>\n        <td>\u59d3\u540d</td>\n        <td>\u4f4f\u5740</td>\n    </tr>\n    <tr th:each="user,userStat:${userList}">\n        <td th:text="${userStat.index}"></td>\n        <td th:text="${user.id}"></td>\n        <td th:text="${user.name}"></td>\n        <td th:text="${user.address}"></td>\n    </tr>\n</table>\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\u6548\u679c"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110154936019-3bb571cd.png",alt:"image-20211110154936019"}),"image-20211110154936019"),(0,l.kt)("p",null,"(3) map\u53d6\u503c"),(0,l.kt)("p",null,"1action"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'    Map<String,Object> dataMap=new HashMap<>();\n    dataMap.put("No", "123");\n    dataMap.put("address", "bj");\n    model.addAttribute("dataMap", dataMap);\n')),(0,l.kt)("p",null,"2 demo.html"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<div th:each="map,mapStat:${dataMap}">\n    <div th:text="${map}"></div>\n\n    key:<span th:text="${mapStat.current.key}"></span><br>\n    value:<span th:text="${mapStat.current.value}"></span><br>\n    ====================================\n</div>\n')),(0,l.kt)("p",null,"3\u6d4b\u8bd5 \u542f\u52a8\u5de5\u7a0b \u8bbf\u95ee ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8080/demo/hello"},"http://localhost:8080/demo/helloopen in new window")),(0,l.kt)("p",null,"\u6d4b\u8bd5\u6548\u679c"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110155326665-ea11dc25.png",alt:"image-20211110155326665"}),"image-20211110155326665"),(0,l.kt)("p",null,"(4)\u6570\u7ec4\u904d\u5386"),(0,l.kt)("p",null,"1action"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'String[] names={"\u5f20\u4e09","\u674e\u56db","\u738b\u4e94"};\nmodel.addAttribute("names",names );\n')),(0,l.kt)("p",null,"2demo.html"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<div th:each="nm,nmStat:${names}">\n    <span th:text="${nmStat.count}"></span><br>\n    <span th:text="${nm}"></span><br>\n    ====================================\n</div>\n')),(0,l.kt)("p",null,"3\u6d4b\u8bd5 \u542f\u52a8\u5de5\u7a0b \u8bbf\u95ee ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8080/demo/test"},"http://localhost:8080/demo/testopen in new window")),(0,l.kt)("p",null,"\u6d4b\u8bd5\u6548\u679c"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110155931741-ad4693a0.png",alt:"image-20211110155931741"}),"image-20211110155931741"),(0,l.kt)("p",null,"(5)Date\u8f93\u51fa"),(0,l.kt)("p",null,"1action"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-javascript"},'model.addAttribute("now", new Date());\n')),(0,l.kt)("p",null,"2demo.html"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<div>    \n    <span th:text=\"${#dates.format(now,'yyyy-MM-dd hh:mm:ss')}\"></span>\n</div>\n")),(0,l.kt)("p",null,"\u6d4b\u8bd5\u6548\u679c"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110160251113-3bf674b6.png",alt:"image-20211110160251113"}),"image-20211110160251113"),(0,l.kt)("p",null,"(6)th:if\u6761\u4ef6"),(0,l.kt)("p",null,"1action"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'model.addAttribute("age", 15);\n')),(0,l.kt)("p",null,"2demo.html"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<div>    \n    <span th:if="${(age>=18)}">\u7ec8\u4e8e\u6210\u5e74\u4e86</span>\n</div>\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\u6548\u679c"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110160627425-cf97510c.png",alt:"image-20211110160627425"}),"image-20211110160627425"),(0,l.kt)("p",null,"(7)th:fragment \u6a21\u5757\u58f0\u660e\u4e0e\u9875\u9762\u5305\u542b"),(0,l.kt)("p",null,"1 \u65b0\u5efafooter.html"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<!DOCTYPE html>\n<html xmlns:th="http://www.thymeleaf.org">\n<head>\n    <meta charset="UTF-8">\n    <title>fragment</title>\n</head>\n<body>\n<div id="C" th:fragment="copy">\n    \u5173\u4e8e\u6211\u4eec<br/>\n</div>\n</body>\n</html>\n')),(0,l.kt)("p",null,"2 demo.html"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'<div id="W" th:include="footer::copy"></div>\n')),(0,l.kt)("p",null,"\u6548\u679c\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110161046356-cabd3df3.png",alt:"image-20211110161046356"}),"image-20211110161046356"),(0,l.kt)("h2",{id:"4-\u641c\u7d22\u9875\u9762\u6e32\u67d3"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-%E6%90%9C%E7%B4%A2%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93"},"#"),"4 \u641c\u7d22\u9875\u9762\u6e32\u67d3"),(0,l.kt)("h3",{id:"41-\u641c\u7d22\u5206\u6790"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-1-%E6%90%9C%E7%B4%A2%E5%88%86%E6%9E%90"},"#"),"4.1 \u641c\u7d22\u5206\u6790"),(0,l.kt)("p",null,"\u6253\u5f00chapter01 \u6846\u67b6\u642d\u5efa/\u8d44\u6e90/\u9759\u6001\u539f\u578b/\u524d\u53f0/search.html"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110175725130-6de32311.png",alt:"image-20211110175725130"}),"image-20211110175725130"),(0,l.kt)("p",null,"\u641c\u7d22\u9875\u9762\u8981\u663e\u793a\u7684\u5185\u5bb9\u4e3b\u8981\u5206\u4e3a3\u5757\u3002"),(0,l.kt)("p",null,"1)\u641c\u7d22\u7684\u6570\u636e\u7ed3\u679c"),(0,l.kt)("p",null,"2)\u7b5b\u9009\u51fa\u7684\u6570\u636e\u641c\u7d22\u6761\u4ef6"),(0,l.kt)("p",null,"3)\u7528\u6237\u5df2\u7ecf\u52fe\u9009\u7684\u6570\u636e\u6761\u4ef6"),(0,l.kt)("h3",{id:"42-\u641c\u7d22\u5b9e\u73b0"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-%E6%90%9C%E7%B4%A2%E5%AE%9E%E7%8E%B0"},"#"),"4.2 \u641c\u7d22\u5b9e\u73b0"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110181009088-9f96a2e0.png",alt:"image-20211110181009088"}),"image-20211110181009088"),(0,l.kt)("p",null,"\u641c\u7d22\u7684\u4e1a\u52a1\u6d41\u7a0b\u5982\u4e0a\u56fe\uff0c\u7528\u6237\u6bcf\u6b21\u641c\u7d22\u7684\u65f6\u5019\uff0c\u5148\u7ecf\u8fc7\u641c\u7d22\u4e1a\u52a1\u5de5\u7a0b\uff0c\u641c\u7d22\u4e1a\u52a1\u5de5\u7a0b\u8c03\u7528\u641c\u7d22\u5fae\u670d\u52a1\u5de5\u7a0b\u3002"),(0,l.kt)("h4",{id:"421-\u641c\u7d22\u5de5\u7a0b\u642d\u5efa"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-1-%E6%90%9C%E7%B4%A2%E5%B7%A5%E7%A8%8B%E6%90%AD%E5%BB%BA"},"#"),"4.2.1 \u641c\u7d22\u5de5\u7a0b\u642d\u5efa"),(0,l.kt)("p",null,"(1)search\u641c\u7d22\u670d\u52a1 \u6dfb\u52a0\u4f9d\u8d56"),(0,l.kt)("p",null,"\u5728ydles-service_search\u5de5\u7a0b\u4e2d\u7684pom.xml\u4e2d\u5f15\u5165\u5982\u4e0b\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-thymeleaf</artifactId>\n    </dependency>\n")),(0,l.kt)("p",null,"(2)\u9759\u6001\u8d44\u6e90\u5bfc\u5165"),(0,l.kt)("p",null,"\u5c06\u8d44\u6e90\u4e2d\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"\u9875\u9762\u8d44\u6e90/\u6240\u6709\u5185\u5bb9"),"\u62f7\u8d1d\u5230\u5de5\u7a0b\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"resources"),"\u76ee\u5f55\u4e0b\u5982\u4e0b\u56fe\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110182123624-59d6bcba.png",alt:"image-20211110182123624"}),"image-20211110182123624"),(0,l.kt)("p",null,"(3) \u66f4\u6539\u914d\u7f6e\u6587\u4ef6,\u5728spring\u4e0b\u6dfb\u52a0\u5185\u5bb9"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"spring.thymeleaf.cache: false\n")),(0,l.kt)("h4",{id:"421-\u57fa\u7840\u6570\u636e\u6e32\u67d3"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-1-%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E6%B8%B2%E6%9F%93"},"#"),"4.2.1 \u57fa\u7840\u6570\u636e\u6e32\u67d3"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a\u4ee5\u524d\u524d\u7aefjson\uff0c\u524d\u7aef\u6e32\u67d3\u3002\u73b0\u5728\u8df3\u8f6c\u5230\u9879\u76ee\u9875\u9762\uff0c\u670d\u52a1\u5668\u7aef\u9875\u9762\u6e32\u67d3\u51fa\u6765\u3002"),(0,l.kt)("p",null,"(1)com.ydles.search.controller\u6dfb\u52a0\u65b9\u6cd5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@GetMapping("/list")\npublic String list(@RequestParam Map<String,String> searchMap,Model model){\n    //\u7279\u6b8a\u7b26\u53f7\u5904\u7406\n    this.handleSearchMap(searchMap);\n\n    //\u83b7\u53d6\u67e5\u8be2\u7ed3\u679c\n    Map resultMap = searchService.search(searchMap);\n    model.addAttribute("result",resultMap);\n    model.addAttribute("searchMap",searchMap);\n\n    return "search";\n}\n')),(0,l.kt)("p",null,"\u7c7b\u6ce8\u89e3\u6539\u4e3aController,search\u65b9\u6cd5\u6dfb\u52a0ResponseBody"),(0,l.kt)("p",null,"\u6d4f\u89c8\u5668\u8bbf\u95ee ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search/list?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,"(2) \u641c\u7d22\u7ed3\u679c\u9875\u9762\u6e32\u67d3"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110210015785-5f310d14.png",alt:"image-20211110210015785"}),"image-20211110210015785"),(0,l.kt)("p",null,"(2.1)\u7528\u6237\u9009\u62e9\u6761\u4ef6\u56de\u663e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'2 <html xmlns:th="http://www.thymeleaf.org">\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'481 <li class="active">\n        <span th:text="${searchMap.keywords}"></span>\n    </li>\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"484                 <li class=\"with-x\" th:if=\"${#maps.containsKey(searchMap,'brand')}\">\n                        \u54c1\u724c:<span th:text=\"${searchMap.brand}\"></span>\n                        <a th:href=\"@{${#strings.replace(url,'&brand='+searchMap.brand,'')}}\">\xd7</a>\n                    </li>\n                    <li class=\"with-x\" th:if=\"${#maps.containsKey(searchMap,'price')}\">\n                        \u4ef7\u683c:<span th:text=\"${searchMap.price}\"></span>\n                        <a th:href=\"@{${#strings.replace(url,'&price='+searchMap.price,'')}}\">\xd7</a>\n                    </li>\n                    \x3c!--\u89c4\u683c--\x3e\n                    <li class=\"with-x\" th:each=\"sm,mapStat:${searchMap}\" th:if=\"${#strings.startsWith(sm.key,'spec_')}\">\n                        <span th:text=\"${#strings.replace(sm.key,'spec_','')}\"></span> : <span th:text=\"${#strings.replace(sm.value,'%2B','+')}\"></span>\n                        <a th:href=\"@{${#strings.replace(url,'&'+sm.key+'='+sm.value,'')}}\">\xd7</a>\n                    </li>\n")),(0,l.kt)("p",null,"3\u6d4b\u8bd5 \u8bbf\u95ee ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85&brand=viney&spec_%E9%A2%9C%E8%89%B2=%E9%BB%91%E8%89%B2"},"http://localhost:9009/search/list?keywords=\u5305\u5305&brand=viney&spec_\u989c\u8272=\u9ed1\u8272open in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110213102694-b8fe9aa9.png",alt:"image-20211110213102694"}),"image-20211110213102694"),(0,l.kt)("p",null,"(2.2)\u54c1\u724c\u4fe1\u606f\u663e\u793a"),(0,l.kt)("p",null,"1\u9700\u6c42\uff1a\u5b9e\u73b0\u4e0b\u56fe\u529f\u80fd"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211111105051917-247b84eb.png",alt:"image-20211111105051917"}),"image-20211111105051917"),(0,l.kt)("p",null,"2\u4fee\u6539search.html\u9875\u9762"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'512         <div class="type-wrap logo" th:unless="${#maps.containsKey(searchMap,\'brand\')}">\n                <div class="fl key brand">\u54c1\u724c</div>\n                <div class="value logos">\n                    <ul class="logo-list">\n                        <li th:each="brand,brandSate:${result.brandList}">\n                            <a th:text="${brand}" th:href="@{${url}(brand=${brand})}"></a>\n                        </li>\n                    </ul>\n                </div>\n                <div class="ext">\n                    <a href="javascript:void(0);" class="sui-btn">\u591a\u9009</a>\n                    <a href="javascript:void(0);">\u66f4\u591a</a>\n                </div>\n            </div>\n')),(0,l.kt)("p",null,"3 \u6d4b\u8bd5 \u8bbf\u95ee ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search/list?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,"\u8bbf\u95ee ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search/list?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,"(2.3)\u89c4\u683c\u4fe1\u606f\u6570\u636e\u8f6c\u6362"),(0,l.kt)("p",null,"1\u9700\u6c42\u8bbf\u95ee\u89c4\u683c\u63a5\u53e3 ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search?keywords=%E5%8C%85%E5%8C%85&spec_%E9%A2%9C%E8%89%B2=%E9%BB%91%E8%89%B2"},"http://localhost:9009/search?keywords=\u5305\u5305&spec_\u989c\u8272=\u9ed1\u8272open in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211111105359517-cf1e901b.png",alt:"image-20211111105359517"}),"image-20211111105359517"),(0,l.kt)("p",null,"==\u300b\u989c\u8272\uff1a\u84dd\u8272\uff0c\u9ed1\u8272\uff0c\u91d1\u8272\uff0c\u7c89\u8272"),(0,l.kt)("p",null," \u7248\u672c\uff1a6GB+128GB,4GB+64GB"),(0,l.kt)("p",null,"\u89c4\u683c\u6570\u636e\u4e0d\u597d\u5728\u524d\u7aef\u5c55\u793a\u3002\u6240\u4ee5\u8981\u8f6c\u6210map\u3002"),(0,l.kt)("p",null,"\u989c\u8272\uff1a"),(0,l.kt)("p",null,"2 SearchServiceImpl \u589e\u52a0\u65b9\u6cd5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public Map<String, Set<String>> formartSpec(List<String> specList) {\n        //1\u5b9a\u4e49\u8fd4\u56demap\n        Map<String, Set<String>> resultMap = new HashMap<>();\n        //2\u904d\u5386specList\n        if (specList != null && specList.size() > 0) {\n            for (String specJsonString : specList) {\n                // \u5c06json\u8f6c\u4e3amap\n                Map<String, String> specMap = JSON.parseObject(specJsonString, Map.class);\n                //\u904d\u5386\u6bcf\u4e2a\u5546\u54c1\u7684\u89c4\u683c\u540d\u5b57\n                for (String specKey : specMap.keySet()) {\n                    //\u770b\u8fd4\u56demap\u4e2d\u6709\u6b64\u89c4\u683c\u6ca1\u6709\n                    Set<String> specSet = resultMap.get(specKey);\n                    if (specSet == null) {\n                        specSet = new HashSet<>();\n                    }\n                    //\u5c06\u6b64\u6761\u6570\u636e\u4e2d\u7684\u89c4\u683c\u653e\u5165set\n                    specSet.add(specMap.get(specKey));\n                    //\u5c06set\u653e\u5165\u8fd4\u56demap\n                    resultMap.put(specKey, specSet);\n                }\n            }\n        }\n        return resultMap;\n    }\n")),(0,l.kt)("p",null,"3\u5728\u5c01\u88c5\u89c4\u683c\u4fe1\u606f\u65f6\uff0c\u8c03\u7528"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'resultMap.put("specList", this.formartSpec(specList));\n')),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211111110616418-9c07c00c.png",alt:"image-20211111110616418"}),"image-20211111110616418"),(0,l.kt)("p",null,"(2.4)\u89c4\u683c\u4e0e\u4ef7\u683c\u663e\u793a"),(0,l.kt)("p",null,"1\u4fee\u6539search.html\u9875\u9762 \u89c4\u683c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'526\n                <div class="type-wrap" th:each="spec,specStat:${result.specList}" th:unless="${#maps.containsKey(searchMap,\'spec_\'+spec.key)}">\n                    <div class="fl key" th:text="${spec.key}">\n\n                    </div>\n                    <div class="fl value">\n                        <ul class="type-list">\n                            <li th:each="op,opstat:${spec.value}">\n                                <a th:text="${op}" th:href="@{${url}(\'spec_\'+${spec.key}=${op})}"></a>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class="fl ext"></div>\n                </div>\n')),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"data:image/png;base64,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",alt:"image-20211111112533466"}),"image-20211111112533466"),(0,l.kt)("p",null,"2\u4fee\u6539search.html\u9875\u9762 \u4ef7\u683c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'539\n<div class="type-wrap" th:unless="${#maps.containsKey(searchMap,\'price\')}">\n                    <div class="fl key">\u4ef7\u683c</div>\n                    <div class="fl value">\n                        <ul class="type-list">\n                            <li>\n                                <a th:text="0-500\u5143" th:href="@{${url}(price=\'0-500\')}"></a>\n                            </li>\n                            <li>\n                                <a th:text="500-1000\u5143" th:href="@{${url}(price=\'500-1000\')}"></a>\n                            </li>\n                            <li>\n                                <a th:text="1000-1500\u5143" th:href="@{${url}(price=\'1000-1500\')}"></a>\n                            </li>\n                            <li>\n                                <a th:text="1500-2000\u5143" th:href="@{${url}(price=\'1500-2000\')}"></a>\n                            </li>\n                            <li>\n                                <a th:text="2000-3000\u5143" th:href="@{${url}(price=\'2000-3000\')}"></a>\n                            </li>\n                            <li>\n                                <a th:text="3000\u5143\u4ee5\u4e0a" th:href="@{${url}(price=\'3000\')}"></a>\n                            </li>\n                        </ul>\n                    </div>\n                    <div class="fl ext">\n                    </div>\n                </div>\n')),(0,l.kt)("p",null,"3\u6d4b\u8bd5\uff1a ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85&price=0-5000"},"http://localhost:9009/search/list?keywords=\u5305\u5305&price=0-5000open in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211111114359768-cb4347b6.png",alt:"image-20211111114359768"}),"image-20211111114359768"),(0,l.kt)("p",null,"(2.5)\u6570\u636e\u5217\u8868\u5c55\u793a"),(0,l.kt)("p",null,"1\u9700\u6c42\uff1a\u663e\u793a\u4e0b\u5217\u5185\u5bb9"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211111115149240-59006398.png",alt:"image-20211111115149240"}),"image-20211111115149240"),(0,l.kt)("p",null,"2 \u4fee\u6539search.html\u9875\u9762"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'603-832\n<li class="yui3-u-1-5" th:each="sku,skuStat:${result.rows}">\n                            <div class="list-wrap">\n                                <div class="p-img">\n                                    \x3c!--<a th:href="\'http://192.168.200.128:8081/\'+${sku.spuId}+\'.html\'"  target="_blank"><img th:src="${sku.image}" /></a>--\x3e\n                                    <a th:href="\'http://192.168.200.128:8081/10000000616300.html\'"  target="_blank"><img th:src="${sku.image}" /></a>\n                                </div>\n                                <div class="price">\n                                    <strong>\n                                            <em>\xa5</em>\n                                            <i th:text="${sku.price}"></i>\n                                        </strong>\n                                </div>\n                                <div class="attr">\n                                    <a target="_blank" th:href="\'http://192.168.200.128:8081/10000000616300.html\'" th:title="${sku.spec}" th:utext="${sku.name}"></a>\n                                </div>\n                                <div class="commit">\n                                    <i class="command">\u5df2\u6709<span>2000</span>\u4eba\u8bc4\u4ef7</i>\n                                </div>\n                                <div class="operate">\n                                    <a href="success-cart.html" target="_blank" class="sui-btn btn-bordered btn-danger">\u52a0\u5165\u8d2d\u7269\u8f66</a>\n                                    <a href="javascript:void(0);" class="sui-btn btn-bordered">\u6536\u85cf</a>\n                                </div>\n                            </div>\n                        </li>\n')),(0,l.kt)("p",null,"3\u6d4b\u8bd5\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85&brand=PRADA"},"http://localhost:9009/search/list?keywords=\u5305\u5305&brand=PRADAopen in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211111115149240-59006398.png",alt:"image-20211111115149240"}),"image-20211111115149240"),(0,l.kt)("h3",{id:"43-\u5173\u952e\u5b57\u641c\u7d22"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-3-%E5%85%B3%E9%94%AE%E5%AD%97%E6%90%9C%E7%B4%A2"},"#"),"4.3 \u5173\u952e\u5b57\u641c\u7d22"),(0,l.kt)("p",null,"1\u9700\u6c42\uff1a\u7528\u6237\u8f93\u5165\u5173\u952e\u5b57\uff0c\u67e5\u8be2\u3002\u56de\u663e\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211111120053433-4ed16595.png",alt:"image-20211111120053433"}),"image-20211111120053433"),(0,l.kt)("p",null,"2 \u4fee\u6539search.html\u9875\u9762"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'40\n                            <form  th:action="@{/search/list}" class="sui-form form-inline">\n                                <div class="input-append">\n                                    <input th:type="text" id="autocomplete" name="keywords"  th:value="${searchMap.keywords}"  class="input-error input-xxlarge" />\n                                    <button class="sui-btn btn-xlarge btn-danger" th:type="submit">\u641c\u7d22</button>\n                                </div>\n                            </form>\n')),(0,l.kt)("p",null,"3\u6d4b\u8bd5\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search/list?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,"\u4fee\u6539\u8f93\u5165\u6846"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211111120053433-4ed16595.png",alt:"image-20211111120052305"}),"image-20211111120052305"),(0,l.kt)("h3",{id:"44-\u6761\u4ef6\u641c\u7d22\u5b9e\u73b0"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-4-%E6%9D%A1%E4%BB%B6%E6%90%9C%E7%B4%A2%E5%AE%9E%E7%8E%B0"},"#"),"4.4 \u6761\u4ef6\u641c\u7d22\u5b9e\u73b0"),(0,l.kt)("p",null,"1\u9700\u6c42\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211111120444998-6db9446c.png",alt:"image-20211111120444998"}),"image-20211111120444998"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u7528\u6237\u641c\u7d22\uff1a\u62fc\u63a5url /search/list?keywords=\u5305\u5305"),(0,l.kt)("li",{parentName:"ul"},'\u70b9\u51fb\u65b0\u89c4\u683c\uff1a\u62fc\u63a5 "url /search/list?keywords=\u5305\u5305&spec__\u989c\u8272=\u7ea2\u8272')),(0,l.kt)("p",null,"(1)\u540e\u53f0\u8bb0\u5f55\u641c\u7d22URL"),(0,l.kt)("p",null,"com.ydles.search.controller SearchController list\u65b9\u6cd5\u4e2d\u65b0\u589e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'    //\u62fc\u63a5url\n    StringBuilder url = new StringBuilder("/search/list");\n    // \u5982\u679c\u6709\u641c\u7d22\u6761\u4ef6\n    if (searchMap != null && searchMap.size() > 0) {\n        url.append("?");\n        //\u62fc\u63a5\n        for (String paramKey : searchMap.keySet()) {\n            //\u6392\u9664\u7279\u6b8a\u60c5\u51b5\n            if(!"sortRule".equals(paramKey)&&!"sortField".equals(paramKey)&&!"pageNum".equals(paramKey)){\n                url.append(paramKey).append("=").append(searchMap.get(paramKey)).append("&");\n            }\n        }\n\n        String urlString = url.toString();\n        //\u9664\u53bb\u6700\u540e\u7684&\n        urlString=urlString.substring(0,urlString.length()-1);\n        model.addAttribute("url", urlString);\n    }else {\n        model.addAttribute("url", url);\n    }\n')),(0,l.kt)("p",null,"(2)\u524d\u7aefurl\u62fc\u63a5\u8df3\u8f6c"),(0,l.kt)("p",null,"1\u9700\u6c42\uff1a"),(0,l.kt)("p",null,"\u7528\u6237\u70b9\u51fb\u76f8\u5e94\u54c1\u724c\u3001\u89c4\u683c\u3001\u4ef7\u683c\uff0c\u8df3\u8f6c\u8bf7\u6c42\u540e\u7aef\u63a5\u53e3\u3002"),(0,l.kt)("p",null,"2\u4fee\u6539search.html\u9875\u9762"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'516 <a th:text="${brand}" th:href="@{${url}(brand=${brand})}"></a>\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'530 <a th:text="${op}" th:href="@{${url}(\'spec_\'+${spec.key}=${op})}"></a>\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'543 <a th:text="0-500\u5143" th:href="@{${url}(price=\'0-500\')}"></a> \n')),(0,l.kt)("p",null,"3\u6d4b\u8bd5\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search/list?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,"\u4f9d\u6b21\u70b9\u51fb\u54c1\u724c\u3001\u89c4\u683c\u3001\u4ef7\u683c\u4fe1\u606f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211112150251770-2bc8181c.png",alt:"image-20211112150251770"}),"image-20211112150251770"),(0,l.kt)("h3",{id:"45-\u79fb\u9664\u641c\u7d22\u6761\u4ef6"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-5-%E7%A7%BB%E9%99%A4%E6%90%9C%E7%B4%A2%E6%9D%A1%E4%BB%B6"},"#"),"4.5 \u79fb\u9664\u641c\u7d22\u6761\u4ef6"),(0,l.kt)("p",null,"1\u9700\u6c42\uff1a"),(0,l.kt)("p",null,"\u7528\u6237\u70b9\u51fbX\u53bb\u9664\u521a\u624d\u7684\u641c\u7d22\u6761\u4ef6\u3002"),(0,l.kt)("p",null,"2\u4fee\u6539search.html\u9875\u9762"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"574-486\n                    <li class=\"with-x\" th:if=\"${#maps.containsKey(searchMap,'brand')}\">\n                        \u54c1\u724c:<span th:text=\"${searchMap.brand}\"></span>\n                        <a th:href=\"@{${#strings.replace(url,'&brand='+searchMap.brand,'')}}\">\xd7</a>\n                    </li>\n                    <li class=\"with-x\" th:if=\"${#maps.containsKey(searchMap,'price')}\">\n                        \u4ef7\u683c:<span th:text=\"${searchMap.price}\"></span>\n                        <a th:href=\"@{${#strings.replace(url,'&price='+searchMap.price,'')}}\">\xd7</a>\n                    </li>\n                    \x3c!--\u89c4\u683c--\x3e\n                    <li class=\"with-x\" th:each=\"sm:${searchMap}\" th:if=\"${#strings.startsWith(sm.key,'spec_')}\">\n                        <span th:text=\"${#strings.replace(sm.key,'spec_','')}\"></span> : <span th:text=\"${#strings.replace(sm.value,'%2B','+')}\"></span>\n                        <a th:href=\"@{${#strings.replace(url,'&'+sm.key+'='+sm.value,'')}}\">\xd7</a>\n                    </li>\n")),(0,l.kt)("p",null,"3\u6d4b\u8bd5\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search/list?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,"\u6dfb\u52a0\u641c\u7d22\u6761\u4ef6\uff0c\u53bb\u9664\u641c\u7d22\u6761\u4ef6\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211112152034015-f90d6d3b.png",alt:"image-20211112152034015"}),"image-20211112152034015"),(0,l.kt)("h3",{id:"46-\u6392\u5e8f"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-6-%E6%8E%92%E5%BA%8F"},"#"),"4.6 \u6392\u5e8f"),(0,l.kt)("p",null,"1\u9700\u6c42\uff1a"),(0,l.kt)("p",null,"\u7528\u6237\u70b9\u51fb\u6392\u5e8f\u5b57\u6bb5\uff0c\u8fd4\u56de\u6392\u5e8f\u597d\u7684\u5185\u5bb9\u3002"),(0,l.kt)("p",null,"2\u4fee\u6539search.html\u9875\u9762"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"593-595\n                            <li>\n                                <a th:href=\"@{${url}(sortRule='ASC',sortField='price')}\">\u4ef7\u683c\u2191</a>\n                            </li>\n                            <li>\n                                <a th:href=\"@{${url}(sortRule='DESC',sortField='price')}\">\u4ef7\u683c\u2193</a>\n                            </li>\n")),(0,l.kt)("p",null,"3\u6d4b\u8bd5\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search/list?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,"\u70b9\u51fb\u4ef7\u683c\u5347\u5e8f\u3001\u964d\u5e8f\u67e5\u770b\u7ed3\u679c"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211112160101659-4ea90f75.png",alt:"image-20211112160101659"}),"image-20211112160101659"),(0,l.kt)("h3",{id:"47-\u5206\u9875"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-7-%E5%88%86%E9%A1%B5"},"#"),"4.7 \u5206\u9875"),(0,l.kt)("p",null,"\u771f\u5b9e\u7684\u5206\u9875\u5e94\u8be5\u50cf\u767e\u5ea6\u90a3\u6837\uff0c\u5982\u4e0b\u56fe\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561834387880-2f2c18ef.png",alt:"1561834387880"}),"1561834387880"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561834414207-54261ad5.png",alt:"1561834414207"}),"1561834414207"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561834458274-d09b5e6c.png",alt:"1561834458274"}),"1561834458274"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5206\u9875\u540e\u7aef\u5b9e\u73b0")),(0,l.kt)("p",null,"1\u9700\u6c42\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"data:image/png;base64,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",alt:"image-20191218094011798"}),"image-20191218094011798"),(0,l.kt)("p",null,"\u5206\u9875\u3002"),(0,l.kt)("p",null,"2\u5c06\u8d44\u6599Page.java \u653e\u5230common\u5de5\u7a0bentity\u4e0b"),(0,l.kt)("p",null,"3com.ydles.search.controller SearchController list\u65b9\u6cd5\u4e2d\u65b0\u589e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'    // \u5c01\u88c5\u5206\u9875\u6570\u636e\uff0c\u5e76\u8fd4\u56de\n    //\u603b\u8bb0\u5f55\u6570\n    // \u5f53\u524d\u9875\n    // \u6bcf\u9875\u51e0\u6761\n    Page<SkuInfo> page = new Page<>(\n            Long.parseLong(String.valueOf(resultMap.get("total"))),\n            Integer.parseInt(String.valueOf(resultMap.get("pageNum"))),\n            Page.pageSize\n    );\n    model.addAttribute("page", page);\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5206\u9875\u524d\u7aef\u5b9e\u73b0")),(0,l.kt)("p",null,"1\u4fee\u6539search.html\u9875\u9762"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'644\n                        <ul>\n                            <li class="prev disabled">\n                                <a th:href="@{${url}(pageNum=${page.upper})}">\xab\u4e0a\u4e00\u9875</a>\n                            </li>\n                            <li th:each="i:${#numbers.sequence(page.lpage,page.rpage)}" th:class="${i}==${page.currentpage}?\'active\':\'\'">\n                                <a th:href="@{${url}(pageNum=${i})}" th:text="${i}"></a>\n                            </li>\n                            <li class="next">\n                                <a th:href="@{${url}(pageNum=${page.next})}">\u4e0b\u4e00\u9875\xbb</a>\n                            </li>\n                        </ul>\n                        <div>\n                            <span>\u5171<i th:text="${page.last}"></i>\u9875&nbsp;</span>\n                            <span>\u5171<i th:text="${page.total}"></i>\u4e2a\u5546\u54c1&nbsp;</span>\n                        </div>\n')),(0,l.kt)("p",null,"2\u6d4b\u8bd5\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search/list?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,"\u5206\u9875 \u4e0a\u4e00\u9875\u4e0b\u4e00\u9875"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211113110229518-9601c6fa.png",alt:"image-20211113110229518"}),"image-20211113110229518"),(0,l.kt)("h2",{id:"5\u5143\u52a8\u529b\u4e8c\u5962\u5546\u54c1\u8be6\u60c5\u9875"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-%E5%85%83%E5%8A%A8%E5%8A%9B%E4%BA%8C%E5%A5%A2%E5%95%86%E5%93%81%E8%AF%A6%E6%83%85%E9%A1%B5"},"#"),"5.\u5143\u52a8\u529b\u4e8c\u5962\u5546\u54c1\u8be6\u60c5\u9875"),(0,l.kt)("h3",{id:"51-\u9700\u6c42\u5206\u6790"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"},"#"),"5.1 \u9700\u6c42\u5206\u6790"),(0,l.kt)("p",null,"\u5f53\u7cfb\u7edf\u5ba1\u6838\u5b8c\u6210\u5546\u54c1\uff0c\u9700\u8981\u5c06\u5546\u54c1\u8be6\u60c5\u9875\u8fdb\u884c\u5c55\u793a\uff0c\u90a3\u4e48\u91c7\u7528\u9759\u6001\u9875\u9762\u751f\u6210\u7684\u65b9\u5f0f\u751f\u6210\uff0c\u5e76\u90e8\u7f72\u5230\u9ad8\u6027\u80fd\u7684web\u670d\u52a1\u5668\u4e2d\u8fdb\u884c\u8bbf\u95ee\u662f\u6bd4\u8f83\u5408\u9002\u7684\u3002\u6240\u4ee5\uff0c\u5f00\u53d1\u6d41\u7a0b\u5982\u4e0b\u56fe\u6240\u793a\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211113111645270-a5cc9606.png",alt:"image-20211113111645270"}),"image-20211113111645270"),(0,l.kt)("p",null,"\u6b64\u5904MQ\u6211\u4eec\u4f7f\u7528Rabbitmq\u5373\u53ef\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6d41\u7a0b\uff1a")),(0,l.kt)("p",null,"1\u5546\u54c1\u4e0a\u67b6->\u5546\u54c1\u670d\u52a1\u53d1\u9001spuid->mq"),(0,l.kt)("p",null,"2mq->\u9759\u6001\u9875\u670d\u52a1"),(0,l.kt)("p",null,"3\u9759\u6001\u9875\u670d\u52a1->\u8c03\u5546\u54c1\u670d\u52a1\u83b7\u53d6spu->\u751f\u6210\u9759\u6001\u9875\u9762"),(0,l.kt)("h3",{id:"52-\u5546\u54c1\u9759\u6001\u5316\u5fae\u670d\u52a1\u521b\u5efa"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-2-%E5%95%86%E5%93%81%E9%9D%99%E6%80%81%E5%8C%96%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%88%9B%E5%BB%BA"},"#"),"5.2 \u5546\u54c1\u9759\u6001\u5316\u5fae\u670d\u52a1\u521b\u5efa"),(0,l.kt)("h4",{id:"521-\u9700\u6c42\u5206\u6790"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-2-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"},"#"),"5.2.1 \u9700\u6c42\u5206\u6790"),(0,l.kt)("p",null,"\u8be5\u5fae\u670d\u52a1\u53ea\u7528\u4e8e\u751f\u6210\u5546\u54c1\u9759\u6001\u9875\uff0c\u4e0d\u505a\u5176\u4ed6\u4e8b\u60c5\u3002"),(0,l.kt)("h4",{id:"522-\u642d\u5efa\u9879\u76ee"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-2-2-%E6%90%AD%E5%BB%BA%E9%A1%B9%E7%9B%AE"},"#"),"5.2.2 \u642d\u5efa\u9879\u76ee"),(0,l.kt)("p",null,"1 \u521b\u5efa \u9759\u6001\u9875\u670d\u52a1ydles_service_page"),(0,l.kt)("p",null,"2\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"    \x3c!--\u516c\u5171\u6a21\u5757--\x3e\n    <dependency>\n        <groupId>com.ydles</groupId>\n        <artifactId>ydles_common</artifactId>\n        <version>1.0-SNAPSHOT</version>\n    </dependency>\n    \x3c!--thymeleaf--\x3e\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-thymeleaf</artifactId>\n    </dependency>\n    \x3c!--mq--\x3e\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-amqp</artifactId>\n    </dependency>\n    \x3c!--goods feigh--\x3e\n    <dependency>\n        <groupId>com.ydles</groupId>\n        <artifactId>ydles_service_goods_api</artifactId>\n        <version>1.0-SNAPSHOT</version>\n    </dependency>   \n")),(0,l.kt)("p",null,"3\u914d\u7f6e\u6587\u4ef6application.yml"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"server:\n  port: 9011\nspring:\n  application:\n    name: page\n  rabbitmq:\n    host: 192.168.200.128\n  main:\n    allow-bean-definition-overriding: true #\u5f53\u9047\u5230\u540c\u6837\u540d\u5b57\u7684\u65f6\u5019\uff0c\u662f\u5426\u5141\u8bb8\u8986\u76d6\u6ce8\u518c\neureka:\n  client:\n    service-url:\n      defaultZone: http://127.0.0.1:6868/eureka\n  instance:\n    prefer-ip-address: true\nfeign:\n  hystrix:\n    enabled: false\n  client:\n    config:\n      default:   #\u914d\u7f6e\u5168\u5c40\u7684feign\u7684\u8c03\u7528\u8d85\u65f6\u65f6\u95f4  \u5982\u679c \u6709\u6307\u5b9a\u7684\u670d\u52a1\u914d\u7f6e \u9ed8\u8ba4\u7684\u914d\u7f6e\u4e0d\u4f1a\u751f\u6548\n        connectTimeout: 600000 # \u6307\u5b9a\u7684\u662f \u6d88\u8d39\u8005 \u8fde\u63a5\u670d\u52a1\u63d0\u4f9b\u8005\u7684\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u662f\u5426\u80fd\u8fde\u63a5  \u5355\u4f4d\u662f\u6beb\u79d2\n        readTimeout: 600000  # \u6307\u5b9a\u7684\u662f\u8c03\u7528\u670d\u52a1\u63d0\u4f9b\u8005\u7684 \u670d\u52a1 \u7684\u8d85\u65f6\u65f6\u95f4\uff08\uff09  \u5355\u4f4d\u662f\u6beb\u79d2\n#hystrix \u914d\u7f6e\nhystrix:\n  command:\n    default:\n      execution:\n        timeout:\n          #\u5982\u679cenabled\u8bbe\u7f6e\u4e3afalse\uff0c\u5219\u8bf7\u6c42\u8d85\u65f6\u4ea4\u7ed9ribbon\u63a7\u5236\n          enabled: true\n        isolation:\n          strategy: SEMAPHORE\n#\u751f\u6210\u9759\u6001\u9875\u7684\u4f4d\u7f6e\npagepath: D:\\items\n")),(0,l.kt)("p",null,"4\u542f\u52a8\u7c7b com.ydles.page.PageApplication"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@SpringBootApplication\n@EnableEurekaClient\n@EnableFeignClients(basePackages = {"com.ydles.goods.feign"})\npublic class PageApplication {\npublic static void main(String[] args) {\n    SpringApplication.run(PageApplication.class,args);\n}\n}\n')),(0,l.kt)("h3",{id:"53-\u751f\u6210\u9759\u6001\u9875"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-%E7%94%9F%E6%88%90%E9%9D%99%E6%80%81%E9%A1%B5"},"#"),"5.3 \u751f\u6210\u9759\u6001\u9875"),(0,l.kt)("h4",{id:"531-\u9700\u6c42\u5206\u6790"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"},"#"),"5.3.1 \u9700\u6c42\u5206\u6790"),(0,l.kt)("p",null,"\u9875\u9762\u53d1\u9001\u8bf7\u6c42\uff0c\u4f20\u9012\u8981\u751f\u6210\u7684\u9759\u6001\u9875\u7684\u5546\u54c1\u7684SpuID.\u540e\u53f0controller \u63a5\u6536\u8bf7\u6c42\uff0c\u8c03\u7528thyemleaf\u7684\u539f\u751fAPI\u751f\u6210\u5546\u54c1\u9759\u6001\u9875\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211113112830233-ca263eba.png",alt:"image-20211113112830233"}),"image-20211113112830233"),(0,l.kt)("p",null,"\u4e0a\u56fe\u662f\u8981\u751f\u6210\u7684\u5546\u54c1\u8be6\u60c5\u9875\uff0c\u4ece\u56fe\u7247\u4e0a\u53ef\u4ee5\u770b\u51fa\u9700\u8981\u67e5\u8be2SPU\u76843\u4e2a\u5206\u7c7b\u4f5c\u4e3a",(0,l.kt)("strong",{parentName:"p"},"\u9762\u5305\u5c51"),"\u663e\u793a\uff0c\u540c\u65f6\u8fd8\u9700\u8981\u67e5\u8be2SKU\u548cSPU\u4fe1\u606f\u3002"),(0,l.kt)("h4",{id:"532-feign\u521b\u5efa"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-2-feign%E5%88%9B%E5%BB%BA"},"#"),"5.3.2 Feign\u521b\u5efa"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a\u67e5\u51fa3\u90e8\u5206\u6570\u636e \u8d44\u6e90/\u9759\u6001\u539f\u578b/\u524d\u53f0/item.html"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5206\u7c7b"),(0,l.kt)("li",{parentName:"ul"},"spu"),(0,l.kt)("li",{parentName:"ul"},"sku")),(0,l.kt)("p",null,"1goods-api\u4e2d com.ydles.goods.feign"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@FeignClient(name = "goods")\npublic interface CategoryFeign {\n    @GetMapping("/category/{id}")\n    public Result<Category> findById(@PathVariable("id") Integer id);\n}\n')),(0,l.kt)("p",null,"2goods\u670d\u52a1 spuController\u6dfb\u52a0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@GetMapping("/findSpuById/{id}")\npublic Result<Spu> findSpuById(@PathVariable("id") String id){\n    Spu spu = spuService.findById(id);\n    return new Result(true,StatusCode.OK,"\u67e5\u8be2\u6210\u529f",spu);\n}\n')),(0,l.kt)("p",null,"3com.ydles.goods.feign"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@FeignClient(name = "goods")\npublic interface SpuFeign {\n@GetMapping("/spu/findSpuById/{id}")\npublic Result<Spu> findSpuById(@PathVariable("id") String id);\n}\n')),(0,l.kt)("h4",{id:"533-\u9759\u6001\u9875\u751f\u6210\u4ee3\u7801-\u91cd\u70b9\u638c\u63e1"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-3-%E9%9D%99%E6%80%81%E9%A1%B5%E7%94%9F%E6%88%90%E4%BB%A3%E7%A0%81-%E9%87%8D%E7%82%B9%E6%8E%8C%E6%8F%A1"},"#"),"5.3.3 \u9759\u6001\u9875\u751f\u6210\u4ee3\u7801-\u91cd\u70b9\u638c\u63e1"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211113114836186-fdf7aa9b.png",alt:"image-20211113114836186"}),"image-20211113114836186"),(0,l.kt)("p",null,"thymleaf\u9875\u9762\u9759\u6001\u5316 \u6570\u636e+\u6a21\u677f=\u9759\u6001html"),(0,l.kt)("p",null,"1\u5c06\u8d44\u6599\u7684item.html\u653e\u5230\u9879\u76eetemplates\u4e0b\u3002\u4f5c\u4e3a\u8be6\u60c5\u9875\u6a21\u677f\u3002"),(0,l.kt)("p",null,"2page\u6a21\u5757 service\u5c42 com.ydles.page.service"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public interface PageService {\n    //\u751f\u6210\u9759\u6001\u5316\u9875\u9762\n    void generateHtml(String spuId);\n}\n")),(0,l.kt)("p",null,"3 \u5b9e\u73b0\u7c7b com.ydles.page.service.impl"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydles.page.service.impl;\n\nimport com.alibaba.fastjson.JSON;\nimport com.ydles.entity.Result;\nimport com.ydles.goods.feign.CategoryFeign;\nimport com.ydles.goods.feign.SkuFeign;\nimport com.ydles.goods.feign.SpuFeign;\nimport com.ydles.goods.pojo.Category;\nimport com.ydles.goods.pojo.Sku;\nimport com.ydles.goods.pojo.Spu;\nimport com.ydles.page.service.PageService;\nimport org.apache.commons.lang.StringUtils;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.stereotype.Service;\nimport org.thymeleaf.TemplateEngine;\nimport org.thymeleaf.context.Context;\n\nimport java.io.File;\nimport java.io.FileWriter;\nimport java.io.IOException;\nimport java.io.Writer;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n *\n * \u7f3a\u5565\u8865\u5565\n */\n@Service\npublic class PageServiceImpl implements PageService {\n    @Autowired\n    TemplateEngine templateEngine;\n    @Value("${pagepath}")\n    String pagepath;\n\n    //\u751f\u6210\u9759\u6001\u5316\u9875\u9762\u7684\u65b9\u6cd5\n    @Override\n    public void generateHtml(String spuId) {\n        //1 \u4e0a\u4e0b\u6587 \u5305\u542b\u6570\u636e\n        Context context=new Context();\n        //context.setVariable("name","value");\n        Map<String, Object> dataMap = getData(spuId);\n        context.setVariables(dataMap);\n\n        //2\u6587\u4ef6\n        File dir = new File(pagepath); //\u6587\u4ef6\u5939   d:/item\n        //\u5982\u679c\u6587\u4ef6\u5939\u4e0d\u5b58\u5728 \u521b\u5efa\n        if(!dir.exists()){\n            dir.mkdirs();\n        }\n\n        //d:/item/spuid.html\n        File file = new File(pagepath + "/" + spuId + ".html");\n\n        Writer writer=null;\n        try {\n            writer=new FileWriter(file);\n            templateEngine.process("item",context, writer);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }finally {\n            //\u5173\u95ed\u6d41\n            try {\n                writer.close();\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n\n    }\n\n    @Autowired\n    SpuFeign spuFeign;\n    @Autowired\n    SkuFeign skuFeign;\n    @Autowired\n    CategoryFeign categoryFeign;\n\n    //\u83b7\u53d6\u6570\u636e\u65b9\u6cd5\n    public Map<String,Object> getData(String spuId){\n        Map<String,Object> resultMap = new HashMap<>();\n\n        //1spu\n        Spu spu = spuFeign.findSpuById(spuId).getData();\n        resultMap.put("spu",spu);\n        //4imageList\n        String images = spu.getImages();\n        if(StringUtils.isNotEmpty(images)){\n            String[] imageList = images.split(",");\n            resultMap.put("imageList",imageList);\n        }\n        //5 specificationList\n        String specItems = spu.getSpecItems();\n        if(StringUtils.isNotEmpty(specItems)){\n            Map specMap = JSON.parseObject(specItems, Map.class);\n            resultMap.put("specificationList",specMap);\n        }\n\n\n        //2sku\n        List<Sku> skuList = skuFeign.findSkuListBySpuId(spuId);\n        resultMap.put("skuList",skuList);\n\n        //3category\n        Category category1 = categoryFeign.findById(spu.getCategory1Id()).getData();\n        Category category2 = categoryFeign.findById(spu.getCategory2Id()).getData();\n        Category category3 = categoryFeign.findById(spu.getCategory3Id()).getData();\n        resultMap.put("category1",category1);\n        resultMap.put("category2",category2);\n        resultMap.put("category3",category3);\n\n        return resultMap;\n    }\n}\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u9759\u6001\u9875\u670d\u52a1\u76d1\u542c")),(0,l.kt)("p",null,"1com.ydles.page.config \u7c98\u8d34canal\u670d\u52a1\u4e2d\u7684\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public static final String PAGE_CREATE_QUEUE="page_create_queue"; \n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@Bean(PAGE_CREATE_QUEUE)\npublic Queue PAGE_CREATE_QUEUE(){\n   return new Queue(PAGE_CREATE_QUEUE);\n}\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Bean\npublic Binding PAGE_CREATE_QUEUE_BINDING(@Qualifier(PAGE_CREATE_QUEUE)Queue queue,@Qualifier(GOODS_UP_EXCHANGE)Exchange exchange){\n    return BindingBuilder.bind(queue).to(exchange).with("").noargs();\n}\n')),(0,l.kt)("p",null,"2 com.ydles.page.listener"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Component\npublic class PageListener {\n@Autowired\nprivate PageService pageService;\n\n@RabbitListener(queues = RabbitMQConfig.PAGE_CREATE_QUEUE)\npublic void receiveMessage(String spuId){\n    System.out.println("\u83b7\u53d6\u9759\u6001\u5316\u9875\u9762\u7684\u5546\u54c1id,id\u7684\u503c\u4e3a:   "+spuId);\n\n    //\u6761\u7528\u4e1a\u52a1\u5c42\u5b8c\u6210\u9759\u6001\u5316\u9875\u9762\u751f\u6210\n    pageService.generateHtml(spuId);\n}\n}\n')),(0,l.kt)("h4",{id:"534-\u6a21\u677f\u586b\u5145"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-4-%E6%A8%A1%E6%9D%BF%E5%A1%AB%E5%85%85"},"#"),"5.3.4 \u6a21\u677f\u586b\u5145"),(0,l.kt)("p",null,"(1)\u9762\u5305\u5c51\u6570\u636e"),(0,l.kt)("p",null,"\u4fee\u6539item.html\uff0c\u586b\u5145\u4e09\u4e2a\u5206\u7c7b\u6570\u636e\u4f5c\u4e3a\u9762\u5305\u5c51\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561858073684-554e5b07.png",alt:"1561858073684"}),"1561858073684"),(0,l.kt)("p",null,"(2)\u5546\u54c1\u56fe\u7247"),(0,l.kt)("p",null,"\u4fee\u6539item.html\uff0c\u5c06\u5546\u54c1\u56fe\u7247\u4fe1\u606f\u8f93\u51fa\uff0c\u5728\u771f\u5b9e\u5de5\u4f5c\u4e2d\u9700\u8981\u505a\u7a7a\u5224\u65ad\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561858651061-2dc86223.png",alt:"1561858651061"}),"1561858651061"),(0,l.kt)("p",null,"(3)\u89c4\u683c\u8f93\u51fa"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561859448044-28eb1d8b.png",alt:"1561859448044"}),"1561859448044"),(0,l.kt)("p",null,"(4)\u9ed8\u8ba4SKU\u663e\u793a"),(0,l.kt)("p",null,"\u9759\u6001\u9875\u751f\u6210\u540e\uff0c\u9700\u8981\u663e\u793a\u9ed8\u8ba4\u7684Sku\uff0c\u6211\u4eec\u8fd9\u91cc\u9ed8\u8ba4\u663e\u793a\u7b2c1\u4e2aSku\u5373\u53ef\uff0c\u8fd9\u91cc\u53ef\u4ee5\u7ed3\u5408\u7740Vue\u4e00\u8d77\u5b9e\u73b0\u3002\u53ef\u4ee5\u5148\u5b9a\u4e49\u4e00\u4e2a\u96c6\u5408\uff0c\u518d\u5b9a\u4e49\u4e00\u4e2aspec\u548csku\uff0c\u7528\u6765\u5b58\u50a8\u5f53\u524d\u9009\u4e2d\u7684Sku\u4fe1\u606f\u548cSku\u7684\u89c4\u683c\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561858986838-cb26c6ad.png",alt:"1561858986838"}),"1561858986838"),(0,l.kt)("p",null,"\u9875\u9762\u663e\u793a\u9ed8\u8ba4\u7684Sku\u4fe1\u606f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561859241651-3e4a7985.png",alt:"1561859241651"}),"1561859241651"),(0,l.kt)("p",null,"(5)\u8bb0\u5f55\u9009\u4e2d\u7684Sku"),(0,l.kt)("p",null,"\u5728\u5f53\u524dSpu\u7684\u6240\u6709Sku\u4e2dspec\u503c\u662f\u552f\u4e00\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636espec\u6765\u5224\u65ad\u7528\u6237\u9009\u4e2d\u7684\u662f\u54ea\u4e2aSku\uff0c\u6211\u4eec\u53ef\u4ee5\u5728Vue\u4e2d\u6dfb\u52a0\u4ee3\u7801\u6765\u5b9e\u73b0\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561860041421-f83748d0.png",alt:"1561860041421"}),"1561860041421"),(0,l.kt)("p",null,"\u6dfb\u52a0\u89c4\u683c\u70b9\u51fb\u4e8b\u4ef6"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561860156033-abe35835.png",alt:"1561860156033"}),"1561860156033"),(0,l.kt)("p",null,"(6)\u6837\u5f0f\u5207\u6362"),(0,l.kt)("p",null,"\u70b9\u51fb\u4e0d\u540c\u89c4\u683c\u540e\uff0c\u5b9e\u73b0\u6837\u5f0f\u9009\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u6bcf\u4e2a\u89c4\u683c\u5224\u65ad\u8be5\u89c4\u683c\u662f\u5426\u5728\u5f53\u524d\u9009\u4e2d\u7684Sku\u89c4\u683c\u4e2d\uff0c\u5982\u679c\u5728\uff0c\u5219\u8fd4\u56detrue\u6dfb\u52a0selected\u6837\u5f0f\uff0c\u5426\u5219\u8fd4\u56defalse\u4e0d\u6dfb\u52a0selected\u6837\u5f0f\u3002"),(0,l.kt)("p",null,"Vue\u6dfb\u52a0\u4ee3\u7801\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561860749790-3ab81f0e.png",alt:"1561860749790"}),"1561860749790"),(0,l.kt)("p",null,"\u9875\u9762\u6dfb\u52a0\u6837\u5f0f\u7ed1\u5b9a\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1561860653870-31c469bf.png",alt:"1561860653870"}),"1561860653870"),(0,l.kt)("h4",{id:"535-\u542f\u52a8\u6d4b\u8bd5"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-5-%E5%90%AF%E5%8A%A8%E6%B5%8B%E8%AF%95"},"#"),"5.3.5 \u542f\u52a8\u6d4b\u8bd5"),(0,l.kt)("p",null,"1page \u670d\u52a1com.ydles.page.service.impl.PageServiceImpl\u7c7bgetItemData\u65b9\u6cd5\u4e2d\u65b0\u589e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'// 5\u83b7\u53d6\u5546\u54c1\u89c4\u683c\u4fe1\u606f\nresultMap.put("specificationList", JSON.parseObject(spu.getSpecItems(),Map.class));\n')),(0,l.kt)("p",null,"2\u6d4b\u8bd5\u542f\u52a8\u6240\u6709\u670d\u52a1 \u4fee\u6539goods\u8868\u4e2d\u4e00\u6761\u6570\u636e status 0->1"),(0,l.kt)("p",null,"3\u751f\u6210\u6587\u4ef6 D:/items/1450862568687009792.html"),(0,l.kt)("p",null,"4\u6253\u5f00\u6709\u6570\u636e\uff0c\u6ca1\u6837\u5f0f"),(0,l.kt)("p",null,"5\u5c06\u9759\u6001\u539f\u578b\u4e2d\u7684css,js,image,data,fonts\u5305\u62f7\u8d1d\u81f3D\u76d8\uff0c\u5237\u65b0\u9875\u9762\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211113161651617-3f111594.png",alt:"image-20211113161651617"}),"image-20211113161651617"),(0,l.kt)("h4",{id:"536-\u57fa\u4e8enginx\u5b8c\u6210\u9759\u6001\u9875\u8bbf\u95ee"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-6-%E5%9F%BA%E4%BA%8Enginx%E5%AE%8C%E6%88%90%E9%9D%99%E6%80%81%E9%A1%B5%E8%AE%BF%E9%97%AE"},"#"),"5.3.6 \u57fa\u4e8enginx\u5b8c\u6210\u9759\u6001\u9875\u8bbf\u95ee"),(0,l.kt)("p",null,"1\u5c061450862568687009792.html\u9875\u9762\u653e\u5165ngixn\u4e0b\u3002"),(0,l.kt)("p",null,"/usr/local/openresty/nginx/html/1450862568687009792.html"),(0,l.kt)("p",null,"2\u91cd\u542fngixn"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"./ngixn -s -reload\n")),(0,l.kt)("p",null,"3\u8bbf\u95ee ",(0,l.kt)("a",{parentName:"p",href:"http://192.168.200.128/1450862568687009792.html"},"http://192.168.200.128/1450862568687009792.htmlopen in new window")),(0,l.kt)("p",null,"4\u4fee\u6539search\u670d\u52a1\u4e2d\u7684search.html"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'608-609\n\x3c!--<a th:href="\'http://192.168.200.128:8081/\'+${sku.spuId}+\'.html\'"  target="_blank"><img th:src="${sku.image}" /></a>--\x3e\n                                    <a th:href="\'http://192.168.200.128/1450862568687009792.html\'"  target="_blank"><img th:src="${sku.image}" /></a>\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'618 <a target="_blank" th:href="\'http://192.168.200.128/1450862568687009792.html\'" th:title="${sku.spec}" th:utext="${sku.name}"></a>\n')),(0,l.kt)("p",null,"5 \u8bbf\u95ee\u641c\u7d22\u9875\u9762",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9009/search/list?keywords=%E5%8C%85%E5%8C%85"},"http://localhost:9009/search/list?keywords=\u5305\u5305open in new window")),(0,l.kt)("p",null,"\u70b9\u51fb\u56fe\u7247\u6216\u540d\u79f0\u90fd\u53ef\u4ee5\u8df3\u8f6c\u81f3\u8be6\u60c5\u9875\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211113172956605-c6370d74.png",alt:"image-20211113172956605"}),"image-20211113172956605"),(0,l.kt)("p",null,"6\u57df\u540d\u8bbf\u95ee"),(0,l.kt)("p",null,"C:\\Windows\\System32\\drivers\\etc\\hosts"),(0,l.kt)("p",null,"\u6dfb\u52a0\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"192.168.200.128 item.ydles.com\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211113172901475-d71ed41f.png",alt:"image-20211113172901475"}),"image-20211113172901475"),(0,l.kt)("p",null,"\u603b\u7ed3\uff1a"),(0,l.kt)("p",null,"1thymeleaf"),(0,l.kt)("p",null,"\u9875\u9762\u9759\u6001\u5316"),(0,l.kt)("p",null,"\u4e3a\u4ec0\u4e48\u9875\u9762\u9759\u6001\u5316"),(0,l.kt)("p",null,"\u5165\u95e8\u5de5\u7a0b\uff0c\u6807\u7b7e"),(0,l.kt)("p",null,"2\u641c\u7d22\u9875\u9762\u9759\u6001\u5316\u6e32\u67d3"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211110181009088-9f96a2e0.png",alt:"image-20211110181009088"}),"image-20211110181009088"),(0,l.kt)("p",null,"3\u5546\u54c1\u8be6\u60c5\u9875"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211113111645270-a5cc9606.png",alt:"image-20211113111645270"}),"image-20211113111645270"),(0,l.kt)("h1",{id:"\u7b2c9\u7ae0-\u7528\u6237\u8ba4\u8bc1"},(0,l.kt)("a",{parentName:"h1",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#%E7%AC%AC9%E7%AB%A0-%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81"},"#"),"\u7b2c9\u7ae0 \u7528\u6237\u8ba4\u8bc1"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u89d2\u8272"),"\uff1a\u9274\u6743\u7ec4\uff0c\u540e\u7aef\u5f00\u53d1\u5de5\u7a0b\u5e08\u3002\u67b6\u6784\u5e08\u3002 \u96be\u3002"),(0,l.kt)("h2",{id:"1-\u7528\u6237\u8ba4\u8bc1\u5206\u6790"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81%E5%88%86%E6%9E%90"},"#"),"1 \u7528\u6237\u8ba4\u8bc1\u5206\u6790"),(0,l.kt)("h3",{id:"1\u7528\u6237\u8ba4\u8bc1\u4e0e\u6388\u6743"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83"},"#"),"1\u7528\u6237\u8ba4\u8bc1\u4e0e\u6388\u6743"),(0,l.kt)("p",null,"\u4ec0\u4e48\u662f\u7528\u6237\u8eab\u4efd\u8ba4\u8bc1\uff1f"),(0,l.kt)("p",null," \u7528\u6237\u8eab\u4efd\u8ba4\u8bc1\u5373\u7528\u6237\u53bb\u8bbf\u95ee\u7cfb\u7edf\u8d44\u6e90\u65f6\u7cfb\u7edf\u8981\u6c42\u9a8c\u8bc1\u7528\u6237\u7684\u8eab\u4efd\u4fe1\u606f\uff0c\u8eab\u4efd\u5408\u6cd5\u65b9\u53ef\u7ee7\u7eed\u8bbf\u95ee\u3002\u5e38\u89c1\u7684\u7528\u6237\u8eab\u4efd\u8ba4\u8bc1\u8868\u73b0\u5f62\u5f0f\u6709\uff1a\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55\uff0c\u6307\u7eb9\u6253\u5361\u7b49\u65b9\u5f0f\u3002"),(0,l.kt)("p",null,"\u4ec0\u4e48\u662f\u7528\u6237\u6388\u6743\uff1f"),(0,l.kt)("p",null," \u7528\u6237\u8ba4\u8bc1\u901a\u8fc7\u540e\u53bb\u8bbf\u95ee\u7cfb\u7edf\u7684\u8d44\u6e90\uff0c\u7cfb\u7edf\u4f1a\u5224\u65ad\u7528\u6237\u662f\u5426\u62e5\u6709\u8bbf\u95ee\u8d44\u6e90\u7684\u6743\u9650\uff0c\u53ea\u5141\u8bb8\u8bbf\u95ee\u6709\u6743\u9650\u7684\u7cfb\u7edf\u8d44\u6e90\uff0c\u6ca1\u6709\u6743\u9650\u7684\u8d44\u6e90\u5c06\u65e0\u6cd5\u8bbf\u95ee\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u7528\u6237\u6388\u6743\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"5\u5f20\u8868\n\ntb_user     username  password\n\ntb_user_role  \u5173\u8054\u8868  user_id role_id\n\ntb_role     rolename\n\ntb_role_auth\n\ntb_auth        auth(\u5220\u9664\u9996\u9875\u56fe\u7247)\n")),(0,l.kt)("h3",{id:"2\u5355\u70b9\u767b\u5f55\u9700\u6c42-sso"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E9%9C%80%E6%B1%82-sso"},"#"),"2\u5355\u70b9\u767b\u5f55\u9700\u6c42 SSO"),(0,l.kt)("p",null,"\u8ba9\u7528\u6237\u5728\u4e00\u4e2a\u7cfb\u7edf\u4e2d\u767b\u5f55\uff0c\u5176\u4ed6\u4efb\u610f\u53d7\u4fe1\u4efb\u7684\u7cfb\u7edf\u90fd\u53ef\u4ee5\u8bbf\u95ee\uff0c\u8fd9\u4e2a\u529f\u80fd\u5c31\u53eb\u5355\u70b9\u767b\u5f55\u3002"),(0,l.kt)("h3",{id:"3\u7b2c\u4e09\u65b9\u8d26\u53f7\u767b\u5f55"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3%E7%AC%AC%E4%B8%89%E6%96%B9%E8%B4%A6%E5%8F%B7%E7%99%BB%E5%BD%95"},"#"),"3\u7b2c\u4e09\u65b9\u8d26\u53f7\u767b\u5f55"),(0,l.kt)("p",null,"\u5f53\u9700\u8981\u8bbf\u95ee\u7b2c\u4e09\u65b9\u7cfb\u7edf\u7684\u8d44\u6e90\u65f6\u9700\u8981\u9996\u5148\u901a\u8fc7\u7b2c\u4e09\u65b9\u7cfb\u7edf\u7684\u8ba4\u8bc1\uff08\u4f8b\u5982\uff1a\u5fae\u4fe1\u8ba4\u8bc1\uff09\uff0c\u7531\u7b2c\u4e09\u65b9\u7cfb\u7edf\u5bf9\u7528\u6237\u8ba4\u8bc1\u901a\u8fc7\uff0c\u5e76\u6388\u6743\u8d44\u6e90\u7684\u8bbf\u95ee\u6743\u9650\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAAA+CAYAAAB9RBRuAAAI5klEQVR4nO2dW2xT9x3HP8fYITiQ0qZL4pRLRbeqWsfkUoizFdEqYkPJSFr6gFDZUBGrH9wqz3sJCFwhXkfbPFhU2qV9yUPTkgjUbvUCYlsT6LCQuqWAKCVVbggSEjskvpz/Hk7iS3KO7VxsE5//J4pyLr//33/H3+/5387/WAn9qkWQBvsXf0x3WiJZ0VgKXQCJpJBIA0hMjTSAxNRIA0hMjTVTQCgUykc5JJKCkNEApaWl+SiHRFIQZBNIYmqkASSmRhpAYmqkASSmRhpAYmqkASSmRhpAYmqkASSmxgJp74aWSIoaSyw8iTSBxKxY1Ng0kfADhJAmkJgPrQ8QU4mGx6QJJKYj0QlWBdHwGGosUsDiSCT5JXUUSBXEwhPSBBLToDsMKk0gMQuG6wFi4Qmw2fNWkIsjCp/2K1y6q9A/qR3baIedPxK8tlGwq9Jc/RN/0E/7aDvdwW4GI4MAOGwOXln7Cvsf30/92voCl7A4UMZ2/tZQWQLBuu4/57QAN8ah5WsLl+8paeN2VAhOv6jyk/KcFqfg9E318fYPb3MheCFt3MtrX+aDDR/wXOlzeSpZcWI4EyzyMDdwcURht39VRvEDXL6nxV4cyRy7UvEH/biuuzKKH+BC8AKu6y78QX8eSla8zDOAmPnJNTfG4c1/WwhFs08TimppboznrlyFom+qj3239hFSs1+DHVJD7Lu1j76pvqziPR6P7rbefrYxK50UA+RD+LO0fG1hXKef/X6t4LvXVO7vF1z6tcrrm1LLNB7R0mYk4MPj8SR+zwT0gvAlx3h86EUtjAG+DXzLwAJTHblzZEHinyWkhjhy50jGOI/HQ1tb25JErZd+pWOF/AoftKaPXrPn/VrBG08DaOd+ul7hTB2A4JM7ifjL9xQujiiGHePBc168XdB0tI2GaoBBzp/w4jnRROvRBhwAQ+fxnuiEva20NToS6Txemo62zqTLD/6gn57Jnvj+C/YXOFZzjFp7LdXWar6Z/oaP733MeyPv6ZqkZ7IHf9Bv2DGeFX8mkuOMDDN7bpZs8n2UseZb/ACf9s8X/wY7M+KfT301fHJnfh76BgjQ2TWI092WJGIHDUfd9Ht8dAYacDsh0NXJ4DZ3XPwAjsZW3AMefF0BGn7vXNR7Wwzto+3x7VfXv0rHlg6+mvwqfmwiNkFLZQsHKw5S9786XRO0j7YbGiBZ1EZ/jcS+0gWeiYyPRckFl+7ON0Dtk8ZG/E2N4B1S0+jlAcDQIMM4aZqnXye128B3JQDOKgYHwNk8X+TO7U7w9RLASb4s0B3sjm+/+9S7AJwdO0vd2jqay5vj25XWSnaX7+azsc/S5qGHUS2gdzzbZlIxmKMgBpgd50/m8Bbj+MdKFDbY4YekdHp5ADDUz6DBqaoaB1rjfJj+IYOg6o046DcuTA6YHecHeLpEqwZP1pyMH2te38xIdISta7bSsaWDoegQp0dOc2rolG4ec0kn6Nkrf7KY59YGxSB0IwpigBILRNTE/rGfC16qTJ/mDz8TvNObxRBoGgEPD8yKpIqN1ehHpTFQPvhy4kuay5sTxYkOsW7VOrau2Ro/1zvZy8mak9TYamjpb8mY51IFLWuAZaaqFG4FE/tvbhFAenHPbQZtNJqkrnZQRSe9AXA6AQKcP1dFQ+Mwvf8Bp1tr2DhqoPNKPIjAufNUNTYwfCUA29x5a/6ANsN7c/omAG/dfovKH1dSZ68D4Hb4dnz7mdXPAFBp1a4Wh588HDeAw+aYm60hCzVDMQjdiIIYYHuF4FYwIeY/3VLY/gSGtcB/xwR/G0o1yPYKoz6Dk6a9Drw+L+ePttJAFQx48XiAbW7aZpTt3NuE44QP77lWWhuhin68Hg/gxN2WT/lDXVld3AB3o3c5O3aWK6ErAAxEBuIGeH7181p8kjmS81gIybWCXjMoGXPWADlcG3Bgs6D9+4Sgj19TeH2TcTMoMKZw/FqqAQ5sNi6fo7GVthofnhMeOmeOOfc2MdzlSwyFVjfQ2ubA5/Hi6ZoJ2tZE00AnvjwPhR564hAf3f8ovp/ctp8luU8AWtPo0HeHUvJYDNkOkWbqKK9U9A2Q44UxuyoFOypEylzA1vXwICx4rEThnyPw/SQ41wuessNme2oneEdFFjfHOd3M+1wbG+YG4Z4X1MDcqFxTv7Yel92VMheQzKmhU3w+/jl7yvdQY6thIKJNs12dvAqAy+5a9M1xyVf/xdQCK51UA+RxRdjpF1X2/GNVfDb4+LX5V3m9fkG5TUtbbHy46UNc112Gs8FXJ6/GBZ9MmaWMM5vOZP06ySLPJPpkirUGUEZ3HtRUbyD+dRf+krMXvzii8Lt/ZX8/UJkV/vpLtWhvjfYH/Qu6H6jMUkbHlg55a/QSsCBEXq/8yeyqFPy9PsYOww5tgh0VWmyxih+0plDPsz247K6MsS67i55ne6T4l4gy+tIbaRWVyxogmbkLYkos2nCpXBDTzc3pm5RZyuSCmBzwyBhAIikE8tGIElOT3gDmanVITIixAaT4JSZg/kSYFL7ERKTWAHPEX4jFMhJJPtFqACl8iUmxSPFLzEy8DyCFLzEjFpDil5gXixS/xMzImWCJqSnIijCJ5FFBvwaQ4peYhIKtCJNIHgUSNYAUv8SEKPd/caAgyl+K30pKy7HYSpevMI840fAUU9P3sVlXs6qkJOWcUNOsj17oPznbeDV9XMaRxXSvI3TyEIKIWMBz9BdAQUaBllrZhB+OEQsv/FHiKxEhBNPhMRTFkr34F7PMNZt4VSxN/OnKJbRfo++nUJTcSDWvBliW5cdC+9AjUxNEHgYzBK98ouFJhFCx2lbHjwlVTS/+hZDth5KF8DOK3zhxPA+jdNYcSTVvT4ZbLuEnE4sEgTC2NY+T6dGKKxE1phKOTGCx2FhlnblvcbmEn22aDMKHLK76xgmN0+ukUxQLQkcHSyHnNcByXvX1iEXChEOjRfkt9+HwA4RQsdlsprzqzyUXtUBODbAsws/C8WosTCR0v6hMoMYiRKMPsVlXg2JQuxVbWz+L92Nd5kbL/wHb3QxppU0/qwAAAABJRU5ErkJggg==",alt:"image-20211122102755245"}),"image-20211122102755245"),(0,l.kt)("p",null,"\u597d\u5904\uff1a"),(0,l.kt)("p",null," 1\u7528\u6237\uff1a\u9632\u6b62\u4fe1\u606f\u6cc4\u9732"),(0,l.kt)("p",null," 2\u7f51\u7ad9\uff1a\u81ea\u5df1\u5c31\u4e0d\u7528\u518d\u505a\u4e00\u5957\u767b\u9646\u7cfb\u7edf\u3002"),(0,l.kt)("h2",{id:"2-\u8ba4\u8bc1\u89e3\u51b3\u65b9\u6848"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-%E8%AE%A4%E8%AF%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"},"#"),"2 \u8ba4\u8bc1\u89e3\u51b3\u65b9\u6848"),(0,l.kt)("h3",{id:"21-\u5355\u70b9\u767b\u5f55\u6280\u672f\u65b9\u6848"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-1-%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88"},"#"),"2.1 \u5355\u70b9\u767b\u5f55\u6280\u672f\u65b9\u6848"),(0,l.kt)("p",null,"\u5206\u5e03\u5f0f\u7cfb\u7edf\u8981\u5b9e\u73b0\u5355\u70b9\u767b\u5f55\uff0c\u901a\u5e38\u5c06\u8ba4\u8bc1\u7cfb\u7edf\u72ec\u7acb\u62bd\u53d6\u51fa\u6765\uff0c\u5e76\u4e14\u5c06\u7528\u6237\u8eab\u4efd\u4fe1\u606f\u5b58\u50a8\u5728\u5355\u72ec\u7684\u5b58\u50a8\u4ecb\u8d28\uff0c\u6bd4\u5982\uff1aMySQL\u3001Redis\uff0c\u8003\u8651\u6027\u80fd\u8981\u6c42\uff0c\u901a\u5e38\u5b58\u50a8\u5728Redis\u4e2d\uff0c\u5982\u4e0b\u56fe\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122101800309-8d0e852f.png",alt:"image-20211122101800309"}),"image-20211122101800309"),(0,l.kt)("p",null,"\u7279\u70b9\uff1a"),(0,l.kt)("p",null,"1\u3001\u8ba4\u8bc1\u7cfb\u7edf\u4e3a\u72ec\u7acb\u7684\u7cfb\u7edf\u3002"),(0,l.kt)("p",null,"2\u3001\u5404\u5b50\u7cfb\u7edf\u901a\u8fc7Http\u6216\u5176\u5b83\u534f\u8bae\u4e0e\u8ba4\u8bc1\u7cfb\u7edf\u901a\u4fe1\uff0c\u5b8c\u6210\u7528\u6237\u8ba4\u8bc1\u3002"),(0,l.kt)("p",null,"3\u3001\u7528\u6237\u8eab\u4efd\u4fe1\u606f\u5b58\u50a8\u5728Redis\u96c6\u7fa4\u3002"),(0,l.kt)("p",null,"Java\u4e2d\u6709\u5f88\u591a\u7528\u6237\u8ba4\u8bc1\u7684\u6846\u67b6\u90fd\u53ef\u4ee5\u5b9e\u73b0\u5355\u70b9\u767b\u5f55\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"}," 1\u3001Apache Shiro. \n 2\u3001CAS \n 3\u3001Spring security CAS  \n")),(0,l.kt)("h3",{id:"22-\u7b2c\u4e09\u65b9\u767b\u5f55\u6280\u672f\u65b9\u6848-\u91cd\u70b9\u638c\u63e1-oauth2"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-2-%E7%AC%AC%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88-%E9%87%8D%E7%82%B9%E6%8E%8C%E6%8F%A1-oauth2"},"#"),"2.2 \u7b2c\u4e09\u65b9\u767b\u5f55\u6280\u672f\u65b9\u6848-\u91cd\u70b9\u638c\u63e1 Oauth2"),(0,l.kt)("h4",{id:"221-oauth2\u8ba4\u8bc1\u6d41\u7a0b"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-2-1-oauth2%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B"},"#"),"2.2.1 Oauth2\u8ba4\u8bc1\u6d41\u7a0b"),(0,l.kt)("p",null,"\u600e\u4e48\u7528\uff1a"),(0,l.kt)("p",null,"\u4e3a\u4ec0\u4e48\uff1a\u7b2c\u4e09\u65b9\u8ba4\u8bc1\u6280\u672f\u65b9\u6848\u6700\u4e3b\u8981\u662f\u89e3\u51b3",(0,l.kt)("strong",{parentName:"p"},"\u8ba4\u8bc1\u534f\u8bae\u7684\u901a\u7528\u6807\u51c6"),"\u95ee\u9898\uff0c\u56e0\u4e3a\u8981\u5b9e\u73b0\u8de8\u7cfb\u7edf\u8ba4\u8bc1\uff0c\u5404\u7cfb\u7edf\u4e4b\u95f4\u8981\u9075\u5faa\u4e00\u5b9a\u7684 \u63a5\u53e3\u534f\u8bae\u3002 OAUTH\u534f\u8bae\u4e3a\u7528\u6237\u8d44\u6e90\u7684\u6388\u6743\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5b89\u5168\u7684\u3001\u5f00\u653e\u800c\u53c8\u7b80\u6613\u7684\u6807\u51c6\u3002\u540c\u65f6\uff0c\u4efb\u4f55\u7b2c\u4e09\u65b9\u90fd\u53ef\u4ee5\u4f7f\u7528OAUTH\u8ba4 \u8bc1\u670d\u52a1\uff0c\u4efb\u4f55\u670d\u52a1\u63d0\u4f9b\u5546\u90fd\u53ef\u4ee5\u5b9e\u73b0\u81ea\u8eab\u7684OAUTH\u8ba4\u8bc1\u670d\u52a1\uff0c\u56e0\u800cOAUTH\u662f\u5f00\u653e\u7684\u3002\u4e1a\u754c\u63d0\u4f9b\u4e86OAUTH\u7684\u591a\u79cd\u5b9e\u73b0\u5982PHP\u3001JavaScript\uff0cJava\uff0cRuby\u7b49\u5404\u79cd\u8bed\u8a00\u5f00\u53d1\u5305\uff0c\u5927\u5927\u8282\u7ea6\u4e86\u7a0b\u5e8f\u5458\u7684\u65f6\u95f4\uff0c\u56e0\u800cOAUTH\u662f\u7b80\u6613\u7684\u3002\u4e92\u8054\u7f51\u5f88\u591a\u670d\u52a1\u5982Open API\uff0c\u5f88\u591a\u5927\u516c\u53f8\u5982Google\uff0cYahoo\uff0cMicrosoft\u7b49\u90fd\u63d0\u4f9b\u4e86OAUTH\u8ba4\u8bc1\u670d\u52a1\uff0c\u8fd9\u4e9b\u90fd\u8db3\u4ee5\u8bf4\u660eOAUTH\u6807\u51c6\u9010\u6e10\u6210\u4e3a\u5f00\u653e\u8d44\u6e90\u6388\u6743\u7684\u6807\u51c6\u3002 Oauth\u534f\u8bae\u76ee\u524d\u53d1\u5c55\u52302.0\u7248\u672c\uff0c1.0\u7248\u672c\u8fc7\u4e8e\u590d\u6742\uff0c2.0\u7248\u672c\u5df2\u5f97\u5230\u5e7f\u6cdb\u5e94\u7528\u3002 \u53c2\u8003\uff1a",(0,l.kt)("a",{parentName:"p",href:"https://baike.baidu.com/item/oAuth/7153134?fr=aladdin"},"https://baike.baidu.com/item/oAuth/7153134?fr=aladdinopen in new window")," Oauth\u534f\u8bae\uff1a",(0,l.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc6749"},"https://tools.ietf.org/html/rfc6749open in new window")," \u4e0b\u8fb9\u5206\u6790\u4e00\u4e2aOauth2\u8ba4\u8bc1\u7684\u4f8b\u5b50\uff0c4399\u7f51\u7ad9\u4f7f\u7528\u5fae\u4fe1\u8ba4\u8bc1\u7684\u8fc7\u7a0b\uff1a"),(0,l.kt)("p",null,"\u662f\u4ec0\u4e48\uff1a"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6d41\u7a0b\u56fe"),"\uff1a!!!!!!!!\u91cd\u70b9\u8bb0\u5fc6"),(0,l.kt)("p",null,"4399\u2014\u2014\u2014\u2014\u2014\u2014\u300b\u5fae\u4fe1\u7b2c\u4e09\u65b9\u767b\u5f55"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122104426755-45bc1ee9.png",alt:"image-20211122104426755"}),"image-20211122104426755"),(0,l.kt)("p",null,"1.\u5ba2\u6237\u7aef\u8bf7\u6c42\u7b2c\u4e09\u65b9\u6388\u6743"),(0,l.kt)("p",null,"\u7528\u6237\u8fdb\u51654399\u7684\u767b\u5f55\u9875\u9762\uff0c\u70b9\u51fb\u5fae\u4fe1\u7684\u56fe\u6807\u4ee5\u5fae\u4fe1\u8d26\u53f7\u767b\u5f55\u7cfb\u7edf\uff0c\u7528\u6237\u662f\u81ea\u5df1\u5728\u5fae\u4fe1\u91cc\u4fe1\u606f\u7684\u8d44\u6e90\u62e5\u6709\u8005\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122104539494-b23e5c0f.png",alt:"image-20211122104539494"}),"image-20211122104539494"),(0,l.kt)("p",null,"\u70b9\u51fb\u201c\u7528\u5fae\u4fe1\u8d26\u53f7\u767b\u5f55\u201d\u51fa\u73b0\u4e00\u4e2a\u4e8c\u7ef4\u7801\uff0c\u6b64\u65f6\u7528\u6237\u626b\u63cf\u4e8c\u7ef4\u7801\uff0c\u5f00\u59cb\u7ed94399\u6388\u6743\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122104558149-a3cb3a0a.png",alt:"image-20211122104558149"}),"image-20211122104558149"),(0,l.kt)("p",null,"2.\u8d44\u6e90\u62e5\u6709\u8005\u540c\u610f\u7ed9\u5ba2\u6237\u7aef\u6388\u6743"),(0,l.kt)("p",null,"\u8d44\u6e90\u62e5\u6709\u8005\u626b\u63cf\u4e8c\u7ef4\u7801\u8868\u793a\u8d44\u6e90\u62e5\u6709\u8005\u540c\u610f\u7ed9\u5ba2\u6237\u7aef\u6388\u6743\uff0c\u5fae\u4fe1\u4f1a\u5bf9\u8d44\u6e90\u62e5\u6709\u8005\u7684\u8eab\u4efd\u8fdb\u884c\u9a8c\u8bc1\uff0c \u9a8c\u8bc1\u901a\u8fc7\u540e\uff0cQQ\u4f1a\u8be2\u95ee\u7528\u6237\u662f\u5426\u7ed9\u6388\u67434399\u8bbf\u95ee\u81ea\u5df1\u7684QQ\u6570\u636e\uff0c\u7528\u6237\u70b9\u51fb\u201c\u786e\u8ba4\u767b\u5f55\u201d\u8868\u793a\u540c\u610f\u6388\u6743\uff0cQQ\u8ba4\u8bc1\u670d\u52a1\u5668\u4f1a \u9881\u53d1\u4e00\u4e2a\u6388\u6743\u7801\uff0c\u5e76\u91cd\u5b9a\u5411\u52304399\u7684\u7f51\u7ad9\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122112657000-148fe696.png",alt:"image-20211122112657000"}),"image-20211122112657000"),(0,l.kt)("p",null,"3.\u5ba2\u6237\u7aef\u83b7\u53d6\u5230\u6388\u6743\u7801\uff0c\u8bf7\u6c42\u8ba4\u8bc1\u670d\u52a1\u5668\u7533\u8bf7\u4ee4\u724c \u6b64\u8fc7\u7a0b\u7528\u6237\u770b\u4e0d\u5230\uff0c\u5ba2\u6237\u7aef\u5e94\u7528\u7a0b\u5e8f\u8bf7\u6c42\u8ba4\u8bc1\u670d\u52a1\u5668\uff0c\u8bf7\u6c42\u643a\u5e26\u6388\u6743\u7801\u3002"),(0,l.kt)("p",null,"4.\u8ba4\u8bc1\u670d\u52a1\u5668\u5411\u5ba2\u6237\u7aef\u54cd\u5e94\u4ee4\u724c \u8ba4\u8bc1\u670d\u52a1\u5668\u9a8c\u8bc1\u4e86\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u6388\u6743\u7801\uff0c\u5982\u679c\u5408\u6cd5\u5219\u7ed9\u5ba2\u6237\u7aef\u9881\u53d1\u4ee4\u724c\uff0c\u4ee4\u724c\u662f\u5ba2\u6237\u7aef\u8bbf\u95ee\u8d44\u6e90\u7684\u901a\u884c\u8bc1\u3002 \u6b64\u4ea4\u4e92\u8fc7\u7a0b\u7528\u6237\u770b\u4e0d\u5230\uff0c\u5f53\u5ba2\u6237\u7aef\u62ff\u5230\u4ee4\u724c\u540e\uff0c\u7528\u6237\u57284399\u770b\u5230\u5df2\u7ecf\u767b\u5f55\u6210\u529f\u3002"),(0,l.kt)("p",null,"5.\u5ba2\u6237\u7aef\u8bf7\u6c42\u8d44\u6e90\u670d\u52a1\u5668\u7684\u8d44\u6e90 \u5ba2\u6237\u7aef\u643a\u5e26\u4ee4\u724c\u8bbf\u95ee\u8d44\u6e90\u670d\u52a1\u5668\u7684\u8d44\u6e90\u3002 4399\u7f51\u7ad9\u643a\u5e26\u4ee4\u724c\u8bf7\u6c42\u8bbf\u95ee\u5fae\u4fe1\u670d\u52a1\u5668\u83b7\u53d6\u7528\u6237\u7684\u57fa\u672c\u4fe1\u606f\u3002"),(0,l.kt)("p",null,"6.\u8d44\u6e90\u670d\u52a1\u5668\u8fd4\u56de\u53d7\u4fdd\u62a4\u8d44\u6e90 \u8d44\u6e90\u670d\u52a1\u5668\u6821\u9a8c\u4ee4\u724c\u7684\u5408\u6cd5\u6027\uff0c\u5982\u679c\u5408\u6cd5\u5219\u5411\u7528\u6237\u54cd\u5e94\u8d44\u6e90\u4fe1\u606f\u5185\u5bb9\u3002 \u6ce8\u610f\uff1a\u8d44\u6e90\u670d\u52a1\u5668\u548c\u8ba4\u8bc1\u670d\u52a1\u5668\u53ef\u4ee5\u662f\u4e00\u4e2a\u670d\u52a1\u4e5f\u53ef\u4ee5\u5206\u5f00\u7684\u670d\u52a1\uff0c\u5982\u679c\u662f\u5206\u5f00\u7684\u670d\u52a1\u8d44\u6e90\u670d\u52a1\u5668\u901a\u5e38\u8981\u8bf7\u6c42\u8ba4\u8bc1 \u670d\u52a1\u5668\u6765\u6821\u9a8c\u4ee4\u724c\u7684\u5408\u6cd5\u6027\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"data:image/png;base64,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",alt:"image-20211122104649845"}),"image-20211122104649845"),(0,l.kt)("p",null,"Oauth2.0\u8ba4\u8bc1\u6d41\u7a0b\u5982\u4e0b\uff1a \u5f15\u81eaOauth2.0\u534f\u8baerfc6749 ",(0,l.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc6749"},"https://tools.ietf.org/html/rfc6749open in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1564717418054-8dc394bd.png",alt:"1564717418054"}),"1564717418054"),(0,l.kt)("p",null,"Oauth2\u5305\u62ec\u4ee5\u4e0b\u89d2\u8272\uff1a"),(0,l.kt)("p",null,"1\u3001\u5ba2\u6237\u7aef \u672c\u8eab\u4e0d\u5b58\u50a8\u8d44\u6e90\uff0c\u9700\u8981\u901a\u8fc7\u8d44\u6e90\u62e5\u6709\u8005\u7684\u6388\u6743\u53bb\u8bf7\u6c42\u8d44\u6e90\u670d\u52a1\u5668\u7684\u8d44\u6e90\uff0c\u6bd4\u5982\uff1a\u5143\u52a8\u529b\u4e8c\u5962Android\u5ba2\u6237\u7aef\u3001\u5143\u52a8\u529b\u4e8c\u5962Web\u5ba2\u6237\u7aef\uff08\u6d4f\u89c8\u5668\u7aef\uff09\u3001\u5fae\u4fe1\u5ba2\u6237\u7aef\u7b49\u3002"),(0,l.kt)("p",null,"2\u3001\u8d44\u6e90\u62e5\u6709\u8005 \u901a\u5e38\u4e3a\u7528\u6237\uff0c\u4e5f\u53ef\u4ee5\u662f\u5e94\u7528\u7a0b\u5e8f\uff0c\u5373\u8be5\u8d44\u6e90\u7684\u62e5\u6709\u8005\u3002"),(0,l.kt)("p",null,"3\u3001\u6388\u6743\u670d\u52a1\u5668\uff08\u4e5f\u79f0\u8ba4\u8bc1\u670d\u52a1\u5668\uff09 \u7528\u6765\u5bf9\u8d44\u6e90\u62e5\u6709\u7684\u8eab\u4efd\u8fdb\u884c\u8ba4\u8bc1\u3001\u5bf9\u8bbf\u95ee\u8d44\u6e90\u8fdb\u884c\u6388\u6743\u3002\u5ba2\u6237\u7aef\u8981\u60f3\u8bbf\u95ee\u8d44\u6e90\u9700\u8981\u901a\u8fc7\u8ba4\u8bc1\u670d\u52a1\u5668\u7531\u8d44\u6e90\u62e5\u6709\u8005\u6388 \u6743\u540e\u65b9\u53ef\u8bbf\u95ee\u3002"),(0,l.kt)("p",null,"4\u3001\u8d44\u6e90\u670d\u52a1\u5668 \u5b58\u50a8\u8d44\u6e90\u7684\u670d\u52a1\u5668\uff0c\u6bd4\u5982\uff0c\u5143\u52a8\u529b\u4e8c\u5962\u7528\u6237\u7ba1\u7406\u670d\u52a1\u5668\u5b58\u50a8\u4e86\u5143\u52a8\u529b\u4e8c\u5962\u7684\u7528\u6237\u4fe1\u606f\uff0c\u5fae\u4fe1\u7684\u8d44\u6e90\u670d\u52a1\u5b58\u50a8\u4e86\u5fae\u4fe1\u7684\u7528\u6237\u4fe1\u606f\u7b49\u3002\u5ba2\u6237\u7aef\u6700\u7ec8\u8bbf\u95ee\u8d44\u6e90\u670d\u52a1\u5668\u83b7\u53d6\u8d44\u6e90\u4fe1\u606f\u3002"),(0,l.kt)("h4",{id:"222-oauth2\u5728\u9879\u76ee\u7684\u5e94\u7528"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-2-2-oauth2%E5%9C%A8%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%BA%94%E7%94%A8"},"#"),"2.2.2 Oauth2\u5728\u9879\u76ee\u7684\u5e94\u7528"),(0,l.kt)("p",null,"Oauth2\u662f\u4e00\u4e2a\u6807\u51c6\u7684\u5f00\u653e\u7684\u6388\u6743\u534f\u8bae\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u8981\u6c42\u53bb\u4f7f\u7528Oauth2\uff0c\u9879\u76ee\u4e2d\u4f7f\u7528Oauth2\u53ef\u4ee5\u5b9e\u73b0\u5b9e\u73b0\u5982\u4e0b\u529f\u80fd\uff1a"),(0,l.kt)("p",null,"1\u3001\u672c\u7cfb\u7edf\u8bbf\u95ee\u7b2c\u4e09\u65b9\u7cfb\u7edf\u7684\u8d44\u6e90"),(0,l.kt)("p",null,"2\u3001\u5916\u90e8\u7cfb\u7edf\u8bbf\u95ee\u672c\u7cfb\u7edf\u7684\u8d44\u6e90"),(0,l.kt)("p",null,"3\u3001\u672c\u7cfb\u7edf\u524d\u7aef\uff08\u5ba2\u6237\u7aef\uff09 \u8bbf\u95ee\u672c\u7cfb\u7edf\u540e\u7aef\u5fae\u670d\u52a1\u7684\u8d44\u6e90\u3002"),(0,l.kt)("p",null,"4\u3001\u672c\u7cfb\u7edf\u5fae\u670d\u52a1\u4e4b\u95f4\u8bbf\u95ee\u8d44\u6e90\uff0c\u4f8b\u5982\uff1a\u5fae\u670d\u52a1A\u8bbf\u95ee\u5fae\u670d\u52a1B\u7684\u8d44\u6e90\uff0cB\u8bbf\u95eeA\u7684\u8d44\u6e90\u3002"),(0,l.kt)("h3",{id:"23-spring-security-oauth2\u8ba4\u8bc1\u89e3\u51b3\u65b9\u6848-\u4e86\u89e3"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-3-spring-security-oauth2%E8%AE%A4%E8%AF%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-%E4%BA%86%E8%A7%A3"},"#"),"2.3 Spring security Oauth2\u8ba4\u8bc1\u89e3\u51b3\u65b9\u6848-\u4e86\u89e3"),(0,l.kt)("p",null,"\u672c\u9879\u76ee\u91c7\u7528 Spring security + Oauth2+JWT\u5b8c\u6210\u7528\u6237\u8ba4\u8bc1\u53ca\u7528\u6237\u6388\u6743\uff0cSpring security \u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u548c\u9ad8\u5ea6\u53ef\u5b9a\u5236\u7684\u8eab\u4efd\u9a8c\u8bc1\u548c\u8bbf\u95ee\u63a7\u5236\u6846\u67b6\uff0cSpring security \u6846\u67b6\u96c6\u6210\u4e86Oauth2\u534f\u8bae\uff0c\u4e0b\u56fe\u662f\u9879\u76ee\u8ba4\u8bc1\u67b6\u6784\u56fe\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1564732556537-c639875e.png",alt:"1564732556537"}),"1564732556537"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u767b\u5f55"),"\uff1a"),(0,l.kt)("p",null,"1\u3001\u7528\u6237\u8bf7\u6c42\u8ba4\u8bc1\u670d\u52a1\u5b8c\u6210\u8ba4\u8bc1\u3002"),(0,l.kt)("p",null,"2\u3001\u8ba4\u8bc1\u670d\u52a1\u4e0b\u53d1\u7528\u6237\u8eab\u4efd\u4ee4\u724c\uff0c\u62e5\u6709\u8eab\u4efd\u4ee4\u724c\u8868\u793a\u8eab\u4efd\u5408\u6cd5\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u8bbf\u95ee"),"\uff1a"),(0,l.kt)("p",null,"1\u3001\u7528\u6237\u643a\u5e26\u4ee4\u724c\u8bf7\u6c42\u8d44\u6e90\u670d\u52a1\uff0c\u8bf7\u6c42\u8d44\u6e90\u670d\u52a1\u5fc5\u5148\u7ecf\u8fc7\u7f51\u5173\u3002"),(0,l.kt)("p",null,"2\u3001\u7f51\u5173\u6821\u9a8c\u7528\u6237\u8eab\u4efd\u4ee4\u724c\u7684\u5408\u6cd5\uff0c\u4e0d\u5408\u6cd5\u8868\u793a\u7528\u6237\u6ca1\u6709\u767b\u5f55\uff0c\u5982\u679c\u5408\u6cd5\u5219\u653e\u884c\u7ee7\u7eed\u8bbf\u95ee\u3002"),(0,l.kt)("p",null,"3\u3001\u8d44\u6e90\u670d\u52a1\u83b7\u53d6\u4ee4\u724c\uff0c\u6839\u636e\u4ee4\u724c\u5b8c\u6210\u6388\u6743\u3002"),(0,l.kt)("p",null,"4\u3001\u8d44\u6e90\u670d\u52a1\u5b8c\u6210\u6388\u6743\u5219\u54cd\u5e94\u8d44\u6e90\u4fe1\u606f\u3002"),(0,l.kt)("h2",{id:"3-jwt\u4ee4\u724c\u56de\u987e"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-jwt%E4%BB%A4%E7%89%8C%E5%9B%9E%E9%A1%BE"},"#"),"3 Jwt\u4ee4\u724c\u56de\u987e"),(0,l.kt)("p",null,"JSON Web Token\uff08JWT\uff09\u662f\u4e00\u4e2a\u5f00\u653e\u7684\u884c\u4e1a\u6807\u51c6\uff08RFC 7519\uff09\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e00\u79cd\u7b80\u4ecb\u7684\u3001\u81ea\u5305\u542b\u7684\u534f\u8bae\u683c\u5f0f\uff0c\u7528\u4e8e \u5728\u901a\u4fe1\u53cc\u65b9\u4f20\u9012json\u5bf9\u8c61\uff0c\u4f20\u9012\u7684\u4fe1\u606f\u7ecf\u8fc7\u6570\u5b57\u7b7e\u540d\u53ef\u4ee5\u88ab\u9a8c\u8bc1\u548c\u4fe1\u4efb\u3002JWT\u53ef\u4ee5\u4f7f\u7528HMAC\u7b97\u6cd5\u6216\u4f7f\u7528RSA\u7684\u516c \u94a5/\u79c1\u94a5\u5bf9\u6765\u7b7e\u540d\uff0c\u9632\u6b62\u88ab\u7be1\u6539\u3002"),(0,l.kt)("p",null,"\u5b98\u7f51\uff1a",(0,l.kt)("a",{parentName:"p",href:"https://jwt.io/"},"https://jwt.io/open in new window")),(0,l.kt)("p",null,"\u6807\u51c6\uff1a",(0,l.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc7519"},"https://tools.ietf.org/html/rfc7519open in new window")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u4f18\u70b9"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"1\u3001jwt\u57fa\u4e8ejson\uff0c\u975e\u5e38\u65b9\u4fbf\u89e3\u6790\u3002 \n2\u3001\u53ef\u4ee5\u5728\u4ee4\u724c\u4e2d\u81ea\u5b9a\u4e49\u4e30\u5bcc\u7684\u5185\u5bb9\uff0c\u6613\u6269\u5c55\u3002 \n3\u3001\u901a\u8fc7\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\u53ca\u6570\u5b57\u7b7e\u540d\u6280\u672f\uff0cJWT\u9632\u6b62\u7be1\u6539\uff0c\u5b89\u5168\u6027\u9ad8\u3002 \n4\u3001\u8d44\u6e90\u670d\u52a1\u4f7f\u7528JWT\u53ef\u4e0d\u4f9d\u8d56\u8ba4\u8bc1\u670d\u52a1\u5373\u53ef\u5b8c\u6210\u6388\u6743\u3002\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u7f3a\u70b9"),"\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"\uff11\u3001JWT\u4ee4\u724c\u8f83\u957f\uff0c\u5360\u5b58\u50a8\u7a7a\u95f4\u6bd4\u8f83\u5927\u3002    \n")),(0,l.kt)("h3",{id:"31-\u4ee4\u724c\u7ed3\u6784"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-1-%E4%BB%A4%E7%89%8C%E7%BB%93%E6%9E%84"},"#"),"3.1 \u4ee4\u724c\u7ed3\u6784"),(0,l.kt)("p",null,"\u901a\u8fc7\u5b66\u4e60JWT\u4ee4\u724c\u7ed3\u6784\u4e3a\u81ea\u5b9a\u4e49jwt\u4ee4\u724c\u6253\u597d\u57fa\u7840\u3002"),(0,l.kt)("p",null,"JWT\u4ee4\u724c\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff0c\u6bcf\u90e8\u5206\u4e2d\u95f4\u4f7f\u7528\u70b9\uff08.\uff09\u5206\u9694\uff0c\u6bd4\u5982\uff1axxxxx.yyyyy.zzzzz"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Header")),(0,l.kt)("p",null,"\u5934\u90e8\u5305\u62ec\u4ee4\u724c\u7684\u7c7b\u578b\uff08\u5373JWT\uff09\u53ca\u4f7f\u7528\u7684\u54c8\u5e0c\u7b97\u6cd5\uff08\u5982HMAC SHA256\u6216RSA\uff09"),(0,l.kt)("p",null,"\u4e00\u4e2a\u4f8b\u5b50\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,"\u4e0b\u8fb9\u662fHeader\u90e8\u5206\u7684\u5185\u5bb9"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'{\n    "alg": "HS256",\n    "typ": "JWT"\n}\n')),(0,l.kt)("p",null,"\u5c06\u4e0a\u8fb9\u7684\u5185\u5bb9\u4f7f\u7528Base64Url\u7f16\u7801\uff0c\u5f97\u5230\u4e00\u4e2a\u5b57\u7b26\u4e32\u5c31\u662fJWT\u4ee4\u724c\u7684\u7b2c\u4e00\u90e8\u5206\u3002"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Payload")),(0,l.kt)("p",null,"\u7b2c\u4e8c\u90e8\u5206\u662f\u8d1f\u8f7d\uff0c\u5185\u5bb9\u4e5f\u662f\u4e00\u4e2ajson\u5bf9\u8c61\uff0c\u5b83\u662f\u5b58\u653e\u6709\u6548\u4fe1\u606f\u7684\u5730\u65b9\uff0c\u5b83\u53ef\u4ee5\u5b58\u653ejwt\u63d0\u4f9b\u7684\u73b0\u6210\u5b57\u6bb5\uff0c\u6bd4 \u5982\uff1aiss\uff08\u7b7e\u53d1\u8005\uff09,exp\uff08\u8fc7\u671f\u65f6\u95f4\u6233\uff09, sub\uff08\u9762\u5411\u7684\u7528\u6237\uff09\u7b49\uff0c\u4e5f\u53ef\u81ea\u5b9a\u4e49\u5b57\u6bb5\u3002"),(0,l.kt)("p",null,"\u6b64\u90e8\u5206\u4e0d\u5efa\u8bae\u5b58\u653e\u654f\u611f\u4fe1\u606f\uff0c\u56e0\u4e3a\u6b64\u90e8\u5206\u53ef\u4ee5\u89e3\u7801\u8fd8\u539f\u539f\u59cb\u5185\u5bb9\u3002"),(0,l.kt)("p",null,"\u6700\u540e\u5c06\u7b2c\u4e8c\u90e8\u5206\u8d1f\u8f7d\u4f7f\u7528Base64Url\u7f16\u7801\uff0c\u5f97\u5230\u4e00\u4e2a\u5b57\u7b26\u4e32\u5c31\u662fJWT\u4ee4\u724c\u7684\u7b2c\u4e8c\u90e8\u5206\u3002"),(0,l.kt)("p",null,"\u4e00\u4e2a\u4f8b\u5b50\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'{\n    "sub": "1234567890",\n    "name": "456",\n    "admin": true\n}\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Signature")),(0,l.kt)("p",null,"\u7b2c\u4e09\u90e8\u5206\u662f\u7b7e\u540d\uff0c\u6b64\u90e8\u5206\u7528\u4e8e\u9632\u6b62jwt\u5185\u5bb9\u88ab\u7be1\u6539\u3002"),(0,l.kt)("p",null,"\u8fd9\u4e2a\u90e8\u5206\u4f7f\u7528base64url\u5c06\u524d\u4e24\u90e8\u5206\u8fdb\u884c\u7f16\u7801\uff0c\u7f16\u7801\u540e\u4f7f\u7528\u70b9\uff08.\uff09\u8fde\u63a5\u7ec4\u6210\u5b57\u7b26\u4e32\uff0c\u6700\u540e\u4f7f\u7528header\u4e2d\u58f0\u660e \u7b7e\u540d\u7b97\u6cd5\u8fdb\u884c\u7b7e\u540d\u3002"),(0,l.kt)("p",null,"\u4e00\u4e2a\u4f8b\u5b50\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'HMACSHA256(\n    base64UrlEncode(header) + "." +\n    base64UrlEncode(payload),\n    secret)\n')),(0,l.kt)("p",null,"base64UrlEncode(header)\uff1ajwt\u4ee4\u724c\u7684\u7b2c\u4e00\u90e8\u5206\u3002"),(0,l.kt)("p",null,"base64UrlEncode(payload)\uff1ajwt\u4ee4\u724c\u7684\u7b2c\u4e8c\u90e8\u5206\u3002"),(0,l.kt)("p",null,"secret\uff1a\u7b7e\u540d\u6240\u4f7f\u7528\u7684\u5bc6\u94a5\u3002"),(0,l.kt)("h3",{id:"32-\u751f\u6210\u79c1\u94a5\u516c\u94a5-\u8fd0\u7ef4"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-2-%E7%94%9F%E6%88%90%E7%A7%81%E9%92%A5%E5%85%AC%E9%92%A5-%E8%BF%90%E7%BB%B4"},"#"),"3.2 \u751f\u6210\u79c1\u94a5\u516c\u94a5-\u8fd0\u7ef4"),(0,l.kt)("p",null,"JWT\u4ee4\u724c\u751f\u6210\u91c7\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5"),(0,l.kt)("p",null,"1\u3001\u751f\u6210\u5bc6\u94a5\u8bc1\u4e66 \u4e0b\u8fb9\u547d\u4ee4\u751f\u6210\u5bc6\u94a5\u8bc1\u4e66\uff0c\u91c7\u7528RSA \u7b97\u6cd5\u6bcf\u4e2a\u8bc1\u4e66\u5305\u542b\u516c\u94a5\u548c\u79c1\u94a5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"keytool -genkeypair -alias ydlershe -keyalg RSA -keypass ydlershe -keystore ydlershe.jks -storepass ydlershe \n")),(0,l.kt)("p",null,"Keytool \u662f\u4e00\u4e2ajava\u63d0\u4f9b\u7684\u8bc1\u4e66\u7ba1\u7406\u5de5\u5177"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"-alias\uff1a\u5bc6\u94a5\u7684\u522b\u540d \n-keyalg\uff1a\u4f7f\u7528\u7684hash\u7b97\u6cd5 \n-keypass\uff1a\u5bc6\u94a5\u7684\u8bbf\u95ee\u5bc6\u7801 \n-keystore\uff1a\u5bc6\u94a5\u5e93\u6587\u4ef6\u540d\uff0cydles.jks\u4fdd\u5b58\u4e86\u751f\u6210\u7684\u8bc1\u4e66 \n-storepass\uff1a\u5bc6\u94a5\u5e93\u7684\u8bbf\u95ee\u5bc6\u7801 \n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122114330894-e27ee1bc.png",alt:"image-20211122114330894"}),"image-20211122114330894"),(0,l.kt)("p",null,"\u67e5\u8be2\u8bc1\u4e66\u4fe1\u606f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"keytool -list -keystore ydlershe.jks\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122114427622-e07b7930.png",alt:"image-20211122114427622"}),"image-20211122114427622"),(0,l.kt)("p",null,"2\u3001\u5bfc\u51fa\u516c\u94a5"),(0,l.kt)("p",null,"openssl\u662f\u4e00\u4e2a\u52a0\u89e3\u5bc6\u5de5\u5177\u5305\uff0c\u8fd9\u91cc\u4f7f\u7528openssl\u6765\u5bfc\u51fa\u516c\u94a5\u4fe1\u606f\u3002"),(0,l.kt)("p",null,"\u5b89\u88c5 openssl\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://slproweb.com/products/Win32OpenSSL.html"},"http://slproweb.com/products/Win32OpenSSL.htmlopen in new window")),(0,l.kt)("p",null,"\u5b89\u88c5\u8d44\u6599\u76ee\u5f55\u4e0b\u7684Win64OpenSSL-1_1_1b.exe"),(0,l.kt)("p",null,"\u914d\u7f6eopenssl\u7684path\u73af\u5883\u53d8\u91cf\uff0c"),(0,l.kt)("p",null,"cmd\u8fdb\u5165ydles.jks\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"keytool -list -rfc --keystore ydlershe.jks | openssl x509 -inform pem -pubkey\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122115012067-511419e8.png",alt:"image-20211122115012067"}),"image-20211122115012067"),(0,l.kt)("p",null,"\u4e0b\u9762\u6bb5\u5185\u5bb9\u662f\u516c\u94a5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1e+vuZYMGIGQnTWCfHlkzOXKmEpe4Mj4rK2sl2ykt0aDq2SVrBtUawfCUzSfyuC73OBdja7IevLcivgs0Vy4cd+T2jjaB0aOr9EwnJUB94TFplwoqMdGHHYrF2JTD4QnjdQDHvR8ugGNw7lqRRhttX/L1GoSBmXl6WwQAurfcl5dUqHekVYmCpOjQPS+29LaTNsdSYWUjzg/grDUD/FjjQDCZkQ6sTt1DxAlbFra/Td41ewbEF6xfK0oRFbuZKFeznCVp08dfSO5fL9JbtCeCxnCJsYwLO1142sVe5PpA9e+qML7i/UX6wiFixwRfcvHtRgLa2n6q9Sw38fnLKxPuwIDAQAB-----END PUBLIC KEY-----\n")),(0,l.kt)("p",null,"\u5c06\u4e0a\u8fb9\u7684\u516c\u94a5\u62f7\u8d1d\u5230\u6587\u672cpublic.key\u6587\u4ef6\u4e2d\uff0c\u5408\u5e76\u4e3a\u4e00\u884c,\u53ef\u4ee5\u5c06\u5b83\u653e\u5230\u9700\u8981\u5b9e\u73b0\u6388\u6743\u8ba4\u8bc1\u7684\u5de5\u7a0b\u4e2d\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122115208169-e7d11acf.png",alt:"image-20211122115208169"}),"image-20211122115208169"),(0,l.kt)("h3",{id:"33-\u57fa\u4e8e\u79c1\u94a5\u751f\u6210jwt\u4ee4\u724c-\u4e86\u89e3"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-%E5%9F%BA%E4%BA%8E%E7%A7%81%E9%92%A5%E7%94%9F%E6%88%90jwt%E4%BB%A4%E7%89%8C-%E4%BA%86%E8%A7%A3"},"#"),"3.3 \u57fa\u4e8e\u79c1\u94a5\u751f\u6210jwt\u4ee4\u724c-\u4e86\u89e3"),(0,l.kt)("h4",{id:"331\u5bfc\u5165\u8ba4\u8bc1\u670d\u52a1"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-1%E5%AF%BC%E5%85%A5%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1"},"#"),"3.3.1\u5bfc\u5165\u8ba4\u8bc1\u670d\u52a1"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u5c06\u8bfe\u4ef6\u4e2d",(0,l.kt)("inlineCode",{parentName:"li"},"ydles_user_auth"),"\u7684\u5de5\u7a0b\u5bfc\u5165\u5230\u9879\u76ee\u4e2d\u53bb\uff0c\u5982\u4e0b\u56fe\uff1a")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122184808706-adb2aea7.png",alt:"image-20211122184808706"}),"image-20211122184808706"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u542f\u52a8eureka\uff0c\u518d\u542f\u52a8\u8ba4\u8bc1\u670d\u52a1")),(0,l.kt)("h4",{id:"332-\u8ba4\u8bc1\u670d\u52a1\u4e2d\u521b\u5efa\u6d4b\u8bd5\u7c7b"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-2-%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1%E4%B8%AD%E5%88%9B%E5%BB%BA%E6%B5%8B%E8%AF%95%E7%B1%BB"},"#"),"3.3.2 \u8ba4\u8bc1\u670d\u52a1\u4e2d\u521b\u5efa\u6d4b\u8bd5\u7c7b"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123101348853-e45c0ec8.png",alt:"image-20211123101348853"}),"image-20211123101348853"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class CreateJWTTest {\n@Test\npublic void createJWT() {\n    // \u57fa\u4e8e\u79c1\u94a5\u751f\u6210jwt\n    // 1\u521b\u5efa\u79d8\u94a5\u5de5\u5382\n\n    // 1.1\u79d8\u94a5\u4f4d\u7f6e\n    ClassPathResource classPathResource = new ClassPathResource("ydlershe.jks");\n    //1.2\u79d8\u94a5\u5e93\u5bc6\u7801\n    String keyPass = "ydlershe";\n    /**\n     * 1\u79d8\u94a5\u4f4d\u7f6e\n     * 2\u79d8\u94a5\u5e93\u5bc6\u7801\n     */\n    KeyStoreKeyFactory keyStoreKeyFactory = new KeyStoreKeyFactory(classPathResource, keyPass.toCharArray());\n\n    // 2\u57fa\u4e8e\u5de5\u5382\u62ff\u5230\u79c1\u94a5\n    String alias="ydlershe";\n    String password="ydlershe";\n    KeyPair keyPair = keyStoreKeyFactory.getKeyPair(alias, password.toCharArray());\n\n    //\u8f6c\u5316\u4e3arsa\u79c1\u94a5\n    RSAPrivateKey rsaPrivateKey = (RSAPrivateKey)keyPair.getPrivate();\n\n    // 3\u751f\u6210jwt\n    Map<String,String> map=new HashMap<>();\n    map.put("conpany", "itlils");\n    map.put("address", "taiyuan");\n    Jwt jwt = JwtHelper.encode(JSON.toJSONString(map), new RsaSigner(rsaPrivateKey));\n\n    String jwtEncoded = jwt.getEncoded();\n    System.out.println("jwtEncoded:"+jwtEncoded);\n    String claims = jwt.getClaims();\n    System.out.println("claims:"+claims);\n\n}\n}\n')),(0,l.kt)("p",null,"\u8fd0\u884c \u67e5\u770b\u8f93\u51fa"),(0,l.kt)("p",null,"\u8bbf\u95ee ",(0,l.kt)("a",{parentName:"p",href:"http://tool.chinaz.com/Tools/Base64.aspx"},"http://tool.chinaz.com/Tools/Base64.aspxopen in new window")," \u89e3\u6790base64"),(0,l.kt)("h3",{id:"34-\u57fa\u4e8e\u516c\u94a5\u89e3\u6790jwt\u4ee4\u724c"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-4-%E5%9F%BA%E4%BA%8E%E5%85%AC%E9%92%A5%E8%A7%A3%E6%9E%90jwt%E4%BB%A4%E7%89%8C"},"#"),"3.4 \u57fa\u4e8e\u516c\u94a5\u89e3\u6790jwt\u4ee4\u724c"),(0,l.kt)("p",null,"\u4e0a\u9762\u521b\u5efa\u4ee4\u724c\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9JWT\u4ee4\u724c\u8fdb\u884c\u89e3\u6790\uff0c\u8fd9\u91cc\u89e3\u6790\u9700\u8981\u7528\u5230\u516c\u94a5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4e4b\u524d\u751f\u6210\u7684\u516c\u94a5public.key\u62f7\u8d1d\u51fa\u6765\u7528\u5b57\u7b26\u4e32\u53d8\u91cftoken\u5b58\u50a8\uff0c\u7136\u540e\u901a\u8fc7\u516c\u94a5\u89e3\u5bc6\u3002"),(0,l.kt)("p",null,"\u5728ydles-user-oauth\u521b\u5efa\u6d4b\u8bd5\u7c7bcom.ydles.token.ParseJwtTest\u5b9e\u73b0\u89e3\u6790\u6821\u9a8c\u4ee4\u724c\u6570\u636e\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class ParseJwtTest {\n@Test\npublic void parseJwt(){\n    //\u57fa\u4e8e\u516c\u94a5\u53bb\u89e3\u6790jwt\n    String jwt ="eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZGRyZXNzIjoiYmVpamluZyIsImNvbXBhbnkiOiJoZWltYSJ9.cjZNz8G0m4noNYN2VM1SH3ujAtbHElW5Vtbadb0NDI0cjM1DaAXzMA53Qbj4pmVQPl_IfSKqUEXbLxowdRa5NHR43laFsR0kzGbJiTINfSVSroSslYpDdEVwCeAF_a7I-R819YTj4p6sjuYKXbzXpeZQErczFbWWWGR2_U44xH6u1ejRNv8PikFiuzNw-muL7zUJkvqeSJzbEMnQdZMbfvZp4LtSI6B4G_PqpdNXkv19-juxAh99VgJInH_ItF0y5IBOxofA7gRebCZmU8L57gO9ohf2L00D95kis_Ji8lmA1ptLIfXqO_qLVvLBUNH-VtgjGAF0-0pyB-5jlbHP7w";\n\n    String publicKey ="-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvFsEiaLvij9C1Mz+oyAmt47whAaRkRu/8kePM+X8760UGU0RMwGti6Z9y3LQ0RvK6I0brXmbGB/RsN38PVnhcP8ZfxGUH26kX0RK+tlrxcrG+HkPYOH4XPAL8Q1lu1n9x3tLcIPxq8ZZtuIyKYEmoLKyMsvTviG5flTpDprT25unWgE4md1kthRWXOnfWHATVY7Y/r4obiOL1mS5bEa/iNKotQNnvIAKtjBM4RlIDWMa6dmz+lHtLtqDD2LF1qwoiSIHI75LQZ/CNYaHCfZSxtOydpNKq8eb1/PGiLNolD4La2zf0/1dlcr5mkesV570NxRmU1tFm8Zd3MZlZmyv9QIDAQAB-----END PUBLIC KEY-----";\n\n    //\u89e3\u6790\u4ee4\u724c\n    Jwt token = JwtHelper.decodeAndVerify(jwt, new RsaVerifier(publicKey));\n    //\u83b7\u53d6\u8d1f\u8f7d\n    String claims = token.getClaims();\n    System.out.println(claims);\n}\n}\n')),(0,l.kt)("p",null,"\u8fd0\u884c\u9a8c\u8bc1"),(0,l.kt)("p",null,"\u6539\u9519\u516c\u94a5\u6216\u4ee4\u724c\uff0c\u518d\u6d4b\u8bd5"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123101811894-753bb94b.png",alt:"image-20211123101811894"}),"image-20211123101811894"),(0,l.kt)("h2",{id:"4-oauth20\u5165\u95e8"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-oauth2-0%E5%85%A5%E9%97%A8"},"#"),"4 Oauth2.0\u5165\u95e8"),(0,l.kt)("h3",{id:"41-\u51c6\u5907\u5de5\u4f5c"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-1-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"},"#"),"4.1 \u51c6\u5907\u5de5\u4f5c"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"1ydles_user\u5e93\u4e2d\u5bfc\u5165\u8868oauth_client_details\uff08\u5df2\u7ecf\u5b58\u5728\u4e86\uff09")),(0,l.kt)("p",null,"\u89c2\u5bdf\u8868\u7ed3\u6784\u53ca\u6570\u636e"),(0,l.kt)("p",null,"oauth\u6846\u67b6\u5fc5\u987b\u6709\u7684\u8868"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE `oauth_client_details` (\n  `client_id` varchar(48) NOT NULL COMMENT '\u5ba2\u6237\u7aefID\uff0c\u4e3b\u8981\u7528\u4e8e\u6807\u8bc6\u5bf9\u5e94\u7684\u5e94\u7528',\n  `resource_ids` varchar(256) DEFAULT NULL,\n  `client_secret` varchar(256) DEFAULT NULL COMMENT '\u5ba2\u6237\u7aef\u79d8\u94a5\uff0cBCryptPasswordEncoder\u52a0\u5bc6',\n  `scope` varchar(256) DEFAULT NULL COMMENT '\u5bf9\u5e94\u7684\u8303\u56f4',\n  `authorized_grant_types` varchar(256) DEFAULT NULL COMMENT '\u8ba4\u8bc1\u6a21\u5f0f',\n  `web_server_redirect_uri` varchar(256) DEFAULT NULL COMMENT '\u8ba4\u8bc1\u540e\u91cd\u5b9a\u5411\u5730\u5740',\n  `authorities` varchar(256) DEFAULT NULL,\n  `access_token_validity` int(11) DEFAULT NULL COMMENT '\u4ee4\u724c\u6709\u6548\u671f',\n  `refresh_token_validity` int(11) DEFAULT NULL COMMENT '\u4ee4\u724c\u5237\u65b0\u5468\u671f',\n  `additional_information` varchar(4096) DEFAULT NULL,\n  `autoapprove` varchar(256) DEFAULT NULL,\n  PRIMARY KEY (`client_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n")),(0,l.kt)("p",null,"\u5bfc\u51651\u6761\u521d\u59cb\u5316\u6570\u636e,\u5176\u4e2d\u52a0\u5bc6\u5b57\u7b26\u660e\u6587\u4e3aydlershe\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"INSERT INTO `oauth_client_details` VALUES ('ydlershe', null, '$2a$10$NCbyxYr7Xaso0u584oEuMOgYsvxDDWzRz5i/Ha7VySKx9qPqKF4RS', 'app', 'authorization_code,password,refresh_token,client_credentials', 'http://localhost', null, '43200', '43200', null, null);\n")),(0,l.kt)("h3",{id:"42-oauth2\u6388\u6743\u6a21\u5f0f\u4ecb\u7ecd"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-oauth2%E6%8E%88%E6%9D%83%E6%A8%A1%E5%BC%8F%E4%BB%8B%E7%BB%8D"},"#"),"4.2 Oauth2\u6388\u6743\u6a21\u5f0f\u4ecb\u7ecd"),(0,l.kt)("p",null,"Oauth2\u6709\u4ee5\u4e0b\u6388\u6743\u6a21\u5f0f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"1.\u6388\u6743\u7801\u6a21\u5f0f\uff08Authorization Code\uff09\n2.\u9690\u5f0f\u6388\u6743\u6a21\u5f0f\uff08Implicit\uff09 \n3.\u5bc6\u7801\u6a21\u5f0f\uff08Resource Owner Password Credentials\uff09 \n4.\u5ba2\u6237\u7aef\u6a21\u5f0f\uff08Client Credentials\uff09 \n")),(0,l.kt)("p",null,"\u5176\u4e2d",(0,l.kt)("strong",{parentName:"p"},"\u6388\u6743\u7801\u6a21\u5f0f"),"\u548c",(0,l.kt)("strong",{parentName:"p"},"\u5bc6\u7801\u6a21\u5f0f"),"\u5e94\u7528\u8f83\u591a\uff0c\u672c\u5c0f\u8282\u4ecb\u7ecd\u6388\u6743\u7801\u6a21\u5f0f\u3002"),(0,l.kt)("h4",{id:"421-\u6388\u6743\u7801\u6a21\u5f0f"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-1-%E6%8E%88%E6%9D%83%E7%A0%81%E6%A8%A1%E5%BC%8F"},"#"),"4.2.1 \u6388\u6743\u7801\u6a21\u5f0f"),(0,l.kt)("h5",{id:"4211-\u6388\u6743\u7801\u6388\u6743\u6d41\u7a0b\u7ed3\u5408\u6d41\u7a0b\u56fe"},(0,l.kt)("a",{parentName:"h5",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-1-1-%E6%8E%88%E6%9D%83%E7%A0%81%E6%8E%88%E6%9D%83%E6%B5%81%E7%A8%8B-%E7%BB%93%E5%90%88%E6%B5%81%E7%A8%8B%E5%9B%BE"},"#"),"4.2.1.1 \u6388\u6743\u7801\u6388\u6743\u6d41\u7a0b\uff08\u7ed3\u5408\u6d41\u7a0b\u56fe\uff09"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122104426755-45bc1ee9.png",alt:"image-20211122104426755"}),"image-20211122104426755"),(0,l.kt)("p",null,"\u4e0a\u8fb9\u4f8b\u4e3e\u76844399\u7f51\u7ad9\u4f7f\u7528\u5fae\u4fe1\u8ba4\u8bc1\u7684\u8fc7\u7a0b\u5c31\u662f\u6388\u6743\u7801\u6a21\u5f0f\uff0c\u6d41\u7a0b\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,"1\u3001\u5ba2\u6237\u7aef\u8bf7\u6c42\u7b2c\u4e09\u65b9\u6388\u6743"),(0,l.kt)("p",null,"2\u3001\u7528\u6237\u540c\u610f\u7ed9\u5ba2\u6237\u7aef\u6388\u6743"),(0,l.kt)("p",null,"3\u3001\u5ba2\u6237\u7aef\u83b7\u53d6\u5230\u6388\u6743\u7801\uff0c\u8bf7\u6c42\u8ba4\u8bc1\u670d\u52a1\u5668\u7533\u8bf7 \u4ee4\u724c"),(0,l.kt)("p",null,"4\u3001\u8ba4\u8bc1\u670d\u52a1\u5668\u5411\u5ba2\u6237\u7aef\u54cd\u5e94\u4ee4\u724c"),(0,l.kt)("p",null,"5\u3001\u5ba2\u6237\u7aef\u8bf7\u6c42\u8d44\u6e90\u670d\u52a1\u5668\u7684\u8d44\u6e90\uff0c\u8d44\u6e90\u670d\u52a1\u6821\u9a8c\u4ee4\u724c\u5408\u6cd5\u6027\uff0c\u5b8c\u6210\u6388\u6743"),(0,l.kt)("p",null,"6\u3001\u8d44\u6e90\u670d\u52a1\u5668\u8fd4\u56de\u53d7\u4fdd\u62a4\u8d44\u6e90"),(0,l.kt)("h5",{id:"4212-\u7533\u8bf7\u6388\u6743\u7801"},(0,l.kt)("a",{parentName:"h5",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-1-2-%E7%94%B3%E8%AF%B7%E6%8E%88%E6%9D%83%E7%A0%81"},"#"),"4.2.1.2 \u7533\u8bf7\u6388\u6743\u7801"),(0,l.kt)("p",null,"\u6d4f\u89c8\u5668\u8bbf\u95ee ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9200/oauth/authorize?client_id=ydlershe&response_type=code&scop=app&redirect_uri=http://localhost"},"http://localhost:9200/oauth/authorize?client_id=ydlershe&response_type=code&scop=app&redirect_uri=http://localhostopen in new window")),(0,l.kt)("p",null,"\u53c2\u6570\u5217\u8868\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"client_id\uff1a\u5ba2\u6237\u7aefid\uff0c\u548c\u6388\u6743\u914d\u7f6e\u7c7b\u4e2d\u8bbe\u7f6e\u7684\u5ba2\u6237\u7aefid\u4e00\u81f4\u3002 \nresponse_type\uff1a\u6388\u6743\u7801\u6a21\u5f0f\u56fa\u5b9a\u4e3acode \nscop\uff1a\u5ba2\u6237\u7aef\u8303\u56f4\uff0c\u548c\u6388\u6743\u914d\u7f6e\u7c7b\u4e2d\u8bbe\u7f6e\u7684scop\u4e00\u81f4\u3002 \nredirect_uri\uff1a\u8df3\u8f6curi\uff0c\u5f53\u6388\u6743\u7801\u7533\u8bf7\u6210\u529f\u540e\u4f1a\u8df3\u8f6c\u5230\u6b64\u5730\u5740\uff0c\u5e76\u5728\u540e\u8fb9\u5e26\u4e0acode\u53c2\u6570\uff08\u6388\u6743\u7801\uff09\n")),(0,l.kt)("p",null,"\u9996\u5148\u8df3\u8f6c\u5230\u767b\u5f55\u9875\u9762\uff1a"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u7528\u6237\u540d\u5bc6\u7801\u90fd\u586b\u4e3a"),"\uff1aydles"),(0,l.kt)("p",null,"\u63a5\u4e0b\u6765\u8fdb\u5165\u6388\u6743\u9875\u9762\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123105807017-38b77d0f.png",alt:"image-20211123105807017"}),"image-20211123105807017"),(0,l.kt)("p",null,"\u70b9\u51fbAuthorize,\u63a5\u4e0b\u6765\u8fd4\u56de\u6388\u6743\u7801\uff1a \u8ba4\u8bc1\u670d\u52a1\u643a\u5e26\u6388\u6743\u7801\u8df3\u8f6credirect_uri,code=k45iLY\u5c31\u662f\u8fd4\u56de\u7684\u6388\u6743\u7801, ",(0,l.kt)("strong",{parentName:"p"},"\u6bcf\u4e00\u4e2a\u6388\u6743\u7801\u53ea\u80fd\u4f7f\u7528\u4e00\u6b21")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"data:image/png;base64,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",alt:"image-20211123105729141"}),"image-20211123105729141"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6ce8\u610f\u89c2\u5bdf"),"\uff1a\u6b64\u63a5\u53e3\u4e3aoauth2\u63d0\u4f9b\uff0c\u9879\u76ee\u4e2d\u6ca1\u6709\u5199controller\u3002"),(0,l.kt)("h5",{id:"4213-\u7533\u8bf7\u4ee4\u724c"},(0,l.kt)("a",{parentName:"h5",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-1-3-%E7%94%B3%E8%AF%B7%E4%BB%A4%E7%89%8C"},"#"),"4.2.1.3 \u7533\u8bf7\u4ee4\u724c"),(0,l.kt)("p",null,"\u62ff\u5230\u6388\u6743\u7801\u540e\uff0c\u7533\u8bf7\u4ee4\u724c\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"Post\u8bf7\u6c42\uff1a\nhttp://localhost:9200/oauth/token\n")),(0,l.kt)("p",null,"\u53c2\u6570\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"grant_type\uff1a\u6388\u6743\u7c7b\u578b\uff0c\u586b\u5199authorization_code\uff0c\u8868\u793a\u6388\u6743\u7801\u6a21\u5f0f \ncode\uff1a\u6388\u6743\u7801\uff0c\u5c31\u662f\u521a\u521a\u83b7\u53d6\u7684\u6388\u6743\u7801\uff0c\u6ce8\u610f\uff1a\u6388\u6743\u7801\u53ea\u4f7f\u7528\u4e00\u6b21\u5c31\u65e0\u6548\u4e86\uff0c\u9700\u8981\u91cd\u65b0\u7533\u8bf7\u3002 \nredirect_uri\uff1a\u7533\u8bf7\u6388\u6743\u7801\u65f6\u7684\u8df3\u8f6curl\uff0c\u4e00\u5b9a\u548c\u7533\u8bf7\u6388\u6743\u7801\u65f6\u7528\u7684redirect_uri\u4e00\u81f4\u3002 \n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123110305801-03a67472.png",alt:"image-20211123110305801"}),"image-20211123110305801"),(0,l.kt)("p",null,"\u6b64\u94fe\u63a5\u9700\u8981\u4f7f\u7528 http Basic\u8ba4\u8bc1\u3002"),(0,l.kt)("p",null,"\u4ec0\u4e48\u662fhttp Basic\u8ba4\u8bc1\uff1f"),(0,l.kt)("p",null,"http\u534f\u8bae\u5b9a\u4e49\u7684\u4e00\u79cd\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u5c06\u5ba2\u6237\u7aefid\u548c\u5ba2\u6237\u7aef\u5bc6\u7801\u6309\u7167\u201c\u5ba2\u6237\u7aefID:\u5ba2\u6237\u7aef\u5bc6\u7801\u201d\u7684\u683c\u5f0f\u62fc\u63a5\uff0c\u5e76\u7528base64\u7f16 \u7801\uff0c\u653e\u5728header\u4e2d\u8bf7\u6c42\u670d\u52a1\u7aef\uff0c\u4e00\u4e2a\u4f8b\u5b50\uff1a"),(0,l.kt)("p",null,"Authorization\uff1aBasic WGNXZWJBcHA6WGNXZWJBcHA=WGNXZWJBcHA6WGNXZWJBcHA= \u662f\u7528\u6237\u540d:\u5bc6\u7801\u7684base64\u7f16\u7801\u3002 \u8ba4\u8bc1\u5931\u8d25\u670d\u52a1\u7aef\u8fd4\u56de 401 Unauthorized\u3002"),(0,l.kt)("p",null,"\u4ee5\u4e0a\u6d4b\u8bd5\u4f7f\u7528postman\u5b8c\u6210\uff1a"),(0,l.kt)("p",null,"http basic\u8ba4\u8bc1\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123110249161-77c026af.png",alt:"image-20211123110249161"}),"image-20211123110249161"),(0,l.kt)("p",null,"\u5ba2\u6237\u7aefId\u548c\u5ba2\u6237\u7aef\u5bc6\u7801\u4f1a\u5339\u914d\u6570\u636e\u5e93oauth_client_details\u8868\u4e2d\u7684\u5ba2\u6237\u7aefid\u53ca\u5ba2\u6237\u7aef\u5bc6\u7801\u3002"),(0,l.kt)("p",null,"\u70b9\u51fb\u53d1\u9001\uff1a \u7533\u8bf7\u4ee4\u724c\u6210\u529f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123110241083-60056d32.png",alt:"image-20211123110241083"}),"image-20211123110241083"),(0,l.kt)("p",null,"\u8fd4\u56de\u4fe1\u5982\u4e0b:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"access_token\uff1a\u8bbf\u95ee\u4ee4\u724c\uff0c\u643a\u5e26\u6b64\u4ee4\u724c\u8bbf\u95ee\u8d44\u6e90 \ntoken_type\uff1a\u6709MAC Token\u4e0eBearer Token\u4e24\u79cd\u7c7b\u578b\uff0c\u4e24\u79cd\u7684\u6821\u9a8c\u7b97\u6cd5\u4e0d\u540c\uff0cRFC 6750\u5efa\u8baeOauth2\u91c7\u7528 Bearer Token\uff08http://www.rfcreader.com/#rfc6750\uff09\u3002 \nrefresh_token\uff1a\u5237\u65b0\u4ee4\u724c\uff0c\u4f7f\u7528\u6b64\u4ee4\u724c\u53ef\u4ee5\u5ef6\u957f\u8bbf\u95ee\u4ee4\u724c\u7684\u8fc7\u671f\u65f6\u95f4\u3002 \nexpires_in\uff1a\u8fc7\u671f\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u79d2\u3002 \nscope\uff1a\u8303\u56f4\uff0c\u4e0e\u5b9a\u4e49\u7684\u5ba2\u6237\u7aef\u8303\u56f4\u4e00\u81f4\u3002    \njti\uff1a\u5f53\u524dtoken\u7684\u552f\u4e00\u6807\u8bc6\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u601d\u8003"),"\uff1a"),(0,l.kt)("p",null,"cookie redis\u653e\u90a3\u4e9b\u4ee4\u724c\uff1f"),(0,l.kt)("p",null,"cookie \u957f\u5ea6\u9650\u5236\u7684 4K\u3002"),(0,l.kt)("h5",{id:"4214-\u4ee4\u724c\u6821\u9a8c-\u4e86\u89e3"},(0,l.kt)("a",{parentName:"h5",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-1-4-%E4%BB%A4%E7%89%8C%E6%A0%A1%E9%AA%8C-%E4%BA%86%E8%A7%A3"},"#"),"4.2.1.4 \u4ee4\u724c\u6821\u9a8c-\u4e86\u89e3"),(0,l.kt)("p",null,"Spring Security Oauth2\u63d0\u4f9b\u6821\u9a8c\u4ee4\u724c\u7684\u7aef\u70b9\uff0c\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,"Get: ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9200/oauth/check_token?token="},"http://localhost:9200/oauth/check_token?token=open in new window")," ","[access_token]"),(0,l.kt)("p",null,"\u53c2\u6570\uff1a"),(0,l.kt)("p",null,"token\uff1a\u4ee4\u724c"),(0,l.kt)("p",null,"\u4f7f\u7528postman\u6d4b\u8bd5\u5982\u4e0b:"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123143858748-508bcb71.png",alt:"image-20211123143858748"}),"image-20211123143858748"),(0,l.kt)("p",null,"\u5982\u679c\u4ee4\u724c\u6821\u9a8c\u5931\u8d25\uff0c\u4f1a\u51fa\u73b0\u5982\u4e0b\u7ed3\u679c\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123143848280-13c0ee0f.png",alt:"image-20211123143848280"}),"image-20211123143848280"),(0,l.kt)("p",null,"\u5982\u679c\u4ee4\u724c\u8fc7\u671f\u4e86\uff0c\u4f1a\u5982\u4e0b\u5982\u4e0b\u7ed3\u679c\uff1a"),(0,l.kt)("h5",{id:"4215-\u5237\u65b0\u4ee4\u724c"},(0,l.kt)("a",{parentName:"h5",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-1-5-%E5%88%B7%E6%96%B0%E4%BB%A4%E7%89%8C"},"#"),"4.2.1.5 \u5237\u65b0\u4ee4\u724c"),(0,l.kt)("p",null,"\u5237\u65b0\u4ee4\u724c\u662f\u5f53\u4ee4\u724c\u5feb\u8fc7\u671f\u65f6\u91cd\u65b0\u751f\u6210\u4e00\u4e2a\u4ee4\u724c\uff0c\u5b83\u4e8e\u6388\u6743\u7801\u6388\u6743\u548c\u5bc6\u7801\u6388\u6743\u751f\u6210\u4ee4\u724c\u4e0d\u540c\uff0c\u5237\u65b0\u4ee4\u724c\u4e0d\u9700\u8981\u6388\u6743\u7801 \u4e5f\u4e0d\u9700\u8981\u8d26\u53f7\u548c\u5bc6\u7801\uff0c\u53ea\u9700\u8981\u4e00\u4e2a\u5237\u65b0\u4ee4\u724c\u3001\u5ba2\u6237\u7aefid\u548c\u5ba2\u6237\u7aef\u5bc6\u7801\u3002"),(0,l.kt)("p",null,"\u6d4b\u8bd5\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,"Post\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9200/oauth/token"},"http://localhost:9200/oauth/tokenopen in new window")),(0,l.kt)("p",null,"\u53c2\u6570\uff1a"),(0,l.kt)("p",null,"grant_type\uff1a \u56fa\u5b9a\u4e3a refresh_token"),(0,l.kt)("p",null,"refresh_token\uff1a\u5237\u65b0\u4ee4\u724c\uff08\u6ce8\u610f\u4e0d\u662faccess_token\uff0c\u800c\u662frefresh_token\uff09"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123144117362-c7e3f508.png",alt:"image-20211123144117362"}),"image-20211123144117362"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6388\u6743\u7801\u6a21\u5f0f\u8bb2\u89e3\u5b8c\u6bd5\u3002\u56de\u987e\u3002")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122104426755-45bc1ee9.png",alt:"image-20211122104426755"}),"image-20211122104426755"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"1\u3001\u5ba2\u6237\u7aef\u8bf7\u6c42\u7b2c\u4e09\u65b9\u6388\u6743"),(0,l.kt)("li",{parentName:"ul"},"2\u3001\u7528\u6237\u540c\u610f\u7ed9\u5ba2\u6237\u7aef\u6388\u6743"),(0,l.kt)("li",{parentName:"ul"},"3\u3001\u5ba2\u6237\u7aef\u83b7\u53d6\u5230\u6388\u6743\u7801\uff0c\u8bf7\u6c42\u8ba4\u8bc1\u670d\u52a1\u5668\u7533\u8bf7\u4ee4\u724c"),(0,l.kt)("li",{parentName:"ul"},"4\u3001\u8ba4\u8bc1\u670d\u52a1\u5668\u5411\u5ba2\u6237\u7aef\u54cd\u5e94\u4ee4\u724c"),(0,l.kt)("li",{parentName:"ul"},"5\u3001\u5ba2\u6237\u7aef\u8bf7\u6c42\u8d44\u6e90\u670d\u52a1\u5668\u7684\u8d44\u6e90\uff0c\u8d44\u6e90\u670d\u52a1\u6821\u9a8c\u4ee4\u724c\u5408\u6cd5\u6027\uff0c\u5b8c\u6210\u6388\u6743"),(0,l.kt)("li",{parentName:"ul"},"6\u3001\u8d44\u6e90\u670d\u52a1\u5668\u8fd4\u56de\u53d7\u4fdd\u62a4\u8d44\u6e90")),(0,l.kt)("h4",{id:"422-\u5bc6\u7801\u6a21\u5f0f"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-2-%E5%AF%86%E7%A0%81%E6%A8%A1%E5%BC%8F"},"#"),"4.2.2 \u5bc6\u7801\u6a21\u5f0f"),(0,l.kt)("p",null,"\u5bc6\u7801\u6a21\u5f0f\uff08Resource Owner Password Credentials\uff09\u4e0e\u6388\u6743\u7801\u6a21\u5f0f\u7684\u533a\u522b\u662f\u7533\u8bf7\u4ee4\u724c\u4e0d\u518d\u4f7f\u7528\u6388\u6743\u7801\uff0c\u800c\u662f",(0,l.kt)("strong",{parentName:"p"},"\u76f4\u63a5 \u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u5373\u53ef\u7533\u8bf7\u4ee4\u724c"),"\u3002"),(0,l.kt)("h5",{id:"4221-\u7533\u8bf7\u4ee4\u724c"},(0,l.kt)("a",{parentName:"h5",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-2-2-1-%E7%94%B3%E8%AF%B7%E4%BB%A4%E7%89%8C"},"#"),"4.2.2.1 \u7533\u8bf7\u4ee4\u724c"),(0,l.kt)("p",null,"\u6d4b\u8bd5\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"Post\u8bf7\u6c42\uff1a\nhttp://localhost:9200/oauth/token\n\n\u643a\u5e26\u53c2\u6570\uff1a \ngrant_type\uff1a\u5bc6\u7801\u6a21\u5f0f\u6388\u6743\u586b\u5199password \nusername\uff1a\u8d26\u53f7 \npassword\uff1a\u5bc6\u7801 \n")),(0,l.kt)("p",null,"\u5e76\u4e14\u6b64\u94fe\u63a5\u9700\u8981\u4f7f\u7528 http Basic\u8ba4\u8bc1\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123145409768-cc8ad2dc.png",alt:"image-20211123145409768"}),"image-20211123145409768"),(0,l.kt)("p",null,"\u6d4b\u8bd5\u6570\u636e\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123145403687-f126649e.png",alt:"image-20211123145403687"}),"image-20211123145403687"),(0,l.kt)("h3",{id:"43-\u8d44\u6e90\u670d\u52a1\u6388\u6743"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-3-%E8%B5%84%E6%BA%90%E6%9C%8D%E5%8A%A1%E6%8E%88%E6%9D%83"},"#"),"4.3 \u8d44\u6e90\u670d\u52a1\u6388\u6743"),(0,l.kt)("p",null,"\u8d44\u6e90\u670d\u52a1\u62e5\u6709\u8981\u8bbf\u95ee\u7684\u53d7\u4fdd\u62a4\u8d44\u6e90\uff0c\u5ba2\u6237\u7aef\u643a\u5e26\u4ee4\u724c\u8bbf\u95ee\u8d44\u6e90\u670d\u52a1\uff0c\u5982\u679c\u4ee4\u724c\u5408\u6cd5\u5219\u53ef\u6210\u529f\u8bbf\u95ee\u8d44\u6e90\u670d\u52a1\u4e2d\u7684\u8d44\u6e90\uff0c\u5982\u4e0b\u56fe:"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124121822950-4604b233.png",alt:"image-20211124121822950"}),"image-20211124121822950"),(0,l.kt)("p",null,"\u4e0a\u56fe\u7684\u4e1a\u52a1\u6d41\u7a0b\u5982\u4e0b:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"1\u3001\u5ba2\u6237\u7aef\u8bf7\u6c42\u8ba4\u8bc1\u670d\u52a1\u7533\u8bf7\u4ee4\u724c\n2\u3001\u8ba4\u8bc1\u670d\u52a1\u751f\u6210\u4ee4\u724c\u8ba4\u8bc1\u670d\u52a1\u91c7\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\uff0c\u4f7f\u7528\u79c1\u94a5\u751f\u6210\u4ee4\u724c\u3002\n3\u3001\u5ba2\u6237\u7aef\u643a\u5e26\u4ee4\u724c\u8bbf\u95ee\u8d44\u6e90\u670d\u52a1\u5ba2\u6237\u7aef\u5728Http header \u4e2d\u6dfb\u52a0\uff1a Authorization\uff1aBearer\u4ee4\u724c\u3002\n4\u3001\u8d44\u6e90\u670d\u52a1\u8bf7\u6c42\u8ba4\u8bc1\u670d\u52a1\u6821\u9a8c\u4ee4\u724c\u7684\u6709\u6548\u6027\u8d44\u6e90\u670d\u52a1\u63a5\u6536\u5230\u4ee4\u724c\uff0c\u4f7f\u7528\u516c\u94a5\u6821\u9a8c\u4ee4\u724c\u7684\u5408\u6cd5\u6027\u3002\n5\u3001\u4ee4\u724c\u6709\u6548\uff0c\u8d44\u6e90\u670d\u52a1\u5411\u5ba2\u6237\u7aef\u54cd\u5e94\u8d44\u6e90\u4fe1\u606f\n")),(0,l.kt)("h4",{id:"431-\u6539\u9020\u7528\u6237\u670d\u52a1-\u5bf9\u63a5oauth2"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-3-1-%E6%94%B9%E9%80%A0%E7%94%A8%E6%88%B7%E6%9C%8D%E5%8A%A1-%E5%AF%B9%E6%8E%A5oauth2"},"#"),"4.3.1 \u6539\u9020\u7528\u6237\u670d\u52a1 \u5bf9\u63a5Oauth2"),(0,l.kt)("p",null,"\u57fa\u672c\u4e0a\u6240\u6709\u5fae\u670d\u52a1\u90fd\u662f\u8d44\u6e90\u670d\u52a1\uff0c\u8fd9\u91cc\u6211\u4eec\u5728\u8bfe\u7a0b\u7ba1\u7406\u670d\u52a1\u4e0a\u914d\u7f6e\u6388\u6743\u63a7\u5236\uff0c\u5f53\u914d\u7f6e\u4e86\u6388\u6743\u63a7\u5236\u540e\u5982\u8981\u8bbf\u95ee\u8bfe\u7a0b\u4fe1 \u606f\u5219\u5fc5\u987b\u63d0\u4f9b\u4ee4\u724c\u3002"),(0,l.kt)("p",null,"1\u3001\u914d\u7f6e\u516c\u94a5 \uff0c\u5c06 ydles_user_auth \u9879\u76ee\u4e2dpublic.key\u590d\u5236\u5230ydles_service_user\u4e2d"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123151535527-041dace5.png",alt:"image-20211123151535527"}),"image-20211123151535527"),(0,l.kt)("p",null,"2\u3001\u6dfb\u52a0\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-oauth2</artifactId>\n</dependency>\n")),(0,l.kt)("p",null,"3\u3001\u914d\u7f6e\u6bcf\u4e2a\u7cfb\u7edf\u7684Http\u8bf7\u6c42\u8def\u5f84\u5b89\u5168\u63a7\u5236\u7b56\u7565\u4ee5\u53ca\u8bfb\u53d6\u516c\u94a5\u4fe1\u606f\u8bc6\u522b\u4ee4\u724c\uff0c\u770b\u61c2\u5373\u53ef\u3002\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@EnableResourceServer\n@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true)//\u6fc0\u6d3b\u65b9\u6cd5\u4e0a\u7684PreAuthorize\u6ce8\u89e3\npublic class ResourceServerConfig extends ResourceServerConfigurerAdapter {\n//\u516c\u94a5\nprivate static final String PUBLIC_KEY = "public.key";\n\n/***\n * \u5b9a\u4e49JwtTokenStore\n * @param jwtAccessTokenConverter\n * @return\n */\n@Bean\npublic TokenStore tokenStore(JwtAccessTokenConverter jwtAccessTokenConverter) {\n    return new JwtTokenStore(jwtAccessTokenConverter);\n}\n\n/***\n * \u5b9a\u4e49JJwtAccessTokenConverter\n * @return\n */\n@Bean\npublic JwtAccessTokenConverter jwtAccessTokenConverter() {\n    JwtAccessTokenConverter converter = new JwtAccessTokenConverter();\n    converter.setVerifierKey(getPubKey());\n    return converter;\n}\n/**\n * \u83b7\u53d6\u975e\u5bf9\u79f0\u52a0\u5bc6\u516c\u94a5 Key\n * @return \u516c\u94a5 Key\n */\nprivate String getPubKey() {\n    Resource resource = new ClassPathResource(PUBLIC_KEY);\n    try {\n        InputStreamReader inputStreamReader = new InputStreamReader(resource.getInputStream());\n        BufferedReader br = new BufferedReader(inputStreamReader);\n        return br.lines().collect(Collectors.joining("\\n"));\n    } catch (IOException ioe) {\n        return null;\n    }\n}\n\n/***\n * Http\u5b89\u5168\u914d\u7f6e\uff0c\u5bf9\u6bcf\u4e2a\u5230\u8fbe\u7cfb\u7edf\u7684http\u8bf7\u6c42\u94fe\u63a5\u8fdb\u884c\u6821\u9a8c\n * @param http\n * @throws Exception\n */\n@Override\npublic void configure(HttpSecurity http) throws Exception {\n    //\u6240\u6709\u8bf7\u6c42\u5fc5\u987b\u8ba4\u8bc1\u901a\u8fc7\n    http.authorizeRequests()\n            //\u4e0b\u8fb9\u7684\u8def\u5f84\u653e\u884c\n            .antMatchers(\n                    "/user/add","/user/load/**"). //\u914d\u7f6e\u5730\u5740\u653e\u884c\n            permitAll()\n            .anyRequest().\n            authenticated();    //\u5176\u4ed6\u5730\u5740\u9700\u8981\u8ba4\u8bc1\u6388\u6743\n}\n}\n')),(0,l.kt)("h4",{id:"432-\u8d44\u6e90\u670d\u52a1\u6388\u6743\u6d4b\u8bd5"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_4-3-2-%E8%B5%84%E6%BA%90%E6%9C%8D%E5%8A%A1%E6%8E%88%E6%9D%83%E6%B5%8B%E8%AF%95"},"#"),"4.3.2 \u8d44\u6e90\u670d\u52a1\u6388\u6743\u6d4b\u8bd5"),(0,l.kt)("p",null,"1\u4e0d\u643a\u5e26\u4ee4\u724c\u8bbf\u95ee",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9005/user"},"http://localhost:9005/useropen in new window")),(0,l.kt)("p",null,"\u7531\u4e8e\u8be5\u5730\u5740\u53d7\u8bbf\u95ee\u9650\u5236\uff0c\u9700\u8981\u6388\u6743\uff0c\u6240\u4ee5\u51fa\u73b0\u5982\u4e0b\u9519\u8bef\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'{\n    "error": "unauthorized",\n    "error_description": "Full authentication is required to access this resource"\n}\n')),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123152023597-9e4c21c8.png",alt:"image-20211123152023597"}),"image-20211123152023597"),(0,l.kt)("p",null,"2\u643a\u5e26\u4ee4\u724c\u8bbf\u95ee",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9005/user"},"http://localhost:9005/useropen in new window")),(0,l.kt)("p",null,"\u5728http header\u4e2d\u6dfb\u52a0 Authorization\uff1a Bearer \u4ee4\u724c"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211123152205060-4a9a71e2.png",alt:"image-20211123152205060"}),"image-20211123152205060"),(0,l.kt)("p",null,"\u5f53\u8f93\u5165\u9519\u8bef\u7684\u4ee4\u724c\u4e5f\u65e0\u6cd5\u6b63\u5e38\u8bbf\u95ee\u8d44\u6e90\u3002"),(0,l.kt)("h2",{id:"5-\u8ba4\u8bc1\u5f00\u53d1"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-%E8%AE%A4%E8%AF%81%E5%BC%80%E5%8F%91"},"#"),"5 \u8ba4\u8bc1\u5f00\u53d1"),(0,l.kt)("h3",{id:"51-\u9700\u6c42\u5206\u6790-1"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-1"},"#"),"5.1 \u9700\u6c42\u5206\u6790"),(0,l.kt)("p",null,"\u529f\u80fd\u6d41\u7a0b\u56fe\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124121822950-4604b233.png",alt:"image-20211124121822950"}),"image-20211124121822950"),(0,l.kt)("p",null,"\u6267\u884c\u6d41\u7a0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"1\u767b\u9646\uff1a\u8ba4\u8bc1\u670d\u52a1\u8ba4\u8bc1\u901a\u8fc7\uff0c\u751f\u6210jwt\u4ee4\u724c\uff0c\u5c06jwt\u4ee4\u724c\u53ca\u76f8\u5173\u4fe1\u606f\u5199\u5165Redis\uff0c\u5e76\u4e14\u5c06\u8eab\u4efd\u4ee4\u724c\u5199\u5165cookie \n2\u8bbf\u95ee\uff1a\u7528\u6237\u8bbf\u95ee\u8d44\u6e90\u9875\u9762\uff0c\u5e26\u7740cookie\u5230\u7f51\u5173\uff0c\u7f51\u5173\u4ececookie\u83b7\u53d6token\uff0c\u5e76\u67e5\u8be2Redis\u6821\u9a8ctoken,\u5982\u679ctoken\u4e0d\u5b58\u5728\u5219\u62d2\u7edd\u8bbf\u95ee\uff0c\u5426\u5219\u653e\u884c\n3\u9000\u51fa\uff1a\u8bf7\u6c42\u8ba4\u8bc1\u670d\u52a1\uff0c\u6e05\u9664redis\u4e2d\u7684token\uff0c\u5e76\u4e14\u5220\u9664cookie\u4e2d\u7684token\n")),(0,l.kt)("p",null,"\u4f7f\u7528redis\u5b58\u50a8\u7528\u6237\u7684\u8eab\u4efd\u4ee4\u724c\u6709\u4ee5\u4e0b\u4f5c\u7528\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"1\u3001\u5b9e\u73b0\u7528\u6237\u9000\u51fa\u6ce8\u9500\u529f\u80fd\uff0c\u670d\u52a1\u7aef\u6e05\u9664\u4ee4\u724c\u540e\uff0c\u5373\u4f7f\u5ba2\u6237\u7aef\u8bf7\u6c42\u643a\u5e26token\u4e5f\u662f\u65e0\u6548\u7684\u3002 \n2\u3001\u7531\u4e8ejwt\u4ee4\u724c\u8fc7\u957f\uff0c\u4e0d\u5b9c\u5b58\u50a8\u5728cookie\u4e2d\uff0c\u6240\u4ee5\u5c06jwt\u4ee4\u724c\u5b58\u50a8\u5728redis\uff0c\u7531\u5ba2\u6237\u7aef\u8bf7\u6c42\u670d\u52a1\u7aef\u83b7\u53d6\u5e76\u5728\u5ba2\u6237\u7aef\u5b58\u50a8\u3002    \n")),(0,l.kt)("h3",{id:"52-redis\u914d\u7f6e"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-2-redis%E9%85%8D%E7%BD%AE"},"#"),"5.2 Redis\u914d\u7f6e"),(0,l.kt)("p",null,"\u5c06\u8ba4\u8bc1\u670d\u52a1ydles_user_auth\u4e2d\u7684application.yml\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684Redis\u914d\u7f6e\u6539\u6210\u81ea\u5df1\u5bf9\u5e94\u7684\u7aef\u53e3\u548c\u5bc6\u7801\u3002"),(0,l.kt)("h3",{id:"53-\u8ba4\u8bc1\u670d\u52a1"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1"},"#"),"5.3 \u8ba4\u8bc1\u670d\u52a1"),(0,l.kt)("h4",{id:"531-\u8ba4\u8bc1\u9700\u6c42\u5206\u6790"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-1-%E8%AE%A4%E8%AF%81%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"},"#"),"5.3.1 \u8ba4\u8bc1\u9700\u6c42\u5206\u6790"),(0,l.kt)("p",null,"\u8ba4\u8bc1\u670d\u52a1\u9700\u8981\u5b9e\u73b0\u7684\u529f\u80fd\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,"1\u3001\u767b\u5f55\u63a5\u53e3"),(0,l.kt)("p",null,"\u524d\u7aefpost\u63d0\u4ea4\u8d26\u53f7\u3001\u5bc6\u7801\u7b49\uff0c\u7528\u6237\u8eab\u4efd\u6821\u9a8c\u901a\u8fc7\uff0c\u751f\u6210\u4ee4\u724c\uff0c\u5e76\u5c06\u4ee4\u724c\u5b58\u50a8\u5230redis\u3002 \u5c06\u4ee4\u724c\u5199\u5165cookie\u3002"),(0,l.kt)("p",null,"2\u3001\u9000\u51fa\u63a5\u53e3"),(0,l.kt)("p",null,"\u6821\u9a8c\u5f53\u524d\u7528\u6237\u7684\u8eab\u4efd\u4e3a\u5408\u6cd5\u5e76\u4e14\u4e3a\u5df2\u767b\u5f55\u72b6\u6001\u3002 \u5c06\u4ee4\u724c\u4eceredis\u5220\u9664\u3002 \u5220\u9664cookie\u4e2d\u7684\u4ee4\u724c\u3002"),(0,l.kt)("h4",{id:"532-\u6388\u6743\u53c2\u6570\u914d\u7f6e"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-2-%E6%8E%88%E6%9D%83%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE"},"#"),"5.3.2 \u6388\u6743\u53c2\u6570\u914d\u7f6e"),(0,l.kt)("p",null,"\u4fee\u6539ydles_user_auth\u4e2dapplication.yml\u914d\u7f6e\u6587\u4ef6\uff0c\u4fee\u6539\u5bf9\u5e94\u7684\u6388\u6743\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"auth:\n  ttl: 1200  #token\u5b58\u50a8\u5230redis\u7684\u8fc7\u671f\u65f6\u95f4\n  clientId: ydlershe    #\u5ba2\u6237\u7aefID\n  clientSecret: ydlershe    #\u5ba2\u6237\u7aef\u79d8\u94a5\n  cookieDomain: localhost   #Cookie\u4fdd\u5b58\u5bf9\u5e94\u7684\u57df\u540d\n  cookieMaxAge: -1          #Cookie\u8fc7\u671f\u65f6\u95f4\uff0c-1\u8868\u793a\u6d4f\u89c8\u5668\u5173\u95ed\u5219\u9500\u6bc1\n")),(0,l.kt)("p",null,"\u914d\u7f6eredis"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"    redis:  \n        host: 192.168.200.128\n")),(0,l.kt)("h4",{id:"533-\u7533\u8bf7\u4ee4\u724c\u6d4b\u8bd5"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-3-%E7%94%B3%E8%AF%B7%E4%BB%A4%E7%89%8C%E6%B5%8B%E8%AF%95"},"#"),"5.3.3 \u7533\u8bf7\u4ee4\u724c\u6d4b\u8bd5"),(0,l.kt)("p",null,"\u660e\u786e\uff1arequest=\u8bf7\u6c42\u5934+\u8bf7\u6c42\u4f53"),(0,l.kt)("p",null,"\u6240\u4ee5postman"),(0,l.kt)("p",null,"\u8f6c\u5316\u4e3a\uff1a\u8bf7\u6c42\u5934\u4e2d"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u8ba1\u7b97\u65b9\u6cd5\u4e3a"),"\uff1aBasic base64(\u5ba2\u6237\u7aef\u540d\u79f0\uff1a\u5ba2\u6237\u7aef\u5bc6\u7801)"),(0,l.kt)("p",null,"\u4e3a\u4e86\u4e0d\u7834\u574fSpring Security\u7684\u4ee3\u7801\uff0c\u6211\u4eec\u5728Service\u65b9\u6cd5\u4e2d\u901a\u8fc7RestTemplate\u8bf7\u6c42Spring Security\u6240\u66b4\u9732\u7684\u7533\u8bf7\u4ee4 \u724c\u63a5\u53e3\u6765\u7533\u8bf7\u4ee4\u724c\uff0c\u4e0b\u8fb9\u662f\u6d4b\u8bd5\u4ee3\u7801\uff1a"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u542f\u52a8\u7c7b\u6dfb\u52a0")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@Bean\npublic RestTemplate restTemplate(){\n    return  new RestTemplate();\n}\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5199\u6d4b\u8bd5\u7c7b")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydles;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.cloud.client.ServiceInstance;\nimport org.springframework.cloud.client.loadbalancer.LoadBalanced;\nimport org.springframework.cloud.client.loadbalancer.LoadBalancerClient;\nimport org.springframework.http.HttpEntity;\nimport org.springframework.http.HttpMethod;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.http.client.ClientHttpResponse;\nimport org.springframework.test.context.junit4.SpringRunner;\nimport org.springframework.util.Base64Utils;\nimport org.springframework.util.LinkedMultiValueMap;\nimport org.springframework.util.MultiValueMap;\nimport org.springframework.web.client.DefaultResponseErrorHandler;\nimport org.springframework.web.client.RestTemplate;\n\nimport java.io.IOException;\nimport java.net.URI;\nimport java.util.Base64;\nimport java.util.HashMap;\nimport java.util.Map;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n * \u7f3a\u5565\u8865\u5565\n */\n@SpringBootTest(classes = OAuthApplication.class)\n@RunWith(SpringRunner.class)\npublic class ApplyTokenTest {\n    @Autowired\n    RestTemplate restTemplate;\n    @Autowired\n    LoadBalancerClient loadBalancerClient;\n\n\n    //\u4ee3\u7801\u7533\u8bf7\u4ee4\u724c\n    @Test\n    public void applyToken(){\n        //1 url http://localhost:9200/oauth/token\n        ServiceInstance serviceInstance = loadBalancerClient.choose("user-auth");\n        URI uri = serviceInstance.getUri(); //http://localhost:9200\n        String url=uri+"/oauth/token";\n\n        //2.1 \u8bf7\u6c42\u5934\n        MultiValueMap<String, String> headers=new LinkedMultiValueMap<>();\n        headers.add("Authorization", getHttpHeaders("ydlershe","ydlershe"));\n\n        //2.2 \u8bf7\u6c42\u4f53\n        MultiValueMap<String, String> body=new LinkedMultiValueMap<>();\n        body.add("grant_type","password");\n        body.add("username","itlils");\n        body.add("password","itlils");\n\n        //2 \u6784\u5efa\u8bf7\u6c42\n        HttpEntity<MultiValueMap<String, String>> requestEntity=new HttpEntity<>(body,headers);\n\n        //400 401 \u4e0d\u62a5\u9519\uff0c\u8fd4\u56de\u56de\u6765\n        restTemplate.setErrorHandler(new DefaultResponseErrorHandler(){\n            //\u54cd\u5e94\u5f53\u4e2d\u6709\u9519\u8bef \u5982\u4f55\u5904\u7406\n            @Override\n            public void handleError(URI url, HttpMethod method, ClientHttpResponse response) throws IOException {\n                if(response.getRawStatusCode()!=400&&response.getRawStatusCode()!=401){\n                    super.handleError(url,method,response);\n                }\n            }\n        });\n\n        //3\u53d1\u8bf7\u6c42\n        ResponseEntity<Map> exchange = restTemplate.exchange(url, HttpMethod.POST, requestEntity, Map.class);\n\n        //4\u8bf7\u6c42\u4e2d \u62ff\u6570\u636e\n        Map body1 = exchange.getBody();\n        System.out.println(body1);\n\n    }\n\n    //\u8bf7\u6c42\u5934\u4e2dAuthorization\u503c\u7684\u8ba1\u7b97\u65b9\u6cd5\n    public String getHttpHeaders(String clientId,String clinetSecret){\n        //Basic base64(\u5ba2\u6237\u7aef\u540d\u79f0\uff1a\u5ba2\u6237\u7aef\u5bc6\u7801)\n        String str=clientId+":"+clinetSecret;\n        byte[] encode = Base64Utils.encode(str.getBytes());\n        return "Basic "+new String(encode);\n    }\n\n}\n')),(0,l.kt)("h4",{id:"534-\u4e1a\u52a1\u5c42"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-4-%E4%B8%9A%E5%8A%A1%E5%B1%82"},"#"),"5.3.4 \u4e1a\u52a1\u5c42"),(0,l.kt)("p",null,"1service\u5c42\u6dfb\u52a0\u63a5\u53e3 com.ydles.oauth.service"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"public interface AuthService {    \n    AuthToken login(String username,String password,String clientId,String clientSecret);\n}\n")),(0,l.kt)("p",null,"2\u63a5\u53e3\u5b9e\u73b0 com.ydles.oauth.service.impl"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Service\npublic class AuthServiceImpl implements AuthService {\n    @Autowired\n    RestTemplate restTemplate;\n    @Autowired\n    LoadBalancerClient loadBalancerClient;\n    @Autowired\n    RedisTemplate redisTemplate;\n    @Value("${auth.ttl}")\n    private long ttl;\n    \n    @Override\npublic AuthToken login(String username, String password, String clientId, String clientSecret) {\n    // 1\u7533\u8bf7\u4ee4\u724c\n    //\u8bf7\u6c42\u5730\u5740\uff1a http://localhost:9200/oauth/token\n    ServiceInstance serviceInstance = loadBalancerClient.choose("user-auth");\n    // http://localhost:9200\n    URI uri = serviceInstance.getUri();\n    String url = uri + "/oauth/token";\n\n    //\u8bf7\u6c42\u4f53 body\n    MultiValueMap<String, String> body = new LinkedMultiValueMap<>();\n    body.add("grant_type", "password");\n    body.add("username", username);\n    body.add("password", password);\n    //\u8bf7\u6c42\u5934\n    MultiValueMap<String, String> headers = new LinkedMultiValueMap<>();\n    headers.add("Authorization", this.getHttpBasic(clientId, clientSecret));\n    //\u5c01\u88c5\u8bf7\u6c42\u53c2\u6570\n    HttpEntity<MultiValueMap<String, String>> requestEntity = new HttpEntity<>(body, headers);\n\n    //\u540e\u7aef401 400\uff0c\u4e0d\u8ba4\u4e3a\u662f\u5f02\u5e38\uff0c\u76f4\u63a5\u8fd4\u56de\u7ed9\u524d\u7aef\n    restTemplate.setErrorHandler(new DefaultResponseErrorHandler(){\n        @Override\n        public void handleError(ClientHttpResponse response) throws IOException {\n            if(response.getRawStatusCode()!=400&&response.getRawStatusCode()!=401){\n                super.handleError(response);\n            }\n        }\n    });\n\n    /**\n     * 1 url\n     * 2\u8bf7\u6c42\u65b9\u6cd5\n     * 3\u8bf7\u6c42\u5934\u548c\u4f53\n     * 4\u8fd4\u56de\u503c\u7c7b\u578b\n     */\n    ResponseEntity<Map> responseMap = restTemplate.exchange(url, HttpMethod.POST, requestEntity, Map.class);\n    Map map = responseMap.getBody();\n    if(map==null&&map.get("access_token")==null&&map.get("refresh_token")==null&&map.get("jti")==null){\n        new RuntimeException("\u7533\u8bf7\u4ee4\u724c\u5931\u8d25\uff01");\n    }\n\n   // 2\u5c01\u88c5\u6570\u636e\u7ed3\u679c\n    AuthToken authToken=new AuthToken();\n    authToken.setAccessToken((String) map.get("access_token"));\n    authToken.setRefreshToken((String) map.get("refresh_token"));\n    authToken.setJti((String) map.get("jti"));\n    \n       // 3\u5c06jti\uff1ajwt\u5b58\u50a8\u5230redis\n    redisTemplate.boundValueOps(authToken.getJti()).set(authToken.getAccessToken(),ttl , TimeUnit.SECONDS);\n    \n    return authToken;\n}\n\n//\u8bf7\u6c42\u5934\u4e2dAuthorization\u503c\u7684\u8ba1\u7b97\u65b9\u6cd5\nprivate String getHttpBasic(String clientId, String clientSecret) {\n\n    String value = clientId + ":" + clientSecret;\n    byte[] encode = Base64Utils.encode(value.getBytes());\n    return "Basic "+new String(encode);\n}\n}\n')),(0,l.kt)("h4",{id:"535-\u63a7\u5236\u5c42"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-5-%E6%8E%A7%E5%88%B6%E5%B1%82"},"#"),"5.3.5 \u63a7\u5236\u5c42"),(0,l.kt)("p",null,"com.ydles.oauth.controller \u6dfb\u52a0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydles.oauth.controller;\n\nimport com.ydles.entity.Result;\nimport com.ydles.entity.StatusCode;\nimport com.ydles.oauth.service.AuthService;\nimport com.ydles.oauth.util.AuthToken;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.ResponseBody;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport javax.servlet.http.Cookie;\nimport javax.servlet.http.HttpServletResponse;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@Controller\n@RequestMapping("/oauth")\npublic class AuthController {\n    @Autowired\n    AuthService authService;\n    @Value("${auth.clientId}")\n    String clientId;\n    @Value("${auth.clientSecret}")\n    String clientSecret;\n    @Value("${auth.cookieMaxAge}")\n    int cookieMaxAge;\n    @Value("${auth.cookieDomain}")\n    String cookieDomain;\n\n    @RequestMapping("/login")\n    @ResponseBody\n    public Result login(String username, String password, HttpServletResponse response){\n\n        AuthToken authToken = authService.login(username, password, clientId, clientSecret);\n\n        //\u4e09 responses cookie \u653ejti\n        Cookie cookie = new Cookie("uid",authToken.getJti());\n        cookie.setMaxAge(cookieMaxAge);\n        cookie.setPath("/");\n        cookie.setDomain(cookieDomain);\n        cookie.setHttpOnly(false);\n        response.addCookie(cookie);\n\n        return new Result(true, StatusCode.OK,"\u767b\u9646\u6210\u529f", authToken.getJti());\n    }\n}\n')),(0,l.kt)("p",null,"\u62d3\u5c55\uff1acookie session \u533a\u522b\u548c\u8054\u7cfb \u5e94\u7528\u573a\u666f\u3002"),(0,l.kt)("p",null," \u5982\u4f55\u7528\u4ee3\u7801\u6765\u64cd\u4f5ccookie session\uff1f"),(0,l.kt)("h4",{id:"536-\u767b\u5f55\u8bf7\u6c42\u653e\u884c"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-6-%E7%99%BB%E5%BD%95%E8%AF%B7%E6%B1%82%E6%94%BE%E8%A1%8C"},"#"),"5.3.6 \u767b\u5f55\u8bf7\u6c42\u653e\u884c"),(0,l.kt)("p",null,"\u4fee\u6539\u8ba4\u8bc1\u670d\u52a1WebSecurityConfig\u7c7b\u4e2dconfigure\uff08\uff09\uff0c\u6dfb\u52a0\u653e\u884c\u8def\u5f84"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1564737871413-31588cd6.png",alt:"1564737871413"}),"1564737871413"),(0,l.kt)("h4",{id:"537-\u6d4b\u8bd5\u8ba4\u8bc1\u63a5\u53e3"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-7-%E6%B5%8B%E8%AF%95%E8%AE%A4%E8%AF%81%E6%8E%A5%E5%8F%A3"},"#"),"5.3.7 \u6d4b\u8bd5\u8ba4\u8bc1\u63a5\u53e3"),(0,l.kt)("p",null,"\u4f7f\u7528postman\u6d4b\u8bd5\uff1a"),(0,l.kt)("p",null,"1\u91cd\u542f\u8ba4\u8bc1\u670d\u52a1"),(0,l.kt)("p",null,"2postman\u6d4b\u8bd5"),(0,l.kt)("p",null,"POST ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9200/oauth/login"},"http://localhost:9200/oauth/loginopen in new window")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"username itlils\npassword itlils\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124114029840-6c4a7a30.png",alt:"image-20211124114029840"}),"image-20211124114029840"),(0,l.kt)("p",null,"\u89c2\u5bdfcookie"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124114141440-1096c2b3.png",alt:"image-20211124114141440"}),"image-20211124114141440"),(0,l.kt)("p",null,"\u89c2\u5bdfredis\u4e2d\u6570\u636e"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124114309292-4e3565b2.png",alt:"image-20211124114309292"}),"image-20211124114309292"),(0,l.kt)("p",null,"\u82e5key value\u6709\u4e71\u7801\uff0c\u5219\u4f7f\u7528 StringRedisTemplate\u3002"),(0,l.kt)("h4",{id:"538-\u52a8\u6001\u83b7\u53d6\u7528\u6237\u4fe1\u606f"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_5-3-8-%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF"},"#"),"5.3.8 \u52a8\u6001\u83b7\u53d6\u7528\u6237\u4fe1\u606f"),(0,l.kt)("p",null,"1\u9700\u6c42\uff1a"),(0,l.kt)("p",null,"\u5f53\u524d\u5728\u8ba4\u8bc1\u670d\u52a1\u4e2d\uff0c\u7528\u6237\u5bc6\u7801\u662f\u5199\u6b7b\u5728\u7528\u6237\u8ba4\u8bc1\u7c7b\u4e2d\u3002\u6240\u4ee5\u7528\u6237\u767b\u5f55\u65f6\uff0c\u65e0\u8bba\u5e10\u53f7\u8f93\u5165\u4ec0\u4e48\uff0c\u53ea\u8981\u5bc6\u7801\u662fitheima\u90fd\u53ef\u4ee5\u8bbf\u95ee\u3002\u56e0\u6b64\u9700\u8981\u52a8\u6001\u83b7\u53d6\u7528\u6237\u5e10\u53f7\u4e0e\u5bc6\u7801."),(0,l.kt)("p",null,"2\u7528\u6237\u670d\u52a1 com.ydles.user.controller UserController\u4e2d\u65b0\u589e\u65b9\u6cd5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@GetMapping("/load/{username}")\npublic User findUserInfo(@PathVariable("username") String username){\n    User user = userService.findById(username);\n    return user;\n}\n')),(0,l.kt)("p",null,"3user-api\u4e2d \u65b0\u589e feigh\u5ba2\u6237\u7aef\u3002com.ydles.user.feign"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@FeignClient(name = "user")\npublic interface UserFeign {\n@GetMapping("/user/load/{username}")\npublic User findUserInfo(@PathVariable("username") String username);\n}\n')),(0,l.kt)("p",null,"4\u8ba4\u8bc1\u670d\u52a1\u5bfc\u5165\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"    <dependency>\n        <groupId>com.ydles</groupId>\n        <artifactId>ydles_service_user_api</artifactId>\n        <version>1.0-SNAPSHOT</version>\n    </dependency>\n")),(0,l.kt)("p",null,"5\u8ba4\u8bc1\u542f\u52a8\u7c7b\u6dfb\u52a0\u6ce8\u89e3"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@EnableFeignClients(basePackages = {"com.ydles.user.feign"})\n')),(0,l.kt)("p",null,"6\u4fee\u6539com.ydles.oauth.config UserDetailsServiceImpl \u6539\u4e3a\u52a8\u6001\u83b7\u53d6\u7528\u6237\u4fe1\u606f"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Service\npublic class UserDetailsServiceImpl implements UserDetailsService {\n@Autowired\nClientDetailsService clientDetailsService;\n@Autowired\nUserFeign userFeign;\n\n/****\n * \u81ea\u5b9a\u4e49\u6388\u6743\u8ba4\u8bc1\n * @param username\n * @return\n * @throws UsernameNotFoundException\n */\n@Override\npublic UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n    //\u53d6\u51fa\u8eab\u4efd\uff0c\u5982\u679c\u8eab\u4efd\u4e3a\u7a7a\u8bf4\u660e\u6ca1\u6709\u8ba4\u8bc1\n    Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\n    //\u6ca1\u6709\u8ba4\u8bc1\u7edf\u4e00\u91c7\u7528httpbasic\u8ba4\u8bc1\uff0chttpbasic\u4e2d\u5b58\u50a8\u4e86client_id\u548cclient_secret\uff0c\u5f00\u59cb\u8ba4\u8bc1client_id\u548cclient_secret\n    if(authentication==null){\n        ClientDetails clientDetails = clientDetailsService.loadClientByClientId(username);\n        if(clientDetails!=null){\n            //\u79d8\u94a5\n            String clientSecret = clientDetails.getClientSecret();\n            //\u9759\u6001\u65b9\u5f0f\n            //return new User(username,new BCryptPasswordEncoder().encode(clientSecret), AuthorityUtils.commaSeparatedStringToAuthorityList(""));\n            //\u6570\u636e\u5e93\u67e5\u627e\u65b9\u5f0f\n            return new User(username,clientSecret, AuthorityUtils.commaSeparatedStringToAuthorityList(""));\n        }\n    }\n\n    if (StringUtils.isEmpty(username)) {\n        return null;\n    }\n\n    //\u6839\u636e\u7528\u6237\u540d\u67e5\u8be2\u7528\u6237\u4fe1\u606f\n    // String pwd = new BCryptPasswordEncoder().encode("itlils");\n    com.ydles.user.pojo.User user = userFeign.findUserInfo(username);\n    //\u521b\u5efaUser\u5bf9\u8c61\n    String permissions = "goods_list,seckill_list";\n    UserJwt userDetails = new UserJwt(username,user.getPassword(),AuthorityUtils.commaSeparatedStringToAuthorityList(permissions));\n    return userDetails;\n}\n}\n')),(0,l.kt)("p",null,"7\u91cd\u542f\u6d4b\u8bd5 \u767b\u9646 ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:9200/oauth/login"},"http://localhost:9200/oauth/loginopen in new window")),(0,l.kt)("p",null,"\u62a5\u9519401 \u56e0\u4e3a\u7528\u6237\u670d\u52a1\u5df2\u7ecf\u53d7\u4fdd\u62a4\u3002"),(0,l.kt)("p",null,"8\u7528\u6237\u670d\u52a1 com.ydles.user.config ResourceServerConfig\u7c7b\u7684configure\u65b9\u6cd5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Override\npublic void configure(HttpSecurity http) throws Exception {\n    //\u6240\u6709\u8bf7\u6c42\u5fc5\u987b\u8ba4\u8bc1\u901a\u8fc7\n    http.authorizeRequests()\n            //\u4e0b\u8fb9\u7684\u8def\u5f84\u653e\u884c\n            .antMatchers(\n                    "/user/add","/user/load/**"). //\u914d\u7f6e\u5730\u5740\u653e\u884c\n            permitAll()\n            .anyRequest().\n            authenticated();    //\u5176\u4ed6\u5730\u5740\u9700\u8981\u8ba4\u8bc1\u6388\u6743\n}\n')),(0,l.kt)("p",null,"9\u518d\u6b21\u8bbf\u95ee\u5373\u53ef\u6210\u529f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124121717560-eda1f00e.png",alt:"image-20211124121717560"}),"image-20211124121717560"),(0,l.kt)("h2",{id:"6-\u8ba4\u8bc1\u670d\u52a1\u5bf9\u63a5\u7f51\u5173"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_6-%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1%E5%AF%B9%E6%8E%A5%E7%BD%91%E5%85%B3"},"#"),"6 \u8ba4\u8bc1\u670d\u52a1\u5bf9\u63a5\u7f51\u5173"),(0,l.kt)("h3",{id:"61-\u65b0\u5efa\u7f51\u5173\u5de5\u7a0bydles_gateway_web"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_6-1-%E6%96%B0%E5%BB%BA%E7%BD%91%E5%85%B3%E5%B7%A5%E7%A8%8Bydles-gateway-web"},"#"),"6.1 \u65b0\u5efa\u7f51\u5173\u5de5\u7a0bydles_gateway_web"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"ydles_gateway\u8fd9\u4e2a\u5927\u6a21\u5757\uff0c\u6dfb\u52a0\u4f9d\u8d56")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependencies>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-gateway</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-hystrix</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n        </dependency>\n        \x3c!--redis--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-data-redis-reactive</artifactId>\n            <version>2.1.3.RELEASE</version>\n        </dependency>\n        \x3c!--\u9274\u6743--\x3e\n        <dependency>\n            <groupId>io.jsonwebtoken</groupId>\n            <artifactId>jjwt</artifactId>\n            <version>0.9.0</version>\n        </dependency>\n    </dependencies>\n")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u521b\u5efaydles_gateway_web\u5ba2\u6237\u7aef\u7f51\u5173\u6a21\u5757\u3002\u4e0d\u7528\u6dfb\u52a0\u4f9d\u8d56\uff0c\u56e0\u4e3a\u7236\u4f9d\u8d56\u5df2\u6709\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u542f\u52a8\u7c7bcom.ydles.web.gateway")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@SpringBootApplication\n@EnableEurekaClient\npublic class WebGatewayApplication {\npublic static void main(String[] args) {\n    SpringApplication.run(WebGatewayApplication.class,args);\n}\n}\n")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u521b\u5efaapplication.yml")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  application:\n    name: gateway-web\n  cloud:\n    gateway:\n      globalcors:\n        cors-configurations:\n          '[/**]': # \u5339\u914d\u6240\u6709\u8bf7\u6c42\n            allowedOrigins: \"*\" #\u8de8\u57df\u5904\u7406 \u5141\u8bb8\u6240\u6709\u7684\u57df\n            allowedMethods: # \u652f\u6301\u7684\u65b9\u6cd5\n              - GET\n              - POST\n              - PUT\n              - DELETE\n      routes:\n        - id: ydles_goods_route\n          uri: lb://goods\n          predicates:\n            - Path=/api/album/**,/api/brand/**,/api/cache/**,/api/categoryBrand/**,/api/category/**,/api/para/**,/api/pref/**,/api/sku/**,/api/spec/**,/api/spu/**,/api/stockBack/**,/api/template/**\n          filters:\n            #- PrefixPath=/brand\n            - StripPrefix=1\n          #\u7528\u6237\u5fae\u670d\u52a1\n        - id: ydles_user_route\n          uri: lb://user\n          predicates:\n            - Path=/api/user/**,/api/address/**,/api/areas/**,/api/cities/**,/api/provinces/**\n          filters:\n            - StripPrefix=1\n          #\u8ba4\u8bc1\u5fae\u670d\u52a1\n        - id: ydles_oauth_user\n          uri: lb://user-auth\n          predicates:\n            - Path=/api/oauth/**\n          filters:\n            - StripPrefix=1\n  redis:\n    host: 192.168.200.128\nserver:\n  port: 8001\neureka:\n  client:\n    service-url:\n      defaultZone: http://127.0.0.1:6868/eureka\n  instance:\n    prefer-ip-address: true\nmanagement:\n  endpoint:\n    gateway:\n      enabled: true\n    web:\n      exposure:\n        include: true\n")),(0,l.kt)("h3",{id:"62-\u7f51\u5173\u5168\u5c40\u8fc7\u6ee4\u5668"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_6-2-%E7%BD%91%E5%85%B3%E5%85%A8%E5%B1%80%E8%BF%87%E6%BB%A4%E5%99%A8"},"#"),"6.2 \u7f51\u5173\u5168\u5c40\u8fc7\u6ee4\u5668"),(0,l.kt)("p",null,"1\u9700\u6c42\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124151858147-e14b1e51.png",alt:"image-20211124151858147"}),"image-20211124151858147"),(0,l.kt)("p",null,"\u5148\u901a\u8fc7\u7f51\u5173\u662f\u786e\u5b9a\u7528\u6237\u662f\u5426\u62e5\u6709\u4ee4\u724c\uff0c\u5fae\u670d\u52a1\u662f\u8fdb\u884c\u4ee4\u724c\u7684\u6821\u9a8c\u3002"),(0,l.kt)("p",null,"1.1\u767b\u9646\u65f6\uff1a\u653e\u884c"),(0,l.kt)("p",null,"1.2\u7528\u6237\u8bbf\u95ee\u65f6\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"1\uff09\u5224\u65ad\u5f53\u524d\u8bf7\u6c42\u662f\u5426\u4e3a\u767b\u5f55\u8bf7\u6c42\uff0c\u662f\u7684\u8bdd\uff0c\u5219\u653e\u884c"),(0,l.kt)("li",{parentName:"ul"},"2 ) \u5224\u65adcookie\u4e2d\u662f\u5426\u5b58\u5728\u4fe1\u606f, \u6ca1\u6709\u7684\u8bdd\uff0c\u62d2\u7edd\u8bbf\u95ee"),(0,l.kt)("li",{parentName:"ul"},"3\uff09\u5224\u65adredis\u4e2d\u4ee4\u724c\u662f\u5426\u5b58\u5728\uff0c\u6ca1\u6709\u7684\u8bdd\uff0c\u62d2\u7edd\u8bbf\u95ee")),(0,l.kt)("p",null,"2\u5ba2\u6237\u7aef\u7f51\u5173\u5de5\u7a0b com.ydles.web.gateway.filter"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Component\npublic class AuthFilter implements GlobalFilter, Ordered {\n    @Autowired\n    AuthService authService;\n    \n@Override\npublic Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n    ServerHttpRequest request = exchange.getRequest();\n    ServerHttpResponse response = exchange.getResponse();\n\n    //1\u5224\u65ad\u5f53\u524d\u8bf7\u6c42\u662f\u5426\u4e3a\u767b\u9646\uff0c\u662f\u5c31\u653e\u884c\n    String path = request.getURI().getPath();\n    if ("/api/oauth/login".equals(path)) {\n        //\u653e\u884c\n        return chain.filter(exchange);\n    }\n\n    //  2\u4ececookie\u4e2d\u83b7\u53d6jti\uff0c\u4e0d\u5b58\u5728\uff0c\u62d2\u7edd\u8bbf\u95ee\n    String jti=authService.getJtiFromCookie(request);\n    if(StringUtils.isEmpty(jti)){\n        //\u62d2\u7edd\u8bbf\u95ee\n        response.setStatusCode(HttpStatus.UNAUTHORIZED);\n        return response.setComplete();\n    }\n\n   //  3\u4eceredis\u83b7\u53d6jwt\uff0c\u4e0d\u5b58\u5728\uff0c\u5219\u62d2\u7edd\u8bbf\u95ee\n    String jwt=authService.getJwtFromRedis(jti);\n    if(StringUtils.isEmpty(jwt)){\n        //\u62d2\u7edd\u8bbf\u95ee\n        response.setStatusCode(HttpStatus.UNAUTHORIZED);\n        return response.setComplete();\n    }\n\n   //  4\u5bf9\u5f53\u524d\u8bf7\u6c42\u589e\u5f3a\uff0c\u8ba9\u5176\u643a\u5e26\u4ee4\u724c\u4fe1\u606f\n    request.mutate().header("Authorization", "Bearer "+jwt);\n\n    return chain.filter(exchange);\n}\n\n@Override\npublic int getOrder() {\n    return 0;\n}\n}\n')),(0,l.kt)("p",null,"3com.ydles.web.gateway.service"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Service\npublic class AuthService {\n    @Autowired\n    StringRedisTemplate stringRedisTemplate;\n    //\u4ecerequest\u4e2d\u83b7\u53d6jti\npublic String getJtiFromCookie(ServerHttpRequest request) {\n    HttpCookie httpCookie = request.getCookies().getFirst("uid");\n    if (httpCookie != null) {\n        String jti = httpCookie.getValue();\n        return jti;\n    }\n    return null;\n}\n\npublic String getJwtFromRedis(String jti) {\n    String jwt = stringRedisTemplate.boundValueOps(jti).get();\n    return jwt;\n}\n}\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6d4b\u8bd5"),"\uff1a"),(0,l.kt)("p",null,"1\u542f\u52a8\u7528\u6237\u7f51\u5173"),(0,l.kt)("p",null,"2\u6d4b\u8bd5Get ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/user/"},"http://localhost:8001/api/user/open in new window")),(0,l.kt)("p",null,"401"),(0,l.kt)("p",null,"3\u6d4b\u8bd5\u767b\u9646"),(0,l.kt)("p",null,"POST ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/oauth/login"},"http://localhost:8001/api/oauth/loginopen in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124154032714-6bb5af40.png",alt:"image-20211124154032714"}),"image-20211124154032714"),(0,l.kt)("p",null,"4\u518d\u6d4b\u8bd5Get ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/user/"},"http://localhost:8001/api/user/open in new window")," \u6210\u529f\u3002\u56e0\u4e3a\u67e5\u770bcookie\u4e2d\u6709uid\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124160506030-631f659a.png",alt:"image-20211124160506030"}),"image-20211124160506030"),(0,l.kt)("h2",{id:"7-\u81ea\u5b9a\u4e49\u767b\u5f55\u9875\u9762"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_7-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2"},"#"),"7 \u81ea\u5b9a\u4e49\u767b\u5f55\u9875\u9762"),(0,l.kt)("p",null,"\u9700\u6c42\uff1aoauth\u81ea\u5e26\u767b\u9646\u9875\u9762\u592a\u4e11\uff0c\u6211\u4eec\u60f3\u8981\u4e00\u4e2a\u4f53\u9a8c\u66f4\u597d\u7684\u767b\u9646\u9875\u9762\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124163728345-0e84b8e3.png",alt:"image-20211124163728345"}),"image-20211124163728345"),(0,l.kt)("p",null,"\u8bbf\u95ee\u8def\u5f84\uff1a ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/oauth/toLogin"},"http://localhost:8001/api/oauth/toLoginopen in new window")),(0,l.kt)("p",null,"\u6d41\u7a0b\uff1a 1\u5ba2\u6237\u7aef\u7f51\u5173-\u300b\u8ba4\u8bc1\u670d\u52a1controller-\u300blogin.html\u3002"),(0,l.kt)("p",null," 2\u70b9\u51fb\u767b\u9646-\u300b/api/oauth/login-\u300b\u83b7\u53d6\u4ee4\u724c\u767b\u9646"),(0,l.kt)("p",null,"1 \u8ba4\u8bc1\u670d\u52a1\u6dfb\u52a0\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"    \x3c!--thymeleaf--\x3e\n    <dependency>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-thymeleaf</artifactId>\n    </dependency>\n")),(0,l.kt)("p",null,"2 resources\u4e0b \u65b0\u589estatic\u3001templates\u6587\u4ef6\u5939\u3002\u653e\u5165\u8d44\u6e90\u91cc\u7684\u6570\u636e\u3002"),(0,l.kt)("p",null,"3 AuthController\u4e2d\u6dfb\u52a0\u8df3\u8f6c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("/toLogin")\npublic String toLogin(){\n    return "login";\n}\n')),(0,l.kt)("p",null,"4 \u653e\u884c\u9759\u6001\u8d44\u6e90\u3002com.ydles.oauth.config\u5305 WebSecurityConfig\u7c7b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Override\npublic void configure(WebSecurity web) throws Exception {\n    web.ignoring().antMatchers(           "/oauth/login","/oauth/logout","/oauth/toLogin","/login.html","/css/**","/data/**","/fonts/**","/./image/**","/js/**"\n            );\n}\n')),(0,l.kt)("p",null,"5\u767b\u9646\u7ecf\u8fc7\u7528\u6237\u7f51\u5173\uff0c\u6240\u4ee5\u5c06static\u76ee\u5f55copy\u81f3gateway_web\u4e00\u4efd"),(0,l.kt)("p",null,"6\u5f00\u542f\u8868\u5355\u767b\u9646\u3002com.ydles.oauth.config\u5305 WebSecurityConfig\u7c7b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Override\npublic void configure(HttpSecurity http) throws Exception {\n    http.csrf().disable()\n            .httpBasic()        //\u542f\u7528Http\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\n            .and()\n            .formLogin()       //\u542f\u7528\u8868\u5355\u8eab\u4efd\u9a8c\u8bc1\n            .and()\n            .authorizeRequests()    //\u9650\u5236\u57fa\u4e8eRequest\u8bf7\u6c42\u8bbf\u95ee\n            .anyRequest()\n            .authenticated();       //\u5176\u4ed6\u8bf7\u6c42\u90fd\u9700\u8981\u7ecf\u8fc7\u9a8c\u8bc1\n//\u5f00\u542f\u8868\u5355\u767b\u9646\n  http.formLogin().loginPage("/oauth/toLogin")//\u8bbe\u7f6e\u8bbf\u95ee\u767b\u9646\u9875\u9762\u7684\u8def\u5f84\n          .loginProcessingUrl("/oauth/login");//\u8bbe\u7f6e\u6267\u884c\u767b\u9646\u64cd\u4f5c\u7684\u8def\u5f84\n}\n')),(0,l.kt)("p",null,"7login.html\u4fee\u6539"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'2 <html lang="en" xmlns:th="http://www.thymeleaf.org">\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'82 <div class="login-box" id="app">\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'101 <input id="inputName" type="text" v-model="username" placeholder="\u90ae\u7bb1/\u7528\u6237\u540d/\u624b\u673a\u53f7" class="span2 input-xfat">\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'104 <input id="inputPassword" type="password" v-model="password" placeholder="\u8bf7\u8f93\u5165\u5bc6\u7801" class="span2 input-xfat">\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'114-115\n\x3c!--<a class="sui-btn btn-block btn-xlarge btn-danger" href="home.html" target="_blank">\u767b&nbsp;&nbsp;\u5f55</a>--\x3e\n<button class="sui-btn btn-block btn-xlarge btn-danger" type="button" @click="login()">\u767b&nbsp;&nbsp;\u5f55</button>\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'167-188\n<script th:inline="javascript">\n    var app = new Vue({\n        el:"#app",\n        data:{\n            username:"",\n            password:"",\n            msg:""\n        },\n        methods:{\n            login:function () {\n                app.msg="\u6b63\u5728\u767b\u5f55";\n                axios.post("/api/oauth/login?username="+app.username+"&password="+app.password).then(function (response) {\n                    if (response.data.flag){\n                        app.msg="\u767b\u5f55\u6210\u529f";\n                    } else{\n                        app.msg="\u767b\u5f55\u5931\u8d25";\n                    }\n                })\n            }\n        }\n    })\n<\/script>\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,l.kt)("p",null,"1geteway-web\u5de5\u7a0b com.ydles.web.gateway.filter AuthFilter\u3002\u653e\u884c\u767b\u9646\u8df3\u8f6c\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'        //1\u5224\u65ad\u5f53\u524d\u8bf7\u6c42\u662f\u5426\u4e3a\u767b\u9646\uff0c\u662f\u5c31\u653e\u884c\n        String path = request.getURI().getPath();\n        if ("/api/oauth/login".equals(path) || "/api/oauth/toLogin".equals(path) ) {\n            //\u653e\u884c\n            return chain.filter(exchange);\n        }\n')),(0,l.kt)("p",null,"2\u91cd\u542f\u8ba4\u8bc1\u670d\u52a1\u3001\u5ba2\u6237\u7f51\u5173"),(0,l.kt)("p",null,"3 \u6d4f\u89c8\u5668\u8bbf\u95ee ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/oauth/toLogin"},"http://localhost:8001/api/oauth/toLoginopen in new window")),(0,l.kt)("p",null,"\u8f93\u5165itlils itlils666 \uff0c\u663e\u793a\u767b\u9646\u6210\u529f\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124173405118-c6816cfd.png",alt:"image-20211124173405118"}),"image-20211124173405118"),(0,l.kt)("p",null,"5F12\u67e5\u770b\u6d4f\u89c8\u5668cookie"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124173431500-0df84f16.png",alt:"image-20211124173431500"}),"image-20211124173431500"),(0,l.kt)("p",null,"6\u67e5\u770bredis"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124173445773-8cfedc06.png",alt:"image-20211124173445773"}),"image-20211124173445773"),(0,l.kt)("h2",{id:"8\u81ea\u5b9a\u4e49\u8def\u5f84\u8fc7\u6ee4\u5668"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_8%E8%87%AA%E5%AE%9A%E4%B9%89%E8%B7%AF%E5%BE%84%E8%BF%87%E6%BB%A4%E5%99%A8"},"#"),(0,l.kt)("strong",{parentName:"h2"},"8\u81ea\u5b9a\u4e49\u8def\u5f84\u8fc7\u6ee4\u5668")),(0,l.kt)("p",null,"1\u9700\u6c42\uff1a\u8bb8\u591aurl\u6211\u4eec\u9700\u8981\u7ecf\u884c\u4ee4\u724c\u6821\u9a8c\uff0c\u8bb8\u591aurl\u4e0d\u9700\u8981\u3002\u6240\u4ee5\u5199\u4e00\u4e2a\u5de5\u5177\u7c7b\u5224\u65ad\u3002"),(0,l.kt)("p",null,"2\u5199\u4e00\u4e2a\u5de5\u5177\u7c7b\uff0c\u5224\u65adurl\u662f\u5426\u9700\u8981\u8fc7\u6ee4\u3002com.ydles.web.gateway.filter"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydles.web.gateway.utils;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n\npublic class UrlUtil {\n\n    //\u54ea\u4e9b\u8def\u5f84\u9700\u8981\u4ee4\u724c\n    public static String filterPath = "/api/wseckillorder,/api/seckill,/api/wxpay,/api/wxpay/**,/api/worder/**,/api/user/**,/api/address/**,/api/wcart/**,/api/cart/**,/api/categoryReport/**,/api/orderConfig/**,/api/order/**,/api/orderItem/**,/api/orderLog/**,/api/preferential/**,/api/returnCause/**,/api/returnOrder/**,/api/returnOrderItem/**";\n\n    //\u4f20\u6765\u4e00\u4e2a\u8def\u5f84 \u9700\u4e0d\u9700\u8981\u4ee4\u724c\n    public static boolean hasAuthorize(String url){\n        String[] split = filterPath.replace("**", "").split(",");\n        for (String s : split) {\n            if(url.startsWith(s)){\n                return true;\n            }\n        }\n        return false;\n    }\n}\n')),(0,l.kt)("p",null,"3AuthFilter\u4f18\u5316"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'        //1.1\u767b\u9646\u65f6\uff1a\u653e\u884c\n        String path = request.getURI().getPath(); // /oauth/login\n        System.out.println("path:"+path);\n        if(!UrlUtil.hasAuthorize(path)){\n            //\u653e\u884c\n            return chain.filter(exchange);\n        }\n')),(0,l.kt)("p",null,"\u603b\u7ed3\uff1a"),(0,l.kt)("p",null,"1\u767b\u9646"),(0,l.kt)("p",null," \u767b\u9646\u4e0e\u9274\u6743 5\u5f20\u8868"),(0,l.kt)("p",null," \u5355\u70b9\u767b\u5f55sso spring cas Shiro"),(0,l.kt)("p",null," \u7b2c\u4e09\u65b9\u767b\u5f55 oauth2"),(0,l.kt)("p",null,"2jwt"),(0,l.kt)("p",null," \u6784\u6210 base64(\u5934{}).base64(\u8d1f\u8f7d{}).sha256(\u524d\u4e24\u90e8\u5206\uff0csecret)"),(0,l.kt)("p",null," secret------\x3e\u79c1\u94a5 jks"),(0,l.kt)("p",null," \u516c\u94a5 public.txt"),(0,l.kt)("p",null,"3oauth2"),(0,l.kt)("p",null,"\u6388\u6743\u7801"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211122104426755-45bc1ee9.png",alt:"image-20211122104426755"}),"image-20211122104426755"),(0,l.kt)("p",null," \u5bc6\u7801"),(0,l.kt)("p",null," postman \u6d4b\u8bd5"),(0,l.kt)("p",null,"4\u8ba4\u8bc1\u5f00\u53d1"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124121822950-4604b233.png",alt:"image-20211124121822950"}),"image-20211124121822950"),(0,l.kt)("p",null,"\u4f5c\u4e1a\uff1a\u9000\u51fa"),(0,l.kt)("p",null,"5\u81ea\u5b9a\u4e49\u767b\u5f55\u9875\u9762"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124163728345-0e84b8e3.png",alt:"image-20211124163728345"}),"image-20211124163728345"),(0,l.kt)("p",null,"\u8def\u5f84\u8fc7\u6ee4\u5668"),(0,l.kt)("h1",{id:"\u7b2c10\u7ae0-\u8d2d\u7269\u8f66"},(0,l.kt)("a",{parentName:"h1",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#%E7%AC%AC10%E7%AB%A0-%E8%B4%AD%E7%89%A9%E8%BD%A6"},"#"),"\u7b2c10\u7ae0 \u8d2d\u7269\u8f66"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u89d2\u8272"),"\uff1a\u8d2d\u7269\u8f66\u6a21\u5757\u540e\u53f0\u5de5\u7a0b\u5e08"),(0,l.kt)("h2",{id:"\u5b66\u4e60\u76ee\u6807-2"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87-2"},"#"),"\u5b66\u4e60\u76ee\u6807"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u80fd\u591f\u901a\u8fc7SpringSecurity\u8fdb\u884c\u6743\u9650\u63a7\u5236"),(0,l.kt)("li",{parentName:"ul"},"\u638c\u63e1\u8d2d\u7269\u8f66\u6d41\u7a0b"),(0,l.kt)("li",{parentName:"ul"},"\u638c\u63e1\u8d2d\u7269\u8f66\u6e32\u67d3"),(0,l.kt)("li",{parentName:"ul"},"\u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u8ba4\u8bc1\u8bbf\u95ee")),(0,l.kt)("h2",{id:"1-springsecurity\u6743\u9650\u63a7\u5236-\u9274\u6743"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-springsecurity%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6-%E9%89%B4%E6%9D%83"},"#"),"1 SpringSecurity\u6743\u9650\u63a7\u5236 \u9274\u6743"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124232357515-dea96931.png",alt:"image-20211124232357515"}),"image-20211124232357515"),(0,l.kt)("p",null,"\u7528\u6237\u6bcf\u6b21\u8bbf\u95ee\u5fae\u670d\u52a1\u7684\u65f6\u5019\uff0c\u5148\u53bboauth2.0\u670d\u52a1\u767b\u5f55\uff0c\u767b\u5f55\u540e\u518d\u8bbf\u95ee\u5fae\u670d\u52a1\u7f51\u5173\uff0c\u5fae\u670d\u52a1\u7f51\u5173\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u5176\u4ed6\u5fae\u670d\u52a1\u5904\u7406\u3002"),(0,l.kt)("p",null,"\u7531\u4e8e\u6211\u4eec\u9879\u76ee\u4f7f\u7528\u4e86\u5fae\u670d\u52a1\uff0c\u4efb\u4f55\u7528\u6237\u90fd\u6709\u53ef\u80fd\u4f7f\u7528\u4efb\u610f\u5fae\u670d\u52a1\uff0c\u6b64\u65f6\u6211\u4eec\u9700\u8981\u63a7\u5236\u76f8\u5173\u6743\u9650\uff0c\u4f8b\u5982\uff1a\u666e\u901a\u7528\u6237\u89d2\u8272\u4e0d\u80fd\u4f7f\u7528\u7528\u6237\u7684\u5220\u9664\u64cd\u4f5c\uff0c\u53ea\u6709\u7ba1\u7406\u5458\u624d\u53ef\u4ee5\u4f7f\u7528,\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u4f7f\u7528\u5230SpringSecurity\u7684\u6743\u9650\u63a7\u5236\u529f\u80fd\u4e86\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"user    user_role      role   role_auth      auth \n\nuser\nid    name    password\n1     itlils  itlils666\n2     itnanls nangeniubi\n\nuser_role\nuserid      roleid\n1           1\n1           2\n1           3\n2           3\n\nrole \nid   name\n1    \u7ba1\u7406\u5458\n2    \u8fd0\u7ef4\u4eba\u5458\n3    \u5ba2\u6237\n\nrole_auth\nroleid    authid\n1         1\n1         2\n3         1\n\nauth\nid     auth\n1      \u67e5\u8be2\u5546\u54c1\n2      \u5220\u9664\u5546\u54c1\n\nUser (id:1,name:itlils,password:itlils666,rolelist[\u7ba1\u7406\u5458, \u8fd0\u7ef4\u4eba\u5458,\u5ba2\u6237],authList[\u67e5\u8be2\u5546\u54c1,\u5220\u9664\u5546\u54c1])\n")),(0,l.kt)("h3",{id:"11-\u89d2\u8272\u6743\u9650\u52a0\u8f7d"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-1-%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90%E5%8A%A0%E8%BD%BD"},"#"),"1.1 \u89d2\u8272\u6743\u9650\u52a0\u8f7d"),(0,l.kt)("p",null,"1ydles-user-oauth\u5de5\u7a0b\u7684com.ydles.oauth.confifig.UserDetailsServiceImpl\u8be5\u7c7b\u5b9e\u73b0\u4e86\u52a0\u8f7d\u7528\u6237\u76f8\u5173\u4fe1\u606f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124232753108-515dff9e.png",alt:"image-20211124232753108"}),"image-20211124232753108"),(0,l.kt)("p",null,"2\u542f\u52a8 eureka gateway_web user_oauth service_user\u5de5\u7a0b"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124232554421-a59662bc.png",alt:"image-20211124232554421"}),"image-20211124232554421"),(0,l.kt)("p",null,"3\u901a\u8fc7\u7f51\u5173\u7533\u8bf7\u4ee4\u724c POST ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/oauth/login"},"http://localhost:8001/api/oauth/loginopen in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124232811751-46f050b8.png",alt:"image-20211124232811751"}),"image-20211124232811751"),(0,l.kt)("p",null,"4 \u89e3\u6790jwt"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://www.qqxiuzi.cn/bianma/base64.htm"},"https://www.qqxiuzi.cn/bianma/base64.htmopen in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211124232943971-0fec9445.png",alt:"image-20211124232943971"}),"image-20211124232943971"),(0,l.kt)("h3",{id:"12-\u89d2\u8272\u6743\u9650\u63a7\u5236"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-2-%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"},"#"),"1.2 \u89d2\u8272\u6743\u9650\u63a7\u5236"),(0,l.kt)("p",null,"1\u88ab\u8c03\u7528\u7684\u5de5\u7a0b\u4e2d\uff0c\u5f00\u542f\u6388\u6743\u3002\u5982ydles-user-service\u5de5\u7a0b\u7684com.ydles.user.config.ResourceServerConfig\u4e2d"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true)//\u6fc0\u6d3b\u65b9\u6cd5\u4e0a\u7684PreAuthorize\u6ce8\u89e3\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211130180616128-ef390174.png",alt:"image-20211130180616128"}),"image-20211130180616128"),(0,l.kt)("p",null,"2controller\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u3002\u5982ydles-user-service\u5de5\u7a0b\u7684com.ydles.user.controller findAll\u65b9\u6cd5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"@PreAuthorize(\"hasAnyAuthority('admin')\")\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211130180636775-797ca28a.png",alt:"image-20211130180636775"}),"image-20211130180636775"),(0,l.kt)("p",null,"3\u91cd\u542fydles-user-service\uff0c\u8bbf\u95ee GET ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/user/"},"http://localhost:8001/api/user/open in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211130180654463-a518ba2c.png",alt:"image-20211130180654463"}),"image-20211130180654463"),(0,l.kt)("p",null,"user\u670d\u52a1\u540e\u53f0"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211130180702834-e932feed.png",alt:"image-20211130180702834"}),"image-20211130180702834"),(0,l.kt)("p",null,"4 \u6539\u6210\u80fd\u8bbf\u95ee\uff0cfindAll\u65b9\u6cd5\u4e0a\uff0c\u6539\u4e3a\uff0c\u91cd\u542fuser\u670d\u52a1\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"@PreAuthorize(\"hasAnyAuthority('goods_list')\")\n")),(0,l.kt)("p",null,"5\u91cd\u65b0\u7528postman\u8bbf\u95ee\uff0c\u5c31\u80fd\u83b7\u53d6\u6570\u636e\u4e86"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211130180718000-ceaa3cbc.png",alt:"image-20211130180718000"}),"image-20211130180718000"),(0,l.kt)("p",null,"\u4f01\u4e1a\u5f00\u53d1\u4e2d\u7684\u7528\u6cd5\uff1a"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"1")," \u67e5\u8be2\u7528\u6237\u65f6\uff0c\u5c31\u628a\u76f8\u5173\u6743\u9650\u5b57\u7b26\u4e32\u4e00\u8d77\u67e5\u51fa\u6765\uff0c\u653e\u5230jwt"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"2")," \u5404\u4e2a\u5fae\u670d\u52a1\u4e2d\uff0c\u6bcf\u4e2acontroller\u7684\u6bcf\u4e2a\u65b9\u6cd5\u4e0a \u60f3\u8981\u6743\u9650\u8ba4\u8bc1\u7684\u65b9\u6cd5\u624d\u52a0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"@PreAuthorize(\"hasAnyAuthority('goods_list')\")\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"3")," \u5e95\u5c42\u548b\u5b9e\u73b0 spring securety Oauth2 \u6846\u67b6\u5b9e\u73b0\u3002"),(0,l.kt)("h3",{id:"13-\u5c0f\u7ed3"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_1-3-%E5%B0%8F%E7%BB%93"},"#"),"1.3 \u5c0f\u7ed3"),(0,l.kt)("p",null,"\u5982\u679c\u5e0c\u671b\u4e00\u4e2a\u65b9\u6cd5\u80fd\u88ab\u591a\u4e2a\u89d2\u8272\u8bbf\u95ee\uff0c\u914d\u7f6e:",(0,l.kt)("inlineCode",{parentName:"p"},"@PreAuthorize(\"hasAnyAuthority('admin','user')\")")),(0,l.kt)("p",null,"\u5982\u679c\u5e0c\u671b\u4e00\u4e2a\u7c7b\u90fd\u80fd\u88ab\u591a\u4e2a\u89d2\u8272\u8bbf\u95ee\uff0c\u5728\u7c7b\u4e0a\u914d\u7f6e:",(0,l.kt)("inlineCode",{parentName:"p"},"@PreAuthorize(\"hasAnyAuthority('admin','user')\")")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211130180915359-f3566f83.png",alt:"image-20211130180915359"}),"image-20211130180915359"),(0,l.kt)("h2",{id:"2-\u8d2d\u7269\u8f66"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-%E8%B4%AD%E7%89%A9%E8%BD%A6"},"#"),"2 \u8d2d\u7269\u8f66"),(0,l.kt)("p",null,"\u8d2d\u7269\u8f66\u5206\u4e3a\u7528\u6237\u767b\u5f55\u8d2d\u7269\u8f66\u548c\u672a\u767b\u5f55\u8d2d\u7269\u8f66\u64cd\u4f5c"),(0,l.kt)("p",null,"1\u4eac\u4e1c\u7528\u6237\u767b\u5f55\u548c\u4e0d\u767b\u5f55\u90fd\u53ef\u4ee5\u64cd\u4f5c\u8d2d\u7269\u8f66\uff0c\u5982\u679c\u7528\u6237\u4e0d\u767b\u5f55\uff0c\u64cd\u4f5c\u8d2d\u7269\u8f66\u53ef\u4ee5\u5c06\u6570\u636e\u5b58\u50a8\u5230Cookie\uff0c\u7528\u6237\u767b\u5f55\u540e\u8d2d\u7269\u8f66\u6570\u636e\u53ef\u4ee5\u5b58\u50a8\u5230Redis\u4e2d\uff0c\u518d\u5c06\u4e4b\u524d\u672a\u767b\u5f55\u52a0\u5165\u7684\u8d2d\u7269\u8f66\u5408\u5e76\u5230Redis\u4e2d\u5373\u53ef\u3002"),(0,l.kt)("p",null,"2\u6dd8\u5b9d\u5929\u732b\uff0c\u7528\u6237\u8981\u60f3\u5c06\u5546\u54c1\u52a0\u5165\u8d2d\u7269\u8f66\uff0c\u5fc5\u987b\u5148\u767b\u5f55\u624d\u80fd\u64cd\u4f5c\u8d2d\u7269\u8f66\u3002"),(0,l.kt)("h3",{id:"21-\u8d2d\u7269\u8f66\u4e1a\u52a1\u5206\u6790"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-1-%E8%B4%AD%E7%89%A9%E8%BD%A6%E4%B8%9A%E5%8A%A1%E5%88%86%E6%9E%90"},"#"),"2.1 \u8d2d\u7269\u8f66\u4e1a\u52a1\u5206\u6790"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u6211\u4eec\u5b9e\u73b0\u5929\u732b\u601d\u8def")),(0,l.kt)("p",null,"\u8d2d\u7269\u8f66\u9700\u6c42\uff1a"),(0,l.kt)("p",null,"1\u7528\u6237\u5728\u5546\u54c1\u8be6\u7ec6\u9875\u70b9\u51fb\u52a0\u5165\u8d2d\u7269\u8f66\uff0c\u63d0\u4ea4\u5546\u54c1SKU\u7f16\u53f7\u548c\u8d2d\u4e70\u6570\u91cf\uff0c\u6dfb\u52a0\u5230\u8d2d\u7269\u8f66\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201092837615-4059ec5d.png",alt:"image-20211201092837615"}),"image-20211201092837615"),(0,l.kt)("p",null,"2\u4e1a\u52a1\u903b\u8f91"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201093507350-796a58ae.png",alt:"image-20211201093507350"}),"image-20211201093507350"),(0,l.kt)("p",null,"\u6dfb\u52a0\u548c\u67e5\u770b\u8d2d\u7269\u8f66\u90fd\u662f\u53bbredis\u3002"),(0,l.kt)("p",null,"3\u8d2d\u7269\u8f66\u8868\u7ed3\u6784\uff1aydles_order\u6570\u636e\u4e2dtb_order_item\u8868"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201093147467-bb6ceacd.png",alt:"image-20211201093147467"}),"image-20211201093147467"),(0,l.kt)("h3",{id:"22-\u6dfb\u52a0\u8d2d\u7269\u8f66"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-2-%E6%B7%BB%E5%8A%A0%E8%B4%AD%E7%89%A9%E8%BD%A6"},"#"),"2.2 \u6dfb\u52a0\u8d2d\u7269\u8f66"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a\u8ba2\u5355\u670d\u52a1\u8fdc\u7a0b\u8c03\u7528\u5546\u54c1\u670d\u52a1"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201093516858-3cb2789b.png",alt:"image-20211201093516858"}),"image-20211201093516858"),(0,l.kt)("p",null,"1\u5c06skucontroller\u7684findById\u65b9\u6cd5\u66b4\u9732"),(0,l.kt)("p",null,"goods-api\u9879\u76eecom.ydles.goods.feign.SkuFeign"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'    //skuId---\x3esku\n    @GetMapping("/sku/{id}")\n    public Result<Sku> findById(@PathVariable String id);\n')),(0,l.kt)("p",null,"2service-order \u8ba2\u5355\u670d\u52a1"),(0,l.kt)("p",null,"\u5bfc\u5165\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"        <dependency>\n            <groupId>com.ydles</groupId>           \n            <artifactId>ydles_service_goods_api</artifactId>\n            <version>1.0-SNAPSHOT</version>\n        </dependency>\n")),(0,l.kt)("p",null,"3\u542f\u52a8\u7c7b\u5f00\u542ffeign"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@EnableFeignClients(basePackages = "com.ydles.goods.feign")\n')),(0,l.kt)("h4",{id:"\u6dfb\u52a0\u8d2d\u7269\u8f66-\u4e1a\u52a1\u5c42\u5b9e\u73b0-\u91cd\u70b9"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#%E6%B7%BB%E5%8A%A0%E8%B4%AD%E7%89%A9%E8%BD%A6-%E4%B8%9A%E5%8A%A1%E5%B1%82%E5%AE%9E%E7%8E%B0-%E9%87%8D%E7%82%B9"},"#"),"\u6dfb\u52a0\u8d2d\u7269\u8f66 \u4e1a\u52a1\u5c42\u5b9e\u73b0-\u91cd\u70b9"),(0,l.kt)("p",null,"\u6dfb\u52a0\u8d2d\u7269\u8f66 \uff1a"),(0,l.kt)("p",null,"1\u9009\u62e9\u89c4\u683c\u540e\u7684\u4e00\u4e2asku,\u5f80\u8d2d\u7269\u8f66\u6dfb\u52a0\u3002\u8d2d\u7269\u8f66redis\u91cc\u5b58\u7740\u3002"),(0,l.kt)("p",null,"2\u76f8\u540csku\u53ef\u4ee5\u53e0\u52a0\u3002\u4e0d\u540csku\u53ef\u4ee5\u90fd\u653e\u5728\u8d2d\u7269\u8f66\u4e2d"),(0,l.kt)("p",null,"3 \u70b9\u51fb\u52a0\u5165\u8d2d\u7269\u8f66 skuid num"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u62d3\u5c55"),"\uff1a\u56de\u987e redis \u6570\u636e\u7ed3\u6784 string"),(0,l.kt)("p",null," value:string list set map zset"),(0,l.kt)("p",null,"service-order \u8ba2\u5355\u670d\u52a1"),(0,l.kt)("p",null,"1com.ydles.order.service.CartService"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydles.order.service;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n * \u8d2d\u7269\u8f66\u670d\u52a1\u5c42\n */\npublic interface CartService {\n\n    //\u6dfb\u52a0\u8d2d\u7269\u8f66\n    public void addCart(String skuId,Integer num,String username);\n}\n")),(0,l.kt)("p",null,"2\u5b9e\u73b0com.ydles.order.service.impl.CartServiceImpl"),(0,l.kt)("p",null,"redis\u4e2d\u6570\u636e\u683c\u5f0f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201102125278-7e3946f6.png",alt:"image-20211201102125278"}),"image-20211201102125278"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydles.order.service.impl;\n\nimport com.alibaba.fastjson.JSON;\nimport com.ydles.goods.feign.SkuFeign;\nimport com.ydles.goods.feign.SpuFeign;\nimport com.ydles.goods.pojo.Sku;\nimport com.ydles.goods.pojo.Spu;\nimport com.ydles.order.pojo.OrderItem;\nimport com.ydles.order.service.CartService;\nimport com.ydles.util.IdWorker;\nimport org.apache.commons.lang.StringUtils;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.data.redis.core.RedisTemplate;\nimport org.springframework.data.redis.core.StringRedisTemplate;\nimport org.springframework.stereotype.Service;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n * \u7f3a\u5565\u8865\u5565\n */\n@Service\npublic class CartServiceImpl implements CartService {\n    //\u8d2d\u7269\u8f66redis key \u5934\n    private static final String CART = "cart_";\n    @Autowired\n    StringRedisTemplate stringRedisTemplate;\n    @Autowired\n    SpuFeign spuFeign;\n    @Autowired\n    SkuFeign skuFeign;\n\n    //\u6dfb\u52a0\u8d2d\u7269\u8f66 \u4ece\u8d2d\u7269\u8f66\u51cf\u4e00\u4e2a\uff0cnum=-1\n    @Override\n    public void addCart(String skuId, Integer num, String username) {\n\n        String orderItemStr = (String) stringRedisTemplate.boundHashOps(CART + username).get(skuId);\n        Sku sku = skuFeign.findById(skuId).getData();\n        Spu spu = spuFeign.findSpuById(sku.getSpuId()).getData();\n        //\u5224\u65ad  \u5f53\u524d\u7528\u6237\u8d2d\u7269\u8f66\u91cc\u6709\u6ca1\u6709\u6dfb\u52a0\u7684sku\n        OrderItem orderItem;\n        if (StringUtils.isNotEmpty(orderItemStr)) {\n            orderItem = JSON.parseObject(orderItemStr, OrderItem.class);\n            //\u8d2d\u7269\u8f66\u91cc\u6709  \u66f4\u65b0redis\u6570\u636e\n            orderItem.setNum(orderItem.getNum() + num);\n            if (orderItem.getNum() < 1) {\n                //\u603b\u6570\u5c0f\u4e8e1 redis\u5220\u9664\n                stringRedisTemplate.boundHashOps(CART + username).delete(skuId);\n            }\n            orderItem.setMoney(orderItem.getPrice() * orderItem.getNum());\n            orderItem.setPayMoney(orderItem.getPrice() * orderItem.getNum());//\u6ee1\u51cf\n            orderItem.setWeight(sku.getWeight() * num);\n        } else {\n            //\u65b0\u52a0\u5165\u8d2d\u7269\u8f66\u7684sku\n            orderItem = sku2OrderItem(spu, sku, num);\n        }\n\n        //\u653e\u5165redis\n        stringRedisTemplate.boundHashOps(CART + username).put(skuId, JSON.toJSONString(orderItem));\n\n    }\n\n    @Autowired\n    IdWorker idWorker;\n\n    //\u62fc\u63a5 OrderItem\n    private OrderItem sku2OrderItem(Spu spu, Sku sku, Integer num) {\n        OrderItem orderItem = new OrderItem();\n        orderItem.setId(idWorker.nextId() + "");\n        orderItem.setCategoryId1(spu.getCategory1Id());\n        orderItem.setCategoryId2(spu.getCategory2Id());\n        orderItem.setCategoryId3(spu.getCategory3Id());\n        orderItem.setSpuId(spu.getId());\n        orderItem.setSkuId(sku.getId());\n        orderItem.setName(sku.getName());\n        orderItem.setPrice(sku.getPrice());\n        orderItem.setNum(num);\n        orderItem.setMoney(sku.getPrice() * num);\n        orderItem.setPayMoney(sku.getPrice() * num);\n        orderItem.setImage(sku.getImage());\n        orderItem.setWeight(sku.getWeight() * num);\n\n        return orderItem;\n    }\n}\n')),(0,l.kt)("h4",{id:"\u8ba2\u5355\u670d\u52a1\u6dfb\u52a0cartservice\u5b9e\u73b0\u6dfb\u52a0\u8d2d\u7269\u8f66"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#%E8%AE%A2%E5%8D%95%E6%9C%8D%E5%8A%A1%E6%B7%BB%E5%8A%A0cartservice-%E5%AE%9E%E7%8E%B0%E6%B7%BB%E5%8A%A0%E8%B4%AD%E7%89%A9%E8%BD%A6"},"#"),"\u8ba2\u5355\u670d\u52a1\u6dfb\u52a0cartService\uff0c\u5b9e\u73b0\u6dfb\u52a0\u8d2d\u7269\u8f66"),(0,l.kt)("p",null,"1 service-order\u5de5\u7a0b com.ydles.order.controller"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@RestController\n@RequestMapping("/cart")\npublic class CartController {\n\n    @Autowired\n    private CartService cartService;\n\n    @Autowired\n    private TokenDecode tokenDecode;\n\n    @GetMapping("/addCart")\n    public Result addCart(@RequestParam("skuId") String skuId, @RequestParam("num") Integer num){\n\n        //\u52a8\u6001\u83b7\u53d6\u5f53\u524d\u4eba\u4fe1\u606f,\u6682\u65f6\u9759\u6001\n        String username = "itlils";\n        \n        cartService.addCart(skuId,num,username);\n        return new Result(true, StatusCode.OK,"\u52a0\u5165\u8d2d\u7269\u8f66\u6210\u529f");\n    }\n    \n}\n')),(0,l.kt)("p",null,"redis\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"spring:\n  redis:\n    host: 192.168.200.128\n")),(0,l.kt)("p",null,"\u7f51\u5173\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"           #\u8ba2\u5355\u5fae\u670d\u52a1\n        - id: ydles_order_route\n          uri: lb://order\n          predicates:\n            - Path=/api/cart/**,/api/cart\n          filters:\n            - StripPrefix=1\n")),(0,l.kt)("p",null,"2\u542f\u52a8 service-order\u3001service-good,gateway_web"),(0,l.kt)("p",null,"3\u901a\u8fc7\u7f51\u5173\u8bbf\u95ee\u670d\u52a1 ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/cart/addCart?skuId=1450868238861729792&num=5"},"http://localhost:8001/api/cart/addCart?skuId=1450868238861729792&num=5open in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201104528001-9f482dd0.png",alt:"image-20211201104528001"}),"image-20211201104528001"),(0,l.kt)("p",null,"4redis\u68c0\u67e5"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201104539261-666eecfc.png",alt:"image-20211201104539261"}),"image-20211201104539261"),(0,l.kt)("h3",{id:"24-\u8d2d\u7269\u8f66\u5217\u8868"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-4-%E8%B4%AD%E7%89%A9%E8%BD%A6%E5%88%97%E8%A1%A8"},"#"),"2.4 \u8d2d\u7269\u8f66\u5217\u8868"),(0,l.kt)("p",null,"\u9700\u6c42\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201105212361-8ea00520.png",alt:"image-20211201105212361"}),"image-20211201105212361"),(0,l.kt)("h4",{id:"241-\u601d\u8def\u5206\u6790"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_2-4-1-%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90"},"#"),"2.4.1 \u601d\u8def\u5206\u6790"),(0,l.kt)("p",null,"\u63a5\u7740\u6211\u4eec\u5b9e\u73b0\u4e00\u6b21\u8d2d\u7269\u8f66\u5217\u8868\u64cd\u4f5c\u3002\u56e0\u4e3a\u5b58\u7684\u65f6\u5019\u662f\u6839\u636e\u7528\u6237\u540d\u5f80Redis\u4e2d\u5b58\u50a8\u7528\u6237\u7684\u8d2d\u7269\u8f66\u6570\u636e\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u91cc\u53ef\u4ee5\u5c06\u7528\u6237\u7684\u540d\u5b57\u4f5c\u4e3akey\u53bbRedis\u4e2d\u67e5\u8be2\u5bf9\u5e94\u7684\u6570\u636e\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201105337532-838b8aad.png",alt:"image-20211201105337532"}),"image-20211201105337532"),(0,l.kt)("h4",{id:"342-\u4ee3\u7801\u5b9e\u73b0"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-4-2-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"},"#"),"3.4.2 \u4ee3\u7801\u5b9e\u73b0"),(0,l.kt)("p",null,"1service-order \u8ba2\u5355\u670d\u52a1 com.ydles.order.service.CartService"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"    //\u67e5\u8be2\u8d2d\u7269\u8f66\u6570\u636e\n    Map list(String username);\n")),(0,l.kt)("p",null,"2 \u5b9e\u73b0\u7c7bcom.ydles.order.service.impl.CartServiceImpl \u4e2d\u589e\u52a0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'//\u67e5\u8be2\u8d2d\u7269\u8f66\u5217\u8868\u6570\u636e\n    @Override\n    public Map list(String username) {\n        Map map = new HashMap();\n\n        List<OrderItem> orderItemList = redisTemplate.boundHashOps(CART + username).values();\n        map.put("orderItemList",orderItemList);\n\n        //\u5546\u54c1\u7684\u603b\u6570\u91cf\u4e0e\u603b\u4ef7\u683c\n        Integer totalNum = 0;\n        Integer totalMoney = 0;\n\n        for (OrderItem orderItem : orderItemList) {\n            totalNum+=orderItem.getNum();\n            totalMoney+=orderItem.getMoney();\n        }\n\n        map.put("totalNum",totalNum);\n        map.put("totalMoney",totalMoney);\n\n        return map;\n    }\n')),(0,l.kt)("p",null,"3\u63a7\u5236\u5c42"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'/***\n * \u67e5\u8be2\u7528\u6237\u8d2d\u7269\u8f66\u5217\u8868\n * @return\n*/\n@GetMapping(value = "/list")\npublic Map list(){\n    //\u6682\u65f6\u9759\u6001\uff0c\u540e\u7eed\u4fee\u6539\n    String username = "itcast";\n    return cartService.list(username);\n}\n')),(0,l.kt)("p",null,"4\u6d4b\u8bd5"),(0,l.kt)("p",null,"\u4f7f\u7528Postman\u8bbf\u95ee GET ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/cart/list"},"http://localhost:8001/api/cart/listopen in new window")," ,\u6548\u679c\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201110522115-9cbd17ff.png",alt:"image-20211201110522115"}),"image-20211201110522115"),(0,l.kt)("h2",{id:"3-\u8d2d\u7269\u8f66\u6e32\u67d3"},(0,l.kt)("a",{parentName:"h2",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-%E8%B4%AD%E7%89%A9%E8%BD%A6%E6%B8%B2%E6%9F%93"},"#"),"3 \u8d2d\u7269\u8f66\u6e32\u67d3"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u9700\u6c42"),"\uff1a\u5c55\u73b0\u5982\u4e0b\u9875\u9762"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201105212361-8ea00520.png",alt:"image-20211201105212361"}),"image-20211201105212361"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u601d\u8def\u5206\u6790")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201115148021-0774c4a9.png",alt:"image-20211201115148021"}),"image-20211201115148021"),(0,l.kt)("p",null,"\u5982\u4e0a\u56fe\u6240\u793a,\u7528\u6237\u6bcf\u6b21\u5c06\u5546\u54c1\u52a0\u5165\u8d2d\u7269\u8f66\uff0c\u6216\u8005\u70b9\u51fb\u8d2d\u7269\u8f66\u5217\u8868\u7684\u65f6\u5019\uff0c\u5148\u7ecf\u8fc7\u8ba2\u5355\u8d2d\u7269\u8f66\u540e\u7aef\u6e32\u67d3\u670d\u52a1\uff0c\u518d\u901a\u8fc7feign\u8c03\u7528\u8d2d\u7269\u8f66\u8ba2\u5355\u5fae\u670d\u52a1\u6765\u5b9e\u73b0\u8d2d\u7269\u8f66\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a\u52a0\u5165\u8d2d\u7269\u8f66\u3001\u8d2d\u7269\u8f66\u5217\u8868\u3002"),(0,l.kt)("h3",{id:"31-\u8d2d\u7269\u8f66\u6e32\u67d3\u670d\u52a1\u642d\u5efa"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-1-%E8%B4%AD%E7%89%A9%E8%BD%A6%E6%B8%B2%E6%9F%93%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA"},"#"),"3.1 \u8d2d\u7269\u8f66\u6e32\u67d3\u670d\u52a1\u642d\u5efa"),(0,l.kt)("p",null,"\u5728ydles_web\u4e2d\u642d\u5efa\u8ba2\u5355\u8d2d\u7269\u8f66\u5fae\u670d\u52a1\u5de5\u7a0b",(0,l.kt)("inlineCode",{parentName:"p"},"ydles_web_order"),"\uff0c\u8be5\u5de5\u7a0b\u4e3b\u8981\u5b9e\u73b0\u8d2d\u7269\u8f66\u548c\u8ba2\u5355\u7684\u6e32\u67d3\u64cd\u4f5c\u3002"),(0,l.kt)("p",null,"\u5728ydles_web\u4e2d\u642d\u5efa\u8ba2\u5355\u8d2d\u7269\u8f66\u5fae\u670d\u52a1\u5de5\u7a0b ydles_web_order"),(0,l.kt)("p",null,"(1) pom.xml\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <artifactId>ydles-web</artifactId>\n        <groupId>com.ydles</groupId>\n        <version>1.0-SNAPSHOT</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n    <artifactId>ydles_web_order</artifactId>\n\n    \x3c!--\u4f9d\u8d56--\x3e\n    <dependencies>\n        <dependency>\n            <groupId>com.ydles</groupId>\n            <artifactId>ydles_service_order_api</artifactId>\n            <version>1.0-SNAPSHOT</version>\n        </dependency>\n        <dependency>\n            <groupId>com.ydles</groupId>\n            <artifactId>ydles_common</artifactId>\n            <version>1.0-SNAPSHOT</version>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-thymeleaf</artifactId>\n        </dependency>\n    </dependencies>\n</project>\n')),(0,l.kt)("p",null,"(2)application.yml\u914d\u7f6e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"server:\n  port: 9111\nspring:\n  application:\n    name: order-web\n  main:\n    allow-bean-definition-overriding: true   #\u5f53\u9047\u5230\u540c\u6837\u540d\u5b57\u7684\u65f6\u5019\uff0c\u662f\u5426\u5141\u8bb8\u8986\u76d6\u6ce8\u518c\n  thymeleaf:\n    cache: false\neureka:\n  client:\n    service-url:\n      defaultZone: http://127.0.0.1:6868/eureka\n  instance:\n    prefer-ip-address: true\nfeign:\n  hystrix:\n    enabled: true\n  client:\n    config:\n      default:   #\u914d\u7f6e\u5168\u5c40\u7684feign\u7684\u8c03\u7528\u8d85\u65f6\u65f6\u95f4  \u5982\u679c \u6709\u6307\u5b9a\u7684\u670d\u52a1\u914d\u7f6e \u9ed8\u8ba4\u7684\u914d\u7f6e\u4e0d\u4f1a\u751f\u6548\n        connectTimeout: 60000 # \u6307\u5b9a\u7684\u662f \u6d88\u8d39\u8005 \u8fde\u63a5\u670d\u52a1\u63d0\u4f9b\u8005\u7684\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u662f\u5426\u80fd\u8fde\u63a5  \u5355\u4f4d\u662f\u6beb\u79d2\n        readTimeout: 80000  # \u6307\u5b9a\u7684\u662f\u8c03\u7528\u670d\u52a1\u63d0\u4f9b\u8005\u7684 \u670d\u52a1 \u7684\u8d85\u65f6\u65f6\u95f4\uff08\uff09  \u5355\u4f4d\u662f\u6beb\u79d2\n#hystrix \u914d\u7f6e\nhystrix:\n  command:\n    default:\n      execution:\n        timeout:\n          #\u5982\u679cenabled\u8bbe\u7f6e\u4e3afalse\uff0c\u5219\u8bf7\u6c42\u8d85\u65f6\u4ea4\u7ed9ribbon\u63a7\u5236\n          enabled: true\n        isolation:\n          strategy: SEMAPHORE\n          thread:\n            # \u7194\u65ad\u5668\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba4\uff1a1000/\u6beb\u79d2\n            timeoutInMilliseconds: 80000\n")),(0,l.kt)("p",null,"(3)\u521b\u5efa\u542f\u52a8\u7c7b"),(0,l.kt)("p",null,"\u521b\u5efacom.ydles.OrderWebApplication\u542f\u52a8\u7c7b\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@SpringBootApplication\n@EnableEurekaClient\n@EnableFeignClients(basePackages = "com.ydles.order.feign")\npublic class OrderWebApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(OrderWebApplication.class,args);\n    }\n}\n')),(0,l.kt)("p",null,"(4)\u9759\u6001\u8d44\u6e90\u62f7\u8d1d"),(0,l.kt)("p",null,"\u8d44\u6e90\\\u6210\u54c1\u9875\u9762\\cart.html\u9875\u9762\u62f7\u8d1d\u5230\u5de5\u7a0b\u4e2d\uff0c\u5982\u4e0b\u56fe\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201115740089-30c7b78a.png",alt:"image-20211201115740089"}),"image-20211201115740089"),(0,l.kt)("h3",{id:"32-\u8d2d\u7269\u8f66\u5217\u8868\u6e32\u67d3"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-2-%E8%B4%AD%E7%89%A9%E8%BD%A6%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"},"#"),"3.2 \u8d2d\u7269\u8f66\u5217\u8868\u6e32\u67d3"),(0,l.kt)("h4",{id:"321-feign\u521b\u5efa"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-2-1-feign%E5%88%9B%E5%BB%BA"},"#"),"3.2.1 Feign\u521b\u5efa"),(0,l.kt)("p",null,"1 ydles_service_order_api\u4e2d\u6dfb\u52a0CartFeign\u63a5\u53e3\uff0c\u5e76\u5728\u63a5\u53e3\u4e2d\u521b\u5efa\u6dfb\u52a0\u8d2d\u7269\u8f66\u548c\u67e5\u8be2\u8d2d\u7269\u8f66\u5217\u8868\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@FeignClient(name="order")\npublic interface CartFeign {\n\n    /**\n     * \u6dfb\u52a0\u8d2d\u7269\u8f66\n     * @param skuId\n     * @param num\n     * @return\n     */\n    @GetMapping("/cart/add")\n    public Result add(@RequestParam("skuId") String skuId, @RequestParam("num") Integer num);\n\n    /***\n     * \u67e5\u8be2\u7528\u6237\u8d2d\u7269\u8f66\u5217\u8868\n     * @return\n     */\n    @GetMapping(value = "/cart/list")\n    public Map list();\n}\n')),(0,l.kt)("p",null,"2 \u5bfc\u5305"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"        <dependency>\n            <groupId>com.ydles</groupId>\n            <artifactId>ydles_common</artifactId>\n            <version>1.0-SNAPSHOT</version>\n        </dependency>\n")),(0,l.kt)("p",null,"3controller"),(0,l.kt)("p",null,"\u5728ydles_web_order\u4e2d\u521b\u5efacom.ydles.order.controller.CartController,\u5e76\u6dfb\u52a0\u67e5\u8be2\u8d2d\u7269\u8f66\u96c6\u5408\u65b9\u6cd5\u548c\u6dfb\u52a0\u8d2d\u7269\u8f66\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Controller\n@RequestMapping("/wcart")\npublic class CartController {\n\n  //\u67e5\u8be2\n    @GetMapping("/list")\n    public String list(Model model){\n        Map map = cartFeign.list();\n        model.addAttribute("items",map);\n        return "cart";\n    }\n\n\n    //\u6dfb\u52a0\n    @GetMapping("/add")\n    @ResponseBody\n    public Result<Map> add(String id,Integer num){\n        cartFeign.addCart(id,num);\n        Map map = cartFeign.list();\n        return new Result<>(true, StatusCode.OK,"\u6dfb\u52a0\u8d2d\u7269\u8f66\u6210\u529f",map);\n    }\n\n}\n')),(0,l.kt)("h4",{id:"323-\u524d\u7aef\u9875\u9762"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-2-3-%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2"},"#"),"3.2.3 \u524d\u7aef\u9875\u9762"),(0,l.kt)("p",null,"1\u8d44\u6599\u7684static\u548ctemplate\u653e\u5165resources\u4e0b\u3002"),(0,l.kt)("p",null,"\u6539\u9020\u9759\u6001\u9875\u9762"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'2  <html xmlns:th="http://www.thymeleaf.org">\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'13-14   \n    <link rel="stylesheet" type="text/css" href="/css/all.css" />\n    <link rel="stylesheet" type="text/css" href="/css/pages-cart.css" />\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'86 <div class="cart py-container" id="app">\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'124-128\n                    <li class="yui3-u-1-8">\n                                    <a href="javascript:void(0)" class="increment mins" @click="add(item.skuId,-1)">-</a>\n                                    <input autocomplete="off" type="text" v-model="item.num" @blur="add(item.skuId,item.num)" minnum="1" class="itxt" />\n                                    <a href="javascript:void(0)" class="increment plus" @click="add(item.skuId,1)">+</a>\n                                </li>\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},'362\n<script th:inline="javascript">\n        var app = new Vue({\n            el:"#app",\n            data:{\n                items:[[${items}]]\n            },\n            methods:{\n                add:function (skuId,num) {\n                    axios.get("/api/wcart/add?skuId="+skuId+"&num="+num).then(function (resp) {\n                        if (resp.data.flag){\n                            app.items=resp.data.data;\n                        }\n                    })\n                }\n            }\n        })\n    <\/script>\n')),(0,l.kt)("p",null,"2\u82e5\u60f3\u8bbf\u95ee\u9875\u9762\u6e32\u67d3\u5fae\u670d\u52a1\uff0c\u9700\u4fee\u6539\u7f51\u5173\u914d\u7f6e gateway-web\uff0c\u589e\u52a0\u8def\u7531"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"        #\u8ba2\u5355\u5fae\u670d\u52a1\n        - id: ydles_order_route\n          uri: lb://order\n          predicates:\n            - Path=/api/cart/**,/api/categoryReport/**,/api/orderConfig/**,/api/order/**,/api/orderItem/**,/api/orderLog/**,/api/preferential/**,/api/returnCause/**,/api/returnOrder/**,/api/returnOrderItem/**\n          filters:\n            - StripPrefix=1\n        #\u8d2d\u7269\u8f66\u8ba2\u5355\u6e32\u67d3\u5fae\u670d\u52a1\n        - id: ydles_order_web_route\n          uri: lb://order-web\n          predicates:\n            - Path=/api/wcart/**,/api/worder/**\n          filters:\n            - StripPrefix=1\n")),(0,l.kt)("p",null,"3\u542f\u52a8\u76f8\u5173\u5fae\u670d\u52a1"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201150753038-185c7534.png",alt:"image-20211201150753038"}),"image-20211201150753038"),(0,l.kt)("p",null,"4\u5148\u767b\u9646 ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/oauth/toLogin"},"http://localhost:8001/api/oauth/toLoginopen in new window")," itlils itlils666"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201150837829-3ca2dcd7.png",alt:"image-20211201150837829"}),"image-20211201150837829"),(0,l.kt)("p",null,"\u767b\u9646\u6210\u529f"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201150743386-a00268ad.png",alt:"image-20211201150743386"}),"image-20211201150743386"),(0,l.kt)("p",null,"5 \u901a\u8fc7\u7f51\u5173\u8bbf\u95ee \u8d2d\u7269\u8f66\u9875\u9762 ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/wcart/list"},"http://localhost:8001/api/wcart/listopen in new window")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201154539067-d070de95.png",alt:"image-20211201154539067"}),"image-20211201154539067"),(0,l.kt)("h4",{id:"324-\u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u8ba4\u8bc1\u8bbf\u95ee-\u8d2d\u7269\u8f66\u6e32\u67d3\u670d\u52a1\u8ba2\u5355\u670d\u52a1\u5bf9\u63a5\u7f51\u5173"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-2-4-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B9%8B%E9%97%B4%E7%9A%84%E8%AE%A4%E8%AF%81%E8%AE%BF%E9%97%AE-%E8%B4%AD%E7%89%A9%E8%BD%A6%E6%B8%B2%E6%9F%93%E6%9C%8D%E5%8A%A1%E3%80%81%E8%AE%A2%E5%8D%95%E6%9C%8D%E5%8A%A1%E5%AF%B9%E6%8E%A5%E7%BD%91%E5%85%B3"},"#"),"3.2.4 \u5fae\u670d\u52a1\u4e4b\u95f4\u7684\u8ba4\u8bc1\u8bbf\u95ee \u8d2d\u7269\u8f66\u6e32\u67d3\u670d\u52a1\u3001\u8ba2\u5355\u670d\u52a1\u5bf9\u63a5\u7f51\u5173"),(0,l.kt)("p",null,"1",(0,l.kt)("strong",{parentName:"p"},"\u8ba2\u5355\u670d\u52a1\u5bf9\u63a5oauth")),(0,l.kt)("p",null,"1\u914d\u7f6e\u516c\u94a5"),(0,l.kt)("p",null," \u5c06ydles_user_oauth\u9879\u76ee\u7684public.key\u62f7\u8d1d\u5230ydles_service_order\u9879\u76ee\u7684resource\u76ee\u5f55\u4e0b"),(0,l.kt)("p",null,"2ydles_service_order\u9879\u76ee\u6dfb\u52a0oauth\u4f9d\u8d56"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-oauth2</artifactId>\n</dependency>\n")),(0,l.kt)("p",null,"3ydles_service_order\u9879\u76ee\u6dfb\u52a0\u6dfb\u52a0\u914d\u7f6e\u7c7b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@EnableResourceServer\n//\u5f00\u542f\u65b9\u6cd5\u4e0a\u7684PreAuthorize\u6ce8\u89e3\n@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true)\npublic class ResourceServerConfig extends ResourceServerConfigurerAdapter {\n\n    //\u516c\u94a5\n    private static final String PUBLIC_KEY = "public.key";\n\n    /***\n     * \u5b9a\u4e49JwtTokenStore\n     * @param jwtAccessTokenConverter\n     * @return\n     */\n    @Bean\n    public TokenStore tokenStore(JwtAccessTokenConverter jwtAccessTokenConverter) {\n        return new JwtTokenStore(jwtAccessTokenConverter);\n    }\n\n    /***\n     * \u5b9a\u4e49JJwtAccessTokenConverter\n     * @return\n     */\n    @Bean\n    public JwtAccessTokenConverter jwtAccessTokenConverter() {\n        JwtAccessTokenConverter converter = new JwtAccessTokenConverter();\n        converter.setVerifierKey(getPubKey());\n        return converter;\n    }\n    /**\n     * \u83b7\u53d6\u975e\u5bf9\u79f0\u52a0\u5bc6\u516c\u94a5 Key\n     * @return \u516c\u94a5 Key\n     */\n    private String getPubKey() {\n        Resource resource = new ClassPathResource(PUBLIC_KEY);\n        try {\n            InputStreamReader inputStreamReader = new InputStreamReader(resource.getInputStream());\n            BufferedReader br = new BufferedReader(inputStreamReader);\n            return br.lines().collect(Collectors.joining("\\n"));\n        } catch (IOException ioe) {\n            return null;\n        }\n    }\n\n    /***\n     * Http\u5b89\u5168\u914d\u7f6e\uff0c\u5bf9\u6bcf\u4e2a\u5230\u8fbe\u7cfb\u7edf\u7684http\u8bf7\u6c42\u94fe\u63a5\u8fdb\u884c\u6821\u9a8c\n     * @param http\n     * @throws Exception\n     */\n    @Override\n    public void configure(HttpSecurity http) throws Exception {\n        //\u6240\u6709\u8bf7\u6c42\u5fc5\u987b\u8ba4\u8bc1\u901a\u8fc7\n        http.authorizeRequests()\n                .anyRequest().\n                authenticated();    //\u5176\u4ed6\u5730\u5740\u9700\u8981\u8ba4\u8bc1\u6388\u6743\n    }\n}\n')),(0,l.kt)("h3",{id:"33-\u5fae\u670d\u52a1\u95f4\u8ba4\u8bc1-\u9762\u8bd5\u91cd\u70b9"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-3-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%97%B4%E8%AE%A4%E8%AF%81-%E9%9D%A2%E8%AF%95%E9%87%8D%E7%82%B9"},"#"),"3.3 \u5fae\u670d\u52a1\u95f4\u8ba4\u8bc1-\u9762\u8bd5\u91cd\u70b9"),(0,l.kt)("p",null,"\u56e0\u4e3a\u5fae\u670d\u52a1\u4e4b\u95f4\u5e76\u6ca1\u6709\u4f20\u9012\u5934\u6587\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u62e6\u622a\u5668\uff0c\u6bcf\u6b21\u5fae\u670d\u52a1\u8c03\u7528\u4e4b\u524d\u90fd\u5148\u68c0\u67e5\u4e0b\u5934\u6587\u4ef6\uff0c\u5c06\u8bf7\u6c42\u7684\u5934\u6587\u4ef6\u4e2d\u7684\u4ee4\u724c\u6570\u636e\u518d\u653e\u5165\u5230header\u4e2d\uff0c\u518d\u8c03\u7528\u5176\u4ed6\u5fae\u670d\u52a1\u5373\u53ef\u3002"),(0,l.kt)("p",null,"\u6d4b\u8bd5\u8bbf\u95ee\u8d2d\u7269\u8f66\uff0c\u4ea7\u751f\u5982\u4e0b\u6548\u679c\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201155307611-35356bd5.png",alt:"image-20211201155307611"}),"image-20211201155307611"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201155318108-c56c5d1d.png",alt:"image-20211201155318108"}),"image-20211201155318108"),(0,l.kt)("p",null,"feign\u62e6\u622a\u5668\u5b9e\u73b0\u5fae\u670d\u52a1\u95f4\u8ba4\u8bc1"),(0,l.kt)("p",null,"1\u521b\u5efa\u62e6\u622a\u5668"),(0,l.kt)("p",null,"\u5728ydles_common\u670d\u52a1\u4e2d\u521b\u5efa\u4e00\u4e2acom.ydles.interceptor.FeignInterceptor\u62e6\u622a\u5668\uff0c\u5e76\u5c06\u6240\u6709\u5934\u6587\u4ef6\u6570\u636e\u518d\u6b21\u52a0\u5165\u5230Feign\u8bf7\u6c42\u7684\u5fae\u670d\u52a1\u5934\u6587\u4ef6\u4e2d\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydles.interceptor;\n\nimport feign.RequestInterceptor;\nimport feign.RequestTemplate;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.context.request.RequestAttributes;\nimport org.springframework.web.context.request.RequestContextHolder;\nimport org.springframework.web.context.request.ServletRequestAttributes;\n\nimport javax.servlet.http.HttpServletRequest;\nimport java.util.Enumeration;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201cIT\u674e\u54e5\u4ea4\u670b\u53cb\u201d\n * \u4e2a\u4eba\u5fae itlils\n * feign\u62e6\u622a\u5668    \u53ea\u8981feign\u8fdc\u7a0b\u8c03\u7528\uff0c\u4f5c\u7528\uff1a\u628a\u4e0a\u4e00\u6b21\u8bf7\u6c42\u5934jwt\u5e26\u5230\u8fd9\u4e00\u6b21\u8bf7\u6c42\u4e2d\n */\n@Component\npublic class FeignInterceptor implements RequestInterceptor {\n\n    @Override\n    public void apply(RequestTemplate requestTemplate) {\n        //1\u62ff\u5230\u4e0a\u4e00\u5c42\u8bf7\u6c42\u5934\u4e2d\u7684jwt\n        //\u8fd9\u4e00\u6b21\u6574\u4f53\u8bf7\u6c42\n        RequestAttributes requestAttributes = RequestContextHolder.getRequestAttributes();\n        if(requestAttributes!=null){\n            //\u62ff\u5230\u6211\u4eec\u5e38\u7528\u7684\u8fd9\u4e2a\u8bf7\u6c42\n            HttpServletRequest request = ((ServletRequestAttributes) requestAttributes).getRequest();\n            if(request!=null){\n                //\u8bf7\u6240\u6709\u7684\u6c42\u5934\n                Enumeration<String> headerNames = request.getHeaderNames();\n                //\u904d\u5386\n                while (headerNames.hasMoreElements()){\n                    String headName = headerNames.nextElement();\n                    if(headName.equalsIgnoreCase("Authorization")){\n                        String jwt = request.getHeader(headName);//Bearer jwt\n                        //2jwt \u5e26\u5230\u8fd9\u4e00\u6b21 feign\u8c03\u7528\u4e2d\n                        requestTemplate.header(headName,jwt);\n                    }\n                }\n            }\n\n        }\n\n\n\n\n    }\n}\n')),(0,l.kt)("p",null,"2 \u66f4\u6539ydles_order_web\u542f\u52a8\u7c7b\uff0c\u6dfb\u52a0\u62e6\u622a\u5668\u58f0\u660e"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@Bean\npublic FeignInterceptor feignInterceptor(){\n    return new FeignInterceptor();\n}\n")),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a\u901a\u8fc7\u7f51\u5173\u8bbf\u95ee \u8d2d\u7269\u8f66\u9875\u9762 ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/wcart/list"},"http://localhost:8001/api/wcart/listopen in new window")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u91cd\u70b9\u7406\u89e3"),"\uff1a\u8c01\u7528feign\uff0c\u62e6\u622a\u5668\u5c31\u653e\u5728\u8c01\u542f\u52a8\u7c7b\u91cc\u3002"),(0,l.kt)("h3",{id:"34-\u52a8\u6001\u83b7\u53d6\u5f53\u524d\u767b\u9646\u4eba"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-4-%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%99%BB%E9%99%86%E4%BA%BA"},"#"),"3.4 \u52a8\u6001\u83b7\u53d6\u5f53\u524d\u767b\u9646\u4eba"),(0,l.kt)("p",null,"1\u6dfb\u52a0\u8d44\u6e90\u4e2d\u7684TokenDecode\u5de5\u5177\u7c7b\u5230ydles-service-order\u5fae\u670d\u52a1config\u5305\u4e0b\uff0c\u7528\u4e8e\u89e3\u5bc6\u4ee4\u724c\u4fe1\u606f"),(0,l.kt)("p",null,"2\u5728ydles-common\u5de5\u7a0b\u4e2d\u5f15\u5165\u9274\u6743\u5305"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!--\u9274\u6743--\x3e\n<dependency>\n    <groupId>io.jsonwebtoken</groupId>\n    <artifactId>jjwt</artifactId>\n    <version>0.9.0</version>\n    <scope>provided</scope>\n</dependency>\n")),(0,l.kt)("p",null,"3order \u670d\u52a1\u589e\u52a0bean\u5bf9\u8c61"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"@Bean\npublic TokenDecode tokenDecode() {\n    return new TokenDecode();\n}\n")),(0,l.kt)("p",null,"4\u5728CartController\u4e2d\u6ce8\u5165TokenDecode\uff0c\u5e76\u8c03\u7528TokenDecode\u7684getUserInfo\u65b9\u6cd5\u83b7\u53d6\u7528\u6237\u4fe1\u606f\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'    @Autowired\n    private TokenDecode tokenDecode;\n\n    @GetMapping("/addCart")\n    public Result addCart(@RequestParam("skuId") String skuId, @RequestParam("num") Integer num){\n\n        //\u52a8\u6001\u83b7\u53d6\u5f53\u524d\u4eba\u4fe1\u606f,\u6682\u65f6\u9759\u6001\n        String username = "itcast";\n        // String username = tokenDecode.getUserInfo().get("username");\n        cartService.addCart(skuId,num,username);\n        return new Result(true, StatusCode.OK,"\u52a0\u5165\u8d2d\u7269\u8f66\u6210\u529f");\n    }\n\n    @GetMapping("/list")\n    public Map list(){\n        //\u52a8\u6001\u83b7\u53d6\u5f53\u524d\u4eba\u4fe1\u606f,\u6682\u65f6\u9759\u6001\n        String username = "itcast";\n        // String username = tokenDecode.getUserInfo().get("username");\n        Map map = cartService.list(username);\n        return map;\n    }\n')),(0,l.kt)("h3",{id:"35-\u9875\u9762\u914d\u7f6e"},(0,l.kt)("a",{parentName:"h3",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-5-%E9%A1%B5%E9%9D%A2%E9%85%8D%E7%BD%AE"},"#"),"3.5 \u9875\u9762\u914d\u7f6e"),(0,l.kt)("h4",{id:"351-\u672a\u767b\u5f55\u65f6\u767b\u5f55\u8df3\u8f6c"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-5-1-%E6%9C%AA%E7%99%BB%E5%BD%95%E6%97%B6%E7%99%BB%E5%BD%95%E8%B7%B3%E8%BD%AC"},"#"),"3.5.1 \u672a\u767b\u5f55\u65f6\u767b\u5f55\u8df3\u8f6c"),(0,l.kt)("p",null,"\u5728\u7528\u6237\u6ca1\u6709\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\uff0c\u76f4\u63a5\u8bbf\u95ee\u8d2d\u7269\u8f66\u9875\u9762\uff0c\u6548\u679c\u5982\u4e0b\uff1a"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201162900005-51e75c1c.png",alt:"image-20211201162900005"}),"image-20211201162900005"),(0,l.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd4\u56de\u7684\u53ea\u662f\u4e2a\u9519\u8bef\u72b6\u6001\u7801\uff0c\u8fd9\u4e2a\u6beb\u65e0\u610f\u4e49\uff0c\u6211\u4eec\u5e94\u8be5\u91cd\u5b9a\u5411\u5230\u767b\u5f55\u9875\u9762\uff0c\u8ba9\u7528\u6237\u767b\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\u7f51\u5173\u7684\u5934\u6587\u4ef6\uff0c\u8ba9\u7528\u6237\u6bcf\u6b21\u6ca1\u767b\u5f55\u7684\u65f6\u5019\uff0c\u90fd\u8df3\u8f6c\u5230\u767b\u5f55\u9875\u9762\u3002"),(0,l.kt)("p",null,"\u4fee\u6539ydles-gateway-web\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"com.ydles.filter.AuthFilter"),"\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Component\npublic class AuthFilter implements GlobalFilter, Ordered {\n\n    public static final String Authorization = "Authorization";\n\n    //\u767b\u5f55\u5730\u5740\n    public static final String LOGIN_URL = "http://localhost:8001/api/oauth/toLogin";\n\n    @Autowired\n    private AuthService authService;\n\n    @Override\n    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n        //\u83b7\u53d6\u5f53\u524d\u8bf7\u6c42\u5bf9\u8c61\n        ServerHttpRequest request = exchange.getRequest();\n        ServerHttpResponse response = exchange.getResponse();\n\n        String path = request.getURI().getPath();\n        if ("/api/oauth/login".equals(path) || !UrlFilter.hasAuthorize(path)){\n            //\u653e\u884c\n            return chain.filter(exchange);\n        }\n\n        //\u5224\u65adcookie\u4e0a\u662f\u5426\u5b58\u5728jti\u4e5f\u5c31\u662f\u77ed\u4ee4\u724c\n        String jti = authService.getJtiFromCookie(request);\n        if (StringUtils.isEmpty(jti)){\n            //\u62d2\u7edd\u8bbf\u95ee,\u8bf7\u6c42\u8df3\u8f6c\n//            response.setStatusCode(HttpStatus.UNAUTHORIZED);\n//            return response.setComplete();\n            return this.toLoginPage(LOGIN_URL, exchange);\n        }\n\n        //\u6839\u636e\u77ed\u4ee4\u724c\u83b7\u53d6\u957f\u4ee4\u724c, \u5e76\u4e14\u5224\u65ad\u662f\u5426\u6709\u957f\u4ee4\u724c\n        String token = authService.getTokenFromRedis(jti);\n        if (StringUtils.isEmpty(token)){\n            //\u62d2\u7edd\u8bbf\u95ee\uff0c\u8bf7\u6c42\u8df3\u8f6c\n//            response.setStatusCode(HttpStatus.UNAUTHORIZED);\n//            return response.setComplete();\n            return this.toLoginPage(LOGIN_URL, exchange);\n        }\n\n        //\u6821\u9a8c\u901a\u8fc7 , \u8bf7\u6c42\u5934\u589e\u5f3a\uff0c\u653e\u884c(\u5c06\u957f\u4ee4\u724c\u653e\u5165\u8bf7\u6c42\u5934)\n        request.mutate().header(Authorization,"Bearer "+token);\n        return chain.filter(exchange);\n    }\n\n    /**\n     * \u8df3\u8f6c\u5230\u767b\u5f55\u9875\u9762\n     * @param loginUrl  \u8df3\u8f6c\u7684\u5730\u5740\n     * @return\n     */\n    private Mono<Void> toLoginPage(String loginUrl, ServerWebExchange exchange) {\n        ServerHttpResponse response = exchange.getResponse();\n        response.setStatusCode(HttpStatus.SEE_OTHER);\n        response.getHeaders().set("Location", loginUrl);\n        return response.setComplete();\n    }\n\n    @Override\n    public int getOrder() {\n        return 0;\n    }\n}\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a\u8bbf\u95ee\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/wcart/list"},"http://localhost:8001/api/wcart/listopen in new window")),(0,l.kt)("p",null,"\u62d3\u5c55\uff1a"),(0,l.kt)("p",null,"http code"),(0,l.kt)("p",null,"2 200 201 \u8bf7\u6c42\u6ca1\u95ee\u9898"),(0,l.kt)("p",null,"3 303 \u8bf7\u6c42\u6ca1\u95ee\u9898\uff0c\u4f46\u662f\u9700\u8981\u5ba2\u6237\u7aef\u5f80\u5916\u505a\u4e00\u4e9b\u4e1c\u897f"),(0,l.kt)("p",null,"4 404 \u5ba2\u6237\u7aef\u7684\u95ee\u9898"),(0,l.kt)("p",null,"5 \u670d\u52a1\u5668\u7aef\u6709\u95ee\u9898\u4e86"),(0,l.kt)("h4",{id:"352-\u767b\u5f55\u6210\u529f\u8df3\u8f6c\u539f\u5730\u5740"},(0,l.kt)("a",{parentName:"h4",href:"https://www.ydlclass.com/doc21xnv/java/fifth/2%E3%80%81%E4%BA%8C%E5%A5%A2%E4%BA%A4%E6%98%93/02/#_3-5-2-%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F%E8%B7%B3%E8%BD%AC%E5%8E%9F%E5%9C%B0%E5%9D%80"},"#"),"3.5.2 \u767b\u5f55\u6210\u529f\u8df3\u8f6c\u539f\u5730\u5740"),(0,l.kt)("p",null,"\u521a\u624d\u5df2\u7ecf\u5b9e\u73b0\u4e86\u672a\u767b\u5f55\u65f6\u8df3\u8f6c\u767b\u5f55\u9875\uff0c\u4f46\u662f\u5f53\u767b\u5f55\u6210\u529f\u540e\uff0c\u5e76\u6ca1\u6709\u8df3\u8f6c\u5230\u7528\u6237\u672c\u6765\u8981\u8bbf\u95ee\u7684\u9875\u9762\u3002"),(0,l.kt)("p",null,"\u8981\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd\u7684\u8bdd\uff0c\u53ef\u4ee5\u5c06\u7528\u6237\u8981\u8bbf\u95ee\u7684\u9875\u9762\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u5230\u767b\u5f55\u63a7\u5236\u5668\uff0c\u7531\u767b\u5f55\u63a7\u5236\u5668\u6839\u636e\u53c2\u6570\u5b8c\u6210\u8def\u5f84\u8df3\u8f6c\u3002"),(0,l.kt)("p",null,"2.1\u4fee\u6539\u7f51\u5173\u643a\u5e26\u5f53\u524d\u8bbf\u95eeURI"),(0,l.kt)("p",null,"\u4fee\u6539ydles-gateway-web\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"com.ydles.filter.AuthFilter"),"\uff0c\u5728\u4e4b\u524d\u7684URL\u540e\u9762\u6dfb\u52a0ReturnUrl\u53c2\u6570\u4ee5\u53caReturnUrl\u53c2\u6570\u7684\u503c\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"request.getURI()"),"\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@Override\npublic Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n    //\u83b7\u53d6\u5f53\u524d\u8bf7\u6c42\u5bf9\u8c61\n    ServerHttpRequest request = exchange.getRequest();\n    ServerHttpResponse response = exchange.getResponse();\n\n    String path = request.getURI().getPath();\n    if ("/api/oauth/login".equals(path) || !UrlFilter.hasAuthorize(path)){\n        //\u653e\u884c\n        return chain.filter(exchange);\n    }\n\n    //\u5224\u65adcookie\u4e0a\u662f\u5426\u5b58\u5728jti\u4e5f\u5c31\u662f\u77ed\u4ee4\u724c\n    String jti = authService.getJtiFromCookie(request);\n    if (StringUtils.isEmpty(jti)){\n        //\u62d2\u7edd\u8bbf\u95ee,\u8bf7\u6c42\u8df3\u8f6c\n        //            response.setStatusCode(HttpStatus.UNAUTHORIZED);\n        //            return response.setComplete();\n        return this.toLoginPage(LOGIN_URL + "?FROM=" + request.getURI(), exchange);\n    }\n\n    //\u6839\u636e\u77ed\u4ee4\u724c\u83b7\u53d6\u957f\u4ee4\u724c, \u5e76\u4e14\u5224\u65ad\u662f\u5426\u6709\u957f\u4ee4\u724c\n    String token = authService.getTokenFromRedis(jti);\n    if (StringUtils.isEmpty(token)){\n        //\u62d2\u7edd\u8bbf\u95ee\uff0c\u8bf7\u6c42\u8df3\u8f6c\n        //            response.setStatusCode(HttpStatus.UNAUTHORIZED);\n        //            return response.setComplete();\n        return this.toLoginPage(LOGIN_URL + "?FROM=" + request.getURI(), exchange);\n    }\n    \n    //........\u7565\n')),(0,l.kt)("p",null,"2.2 \u767b\u5f55\u63a7\u5236\u5668\u83b7\u53d6\u53c2\u6570"),(0,l.kt)("p",null,"\u4fee\u6539ydles-user-oauth\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"com.ydles.oauth.controller.AuthController"),"\u8bb0\u5f55\u8bbf\u95ee\u6765\u6e90\u9875\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("/toLogin")\npublic String toLogin(@RequestParam(value = "FROM", required = false, defaultValue = "") String from, Model model) throws Exception{\n     model.addAttribute("from",from);\n     return "login";\n}\n')),(0,l.kt)("p",null,"2.3\u4fee\u6539\u767b\u9646\u9875\u9762 login.html"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-html"},'167 <script th:inline="javascript">\n    var app = new Vue({\n        el:"#app",\n        data:{\n            username:"",\n            password:"",\n            msg:"",\n            from:[[${from}]]\n        },\n        methods:{\n            login:function () {\n                app.msg="\u6b63\u5728\u767b\u5f55";\n                axios.post("/api/oauth/login?username="+app.username+"&password="+app.password).then(function (response) {\n                    if (response.data.flag){\n                        app.msg="\u767b\u5f55\u6210\u529f";\n                        //\u8df3\u8f6c\u539f\u5730\u5740\n                        location.href=app.from;\n                    } else{\n                        app.msg="\u767b\u5f55\u5931\u8d25";\n                    }\n                })\n            }\n        }\n    })\n<\/script>\n')),(0,l.kt)("p",null,"\u6d4b\u8bd5\uff1a\u8bbf\u95ee\uff1a",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8001/api/wcart/list"},"http://localhost:8001/api/wcart/listopen in new window")),(0,l.kt)("p",null,"\u603b\u7ed3\uff1a"),(0,l.kt)("p",null,"1\u9274\u6743"),(0,l.kt)("p",null," 5\u5f20\u8868\u6a21\u578b"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201170435457-3a99886b.png",alt:"image-20211201170435457"}),"image-20211201170435457"),(0,l.kt)("p",null,"oauth2"),(0,l.kt)("p",null,"\u67e5\u8be2\u7528\u6237 \u6743\u9650\u5b57\u7b26\u4e32\u62fc\u51fa\u6765"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201170504113-9151d8b8.png",alt:"image-20211201170504113"}),"image-20211201170504113"),(0,l.kt)("p",null," \u540e\u7aef\u5fae\u670d\u52a1 controll\u5c42"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"@PreAuthorize(\"hasAnyAuthority('seckill_list','user_list')\")\n")),(0,l.kt)("p",null,"2\u8d2d\u7269\u8f66\u6a21\u5757"),(0,l.kt)("p",null,"2.1\u6dfb\u52a0"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201093507350-796a58ae.png",alt:"image-20211201093507350"}),"image-20211201093507350"),(0,l.kt)("p",null," 2.2\u67e5\u8be2"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201105337532-838b8aad.png",alt:"image-20211201105337532"}),"image-20211201105337532"),(0,l.kt)("p",null,"3\u8d2d\u7269\u8f66\u9875\u9762\u6e32\u67d3"),(0,l.kt)("p",null," \u8d2d\u7269\u8f66\u9875\u9762\u6e32\u67d3\u5fae\u670d\u52a1\u642d\u5efa"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201115148021-0774c4a9.png",alt:"image-20211201115148021"}),"image-20211201115148021"),(0,l.kt)("p",null," \u5fae\u670d\u52a1\u8ba4\u8bc1"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20211201170927459-c31a0c08.png",alt:"image-20211201170927459"}),"image-20211201170927459"),(0,l.kt)("p",null," \u52a8\u6001\u83b7\u53d6\u5f53\u524d\u767b\u5f55\u4eba"),(0,l.kt)("p",null," tokenDecode"),(0,l.kt)("p",null,"\u9875\u9762\u914d\u7f6e"),(0,l.kt)("p",null," \u672a\u767b\u5f55--------\u300b\u767b\u9646\u9875\u9762"),(0,l.kt)("p",null," \u4f18\u5316\uff1a\u672a\u767b\u5f55--------\u300b\u767b\u9646\u9875\u9762-----\u300b\u8df3\u56de\u5230\u8d2d\u7269\u8f66"))}u.isMDXComponent=!0}}]);