"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[911],{3905:(n,e,t)=>{t.d(e,{Zo:()=>p,kt:()=>g});var a=t(7294);function r(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function l(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,a)}return t}function i(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?l(Object(t),!0).forEach((function(e){r(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function o(n,e){if(null==n)return{};var t,a,r=function(n,e){if(null==n)return{};var t,a,r={},l=Object.keys(n);for(a=0;a<l.length;a++)t=l[a],e.indexOf(t)>=0||(r[t]=n[t]);return r}(n,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);for(a=0;a<l.length;a++)t=l[a],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}var s=a.createContext({}),c=function(n){var e=a.useContext(s),t=e;return n&&(t="function"==typeof n?n(e):i(i({},e),n)),t},p=function(n){var e=c(n.components);return a.createElement(s.Provider,{value:e},n.children)},u="mdxType",m={inlineCode:"code",wrapper:function(n){var e=n.children;return a.createElement(a.Fragment,{},e)}},b=a.forwardRef((function(n,e){var t=n.components,r=n.mdxType,l=n.originalType,s=n.parentName,p=o(n,["components","mdxType","originalType","parentName"]),u=c(t),b=r,g=u["".concat(s,".").concat(b)]||u[b]||m[b]||l;return t?a.createElement(g,i(i({ref:e},p),{},{components:t})):a.createElement(g,i({ref:e},p))}));function g(n,e){var t=arguments,r=e&&e.mdxType;if("string"==typeof n||r){var l=t.length,i=new Array(l);i[0]=b;var o={};for(var s in e)hasOwnProperty.call(e,s)&&(o[s]=e[s]);o.originalType=n,o[u]="string"==typeof n?n:r,i[1]=o;for(var c=2;c<l;c++)i[c]=t[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}b.displayName="MDXCreateElement"},3419:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>o,toc:()=>c});var a=t(7462),r=(t(7294),t(3905));const l={},i="3.1 RabbitMQ\u5165\u95e8",o={unversionedId:"Java/\u4e2d\u95f4\u4ef6/3.1 RabbitMQ\u5165\u95e8",id:"Java/\u4e2d\u95f4\u4ef6/3.1 RabbitMQ\u5165\u95e8",title:"3.1 RabbitMQ\u5165\u95e8",description:"\u5b66\u4e60\u76ee\u6807",source:"@site/docs/Java/7.\u4e2d\u95f4\u4ef6/3.1 RabbitMQ\u5165\u95e8.md",sourceDirName:"Java/7.\u4e2d\u95f4\u4ef6",slug:"/Java/\u4e2d\u95f4\u4ef6/3.1 RabbitMQ\u5165\u95e8",permalink:"/docs/Java/\u4e2d\u95f4\u4ef6/3.1 RabbitMQ\u5165\u95e8",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Java/7.\u4e2d\u95f4\u4ef6/3.1 RabbitMQ\u5165\u95e8.md",tags:[],version:"current",frontMatter:{},sidebar:"Java",previous:{title:"2.2 ELK\u8fdb\u9636",permalink:"/docs/Java/\u4e2d\u95f4\u4ef6/2.2 ELK\u8fdb\u9636"},next:{title:"3.2 RocketMQ\u57fa\u7840\u7bc7",permalink:"/docs/Java/\u4e2d\u95f4\u4ef6/3.2 RocketMQ\u57fa\u7840\u7bc7"}},s={},c=[{value:"\u7b2c\u4e00\u7ae0 \u6d88\u606f\u4e2d\u95f4\u4ef6\u6982\u8ff0-\u4e86\u89e3",id:"\u7b2c\u4e00\u7ae0-\u6d88\u606f\u4e2d\u95f4\u4ef6\u6982\u8ff0-\u4e86\u89e3",level:2},{value:"1\u3001 \u4ec0\u4e48\u662f\u6d88\u606f\u4e2d\u95f4\u4ef6",id:"1-\u4ec0\u4e48\u662f\u6d88\u606f\u4e2d\u95f4\u4ef6",level:3},{value:"\uff081\uff09MQ\u662f\u4ec0\u4e48",id:"1mq\u662f\u4ec0\u4e48",level:4},{value:"\uff082\uff09\u4e3a\u4ec0\u4e48\u4f7f\u7528MQ--\u9762\u8bd5",id:"2\u4e3a\u4ec0\u4e48\u4f7f\u7528mq--\u9762\u8bd5",level:4},{value:"<strong>\uff083\uff09MQ\u4f18\u52bf</strong>",id:"3mq\u4f18\u52bf",level:4},{value:"a\u3001<strong>\u5e94\u7528\u89e3\u8026</strong>",id:"a\u5e94\u7528\u89e3\u8026",level:5},{value:"b\u3001<strong>\u5f02\u6b65\u63d0\u901f</strong>",id:"b\u5f02\u6b65\u63d0\u901f",level:5},{value:"c\u3001<strong>\u524a\u5cf0\u586b\u8c37</strong>",id:"c\u524a\u5cf0\u586b\u8c37",level:5},{value:"\uff084\uff09<strong>MQ\u52a3\u52bf</strong>",id:"4mq\u52a3\u52bf",level:4},{value:"\uff085\uff09\u4ec0\u4e48\u65f6\u5019\u7528MQ",id:"5\u4ec0\u4e48\u65f6\u5019\u7528mq",level:4},{value:"2\u3001AMQP \u548c JMS",id:"2amqp-\u548c-jms",level:3},{value:"\uff081\uff09AMQP",id:"1amqp",level:4},{value:"\uff082\uff09JMS",id:"2jms",level:4},{value:"\uff083\uff09AMQP \u4e0e JMS \u533a\u522b",id:"3amqp-\u4e0e-jms-\u533a\u522b",level:4},{value:"3\u3001\u6d88\u606f\u961f\u5217\u4ea7\u54c1",id:"3\u6d88\u606f\u961f\u5217\u4ea7\u54c1",level:3},{value:"4\u3001 RabbitMQ",id:"4-rabbitmq",level:3},{value:"\uff081\uff09RabbitMQ<strong>\u7279\u70b9</strong>\uff1a",id:"1rabbitmq\u7279\u70b9",level:4},{value:"\uff082\uff09\u5176\u5b83\u76f8\u5173\u672f\u8bed",id:"2\u5176\u5b83\u76f8\u5173\u672f\u8bed",level:4},{value:"\uff083\uff09\u5de5\u4f5c\u6a21\u5f0f",id:"3\u5de5\u4f5c\u6a21\u5f0f",level:4},{value:"\u7b2c\u4e8c\u7ae0 RabbitMQ\u5de5\u4f5c\u539f\u7406--\u91cd\u70b9\uff01",id:"\u7b2c\u4e8c\u7ae0-rabbitmq\u5de5\u4f5c\u539f\u7406--\u91cd\u70b9",level:2},{value:"1\u3001\u76f8\u5173\u6982\u5ff5\u4ecb\u7ecd",id:"1\u76f8\u5173\u6982\u5ff5\u4ecb\u7ecd",level:3},{value:"2\u3001RabbitMQ\u8fd0\u8f6c\u6d41\u7a0b",id:"2rabbitmq\u8fd0\u8f6c\u6d41\u7a0b",level:3},{value:"3\u3001\u751f\u4ea7\u8005\u6d41\u8f6c\u8fc7\u7a0b\u8bf4\u660e",id:"3\u751f\u4ea7\u8005\u6d41\u8f6c\u8fc7\u7a0b\u8bf4\u660e",level:3},{value:"4\u3001\u6d88\u8d39\u8005\u6d41\u8f6c\u8fc7\u7a0b\u8bf4\u660e",id:"4\u6d88\u8d39\u8005\u6d41\u8f6c\u8fc7\u7a0b\u8bf4\u660e",level:3},{value:"\u7b2c\u4e09\u7ae0 \u5b89\u88c5\u53ca\u914d\u7f6eRabbitMQ",id:"\u7b2c\u4e09\u7ae0-\u5b89\u88c5\u53ca\u914d\u7f6erabbitmq",level:2},{value:"1\u3001\u4e0b\u8f7d\u5b89\u88c5",id:"1\u4e0b\u8f7d\u5b89\u88c5",level:3},{value:"2\u3001\u4e0b\u8f7derlang",id:"2\u4e0b\u8f7derlang",level:3},{value:"3\u3001\u5b89\u88c5RabbitMQ",id:"3\u5b89\u88c5rabbitmq",level:3},{value:"4\u3001\u542f\u52a8",id:"4\u542f\u52a8",level:3},{value:"5\u3001\u542f\u52a8\u6210\u529f \u767b\u5f55RabbitMQ",id:"5\u542f\u52a8\u6210\u529f-\u767b\u5f55rabbitmq",level:3},{value:"6\u3001\u6ce8\u610f\u4e8b\u9879",id:"6\u6ce8\u610f\u4e8b\u9879",level:3},{value:"7\u3001\u67e5\u770b\u7ba1\u7406\u63a7\u5236\u53f0",id:"7\u67e5\u770b\u7ba1\u7406\u63a7\u5236\u53f0",level:3},{value:"\u7b2c\u56db\u7ae0 RabbitMQ\u5165\u95e8",id:"\u7b2c\u56db\u7ae0-rabbitmq\u5165\u95e8",level:2},{value:"1\u3001\u642d\u5efa\u793a\u4f8b\u5de5\u7a0b",id:"1\u642d\u5efa\u793a\u4f8b\u5de5\u7a0b",level:3},{value:"\uff081\uff09\u521b\u5efa\u5de5\u7a0b",id:"1\u521b\u5efa\u5de5\u7a0b",level:4},{value:"\uff082\uff09\u6dfb\u52a0\u4f9d\u8d56",id:"2\u6dfb\u52a0\u4f9d\u8d56",level:4},{value:"2\u3001 \u7f16\u5199\u751f\u4ea7\u8005",id:"2-\u7f16\u5199\u751f\u4ea7\u8005",level:3},{value:"3\u3001 \u7f16\u5199\u6d88\u8d39\u8005",id:"3-\u7f16\u5199\u6d88\u8d39\u8005",level:3},{value:"4\u3001\u5c0f\u7ed3",id:"4\u5c0f\u7ed3",level:3},{value:"\u7b2c\u4e94\u7ae0 RabbitMQ\u5de5\u4f5c\u6a21\u5f0f--\u91cd\u70b9",id:"\u7b2c\u4e94\u7ae0-rabbitmq\u5de5\u4f5c\u6a21\u5f0f--\u91cd\u70b9",level:2},{value:"1\u3001Work queues\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f\uff08\u5305\u5de5\u5934\uff09",id:"1work-queues\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f\u5305\u5de5\u5934",level:3},{value:"\uff081\uff09 \u6a21\u5f0f\u8bf4\u660e",id:"1-\u6a21\u5f0f\u8bf4\u660e",level:4},{value:"\uff082\uff09\u4ee3\u7801",id:"2\u4ee3\u7801",level:4},{value:"a\u3001\u751f\u4ea7\u8005 \u4fee\u6539\u961f\u5217\u540d",id:"a\u751f\u4ea7\u8005-\u4fee\u6539\u961f\u5217\u540d",level:5},{value:"b\u3001\u6d88\u8d39\u80051 \u76d1\u542c\u540c\u4e00\u4e2a\u961f\u5217",id:"b\u6d88\u8d39\u80051-\u76d1\u542c\u540c\u4e00\u4e2a\u961f\u5217",level:5},{value:"c\u3001\u6d88\u8d39\u80052 \u6d88\u8d39\u8005\u518d\u8d77\u4e00\u4efd",id:"c\u6d88\u8d39\u80052-\u6d88\u8d39\u8005\u518d\u8d77\u4e00\u4efd",level:5},{value:"\uff083\uff09\u6d4b\u8bd5",id:"3\u6d4b\u8bd5",level:3},{value:"2\u3001publish/subscribe \u8ba2\u9605\u53d1\u5e03\u6a21\u5f0f\u7c7b\u578b\uff08\u5fae\u535a\uff09",id:"2publishsubscribe-\u8ba2\u9605\u53d1\u5e03\u6a21\u5f0f\u7c7b\u578b\u5fae\u535a",level:3},{value:"3\u3001 Publish/Subscribe\u53d1\u5e03\u4e0e\u8ba2\u9605\u6a21\u5f0f\uff08\u5fae\u535a\uff09",id:"3-publishsubscribe\u53d1\u5e03\u4e0e\u8ba2\u9605\u6a21\u5f0f\u5fae\u535a",level:3},{value:"\uff08 1\uff09\u6a21\u5f0f\u8bf4\u660e",id:"-1\u6a21\u5f0f\u8bf4\u660e",level:4},{value:"\uff082\uff09\u4ee3\u7801",id:"2\u4ee3\u7801-1",level:4},{value:"a\u3001\u751f\u4ea7\u8005",id:"a\u751f\u4ea7\u8005",level:5},{value:"b\u3001\u6d88\u8d39\u80051",id:"b\u6d88\u8d39\u80051",level:5},{value:"c\u3001\u6d88\u8d39\u80052",id:"c\u6d88\u8d39\u80052",level:5},{value:"\uff083\uff09 \u6d4b\u8bd5",id:"3-\u6d4b\u8bd5",level:4},{value:"\uff084\uff09\u5c0f\u7ed3",id:"4\u5c0f\u7ed3-1",level:4},{value:"4\u3001Routing\u8def\u7531\u6a21\u5f0f\uff08\u5206\u5e03\u5f0f\u65e5\u5fd7\u6536\u96c6\u7cfb\u7edf\uff09",id:"4routing\u8def\u7531\u6a21\u5f0f\u5206\u5e03\u5f0f\u65e5\u5fd7\u6536\u96c6\u7cfb\u7edf",level:3},{value:"\uff081\uff09\u6a21\u5f0f\u8bf4\u660e",id:"1\u6a21\u5f0f\u8bf4\u660e",level:4},{value:"\uff082\uff09\u4ee3\u7801",id:"2\u4ee3\u7801-2",level:4},{value:"a\u3001\u751f\u4ea7\u8005",id:"a\u751f\u4ea7\u8005-1",level:5},{value:"b\u3001\u6d88\u8d39\u80051",id:"b\u6d88\u8d39\u80051-1",level:5},{value:"c\u3001\u6d88\u8d39\u80052",id:"c\u6d88\u8d39\u80052-1",level:5},{value:"\uff083\uff09\u6d4b\u8bd5",id:"3\u6d4b\u8bd5-1",level:4},{value:"\uff084\uff09\u5c0f\u7ed3",id:"4\u5c0f\u7ed3-2",level:4},{value:"5\u3001 Topics\u901a\u914d\u7b26\u6a21\u5f0f",id:"5-topics\u901a\u914d\u7b26\u6a21\u5f0f",level:3},{value:"\uff081\uff09 \u6a21\u5f0f\u8bf4\u660e",id:"1-\u6a21\u5f0f\u8bf4\u660e-1",level:4},{value:"\uff082\uff09 \u4ee3\u7801",id:"2-\u4ee3\u7801",level:4},{value:"a\u3001\u751f\u4ea7\u8005",id:"a\u751f\u4ea7\u8005-2",level:5},{value:"b\u3001\u6d88\u8d39\u80051",id:"b\u6d88\u8d39\u80051-2",level:5},{value:"c\u3001\u6d88\u8d39\u80052",id:"c\u6d88\u8d39\u80052-2",level:5},{value:"\uff083\uff09\u6d4b\u8bd5",id:"3\u6d4b\u8bd5-2",level:4},{value:"\uff084\uff09\u5c0f\u7ed3",id:"4\u5c0f\u7ed3-3",level:4},{value:"6\u3001 \u6a21\u5f0f\u603b\u7ed3",id:"6-\u6a21\u5f0f\u603b\u7ed3",level:3},{value:"<strong>\uff081\uff09\u7b80\u5355\u6a21\u5f0f HelloWorld</strong>",id:"1\u7b80\u5355\u6a21\u5f0f-helloworld",level:4},{value:"<strong>\uff082\uff09\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f Work Queue</strong>",id:"2\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f-work-queue",level:4},{value:"<strong>\uff083\uff09\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f Publish/subscribe</strong>",id:"3\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f-publishsubscribe",level:4},{value:"<strong>\uff084\uff09\u8def\u7531\u6a21\u5f0f Routing</strong>",id:"4\u8def\u7531\u6a21\u5f0f-routing",level:4},{value:"<strong>\uff085\uff09\u901a\u914d\u7b26\u6a21\u5f0f Topic</strong>",id:"5\u901a\u914d\u7b26\u6a21\u5f0f-topic",level:4},{value:"\u7b2c\u516d\u7ae0 Spring \u6574\u5408RabbitMQ-\u4e86\u89e3",id:"\u7b2c\u516d\u7ae0-spring-\u6574\u5408rabbitmq-\u4e86\u89e3",level:2},{value:"1\u3001\u642d\u5efa\u751f\u4ea7\u8005\u5de5\u7a0b",id:"1\u642d\u5efa\u751f\u4ea7\u8005\u5de5\u7a0b",level:3},{value:"\uff081\uff09\u521b\u5efa\u5de5\u7a0b",id:"1\u521b\u5efa\u5de5\u7a0b-1",level:4},{value:"\uff082\uff09\u6dfb\u52a0\u4f9d\u8d56",id:"2\u6dfb\u52a0\u4f9d\u8d56-1",level:4},{value:"\uff083\uff09 \u914d\u7f6e\u6574\u5408",id:"3-\u914d\u7f6e\u6574\u5408",level:4},{value:"\uff084\uff09\u53d1\u9001\u6d88\u606f",id:"4\u53d1\u9001\u6d88\u606f",level:4},{value:"2\u3001\u642d\u5efa\u6d88\u8d39\u8005\u5de5\u7a0b",id:"2\u642d\u5efa\u6d88\u8d39\u8005\u5de5\u7a0b",level:3},{value:"\uff081\uff09\u521b\u5efa\u5de5\u7a0b",id:"1\u521b\u5efa\u5de5\u7a0b-2",level:4},{value:"\uff082\uff09\u6dfb\u52a0\u4f9d\u8d56",id:"2\u6dfb\u52a0\u4f9d\u8d56-2",level:4},{value:"\uff083\uff09 \u914d\u7f6e\u6574\u5408",id:"3-\u914d\u7f6e\u6574\u5408-1",level:4},{value:"\uff084\uff09 \u6d88\u606f\u76d1\u542c\u5668",id:"4-\u6d88\u606f\u76d1\u542c\u5668",level:4},{value:"a\u3001\u961f\u5217\u76d1\u542c\u5668",id:"a\u961f\u5217\u76d1\u542c\u5668",level:5},{value:"b\u3001\u5e7f\u64ad\u76d1\u542c\u56681",id:"b\u5e7f\u64ad\u76d1\u542c\u56681",level:5},{value:"c\u3001\u5e7f\u64ad\u76d1\u542c\u56682",id:"c\u5e7f\u64ad\u76d1\u542c\u56682",level:5},{value:"d\u3001\u661f\u53f7\u901a\u914d\u7b26\u76d1\u542c\u5668",id:"d\u661f\u53f7\u901a\u914d\u7b26\u76d1\u542c\u5668",level:5},{value:"e\u3001\u4e95\u53f7\u901a\u914d\u7b26\u76d1\u542c\u5668",id:"e\u4e95\u53f7\u901a\u914d\u7b26\u76d1\u542c\u5668",level:5},{value:"f\u3001\u4e95\u53f7\u901a\u914d\u7b26\u76d1\u542c\u56682",id:"f\u4e95\u53f7\u901a\u914d\u7b26\u76d1\u542c\u56682",level:5},{value:"\u7b2c\u4e03\u7ae0 Spring Boot\u6574\u5408RabbitMQ",id:"\u7b2c\u4e03\u7ae0-spring-boot\u6574\u5408rabbitmq",level:2},{value:"1\u3001 \u7b80\u4ecb",id:"1-\u7b80\u4ecb",level:3},{value:"2\u3001\u642d\u5efa\u751f\u4ea7\u8005\u5de5\u7a0b",id:"2\u642d\u5efa\u751f\u4ea7\u8005\u5de5\u7a0b",level:3},{value:"\uff081\uff09 \u521b\u5efa\u5de5\u7a0b",id:"1-\u521b\u5efa\u5de5\u7a0b",level:4},{value:"\uff082\uff09 \u6dfb\u52a0\u4f9d\u8d56",id:"2-\u6dfb\u52a0\u4f9d\u8d56",level:4},{value:"\uff083\uff09 \u542f\u52a8\u7c7b",id:"3-\u542f\u52a8\u7c7b",level:4},{value:"\uff084\uff09\u914d\u7f6eRabbitMQ",id:"4\u914d\u7f6erabbitmq",level:4},{value:"a\u3001\u914d\u7f6e\u6587\u4ef6",id:"a\u914d\u7f6e\u6587\u4ef6",level:5},{value:"b\u3001\u7ed1\u5b9a\u4ea4\u6362\u673a\u548c\u961f\u5217",id:"b\u7ed1\u5b9a\u4ea4\u6362\u673a\u548c\u961f\u5217",level:5},{value:"3\u3001\u642d\u5efa\u6d88\u8d39\u8005\u5de5\u7a0b",id:"3\u642d\u5efa\u6d88\u8d39\u8005\u5de5\u7a0b",level:3},{value:"\uff081\uff09 \u521b\u5efa\u5de5\u7a0b",id:"1-\u521b\u5efa\u5de5\u7a0b-1",level:4},{value:"\uff082\uff09 \u6dfb\u52a0\u4f9d\u8d56",id:"2-\u6dfb\u52a0\u4f9d\u8d56-1",level:4},{value:"\uff083\uff09 \u542f\u52a8\u7c7b",id:"3-\u542f\u52a8\u7c7b-1",level:4},{value:"\uff084\uff09 \u914d\u7f6eRabbitMQ",id:"4-\u914d\u7f6erabbitmq",level:4},{value:"\uff085\uff09 \u6d88\u606f\u76d1\u542c\u5904\u7406\u7c7b",id:"5-\u6d88\u606f\u76d1\u542c\u5904\u7406\u7c7b",level:4},{value:"4\u3001 \u6d4b\u8bd5",id:"4-\u6d4b\u8bd5",level:3},{value:"\u7b2c\u4e00\u7ae0 RabbitMQ \u9ad8\u7ea7\u7279\u6027",id:"\u7b2c\u4e00\u7ae0-rabbitmq-\u9ad8\u7ea7\u7279\u6027",level:2},{value:"1\u3001\u6d88\u606f\u53ef\u9760\u6027\u6295\u9012",id:"1\u6d88\u606f\u53ef\u9760\u6027\u6295\u9012",level:3},{value:"\uff081\uff09confirm\u786e\u8ba4\u6a21\u5f0f\u4ee3\u7801\u5b9e\u73b0",id:"1confirm\u786e\u8ba4\u6a21\u5f0f\u4ee3\u7801\u5b9e\u73b0",level:4},{value:"\uff082\uff09 return\u9000\u56de\u6a21\u5f0f\u4ee3\u7801\u5b9e\u73b0",id:"2-return\u9000\u56de\u6a21\u5f0f\u4ee3\u7801\u5b9e\u73b0",level:4},{value:"\uff083\uff09\u5c0f\u7ed3",id:"3\u5c0f\u7ed3",level:4},{value:"2\u3001Consumer ACK",id:"2consumer-ack",level:3},{value:"\uff081\uff09\u4ee3\u7801\u5b9e\u73b0",id:"1\u4ee3\u7801\u5b9e\u73b0",level:4},{value:"\uff082\uff09\u5c0f\u7ed3",id:"2\u5c0f\u7ed3",level:4},{value:"3\u3001\u6d88\u8d39\u7aef\u9650\u6d41",id:"3\u6d88\u8d39\u7aef\u9650\u6d41",level:3},{value:"\uff081\uff09\u4ee3\u7801\u5b9e\u73b0",id:"1\u4ee3\u7801\u5b9e\u73b0-1",level:4},{value:"\uff082\uff09\u5c0f\u7ed3",id:"2\u5c0f\u7ed3-1",level:4},{value:"4\u3001TTL",id:"4ttl",level:3},{value:"\uff081\uff09\u4ee3\u7801\u5b9e\u73b0",id:"1\u4ee3\u7801\u5b9e\u73b0-2",level:4},{value:"a\u3001\u8bbe\u7f6e\u961f\u5217\u7684\u8fc7\u671f\u65f6\u95f4",id:"a\u8bbe\u7f6e\u961f\u5217\u7684\u8fc7\u671f\u65f6\u95f4",level:5},{value:"b\u3001\u8bbe\u7f6e\u5355\u4e2a\u6d88\u606f\u7684\u8fc7\u671f\u65f6\u95f4",id:"b\u8bbe\u7f6e\u5355\u4e2a\u6d88\u606f\u7684\u8fc7\u671f\u65f6\u95f4",level:5},{value:"\uff082\uff09\u5c0f\u7ed3",id:"2\u5c0f\u7ed3-2",level:4},{value:"5\u3001\u6b7b\u4fe1\u961f\u5217",id:"5\u6b7b\u4fe1\u961f\u5217",level:3},{value:"\uff081\uff09\u4ee3\u7801\u5b9e\u73b0",id:"1\u4ee3\u7801\u5b9e\u73b0-3",level:4},{value:"\uff082\uff09\u5c0f\u7ed3",id:"2\u5c0f\u7ed3-3",level:4},{value:"6\u3001\u5ef6\u8fdf\u961f\u5217-\u91cd\u70b9",id:"6\u5ef6\u8fdf\u961f\u5217-\u91cd\u70b9",level:3},{value:"\uff081\uff09\u4ee3\u7801\u5b9e\u73b0",id:"1\u4ee3\u7801\u5b9e\u73b0-4",level:4},{value:"\uff082\uff09 \u5c0f\u7ed3",id:"2-\u5c0f\u7ed3",level:4},{value:"7\u3001\u65e5\u5fd7\u4e0e\u76d1\u63a7-\u4e86\u89e3",id:"7\u65e5\u5fd7\u4e0e\u76d1\u63a7-\u4e86\u89e3",level:3},{value:"\uff081\uff09RabbitMQ\u65e5\u5fd7",id:"1rabbitmq\u65e5\u5fd7",level:4},{value:"\uff082\uff09web\u7ba1\u63a7\u53f0\u76d1\u63a7",id:"2web\u7ba1\u63a7\u53f0\u76d1\u63a7",level:4},{value:"8\u3001\u6d88\u606f\u8ffd\u8e2a-\u4e86\u89e3",id:"8\u6d88\u606f\u8ffd\u8e2a-\u4e86\u89e3",level:3},{value:"\uff081\uff09\u6d88\u606f\u8ffd\u8e2a-Firehose",id:"1\u6d88\u606f\u8ffd\u8e2a-firehose",level:4},{value:"\uff082\uff09 \u6d88\u606f\u8ffd\u8e2a-rabbitmq_tracing",id:"2-\u6d88\u606f\u8ffd\u8e2a-rabbitmq_tracing",level:4},{value:"\u7b2c\u4e8c\u7ae0 RabbitMQ\u5e94\u7528\u95ee\u9898-\u9762\u8bd5",id:"\u7b2c\u4e8c\u7ae0-rabbitmq\u5e94\u7528\u95ee\u9898-\u9762\u8bd5",level:2},{value:"1\u3001\u6d88\u606f\u53ef\u9760\u6027\u4fdd\u969c",id:"1\u6d88\u606f\u53ef\u9760\u6027\u4fdd\u969c",level:3},{value:"2\u3001 \u6d88\u606f\u5e42\u7b49\u6027\u5904\u7406",id:"2-\u6d88\u606f\u5e42\u7b49\u6027\u5904\u7406",level:3},{value:"3\u3001RabbitMQ\u96c6\u7fa4\u642d\u5efa-\u8fd0\u7ef4",id:"3rabbitmq\u96c6\u7fa4\u642d\u5efa-\u8fd0\u7ef4",level:3},{value:"\uff081\uff09 \u96c6\u7fa4\u65b9\u6848\u7684\u539f\u7406",id:"1-\u96c6\u7fa4\u65b9\u6848\u7684\u539f\u7406",level:4},{value:"\uff082\uff09\u5355\u673a\u591a\u5b9e\u4f8b\u90e8\u7f72",id:"2\u5355\u673a\u591a\u5b9e\u4f8b\u90e8\u7f72",level:4},{value:"\uff083\uff09\u96c6\u7fa4\u7ba1\u7406",id:"3\u96c6\u7fa4\u7ba1\u7406",level:4},{value:"\uff084\uff09RabbitMQ\u955c\u50cf\u96c6\u7fa4\u914d\u7f6e",id:"4rabbitmq\u955c\u50cf\u96c6\u7fa4\u914d\u7f6e",level:4},{value:"\uff085\uff09\u8d1f\u8f7d\u5747\u8861-HAProxy",id:"5\u8d1f\u8f7d\u5747\u8861-haproxy",level:4},{value:"a\u3001 \u5b89\u88c5HAProxy",id:"a-\u5b89\u88c5haproxy",level:5},{value:"b\u3001\u914d\u7f6eHAProxy",id:"b\u914d\u7f6ehaproxy",level:5}],p={toc:c};function u(n){let{components:e,...t}=n;return(0,r.kt)("wrapper",(0,a.Z)({},p,t,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"31-rabbitmq\u5165\u95e8"},"3.1 RabbitMQ\u5165\u95e8"),(0,r.kt)("p",null,"\u5b66\u4e60\u76ee\u6807"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u80fd\u591f\u8bf4\u51fa\u4ec0\u4e48\u662f\u6d88\u606f\u4e2d\u95f4\u4ef6"),(0,r.kt)("li",{parentName:"ul"},"\u80fd\u591f\u5b89\u88c5RabbitMQ"),(0,r.kt)("li",{parentName:"ul"},"\u80fd\u591f\u7f16\u5199RabbitMQ\u7684\u5165\u95e8\u7a0b\u5e8f"),(0,r.kt)("li",{parentName:"ul"},"\u80fd\u591f\u8bf4\u51faRabbitMQ\u76845\u79cd\u6a21\u5f0f\u7279\u5f81-\u91cd\u70b9"),(0,r.kt)("li",{parentName:"ul"},"\u80fd\u591f\u4f7f\u7528Spring\u6574\u5408RabbitMQ")),(0,r.kt)("h2",{id:"\u7b2c\u4e00\u7ae0-\u6d88\u606f\u4e2d\u95f4\u4ef6\u6982\u8ff0-\u4e86\u89e3"},"\u7b2c\u4e00\u7ae0 \u6d88\u606f\u4e2d\u95f4\u4ef6\u6982\u8ff0-\u4e86\u89e3"),(0,r.kt)("h3",{id:"1-\u4ec0\u4e48\u662f\u6d88\u606f\u4e2d\u95f4\u4ef6"},"1\u3001 \u4ec0\u4e48\u662f\u6d88\u606f\u4e2d\u95f4\u4ef6"),(0,r.kt)("h4",{id:"1mq\u662f\u4ec0\u4e48"},"\uff081\uff09MQ\u662f\u4ec0\u4e48"),(0,r.kt)("p",null,"MQ\u5168\u79f0\u4e3aMessage Queue\uff0c\u6d88\u606f\u961f\u5217\u662f\u5e94\u7528\u7a0b\u5e8f\u548c\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u7684\u901a\u4fe1\u65b9\u6cd5\u3002"),(0,r.kt)("p",null,"\u5148\u8fdb\u5148\u51fa"),(0,r.kt)("p",null,"\u539f\u5148\uff1aip:port/order/add?goodsId=1"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408204615842-2ec9d620.png",alt:"image-20220408204615842"}),"image-20220408204615842"),(0,r.kt)("p",null,"\u73b0\u5728\uff1a\u5f02\u6b65\u8c03\u7528"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408205148101-2172857b.png",alt:"image-20220408205148101"}),"image-20220408205148101"),(0,r.kt)("h4",{id:"2\u4e3a\u4ec0\u4e48\u4f7f\u7528mq--\u9762\u8bd5"},"\uff082\uff09\u4e3a\u4ec0\u4e48\u4f7f\u7528MQ--\u9762\u8bd5"),(0,r.kt)("p",null,"\u5728\u9879\u76ee\u4e2d\uff0c\u53ef\u5c06\u4e00\u4e9b\u65e0\u9700\u5373\u65f6\u8fd4\u56de\u4e14\u8017\u65f6\u7684\u64cd\u4f5c\u63d0\u53d6\u51fa\u6765\uff0c\u8fdb\u884c",(0,r.kt)("strong",{parentName:"p"},"\u5f02\u6b65\u5904\u7406"),"\uff0c\u800c\u8fd9\u79cd\u5f02\u6b65\u5904\u7406\u7684\u65b9\u5f0f\u5927\u5927\u7684\u8282\u7701\u4e86\u670d\u52a1\u5668\u7684\u8bf7\u6c42\u54cd\u5e94\u65f6\u95f4\uff0c\u4ece\u800c",(0,r.kt)("strong",{parentName:"p"},"\u63d0\u9ad8"),"\u4e86",(0,r.kt)("strong",{parentName:"p"},"\u7cfb\u7edf"),"\u7684",(0,r.kt)("strong",{parentName:"p"},"\u541e\u5410\u91cf"),"\u3002"),(0,r.kt)("p",null,"\u73b0\u5728\uff0c\u5e94\u7528\u5f00\u53d1\u548c\u90e8\u7f72---\u5fae\u670d\u52a1\u3002"),(0,r.kt)("h4",{id:"3mq\u4f18\u52bf"},(0,r.kt)("strong",{parentName:"h4"},"\uff083\uff09MQ\u4f18\u52bf")),(0,r.kt)("h5",{id:"a\u5e94\u7528\u89e3\u8026"},"a\u3001",(0,r.kt)("strong",{parentName:"h5"},"\u5e94\u7528\u89e3\u8026")),(0,r.kt)("p",null,"MQ\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e2d\u4ecb\uff0c\u751f\u4ea7\u65b9\u901a\u8fc7MQ\u4e0e\u6d88\u8d39\u65b9\u4ea4\u4e92\uff0c\u5b83\u5c06\u5e94\u7528\u7a0b\u5e8f\u8fdb\u884c\u89e3\u8026\u5408\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408210051290-27a1c5bb.png",alt:"image-20220408210051290"}),"image-20220408210051290"),(0,r.kt)("h5",{id:"b\u5f02\u6b65\u63d0\u901f"},"b\u3001",(0,r.kt)("strong",{parentName:"h5"},"\u5f02\u6b65\u63d0\u901f")),(0,r.kt)("p",null,"\u5c06\u4e0d\u9700\u8981\u540c\u6b65\u5904\u7406\u7684\u5e76\u4e14\u8017\u65f6\u957f\u7684\u64cd\u4f5c\u7531\u6d88\u606f\u961f\u5217\u901a\u77e5\u6d88\u606f\u63a5\u6536\u65b9\u8fdb\u884c\u5f02\u6b65\u5904\u7406\u3002\u63d0\u9ad8\u4e86\u5e94\u7528\u7a0b\u5e8f\u7684\u54cd\u5e94\u65f6\u95f4\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408210805836-3b12b167.png",alt:"image-20220408210805836"}),"image-20220408210805836"),(0,r.kt)("p",null,"order_table status 0 \u5df2\u4e0b\u5355 status 1 \u652f\u4ed8\u6210\u529f status 2 \u5df2\u901a\u77e5\u5546\u5bb6\u53d1\u8d27 status 3 \u5546\u5bb6\u53d1\u8d27 status 4 \u5df2\u7ecf\u6536\u8d27"),(0,r.kt)("h5",{id:"c\u524a\u5cf0\u586b\u8c37"},"c\u3001",(0,r.kt)("strong",{parentName:"h5"},"\u524a\u5cf0\u586b\u8c37")),(0,r.kt)("p",null,"\u5982\u8ba2\u5355\u7cfb\u7edf\uff0c\u5728\u4e0b\u5355\u7684\u65f6\u5019\u5c31\u4f1a\u5f80\u6570\u636e\u5e93\u5199\u6570\u636e\u3002\u4f46\u662f\u6570\u636e\u5e93\u53ea\u80fd\u652f\u6491\u6bcf\u79d21000\u5de6\u53f3\u7684\u5e76\u53d1\u5199\u5165\uff0c\u5e76\u53d1\u91cf\u518d\u9ad8\u5c31\u5bb9\u6613\u5b95\u673a\u3002\u4f4e\u5cf0\u671f\u7684\u65f6\u5019\u5e76\u53d1\u4e5f\u5c31100\u591a\u4e2a\uff0c\u4f46\u662f\u5728\u9ad8\u5cf0\u671f\u65f6\u5019\uff0c\u5e76\u53d1\u91cf\u4f1a\u7a81\u7136\u6fc0\u589e\u52305000\u4ee5\u4e0a\uff0c\u8fd9\u4e2a\u65f6\u5019\u6570\u636e\u5e93\u80af\u5b9a\u5361\u6b7b\u4e86\u3002"),(0,r.kt)("p",null,"\u6d88\u606f\u88abMQ\u4fdd\u5b58\u8d77\u6765\u4e86\uff0c\u7136\u540e\u7cfb\u7edf\u5c31\u53ef\u4ee5\u6309\u7167\u81ea\u5df1\u7684\u6d88\u8d39\u80fd\u529b\u6765\u6d88\u8d39\uff0c\u6bd4\u5982\u6bcf\u79d21000\u4e2a\u6570\u636e\uff0c\u8fd9\u6837\u6162\u6162\u5199\u5165\u6570\u636e\u5e93\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u5361\u6b7b\u6570\u636e\u5e93\u4e86\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408211341420-1d296a5c.png",alt:"image-20220408211341420"}),"image-20220408211341420"),(0,r.kt)("p",null,"\u4f46\u662f\u4f7f\u7528\u4e86MQ\u4e4b\u540e\uff0c\u9650\u5236\u6d88\u8d39\u6d88\u606f\u7684\u901f\u5ea6\u4e3a1000\uff0c\u4f46\u662f\u8fd9\u6837\u4e00\u6765\uff0c\u9ad8\u5cf0\u671f\u4ea7\u751f\u7684\u6570\u636e\u52bf\u5fc5\u4f1a\u88ab\u79ef\u538b\u5728MQ\u4e2d\uff0c\u9ad8\u5cf0\u5c31\u88ab\u201c\u524a\u201d\u6389\u4e86\u3002\u4f46\u662f\u56e0\u4e3a\u6d88\u606f\u79ef\u538b\uff0c\u5728\u9ad8\u5cf0\u671f\u8fc7\u540e\u7684\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u6d88\u8d39\u6d88\u606f\u7684\u901f\u5ea6\u8fd8\u662f\u4f1a\u7ef4\u6301\u57281000QPS\uff0c\u76f4\u5230\u6d88\u8d39\u5b8c\u79ef\u538b\u7684\u6d88\u606f,\u8fd9\u5c31\u53eb\u505a\u201c\u586b\u8c37\u201d"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/03-8859b83b.png",alt:"img"})),(0,r.kt)("h4",{id:"4mq\u52a3\u52bf"},"\uff084\uff09",(0,r.kt)("strong",{parentName:"h4"},"MQ\u52a3\u52bf")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\u7cfb\u7edf\u53ef\u7528\u6027\u964d\u4f4e"))),(0,r.kt)("p",null,"\u7cfb\u7edf\u5f15\u5165\u7684\u5916\u90e8\u4f9d\u8d56\u8d8a\u591a\uff0c\u7cfb\u7edf\u7a33\u5b9a\u6027\u8d8a\u5dee\u3002\u4e00\u65e6 MQ \u5b95\u673a\uff0c\u5c31\u4f1a\u5bf9\u4e1a\u52a1\u9020\u6210\u5f71\u54cd\u3002\u5982\u4f55\u4fdd\u8bc1MQ\u7684\u9ad8\u53ef\u7528\uff1f"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\u7cfb\u7edf\u590d\u6742\u5ea6\u63d0\u9ad8"))),(0,r.kt)("p",null,"MQ \u7684\u52a0\u5165\u5927\u5927\u589e\u52a0\u4e86\u7cfb\u7edf\u7684\u590d\u6742\u5ea6\uff0c\u4ee5\u524d\u7cfb\u7edf\u95f4\u662f\u540c\u6b65\u7684\u8fdc\u7a0b\u8c03\u7528\uff0c\u73b0\u5728\u662f\u901a\u8fc7 MQ \u8fdb\u884c\u5f02\u6b65\u8c03\u7528\u3002\u5982\u4f55"),(0,r.kt)("p",null,"\u4fdd\u8bc1\u6d88\u606f\u6ca1\u6709\u88ab\u91cd\u590d\u6d88\u8d39\uff1f\u600e\u4e48\u5904\u7406\u6d88\u606f\u4e22\u5931\u60c5\u51b5\uff1f\u90a3\u4e48\u4fdd\u8bc1\u6d88\u606f\u4f20\u9012\u7684\u987a\u5e8f\u6027\uff1f"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"\u4e00\u81f4\u6027\u95ee\u9898"))),(0,r.kt)("p",null,"A \u7cfb\u7edf\u5904\u7406\u5b8c\u4e1a\u52a1\uff0c\u901a\u8fc7 MQ \u7ed9B\u3001C\u3001D\u4e09\u4e2a\u7cfb\u7edf\u53d1\u6d88\u606f\u6570\u636e\uff0c\u5982\u679c B \u7cfb\u7edf\u3001C \u7cfb\u7edf\u5904\u7406\u6210\u529f\uff0cD \u7cfb\u7edf\u5904\u7406"),(0,r.kt)("p",null,"\u5931\u8d25\u3002\u5982\u4f55\u4fdd\u8bc1\u6d88\u606f\u6570\u636e\u5904\u7406\u7684\u4e00\u81f4\u6027\u3002"),(0,r.kt)("p",null,"\u6700\u7ec8\u4e00\u81f4\u6027\u3002"),(0,r.kt)("h4",{id:"5\u4ec0\u4e48\u65f6\u5019\u7528mq"},"\uff085\uff09\u4ec0\u4e48\u65f6\u5019\u7528MQ"),(0,r.kt)("p",null,"\u2460 \u751f\u4ea7\u8005\u4e0d\u9700\u8981\u4ece\u6d88\u8d39\u8005\u5904\u83b7\u5f97\u53cd\u9988\u3002\u5f15\u5165\u6d88\u606f\u961f\u5217\u4e4b\u524d\u7684\u76f4\u63a5\u8c03\u7528\uff0c\u5176\u63a5\u53e3\u7684\u8fd4\u56de\u503c\u5e94\u8be5\u4e3a\u7a7a\uff0c\u8fd9\u624d\u8ba9\u660e \u660e\u4e0b\u5c42\u7684\u52a8\u4f5c\u8fd8\u6ca1\u505a\uff0c\u4e0a\u5c42\u5374\u5f53\u6210\u52a8\u4f5c\u505a\u5b8c\u4e86\u7ee7\u7eed\u5f80\u540e\u8d70\uff0c\u5373\u6240\u8c13\u5f02\u6b65\u6210\u4e3a\u4e86\u53ef\u80fd\u3002"),(0,r.kt)("p",null,"\u2461 \u5bb9\u8bb8\u77ed\u6682\u7684\u4e0d\u4e00\u81f4\u6027\u3002"),(0,r.kt)("p",null,"\u2462 \u786e\u5b9e\u662f\u7528\u4e86\u6709\u6548\u679c\u3002\u5373\u89e3\u8026\u3001\u63d0\u901f\u3001\u524a\u5cf0\u8fd9\u4e9b\u65b9\u9762\u7684\u6536\u76ca\uff0c\u8d85\u8fc7\u52a0\u5165MQ\uff0c\u7ba1\u7406MQ\u8fd9\u4e9b\u6210\u672c\u3001"),(0,r.kt)("h3",{id:"2amqp-\u548c-jms"},"2\u3001AMQP \u548c JMS"),(0,r.kt)("p",null,"MQ\u662f\u6d88\u606f\u901a\u4fe1\u7684\u6a21\u578b\uff1b\u5b9e\u73b0MQ\u7684\u5927\u81f4\u6709\u4e24\u79cd\u4e3b\u6d41\u65b9\u5f0f\uff1aAMQP\u3001JMS\u3002"),(0,r.kt)("h4",{id:"1amqp"},"\uff081\uff09AMQP"),(0,r.kt)("p",null,"AMQP\u662f\u4e00\u79cd\u534f\u8bae\uff0c\u66f4\u51c6\u786e\u7684\u8bf4\u662f\u4e00\u79cdbinary wire-level protocol\uff08\u94fe\u63a5\u534f\u8bae\uff09\u3002\u8fd9\u662f\u5176\u548cJMS\u7684\u672c\u8d28\u5dee\u522b\uff0cAMQP\u4e0d\u4eceAPI\u5c42\u8fdb\u884c\u9650\u5b9a\uff0c\u800c\u662f\u76f4\u63a5\u5b9a\u4e49\u7f51\u7edc\u4ea4\u6362\u7684\u6570\u636e\u683c\u5f0f\u3002"),(0,r.kt)("h4",{id:"2jms"},"\uff082\uff09JMS"),(0,r.kt)("p",null,"JMS\u5373Java\u6d88\u606f\u670d\u52a1\uff08JavaMessage Service\uff09\u5e94\u7528\u7a0b\u5e8f\u63a5\u53e3\uff0c\u662f\u4e00\u4e2aJava\u5e73\u53f0\u4e2d\u5173\u4e8e\u9762\u5411\u6d88\u606f\u4e2d\u95f4\u4ef6\uff08MOM\uff09\u7684API\uff0c\u7528\u4e8e\u5728\u4e24\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\uff0c\u6216\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u53d1\u9001\u6d88\u606f\uff0c\u8fdb\u884c\u5f02\u6b65\u901a\u4fe1\u3002"),(0,r.kt)("h4",{id:"3amqp-\u4e0e-jms-\u533a\u522b"},"\uff083\uff09AMQP \u4e0e JMS \u533a\u522b"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"JMS\u662f\u5b9a\u4e49\u4e86\u7edf\u4e00\u7684\u63a5\u53e3\uff0c\u6765\u5bf9\u6d88\u606f\u64cd\u4f5c\u8fdb\u884c\u7edf\u4e00\uff1bAMQP\u662f\u901a\u8fc7\u89c4\u5b9a\u534f\u8bae\u6765\u7edf\u4e00\u6570\u636e\u4ea4\u4e92\u7684\u683c\u5f0f"),(0,r.kt)("li",{parentName:"ul"},"JMS\u9650\u5b9a\u4e86\u5fc5\u987b\u4f7f\u7528Java\u8bed\u8a00\uff1bAMQP\u53ea\u662f\u534f\u8bae\uff0c\u4e0d\u89c4\u5b9a\u5b9e\u73b0\u65b9\u5f0f\uff0c\u56e0\u6b64\u662f\u8de8\u8bed\u8a00\u7684\u3002"),(0,r.kt)("li",{parentName:"ul"},"JMS\u89c4\u5b9a\u4e86\u4e24\u79cd\u6d88\u606f\u6a21\u5f0f\uff1b\u800cAMQP\u7684\u6d88\u606f\u6a21\u5f0f\u66f4\u52a0\u4e30\u5bcc\u3002")),(0,r.kt)("h3",{id:"3\u6d88\u606f\u961f\u5217\u4ea7\u54c1"},"3\u3001\u6d88\u606f\u961f\u5217\u4ea7\u54c1"),(0,r.kt)("p",null,"\u5e02\u573a\u4e0a\u5e38\u89c1\u7684\u6d88\u606f\u961f\u5217\u6709\u5982\u4e0b\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"ActiveMQ\uff1a\u57fa\u4e8eJMS"),(0,r.kt)("li",{parentName:"ul"},"ZeroMQ\uff1a\u57fa\u4e8eC\u8bed\u8a00\u5f00\u53d1"),(0,r.kt)("li",{parentName:"ul"},"RabbitMQ\uff1a\u57fa\u4e8eAMQP\u534f\u8bae\uff0cerlang\u8bed\u8a00\u5f00\u53d1\uff0c\u7a33\u5b9a\u6027\u597d"),(0,r.kt)("li",{parentName:"ul"},"RocketMQ\uff1a\u57fa\u4e8eJMS\uff0c\u963f\u91cc\u5df4\u5df4\u4ea7\u54c1"),(0,r.kt)("li",{parentName:"ul"},"Kafka\uff1a\u7c7b\u4f3cMQ\u7684\u4ea7\u54c1\uff1b\u5206\u5e03\u5f0f\u6d88\u606f\u7cfb\u7edf\uff0c\u9ad8\u541e\u5410\u91cf")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320111345727-041941a7.png",alt:"image-20200320111345727"}),"image-20200320111345727"),(0,r.kt)("h3",{id:"4-rabbitmq"},"4\u3001 RabbitMQ"),(0,r.kt)("h4",{id:"1rabbitmq\u7279\u70b9"},"\uff081\uff09RabbitMQ",(0,r.kt)("strong",{parentName:"h4"},"\u7279\u70b9"),"\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"1\u3001\u4f7f\u7528\u7b80\u5355\uff0c\u529f\u80fd\u5f3a\u5927\u3002"),(0,r.kt)("li",{parentName:"ul"},"2\u3001\u57fa\u4e8e",(0,r.kt)("strong",{parentName:"li"},"AMQP"),"\u534f\u8bae\u3002 \u8de8\u8bed\u8a00 c node.js->mq->java python"),(0,r.kt)("li",{parentName:"ul"},"3\u3001\u793e\u533a\u6d3b\u8dc3\uff0c\u6587\u6863\u5b8c\u5584\u3002"),(0,r.kt)("li",{parentName:"ul"},"4\u3001\u9ad8\u5e76\u53d1\u6027\u80fd\u597d\uff0c\u8fd9\u4e3b\u8981\u5f97\u76ca\u4e8e",(0,r.kt)("strong",{parentName:"li"},"Erlang"),"\u8bed\u8a00\u3002 c \u5e95\u5c42\u8bed\u8a00\uff0c\u6027\u80fd\u5f3a\u3002java \u597d\u5f00\u53d1\u3002\u6784\u5efa\u4e00\u4e2aweb\u3002"),(0,r.kt)("li",{parentName:"ul"},"5\u3001Spring Boot\u9ed8\u8ba4\u5df2\u96c6\u6210RabbitMQ")),(0,r.kt)("h4",{id:"2\u5176\u5b83\u76f8\u5173\u672f\u8bed"},"\uff082\uff09\u5176\u5b83\u76f8\u5173\u672f\u8bed"),(0,r.kt)("p",null,"AMQP\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320174327969-9152399e.png",alt:"image-20200320174327969"}),"image-20200320174327969"),(0,r.kt)("p",null,"JMS \uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320174346261-ff48f62e.png",alt:"image-20200320174346261"}),"image-20200320174346261"),(0,r.kt)("p",null,"\u603b\u7ed3\uff1a"),(0,r.kt)("p",null,"JMS\u662fjava\u63d0\u4f9b\u7684\u4e00\u5957\u6d88\u606f\u670d\u52a1API\u6807\u51c6\uff0c\u5176\u76ee\u7684\u662f\u4e3a\u6240\u6709\u7684java\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u7edf\u4e00\u7684\u6d88\u606f\u901a\u4fe1\u7684\u6807\u51c6\uff0c\u7c7b\u4f3cjava\u7684jdbc\uff0c\u53ea\u8981\u9075\u5faajms\u6807\u51c6\u7684\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u90fd\u53ef\u4ee5\u8fdb\u884c\u6d88\u606f\u901a\u4fe1\u3002"),(0,r.kt)("p",null,"\u5b83\u548cAMQP\u6709\u4ec0\u4e48 \u4e0d\u540c\uff0cjms\u662fjava\u8bed\u8a00\u4e13\u5c5e\u7684\u6d88\u606f\u670d\u52a1\u6807\u51c6\uff0c\u5b83\u662f\u5728api\u5c42\u5b9a\u4e49\u6807\u51c6\uff0c\u5e76\u4e14\u53ea\u80fd\u7528\u4e8ejava\u5e94\u7528\uff1b\u800cAMQP\u662f\u5728\u534f\u8bae\u5c42\u5b9a\u4e49\u7684\u6807\u51c6\uff0c\u662f\u8de8\u8bed\u8a00\u7684 \u3002"),(0,r.kt)("h4",{id:"3\u5de5\u4f5c\u6a21\u5f0f"},"\uff083\uff09\u5de5\u4f5c\u6a21\u5f0f"),(0,r.kt)("p",null,"RabbitMQ\u63d0\u4f9b\u4e866\u79cd\u6a21\u5f0f\uff1a\u7b80\u5355\u6a21\u5f0f\uff0cwork\u6a21\u5f0f\uff0cPublish/Subscribe\u53d1\u5e03\u4e0e\u8ba2\u9605\u6a21\u5f0f\uff0c",(0,r.kt)("strong",{parentName:"p"},"Routing"),"\u8def\u7531\u6a21\u5f0f\uff0c",(0,r.kt)("strong",{parentName:"p"},"Topics"),"\u4e3b\u9898\u6a21\u5f0f\uff0cRPC\u8fdc\u7a0b\u8c03\u7528\u6a21\u5f0f\uff08\u8fdc\u7a0b\u8c03\u7528\uff0c\u4e0d\u592a\u7b97MQ\uff1b\u6682\u4e0d\u4f5c\u4ecb\u7ecd\uff09\uff1b"),(0,r.kt)("p",null,"\u5b98\u7f51\u5bf9\u5e94\u6a21\u5f0f\u4ecb\u7ecd\uff1a",(0,r.kt)("a",{parentName:"p",href:"https://www.rabbitmq.com/getstarted.html"},"https://www.rabbitmq.com/getstarted.htmlopen in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1555988678324-a0be1434.png",alt:"1555988678324"}),"1555988678324"),(0,r.kt)("h2",{id:"\u7b2c\u4e8c\u7ae0-rabbitmq\u5de5\u4f5c\u539f\u7406--\u91cd\u70b9"},"\u7b2c\u4e8c\u7ae0 RabbitMQ\u5de5\u4f5c\u539f\u7406--\u91cd\u70b9\uff01"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u91cd\u70b9\u770b\u8fd9\u5f20\u56fe"),"\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320180217097-f868c655.png",alt:"image-20200320180217097"}),"image-20200320180217097"),(0,r.kt)("p",null,"http \u4e09\u6b21\u63e1\u624b \u56db\u6b21\u6325\u624b \u4e00\u4e2a\u957f\u8fde\u63a5"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4e00\u4e2a\u6d88\u8d39\u8005\u76d1\u542c\u201c\u4e00\u4e2a\u201d\u201c\u961f\u5217\u201d")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Broker\uff1a\u6d88\u606f\u961f\u5217\u670d\u52a1\u8fdb\u7a0b\uff0c\u6b64\u8fdb\u7a0b\u5305\u62ec\u4e24\u4e2a\u90e8\u5206\uff1aExchange\u548cQueue\u3002"),(0,r.kt)("li",{parentName:"ul"},"Exchange\uff1a\u6d88\u606f\u961f\u5217\u4ea4\u6362\u673a\uff0c\u6309\u4e00\u5b9a\u7684\u89c4\u5219\u5c06\u6d88\u606f\u8def\u7531\u8f6c\u53d1\u5230\u67d0\u4e2a\u961f\u5217\uff0c\u5bf9\u6d88\u606f\u8fdb\u884c\u8fc7\u8651\u3002"),(0,r.kt)("li",{parentName:"ul"},"Queue\uff1a\u6d88\u606f\u961f\u5217\uff0c\u5b58\u50a8\u6d88\u606f\u7684\u961f\u5217\uff0c\u6d88\u606f\u5230\u8fbe\u961f\u5217\u5e76\u8f6c\u53d1\u7ed9\u6307\u5b9a\u7684\u6d88\u8d39\u65b9\u3002"),(0,r.kt)("li",{parentName:"ul"},"Producer\uff1a\u6d88\u606f\u751f\u4ea7\u8005\uff0c\u5373\u751f\u4ea7\u65b9\u5ba2\u6237\u7aef\uff0c\u751f\u4ea7\u65b9\u5ba2\u6237\u7aef\u5c06\u6d88\u606f\u53d1\u9001\u5230MQ\u3002"),(0,r.kt)("li",{parentName:"ul"},"Consumer\uff1a\u6d88\u606f\u6d88\u8d39\u8005\uff0c\u5373\u6d88\u8d39\u65b9\u5ba2\u6237\u7aef\uff0c\u63a5\u6536MQ\u8f6c\u53d1\u7684\u6d88\u606f\u3002")),(0,r.kt)("p",null,"\u6d88\u606f\u53d1\u5e03\u63a5\u6536\u6d41\u7a0b\uff1a"),(0,r.kt)("p",null,"-----\u53d1\u9001\u6d88\u606f-----"),(0,r.kt)("p",null,"1\u3001\u751f\u4ea7\u8005\u548cBroker\u5efa\u7acbTCP\u8fde\u63a5\u3002"),(0,r.kt)("p",null,"2\u3001\u751f\u4ea7\u8005\u548cBroker\u5efa\u7acb\u901a\u9053\u3002"),(0,r.kt)("p",null,"3\u3001\u751f\u4ea7\u8005\u901a\u8fc7\u901a\u9053\u6d88\u606f\u53d1\u9001\u7ed9Broker\uff0c\u7531Exchange\u5c06\u6d88\u606f\u8fdb\u884c\u8f6c\u53d1\u3002"),(0,r.kt)("p",null,"4\u3001Exchange\u5c06\u6d88\u606f\u8f6c\u53d1\u5230\u6307\u5b9a\u7684Queue\uff08\u961f\u5217\uff09"),(0,r.kt)("p",null,"----\u63a5\u6536\u6d88\u606f-----"),(0,r.kt)("p",null,"1\u3001\u6d88\u8d39\u8005\u548cBroker\u5efa\u7acbTCP\u8fde\u63a5"),(0,r.kt)("p",null,"2\u3001\u6d88\u8d39\u8005\u548cBroker\u5efa\u7acb\u901a\u9053"),(0,r.kt)("p",null,"3\u3001\u6d88\u8d39\u8005\u76d1\u542c\u6307\u5b9a\u7684Queue\uff08\u961f\u5217\uff09"),(0,r.kt)("p",null,"4\u3001\u5f53\u6709\u6d88\u606f\u5230\u8fbeQueue\u65f6Broker\u9ed8\u8ba4\u5c06\u6d88\u606f\u63a8\u9001\u7ed9\u6d88\u8d39\u8005\u3002"),(0,r.kt)("p",null,"5\u3001\u6d88\u8d39\u8005\u63a5\u6536\u5230\u6d88\u606f\u3002"),(0,r.kt)("h3",{id:"1\u76f8\u5173\u6982\u5ff5\u4ecb\u7ecd"},"1\u3001\u76f8\u5173\u6982\u5ff5\u4ecb\u7ecd"),(0,r.kt)("p",null,"AMQP \u4e00\u4e2a\u63d0\u4f9b\u7edf\u4e00\u6d88\u606f\u670d\u52a1\u7684\u5e94\u7528\u5c42\u6807\u51c6\u9ad8\u7ea7\u6d88\u606f\u961f\u5217\u534f\u8bae\uff0c\u662f\u5e94\u7528\u5c42\u534f\u8bae\u7684\u4e00\u4e2a\u5f00\u653e\u6807\u51c6\uff0c\u4e3a\u9762\u5411\u6d88\u606f\u7684\u4e2d\u95f4\u4ef6\u8bbe\u8ba1\u3002"),(0,r.kt)("p",null,"AMQP\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u534f\u8bae\uff0c\u62e5\u6709\u4e00\u4e9b\u73b0\u4ee3\u5316\u7279\u70b9\uff1a\u591a\u4fe1\u9053\u3001\u534f\u5546\u5f0f\uff0c\u5f02\u6b65\uff0c\u5b89\u5168\uff0c\u6269\u5e73\u53f0\uff0c\u4e2d\u7acb\uff0c\u9ad8\u6548\u3002"),(0,r.kt)("p",null,"RabbitMQ\u662fAMQP\u534f\u8bae\u7684Erlang\u7684\u5b9e\u73b0\u3002"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u6982\u5ff5"),(0,r.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"\u8fde\u63a5Connection"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\uff0c\u6bd4\u5982TCP/IP\u5957\u63a5\u5b57\u8fde\u63a5\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"\u4f1a\u8bddSession"),(0,r.kt)("td",{parentName:"tr",align:null},"\u7aef\u70b9\u4e4b\u95f4\u7684\u547d\u540d\u5bf9\u8bdd\u3002\u5728\u4e00\u4e2a\u4f1a\u8bdd\u4e0a\u4e0b\u6587\u4e2d\uff0c\u4fdd\u8bc1\u201c\u6070\u597d\u4f20\u9012\u4e00\u6b21\u201d\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"\u4fe1\u9053Channel"),(0,r.kt)("td",{parentName:"tr",align:null},"\u591a\u8def\u590d\u7528\u8fde\u63a5\u4e2d\u7684\u4e00\u6761\u72ec\u7acb\u7684\u53cc\u5411\u6570\u636e\u6d41\u901a\u9053\u3002\u4e3a\u4f1a\u8bdd\u63d0\u4f9b\u7269\u7406\u4f20\u8f93\u4ecb\u8d28\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"\u5ba2\u6237\u7aefClient"),(0,r.kt)("td",{parentName:"tr",align:null},"AMQP\u8fde\u63a5\u6216\u8005\u4f1a\u8bdd\u7684\u53d1\u8d77\u8005\u3002AMQP\u662f\u975e\u5bf9\u79f0\u7684\uff0c\u5ba2\u6237\u7aef\u751f\u4ea7\u548c\u6d88\u8d39\u6d88\u606f\uff0c\u670d\u52a1\u5668\u5b58\u50a8\u548c\u8def\u7531\u8fd9\u4e9b\u6d88\u606f\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"\u670d\u52a1\u8282\u70b9Broker"),(0,r.kt)("td",{parentName:"tr",align:null},"\u6d88\u606f\u4e2d\u95f4\u4ef6\u7684\u670d\u52a1\u8282\u70b9\uff1b\u4e00\u822c\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5c06\u4e00\u4e2aRabbitMQ Broker\u770b\u4f5c\u4e00\u53f0RabbitMQ \u670d\u52a1\u5668\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"\u7aef\u70b9"),(0,r.kt)("td",{parentName:"tr",align:null},"AMQP\u5bf9\u8bdd\u7684\u4efb\u610f\u4e00\u65b9\u3002\u4e00\u4e2aAMQP\u8fde\u63a5\u5305\u62ec\u4e24\u4e2a\u7aef\u70b9\uff08\u4e00\u4e2a\u662f\u5ba2\u6237\u7aef\uff0c\u4e00\u4e2a\u662f\u670d\u52a1\u5668\uff09\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"\u6d88\u8d39\u8005Consumer"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4e00\u4e2a\u4ece\u6d88\u606f\u961f\u5217\u91cc\u8bf7\u6c42\u6d88\u606f\u7684\u5ba2\u6237\u7aef\u7a0b\u5e8f\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"\u751f\u4ea7\u8005Producer"),(0,r.kt)("td",{parentName:"tr",align:null},"\u4e00\u4e2a\u5411\u4ea4\u6362\u673a\u53d1\u5e03\u6d88\u606f\u7684\u5ba2\u6237\u7aef\u5e94\u7528\u7a0b\u5e8f\u3002")))),(0,r.kt)("h3",{id:"2rabbitmq\u8fd0\u8f6c\u6d41\u7a0b"},"2\u3001RabbitMQ\u8fd0\u8f6c\u6d41\u7a0b"),(0,r.kt)("p",null,"\u5728\u5165\u95e8\u6848\u4f8b\u4e2d\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u751f\u4ea7\u8005\u521b\u5efa\u8fde\u63a5\uff08Connection\uff09\uff0c\u5f00\u542f\u4e00\u4e2a\u4fe1\u9053\uff08Channel\uff09\uff0c\u8fde\u63a5\u5230RabbitMQ Broker\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u58f0\u660e\u961f\u5217\u5e76\u8bbe\u7f6e\u5c5e\u6027\uff1b\u5982\u662f\u5426\u6392\u5b83\uff0c\u662f\u5426\u6301\u4e45\u5316\uff0c\u662f\u5426\u81ea\u52a8\u5220\u9664\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u5c06\u8def\u7531\u952e\uff08\u7a7a\u5b57\u7b26\u4e32\uff09\u4e0e\u961f\u5217\u7ed1\u5b9a\u8d77\u6765\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u53d1\u9001\u6d88\u606f\u81f3RabbitMQ Broker\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u5173\u95ed\u4fe1\u9053\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u5173\u95ed\u8fde\u63a5\uff1b"))),(0,r.kt)("li",{parentName:"ul"},"\u6d88\u8d39\u8005\u63a5\u6536\u6d88\u606f",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u6d88\u8d39\u8005\u521b\u5efa\u8fde\u63a5\uff08Connection\uff09\uff0c\u5f00\u542f\u4e00\u4e2a\u4fe1\u9053\uff08Channel\uff09\uff0c\u8fde\u63a5\u5230RabbitMQ Broker"),(0,r.kt)("li",{parentName:"ol"},"\u5411Broker \u8bf7\u6c42\u6d88\u8d39\u76f8\u5e94\u961f\u5217\u4e2d\u7684\u6d88\u606f\uff0c\u8bbe\u7f6e\u76f8\u5e94\u7684\u56de\u8c03\u51fd\u6570\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u7b49\u5f85Broker\u56de\u5e94\u95ed\u5173\u6295\u9012\u54cd\u5e94\u961f\u5217\u4e2d\u7684\u6d88\u606f\uff0c\u6d88\u8d39\u8005\u63a5\u6536\u6d88\u606f\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u786e\u8ba4\uff08ack\uff0c\u81ea\u52a8\u786e\u8ba4\uff09\u63a5\u6536\u5230\u7684\u6d88\u606f\uff1b"),(0,r.kt)("li",{parentName:"ol"},"RabbitMQ\u4ece\u961f\u5217\u4e2d\u5220\u9664\u76f8\u5e94\u5df2\u7ecf\u88ab\u786e\u8ba4\u7684\u6d88\u606f\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u5173\u95ed\u4fe1\u9053\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u5173\u95ed\u8fde\u63a5\uff1b")))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1565105223969-aa63c797.png",alt:"1565105223969"}),"1565105223969"),(0,r.kt)("h3",{id:"3\u751f\u4ea7\u8005\u6d41\u8f6c\u8fc7\u7a0b\u8bf4\u660e"},"3\u3001\u751f\u4ea7\u8005\u6d41\u8f6c\u8fc7\u7a0b\u8bf4\u660e"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5ba2\u6237\u7aef\u4e0e\u4ee3\u7406\u670d\u52a1\u5668Broker\u5efa\u7acb\u8fde\u63a5\u3002\u4f1a\u8c03\u7528newConnection() \u65b9\u6cd5,\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u8fdb\u4e00\u6b65\u5c01\u88c5Protocol Header 0-9-1 \u7684\u62a5\u6587\u5934\u53d1\u9001\u7ed9Broker \uff0c\u4ee5\u6b64\u901a\u77e5Broker \u672c\u6b21\u4ea4\u4e92\u91c7\u7528\u7684\u662fAMQPO-9-1 \u534f\u8bae\uff0c\u7d27\u63a5\u7740Broker \u8fd4\u56deConnection.Start \u6765\u5efa\u7acb\u8fde\u63a5\uff0c\u5728\u8fde\u63a5\u7684\u8fc7\u7a0b\u4e2d\u6d89\u53caConnection.Start/.Start-OK \u3001Connection.Tune/.Tune-Ok \uff0cConnection.Open/ .Open-Ok \u8fd96 \u4e2a\u547d\u4ee4\u7684\u4ea4\u4e92\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5ba2\u6237\u7aef\u8c03\u7528connection.createChannel\u65b9\u6cd5\u3002\u6b64\u65b9\u6cd5\u5f00\u542f\u4fe1\u9053\uff0c\u5176\u5305\u88c5\u7684channel.open\u547d\u4ee4\u53d1\u9001\u7ed9Broker,\u7b49\u5f85channel.basicPublish\u65b9\u6cd5\uff0c\u5bf9\u5e94\u7684AMQP\u547d\u4ee4\u4e3aBasic.Publish,\u8fd9\u4e2a\u547d\u4ee4\u5305\u542b\u4e86content Header \u548ccontent Body()\u3002content Header \u5305\u542b\u4e86\u6d88\u606f\u4f53\u7684\u5c5e\u6027\uff0c\u4f8b\u5982:\u6295\u9012\u6a21\u5f0f\uff0c\u4f18\u5148\u7ea7\u7b49\uff0ccontent Body \u5305\u542b\u4e86\u6d88\u606f\u4f53\u672c\u8eab\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5ba2\u6237\u7aef\u53d1\u9001\u5b8c\u6d88\u606f\u9700\u8981\u5173\u95ed\u8d44\u6e90\u65f6\uff0c\u6d89\u53ca\u5230Channel.Close\u548cChannl.Close-Ok \u4e0eConnetion.Close\u548cConnection.Close-Ok\u7684\u547d\u4ee4\u4ea4\u4e92\u3002")),(0,r.kt)("p",null,"![\u751f\u4ea7\u8005\u6d41\u8f6c\u8fc7\u7a0b\u56fe]","(./img/\u751f\u4ea7\u8005\u6d41\u8f6c\u8fc7\u7a0b\u56fe.bmp"),(0,r.kt)("h3",{id:"4\u6d88\u8d39\u8005\u6d41\u8f6c\u8fc7\u7a0b\u8bf4\u660e"},"4\u3001\u6d88\u8d39\u8005\u6d41\u8f6c\u8fc7\u7a0b\u8bf4\u660e"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u6d88\u8d39\u8005\u5ba2\u6237\u7aef\u4e0e\u4ee3\u7406\u670d\u52a1\u5668Broker\u5efa\u7acb\u8fde\u63a5\u3002\u4f1a\u8c03\u7528newConnection() \u65b9\u6cd5,\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u8fdb\u4e00\u6b65\u5c01\u88c5Protocol Header 0-9-1 \u7684\u62a5\u6587\u5934\u53d1\u9001\u7ed9Broker \uff0c\u4ee5\u6b64\u901a\u77e5Broker \u672c\u6b21\u4ea4\u4e92\u91c7\u7528\u7684\u662fAMQPO-9-1 \u534f\u8bae\uff0c\u7d27\u63a5\u7740Broker \u8fd4\u56deConnection.Start \u6765\u5efa\u7acb\u8fde\u63a5\uff0c\u5728\u8fde\u63a5\u7684\u8fc7\u7a0b\u4e2d\u6d89\u53caConnection.Start/.Start-OK \u3001Connection.Tune/.Tune-Ok \uff0cConnection.Open/ .Open-Ok \u8fd96 \u4e2a\u547d\u4ee4\u7684\u4ea4\u4e92\u3002")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u6d88\u8d39\u8005\u5ba2\u6237\u7aef\u8c03\u7528connection.createChannel\u65b9\u6cd5\u3002\u548c\u751f\u4ea7\u8005\u5ba2\u6237\u7aef\u4e00\u6837\uff0c\u534f\u8bae\u6d89\u53caChannel . Open/Open-Ok\u547d\u4ee4\u3002")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728\u771f\u6b63\u6d88\u8d39\u4e4b\u524d\uff0c\u6d88\u8d39\u8005\u5ba2\u6237\u7aef\u9700\u8981\u5411Broker \u53d1\u9001Basic.Consume \u547d\u4ee4(\u5373\u8c03\u7528channel.basicConsume \u65b9\u6cd5\u3009\u5c06Channel \u7f6e\u4e3a\u63a5\u6536\u6a21\u5f0f\uff0c\u4e4b\u540eBroker \u56de\u6267Basic . Consume - Ok \u4ee5\u544a\u8bc9\u6d88\u8d39\u8005\u5ba2\u6237\u7aef\u51c6\u5907\u597d\u6d88\u8d39\u6d88\u606f\u3002")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Broker \u5411\u6d88\u8d39\u8005\u5ba2\u6237\u7aef\u63a8\u9001(Push) \u6d88\u606f\uff0c\u5373Basic.Deliver \u547d\u4ee4\uff0c\u8fd9\u4e2a\u547d\u4ee4\u548cBasic.Publish \u547d\u4ee4\u4e00\u6837\u4f1a\u643a\u5e26Content Header \u548cContent Body\u3002")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u6d88\u8d39\u8005\u63a5\u6536\u5230\u6d88\u606f\u5e76\u6b63\u786e\u6d88\u8d39\u4e4b\u540e\uff0c\u5411Broker \u53d1\u9001\u786e\u8ba4\uff0c\u5373Basic.Ack \u547d\u4ee4\u3002")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5ba2\u6237\u7aef\u53d1\u9001\u5b8c\u6d88\u606f\u9700\u8981\u5173\u95ed\u8d44\u6e90\u65f6\uff0c\u6d89\u53ca\u5230Channel.Close\u548cChannl.Close-Ok \u4e0eConnetion.Close\u548cConnection.Close-Ok\u7684\u547d\u4ee4\u4ea4\u4e92\u3002"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20221124210458935-d4f288f6.png",alt:"\u6d88\u8d39\u8005\u6d41\u8f6c\u8fc7\u7a0b\u56fe"}),"\u6d88\u8d39\u8005\u6d41\u8f6c\u8fc7\u7a0b\u56fe"))),(0,r.kt)("h2",{id:"\u7b2c\u4e09\u7ae0-\u5b89\u88c5\u53ca\u914d\u7f6erabbitmq"},"\u7b2c\u4e09\u7ae0 \u5b89\u88c5\u53ca\u914d\u7f6eRabbitMQ"),(0,r.kt)("h3",{id:"1\u4e0b\u8f7d\u5b89\u88c5"},"1\u3001\u4e0b\u8f7d\u5b89\u88c5"),(0,r.kt)("p",null," RabbitMQ\u7531Erlang\u8bed\u8a00\u5f00\u53d1\uff0cErlang\u8bed\u8a00\u7528\u4e8e\u5e76\u53d1\u53ca\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u5f00\u53d1\uff0c\u5728\u7535\u4fe1\u9886\u57df\u5e94\u7528\u5e7f\u6cdb\uff0cOTP\uff08Open Telecom Platform\uff09\u4f5c\u4e3aErlang\u8bed\u8a00\u7684\u4e00\u90e8\u5206\uff0c\u5305\u542b\u4e86\u5f88\u591a\u57fa\u4e8eErlang\u5f00\u53d1\u7684\u4e2d\u95f4\u4ef6\u53ca\u5de5\u5177\u5e93\uff0c\u5b89\u88c5RabbitMQ\u9700\u8981\u5b89\u88c5Erlang/OTP\uff0c\u5e76\u4fdd\u6301\u7248\u672c\u5339\u914d\uff0c\u5982\u4e0b\u56fe\uff1a"),(0,r.kt)("p",null,"RabbitMQ\u7684\u4e0b\u8f7d\u5730\u5740\uff1a",(0,r.kt)("a",{parentName:"p",href:"http://www.rabbitmq.com/download.html"},"http://www.rabbitmq.com/download.htmlopen in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408215304890-e1f46c2f.png",alt:"image-20220408215304890"}),"image-20220408215304890"),(0,r.kt)("p",null,"\u672c\u9879\u76ee\u4f7f\u7528Erlang/OTP 20.3\u7248\u672c\u548cRabbitMQ3.7.3\u7248\u672c\u3002"),(0,r.kt)("h3",{id:"2\u4e0b\u8f7derlang"},"2\u3001\u4e0b\u8f7derlang"),(0,r.kt)("p",null,"\u5b89\u88c5\u8f6f\u4ef6\uff1a\u8def\u5f84\u4e0d\u8981\u6709\u4e2d\u6587\u548c\u7a7a\u683c\u3002",(0,r.kt)("strong",{parentName:"p"},"\u7ba1\u7406\u5458")),(0,r.kt)("p",null,"1\u5730\u5740\u5982\u4e0b\uff1a"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.erlang.org/downloads"},"https://www.erlang.org/downloadsopen in new window")),(0,r.kt)("p",null,"\u6216\u53bb\u8001\u5e08\u63d0\u4f9b\u7684\u8f6f\u4ef6\u5305\u4e2d\u627e\u5230 otp_win64_20.3.exe\uff0c\u4ee5",(0,r.kt)("strong",{parentName:"p"},"\u7ba1\u7406\u5458"),"\u65b9\u5f0f\u8fd0\u884c\u6b64\u6587\u4ef6\uff0c\u5b89\u88c5\u3002"),(0,r.kt)("p",null,"2erlang\u5b89\u88c5\u5b8c\u6210\u9700\u8981\u914d\u7f6eerlang\u73af\u5883\u53d8\u91cf\uff1a"),(0,r.kt)("p",null," ERLANG_HOME=D:\\soft\\erl9.3"),(0,r.kt)("p",null," \u5728path\u4e2d\u6dfb\u52a0%ERLANG_HOME%\\bin"),(0,r.kt)("h3",{id:"3\u5b89\u88c5rabbitmq"},"3\u3001\u5b89\u88c5RabbitMQ"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/rabbitmq/rabbitmq-server/releases/tag/v3.7.3"},"https://github.com/rabbitmq/rabbitmq-server/releases/tag/v3.7.3open in new window")),(0,r.kt)("p",null,"\u6216\u53bb\u8001\u5e08\u63d0\u4f9b\u7684\u8f6f\u4ef6\u5305\u4e2d\u627e\u5230 rabbitmq-server-3.7.3.exe\uff0c\u4ee5",(0,r.kt)("strong",{parentName:"p"},"\u7ba1\u7406\u5458"),"\u65b9\u5f0f\u8fd0\u884c\u6b64\u6587\u4ef6\uff0c\u5b89\u88c5\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408220632620-dcd30a93.png",alt:"image-20220408220632620"}),"image-20220408220632620"),(0,r.kt)("h3",{id:"4\u542f\u52a8"},"4\u3001\u542f\u52a8"),(0,r.kt)("p",null,"\u5b89\u88c5\u6210\u529f\u540e\u4f1a\u81ea\u52a8\u521b\u5efaRabbitMQ\u670d\u52a1\u5e76\u4e14\u542f\u52a8\u3002"),(0,r.kt)("p",null,"\uff081\uff09\u4ece\u5f00\u59cb\u83dc\u5355\u542f\u52a8RabbitMQ"),(0,r.kt)("p",null,"\u5b8c\u6210\u5728\u5f00\u59cb\u83dc\u5355\u627e\u5230RabbitMQ\u7684\u83dc\u5355\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320174855134-7aa6274f.png",alt:"image-20200320174855134"}),"image-20200320174855134"),(0,r.kt)("p",null,"RabbitMQ Service-install :\u5b89\u88c5\u670d\u52a1"),(0,r.kt)("p",null,"RabbitMQ Service-remove \u5220\u9664\u670d\u52a1"),(0,r.kt)("p",null,"RabbitMQ Service-start \u542f\u52a8"),(0,r.kt)("p",null,"RabbitMQ Service-stop \u542f\u52a8"),(0,r.kt)("p",null,"\uff082\uff09\u5982\u679c\u6ca1\u6709\u5f00\u59cb\u83dc\u5355\u5219\u8fdb\u5165\u5b89\u88c5\u76ee\u5f55\u4e0bsbin\u76ee\u5f55\u624b\u52a8\u542f\u52a8\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320174919367-09c74d6b.png",alt:"image-20200320174919367"}),"image-20200320174919367"),(0,r.kt)("p",null,"\uff083\uff09\u5b89\u88c5\u5e76\u8fd0\u884c\u670d\u52a1"),(0,r.kt)("p",null,"rabbitmq-service.bat install \u5b89\u88c5\u670d\u52a1"),(0,r.kt)("p",null,"rabbitmq-service.bat stop \u505c\u6b62\u670d\u52a1"),(0,r.kt)("p",null,"rabbitmq-service.bat start \u542f\u52a8\u670d\u52a1"),(0,r.kt)("p",null,"\uff084\uff09\u5b89\u88c5\u7ba1\u7406\u63d2\u4ef6"),(0,r.kt)("p",null,"\u5b89\u88c5rabbitMQ\u7684\u7ba1\u7406\u63d2\u4ef6\uff0c\u65b9\u4fbf\u5728\u6d4f\u89c8\u5668\u7aef\u7ba1\u7406RabbitMQ"),(0,r.kt)("p",null,"\u5728sbin\u76ee\u5f55\u4e0b\uff0c",(0,r.kt)("strong",{parentName:"p"},"\u7ba1\u7406\u5458\u8eab\u4efd"),"\u8fd0\u884ccmd"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"rabbitmq-plugins.bat enable rabbitmq_management\n")),(0,r.kt)("h3",{id:"5\u542f\u52a8\u6210\u529f-\u767b\u5f55rabbitmq"},"5\u3001\u542f\u52a8\u6210\u529f \u767b\u5f55RabbitMQ"),(0,r.kt)("p",null,"\u8fdb\u5165\u6d4f\u89c8\u5668\uff0c\u8f93\u5165\uff1a",(0,r.kt)("a",{parentName:"p",href:"http://localhost:15672/"},"http://localhost:15672open in new window")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320175052306-a9c088c5.png",alt:"image-20200320175052306"}),"image-20200320175052306"),(0,r.kt)("p",null,"\u521d\u59cb\u8d26\u53f7\u548c\u5bc6\u7801\uff1aguest/guest"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408221008693-bd953c3f.png",alt:"image-20220408221008693"}),"image-20220408221008693"),(0,r.kt)("h3",{id:"6\u6ce8\u610f\u4e8b\u9879"},"6\u3001\u6ce8\u610f\u4e8b\u9879"),(0,r.kt)("p",null,"1\u3001\u5b89\u88c5erlang\u548crabbitMQ\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\u3002"),(0,r.kt)("p",null,"2\u3001\u5f53\u5378\u8f7d\u91cd\u65b0\u5b89\u88c5\u65f6\u4f1a\u51fa\u73b0RabbitMQ\u670d\u52a1\u6ce8\u518c\u5931\u8d25\uff0c\u6b64\u65f6\u9700\u8981\u8fdb\u5165\u6ce8\u518c\u8868\u6e05\u7406erlang"),(0,r.kt)("p",null,"\u641c\u7d22RabbitMQ\u3001ErlSrv\uff0c\u5c06\u5bf9\u5e94\u7684\u9879\u5168\u90e8\u5220\u9664\u3002"),(0,r.kt)("h3",{id:"7\u67e5\u770b\u7ba1\u7406\u63a7\u5236\u53f0"},"7\u3001\u67e5\u770b\u7ba1\u7406\u63a7\u5236\u53f0"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320175339750-e00ee8bc.png",alt:"image-20200320175339750"}),"image-20200320175339750"),(0,r.kt)("p",null,"\u5c1d\u8bd5\u65b0\u589e\u7528\u6237\u3001\u65b0\u589e\u865a\u62df\u673a\u3002"),(0,r.kt)("h2",{id:"\u7b2c\u56db\u7ae0-rabbitmq\u5165\u95e8"},"\u7b2c\u56db\u7ae0 RabbitMQ\u5165\u95e8"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u7b80\u5355\u6a21\u5f0f")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320180411894-5ac5a8b3.png",alt:"image-20200320180411894"}),"image-20200320180411894"),(0,r.kt)("h3",{id:"1\u642d\u5efa\u793a\u4f8b\u5de5\u7a0b"},"1\u3001\u642d\u5efa\u793a\u4f8b\u5de5\u7a0b"),(0,r.kt)("h4",{id:"1\u521b\u5efa\u5de5\u7a0b"},"\uff081\uff09\u521b\u5efa\u5de5\u7a0b"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408221608751-f881d76e.png",alt:"image-20220408221608751"}),"image-20220408221608751"),(0,r.kt)("p",null,"rabbitmqtest\u7236\u5de5\u7a0b\u4e0b\uff0c\u65b0\u5efa\u4e24\u4e2a\u6a21\u5757\uff1aproducer\u548cconsumer"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408221703947-3fefbc02.png",alt:"image-20220408221703947"}),"image-20220408221703947"),(0,r.kt)("h4",{id:"2\u6dfb\u52a0\u4f9d\u8d56"},"\uff082\uff09\u6dfb\u52a0\u4f9d\u8d56"),(0,r.kt)("p",null,"\u5f80rabbitmqtest\u7684pom.xml\u6587\u4ef6\u4e2d\u6dfb\u52a0\u5982\u4e0b\u4f9d\u8d56\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},"    <dependencies>\n        <dependency>\n            <groupId>com.rabbitmq</groupId>\n            <artifactId>amqp-client</artifactId>\n            <version>5.6.0</version>\n        </dependency>\n    </dependencies>\n")),(0,r.kt)("h3",{id:"2-\u7f16\u5199\u751f\u4ea7\u8005"},"2\u3001 \u7f16\u5199\u751f\u4ea7\u8005"),(0,r.kt)("p",null,"producer\u5de5\u7a0b\u4e2d\uff0c\u7f16\u5199\u6d88\u606f\u751f\u4ea7\u8005com.ydlclass.rabbitmq.simple.Producer"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.simple;\n\nimport com.rabbitmq.client.AMQP;\nimport com.rabbitmq.client.Channel;\nimport com.rabbitmq.client.Connection;\nimport com.rabbitmq.client.ConnectionFactory;\n\nimport java.io.IOException;\nimport java.util.concurrent.TimeoutException;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\npublic class Producer {\n\n    public static void main(String[] args) throws Exception {\n        //1\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory=new ConnectionFactory();\n        //\u8fde\u63a5\u7684ip\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7684\u7aef\u53e3\n        connectionFactory.setPort(5672);\n        //\u8bbe\u7f6e\u865a\u62df\u4e3b\u673a\n        connectionFactory.setVirtualHost("/");\n        //\u8bbe\u7f6e\u7528\u6237\u540d\n        connectionFactory.setUsername("itlils");\n        //\u8bbe\u7f6e\u5bc6\u7801\n        connectionFactory.setPassword("itlils");\n\n        //2\u521b\u5efa\u957f\u8fde\u63a5\n        Connection connection = connectionFactory.newConnection();\n        //3\u521b\u5efachannel\n        Channel channel = connection.createChannel();\n        //\u58f0\u660e\u961f\u5217\n        //String queue,  \u961f\u5217\u540d\n        // boolean durable, \u6301\u4e45\u5316\n        // boolean exclusive, \u6392\u4ed6\u7684\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.queueDeclare("ydlqueue",true,false,false,null);\n\n        //4\u53d1\u6d88\u606f\n        // String exchange,  \u4ea4\u6362\u673a\n        // String routingKey, \u8def\u7531\u952e\n        // AMQP.BasicProperties props, \u5c5e\u6027\n        // byte[] body \u6d88\u606f      string byte[] char[]\u5982\u4f55\u76f8\u4e92\u8f6c\u6362\u7684\uff1f\n        String msg="hello rabbitmq!";\n        channel.basicPublish("","ydlqueue",null,msg.getBytes());\n\n        //5\u5173\u95ed\u8fde\u63a5  \u8d44\u6e90\u5173\u95ed\u7684\u987a\u5e8f\uff0c\u5148\u5173\u540e\u51fa\u6765\u7684\u8d44\u6e90\uff0c\u6700\u540e\u5173\uff0c\u7b2c\u4e00\u4e2a\u8d44\u6e90\n        channel.close();\n        connection.close();\n    }\n}\n')),(0,r.kt)("p",null,"\u5728\u6267\u884c\u4e0a\u8ff0\u7684\u6d88\u606f\u53d1\u9001\u4e4b\u540e\uff1b\u53ef\u4ee5\u767b\u5f55rabbitMQ\u7684\u7ba1\u7406\u63a7\u5236\u53f0\uff0c\u53ef\u4ee5\u53d1\u73b0\u961f\u5217\u548c\u5176\u6d88\u606f\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408223540630-119923ff.png",alt:"image-20220408223540630"}),"image-20220408223540630"),(0,r.kt)("p",null,"\u67e5\u770b\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220408223601408-a29a49a6.png",alt:"image-20220408223601408"}),"image-20220408223601408"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6ce8\u610f"),"\uff1a\u5173\u95ed\u8fde\u63a5"),(0,r.kt)("h3",{id:"3-\u7f16\u5199\u6d88\u8d39\u8005"},"3\u3001 \u7f16\u5199\u6d88\u8d39\u8005"),(0,r.kt)("p",null,"consumer\u5de5\u7a0b\uff0c\u7f16\u5199\u6d88\u606f\u7684\u6d88\u8d39\u8005com.ydlclass.rabbitmq.simple.Consumer"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.simple;\n\nimport com.ydlclass.rabbitmq.util.ConnectionUtil;\nimport com.rabbitmq.client.*;\n\nimport java.io.IOException;\n\npublic class Consumer {\n\n    static final String QUEUE_NAME = "simple_queue";\n    public static void main(String[] args) throws Exception {\n        //1\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory = new ConnectionFactory();\n        //\u4e3b\u673a\u5730\u5740;\u9ed8\u8ba4\u4e3a localhost\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7aef\u53e3;\u9ed8\u8ba4\u4e3a 5672\n        connectionFactory.setPort(5672);\n        //\u865a\u62df\u4e3b\u673a\u540d\u79f0;\u9ed8\u8ba4\u4e3a /\n        connectionFactory.setVirtualHost("/");\n        //\u8fde\u63a5\u7528\u6237\u540d\uff1b\u9ed8\u8ba4\u4e3aguest\n        connectionFactory.setUsername("itlils");\n        //\u8fde\u63a5\u5bc6\u7801\uff1b\u9ed8\u8ba4\u4e3aguest\n        connectionFactory.setPassword("itlils");\n\n        //2\u521b\u5efa\u8fde\u63a5\n        Connection connection = connectionFactory.newConnection();\n\n        //3\u521b\u5efa\u9891\u9053\n        Channel channel = connection.createChannel();\n\n        //6\u58f0\u660e\uff08\u521b\u5efa\uff09\u961f\u5217\n        /**\n         * \u53c2\u65701\uff1a\u961f\u5217\u540d\u79f0\n         * \u53c2\u65702\uff1a\u662f\u5426\u5b9a\u4e49\u6301\u4e45\u5316\u961f\u5217\n         * \u53c2\u65703\uff1a\u662f\u5426\u72ec\u5360\u672c\u6b21\u8fde\u63a5\n         * \u53c2\u65704\uff1a\u662f\u5426\u5728\u4e0d\u4f7f\u7528\u7684\u65f6\u5019\u81ea\u52a8\u5220\u9664\u961f\u5217\n         * \u53c2\u65705\uff1a\u961f\u5217\u5176\u5b83\u53c2\u6570\n         */\n        channel.queueDeclare(QUEUE_NAME, true, false, false, null);\n\n        //5\u521b\u5efa\u6d88\u8d39\u8005\uff1b\u5e76\u8bbe\u7f6e\u6d88\u606f\u5904\u7406\n        DefaultConsumer consumer = new DefaultConsumer(channel){\n            @Override\n            /**\n             * consumerTag \u6d88\u606f\u8005\u6807\u7b7e\uff0c\u5728channel.basicConsume\u65f6\u5019\u53ef\u4ee5\u6307\u5b9a\n             * envelope \u6d88\u606f\u5305\u7684\u5185\u5bb9\uff0c\u53ef\u4ece\u4e2d\u83b7\u53d6\u6d88\u606fid\uff0c\u6d88\u606froutingkey\uff0c\u4ea4\u6362\u673a\uff0c\u6d88\u606f\u548c\u91cd\u4f20\u6807\u5fd7(\u6536\u5230\u6d88\u606f\u5931\u8d25\u540e\u662f\u5426\u9700\u8981\u91cd\u65b0\u53d1\u9001)\n             * properties \u5c5e\u6027\u4fe1\u606f\n             * body \u6d88\u606f\n             */\n            public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body) throws IOException {\n                //\u6d88\u8d39\u8005\u6807\u7b7e\n                System.out.println("\u6d88\u8d39\u8005\u6807\u7b7e\u4e3a\uff1a" + consumerTag);\n                //\u8def\u7531key\n                System.out.println("\u8def\u7531key\u4e3a\uff1a" + envelope.getRoutingKey());\n                //\u4ea4\u6362\u673a\n                System.out.println("\u4ea4\u6362\u673a\u4e3a\uff1a" + envelope.getExchange());\n                //\u6d88\u606fid\n                System.out.println("\u6d88\u606fid\u4e3a\uff1a" + envelope.getDeliveryTag());\n                //\u6536\u5230\u7684\u6d88\u606f\n                System.out.println("\u63a5\u6536\u5230\u7684\u6d88\u606f\u4e3a\uff1a" + new String(body, "utf-8"));\n            }\n        };\n        //4\u76d1\u542c\u6d88\u606f\n        /**\n         * \u53c2\u65701\uff1a\u961f\u5217\u540d\u79f0\n         * \u53c2\u65702\uff1a\u662f\u5426\u81ea\u52a8\u786e\u8ba4\uff0c\u8bbe\u7f6e\u4e3atrue\u4e3a\u8868\u793a\u6d88\u606f\u63a5\u6536\u5230\u81ea\u52a8\u5411mq\u56de\u590d\u63a5\u6536\u5230\u4e86\uff0cmq\u63a5\u6536\u5230\u56de\u590d\u4f1a\u5220\u9664\u6d88\u606f\uff0c\u8bbe\u7f6e\u4e3afalse\u5219\u9700\u8981\u624b\u52a8\u786e\u8ba4\n         * \u53c2\u65703\uff1a\u6d88\u606f\u63a5\u6536\u5230\u540e\u56de\u8c03\n         */\n        channel.basicConsume(QUEUE_NAME, true, consumer);\n\n        //\u4e0d\u5173\u95ed\u8d44\u6e90\uff0c\u5e94\u8be5\u4e00\u76f4\u76d1\u542c\u6d88\u606f\n        //channel.close();\n        //connection.close();\n    }\n}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6709\u80fd\u529b\u7684\u540c\u5b66"),"\uff0c\u62bd\u53d6\u521b\u5efaconnection\u7684\u5de5\u5177\u7c7bcom.ydlclass.rabbitmq.util.ConnectionUtil\uff1b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.util;\n\nimport com.rabbitmq.client.Connection;\nimport com.rabbitmq.client.ConnectionFactory;\n\npublic class ConnectionUtil {\n\n    public static Connection getConnection() throws Exception {\n        //\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory = new ConnectionFactory();\n        //\u4e3b\u673a\u5730\u5740;\u9ed8\u8ba4\u4e3a localhost\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7aef\u53e3;\u9ed8\u8ba4\u4e3a 5672\n        connectionFactory.setPort(5672);\n        //\u865a\u62df\u4e3b\u673a\u540d\u79f0;\u9ed8\u8ba4\u4e3a /\n        connectionFactory.setVirtualHost("/");\n        //\u8fde\u63a5\u7528\u6237\u540d\uff1b\u9ed8\u8ba4\u4e3aguest\n        connectionFactory.setUsername("itlils");\n        //\u8fde\u63a5\u5bc6\u7801\uff1b\u9ed8\u8ba4\u4e3aguest\n        connectionFactory.setPassword("itlils");\n\n        //\u521b\u5efa\u8fde\u63a5\n        return connectionFactory.newConnection();\n    }\n}\n')),(0,r.kt)("h3",{id:"4\u5c0f\u7ed3"},"4\u3001\u5c0f\u7ed3"),(0,r.kt)("p",null,"\u4e0a\u8ff0\u7684\u5165\u95e8\u6848\u4f8b\u4e2d\u4e2d\u5176\u5b9e\u4f7f\u7528\u7684\u662f\u5982\u4e0b\u7684\u7b80\u5355\u6a21\u5f0f\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1555991074575-378c6df5.png",alt:"1555991074575"}),"1555991074575"),(0,r.kt)("p",null,"\u5728\u4e0a\u56fe\u7684\u6a21\u578b\u4e2d\uff0c\u6709\u4ee5\u4e0b\u6982\u5ff5\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"P\uff1a\u751f\u4ea7\u8005\uff0c\u4e5f\u5c31\u662f\u8981\u53d1\u9001\u6d88\u606f\u7684\u7a0b\u5e8f"),(0,r.kt)("li",{parentName:"ul"},"C\uff1a\u6d88\u8d39\u8005\uff1a\u6d88\u606f\u7684\u63a5\u53d7\u8005\uff0c\u4f1a\u4e00\u76f4\u7b49\u5f85\u6d88\u606f\u5230\u6765\u3002"),(0,r.kt)("li",{parentName:"ul"},"queue\uff1a\u6d88\u606f\u961f\u5217\uff0c\u56fe\u4e2d\u7ea2\u8272\u90e8\u5206\u3002\u7c7b\u4f3c\u4e00\u4e2a\u90ae\u7bb1\uff0c\u53ef\u4ee5\u7f13\u5b58\u6d88\u606f\uff1b\u751f\u4ea7\u8005\u5411\u5176\u4e2d\u6295\u9012\u6d88\u606f\uff0c\u6d88\u8d39\u8005\u4ece\u5176\u4e2d\u53d6\u51fa\u6d88\u606f\u3002")),(0,r.kt)("h2",{id:"\u7b2c\u4e94\u7ae0-rabbitmq\u5de5\u4f5c\u6a21\u5f0f--\u91cd\u70b9"},"\u7b2c\u4e94\u7ae0 RabbitMQ\u5de5\u4f5c\u6a21\u5f0f--\u91cd\u70b9"),(0,r.kt)("h3",{id:"1work-queues\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f\u5305\u5de5\u5934"},"1\u3001Work queues\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f\uff08\u5305\u5de5\u5934\uff09"),(0,r.kt)("h4",{id:"1-\u6a21\u5f0f\u8bf4\u660e"},"\uff081\uff09 \u6a21\u5f0f\u8bf4\u660e"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1556009144848-97988634.png",alt:"1556009144848"}),"1556009144848"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Work Queues"),"\u4e0e\u5165\u95e8\u7a0b\u5e8f\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"\u7b80\u5355\u6a21\u5f0f"),"\u76f8\u6bd4\uff0c\u591a\u4e86\u4e00\u4e2a\u6216\u4e00\u4e9b\u6d88\u8d39\u7aef\uff0c\u591a\u4e2a\u6d88\u8d39\u7aef\u5171\u540c\u6d88\u8d39\u540c\u4e00\u4e2a\u961f\u5217\u4e2d\u7684\u6d88\u606f\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5e94\u7528\u573a\u666f"),"\uff1a\u5bf9\u4e8e \u4efb\u52a1\u8fc7\u91cd\u6216\u4efb\u52a1\u8f83\u591a\u60c5\u51b5\u4f7f\u7528\u5de5\u4f5c\u961f\u5217\u53ef\u4ee5\u63d0\u9ad8\u4efb\u52a1\u5904\u7406\u7684\u901f\u5ea6\u3002"),(0,r.kt)("h4",{id:"2\u4ee3\u7801"},"\uff082\uff09\u4ee3\u7801"),(0,r.kt)("p",null,"\u590d\u5236\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u5404\u4e00\u4efd"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411210359456-c4ca6df9.png",alt:"image-20220411210359456"}),"image-20220411210359456"),(0,r.kt)("h5",{id:"a\u751f\u4ea7\u8005-\u4fee\u6539\u961f\u5217\u540d"},"a\u3001\u751f\u4ea7\u8005 \u4fee\u6539\u961f\u5217\u540d"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'static final String QUEUE_NAME = "workqueue";\n\nfor (int i = 0; i < 10; i++) {\n            String msg="hello rabbitmq!workqueue"+i;\n            channel.basicPublish("",QUEUE,null,msg.getBytes());\n}\n')),(0,r.kt)("h5",{id:"b\u6d88\u8d39\u80051-\u76d1\u542c\u540c\u4e00\u4e2a\u961f\u5217"},"b\u3001\u6d88\u8d39\u80051 \u76d1\u542c\u540c\u4e00\u4e2a\u961f\u5217"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'static final String QUEUE_NAME = "workqueue";\n')),(0,r.kt)("h5",{id:"c\u6d88\u8d39\u80052-\u6d88\u8d39\u8005\u518d\u8d77\u4e00\u4efd"},"c\u3001\u6d88\u8d39\u80052 \u6d88\u8d39\u8005\u518d\u8d77\u4e00\u4efd"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'static final String QUEUE_NAME = "workqueue";\n')),(0,r.kt)("h3",{id:"3\u6d4b\u8bd5"},"\uff083\uff09\u6d4b\u8bd5"),(0,r.kt)("p",null,"\u751f\u4ea7\u8005\uff0c\u591a\u8fd0\u884c\u51e0\u6b21\uff0c\u89c2\u5bdf\u8fde\u4e2a\u6d88\u8d39\u8005"),(0,r.kt)("p",null,"\u8bbe\u7f6e\uff0c\u6d88\u8d39\u8005\u80fd\u542f\u591a\u4efd\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411210105591-b88f5e92.png",alt:"image-20220411210105591"}),"image-20220411210105591"),(0,r.kt)("p",null,"\u5728\u4e00\u4e2a\u961f\u5217\u4e2d\u5982\u679c\u6709\u591a\u4e2a\u6d88\u8d39\u8005\uff0c\u90a3\u4e48\u6d88\u8d39\u8005\u4e4b\u95f4\u5bf9\u4e8e\u540c\u4e00\u4e2a\u961f\u5217\u6d88\u606f\u7684\u5173\u7cfb\u662f",(0,r.kt)("strong",{parentName:"p"},"\u7ade\u4e89"),"\u7684\u5173\u7cfb\u3002"),(0,r.kt)("p",null,"\u7b2c\u4e00\u4e2a\u6d88\u8d39\u8005"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411210449520-b8782f8d.png",alt:"image-20220411210449520"}),"image-20220411210449520"),(0,r.kt)("p",null,"\u7b2c\u4e8c\u4e2a\u6d88\u8d39\u8005:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411210501744-c194803f.png",alt:"image-20220411210501744"}),"image-20220411210501744"),(0,r.kt)("h3",{id:"2publishsubscribe-\u8ba2\u9605\u53d1\u5e03\u6a21\u5f0f\u7c7b\u578b\u5fae\u535a"},"2\u3001publish/subscribe \u8ba2\u9605\u53d1\u5e03\u6a21\u5f0f\u7c7b\u578b\uff08\u5fae\u535a\uff09"),(0,r.kt)("p",null,"atm\u53d6100\u5143\uff0c\u77ed\u4fe1\uff0c\u90ae\u4ef6\u3002"),(0,r.kt)("p",null,"\u8ba2\u9605\u6a21\u5f0f\u793a\u4f8b\u56fe\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1556014499573-697c4d0b.png",alt:"1556014499573"}),"1556014499573"),(0,r.kt)("p",null,"\u524d\u97622\u4e2a\u6848\u4f8b\u4e2d\uff0c\u53ea\u67093\u4e2a\u89d2\u8272\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"P\uff1a\u751f\u4ea7\u8005\uff0c\u4e5f\u5c31\u662f\u8981\u53d1\u9001\u6d88\u606f\u7684\u7a0b\u5e8f"),(0,r.kt)("li",{parentName:"ul"},"C\uff1a\u6d88\u8d39\u8005\uff1a\u6d88\u606f\u7684\u63a5\u53d7\u8005\uff0c\u4f1a\u4e00\u76f4\u7b49\u5f85\u6d88\u606f\u5230\u6765\u3002"),(0,r.kt)("li",{parentName:"ul"},"queue\uff1a\u6d88\u606f\u961f\u5217\uff0c\u56fe\u4e2d\u7ea2\u8272\u90e8\u5206")),(0,r.kt)("p",null,"\u800c\u5728\u8ba2\u9605\u6a21\u578b\u4e2d\uff0c\u591a\u4e86\u4e00\u4e2aexchange\u89d2\u8272\uff0c\u800c\u4e14\u8fc7\u7a0b\u7565\u6709\u53d8\u5316\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"P\uff1a\u751f\u4ea7\u8005\uff0c\u4e5f\u5c31\u662f\u8981\u53d1\u9001\u6d88\u606f\u7684\u7a0b\u5e8f\uff0c\u4f46\u662f\u4e0d\u518d\u53d1\u9001\u5230\u961f\u5217\u4e2d\uff0c\u800c\u662f\u53d1\u7ed9X\uff08\u4ea4\u6362\u673a\uff09"),(0,r.kt)("li",{parentName:"ul"},"C\uff1a\u6d88\u8d39\u8005\uff0c\u6d88\u606f\u7684\u63a5\u53d7\u8005\uff0c\u4f1a\u4e00\u76f4\u7b49\u5f85\u6d88\u606f\u5230\u6765\u3002"),(0,r.kt)("li",{parentName:"ul"},"Queue\uff1a\u6d88\u606f\u961f\u5217\uff0c\u63a5\u6536\u6d88\u606f\u3001\u7f13\u5b58\u6d88\u606f\u3002"),(0,r.kt)("li",{parentName:"ul"},"Exchange\uff1a\u4ea4\u6362\u673a\uff0c\u56fe\u4e2d\u7684X\u3002\u4e00\u65b9\u9762\uff0c\u63a5\u6536\u751f\u4ea7\u8005\u53d1\u9001\u7684\u6d88\u606f\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u77e5\u9053\u5982\u4f55\u5904\u7406\u6d88\u606f\uff0c\u4f8b\u5982\u9012\u4ea4\u7ed9\u67d0\u4e2a\u7279\u522b\u961f\u5217\u3001\u9012\u4ea4\u7ed9\u6240\u6709\u961f\u5217\u3001\u6216\u662f\u5c06\u6d88\u606f\u4e22\u5f03\u3002\u5230\u5e95\u5982\u4f55\u64cd\u4f5c\uff0c\u53d6\u51b3\u4e8eExchange\u7684\u7c7b\u578b\u3002Exchange\u6709\u5e38\u89c1\u4ee5\u4e0b3\u79cd\u7c7b\u578b\uff1a",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Fanout\uff1a\u5e7f\u64ad\uff0c\u5c06\u6d88\u606f\u4ea4\u7ed9\u6240\u6709\u7ed1\u5b9a\u5230\u4ea4\u6362\u673a\u7684\u961f\u5217"),(0,r.kt)("li",{parentName:"ul"},"Direct\uff1a\u5b9a\u5411\uff0c\u628a\u6d88\u606f\u4ea4\u7ed9\u7b26\u5408\u6307\u5b9arouting key \u7684\u961f\u5217"),(0,r.kt)("li",{parentName:"ul"},"Topic\uff1a\u901a\u914d\u7b26\uff0c\u628a\u6d88\u606f\u4ea4\u7ed9\u7b26\u5408routing pattern\uff08\u8def\u7531\u6a21\u5f0f\uff09 \u7684\u961f\u5217")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Exchange\uff08\u4ea4\u6362\u673a\uff09\u53ea\u8d1f\u8d23\u8f6c\u53d1\u6d88\u606f\uff0c\u4e0d\u5177\u5907\u5b58\u50a8\u6d88\u606f\u7684\u80fd\u529b"),"\uff0c\u56e0\u6b64\u5982\u679c\u6ca1\u6709\u4efb\u4f55\u961f\u5217\u4e0eExchange\u7ed1\u5b9a\uff0c\u6216\u8005\u6ca1\u6709\u7b26\u5408\u8def\u7531\u89c4\u5219\u7684\u961f\u5217\uff0c\u90a3\u4e48\u6d88\u606f\u4f1a\u4e22\u5931\uff01"),(0,r.kt)("h3",{id:"3-publishsubscribe\u53d1\u5e03\u4e0e\u8ba2\u9605\u6a21\u5f0f\u5fae\u535a"},"3\u3001 Publish/Subscribe\u53d1\u5e03\u4e0e\u8ba2\u9605\u6a21\u5f0f\uff08\u5fae\u535a\uff09"),(0,r.kt)("h4",{id:"-1\u6a21\u5f0f\u8bf4\u660e"},"\uff08 1\uff09\u6a21\u5f0f\u8bf4\u660e"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1556010329032-ed5e1d7d.png",alt:"1556010329032"}),"1556010329032"),(0,r.kt)("p",null,"\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\uff1a 1\u3001\u6bcf\u4e2a\u6d88\u8d39\u8005\u76d1\u542c\u81ea\u5df1\u7684\u961f\u5217\u3002 2\u3001\u751f\u4ea7\u8005\u5c06\u6d88\u606f\u53d1\u7ed9broker\uff0c\u7531\u4ea4\u6362\u673a\u5c06\u6d88\u606f\u8f6c\u53d1\u5230\u7ed1\u5b9a\u6b64\u4ea4\u6362\u673a\u7684\u6bcf\u4e2a\u961f\u5217\uff0c\u6bcf\u4e2a\u7ed1\u5b9a\u4ea4\u6362\u673a\u7684\u961f\u5217\u90fd\u5c06\u63a5\u6536 \u5230\u6d88\u606f"),(0,r.kt)("h4",{id:"2\u4ee3\u7801-1"},"\uff082\uff09\u4ee3\u7801"),(0,r.kt)("h5",{id:"a\u751f\u4ea7\u8005"},"a\u3001\u751f\u4ea7\u8005"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.simple;\n\nimport com.rabbitmq.client.BuiltinExchangeType;\nimport com.rabbitmq.client.Channel;\nimport com.rabbitmq.client.Connection;\nimport com.rabbitmq.client.ConnectionFactory;\n\n/**\n * creste by ydlclass.\n */\npublic class Producer_pubsub {\n    //\u4ea4\u6362\u673a\u540d\u79f0\n    static final String FANOUT_EXCHAGE = "fanout_exchange";\n    //\u961f\u5217\u540d\u79f0\n    static final String FANOUT_QUEUE_1 = "fanout_queue_1";\n    //\u961f\u5217\u540d\u79f0\n    static final String FANOUT_QUEUE_2 = "fanout_queue_2";\n\n    public static void main(String[] args) throws Exception {\n\n        //1\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory = new ConnectionFactory();\n        //\u4e3b\u673a\u5730\u5740;\u9ed8\u8ba4\u4e3a localhost\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7aef\u53e3;\u9ed8\u8ba4\u4e3a 5672\n        connectionFactory.setPort(5672);\n        //\u865a\u62df\u4e3b\u673a\u540d\u79f0;\u9ed8\u8ba4\u4e3a /\n        connectionFactory.setVirtualHost("/");\n        //\u8fde\u63a5\u7528\u6237\u540d\uff1b\u9ed8\u8ba4\u4e3aguest\n        connectionFactory.setUsername("itlils");\n        //\u8fde\u63a5\u5bc6\u7801\uff1b\u9ed8\u8ba4\u4e3aguest\n        connectionFactory.setPassword("itlils");\n\n        //2\u521b\u5efa\u8fde\u63a5\n        Connection connection = connectionFactory.newConnection();\n\n        //3\u521b\u5efa\u9891\u9053\n        Channel channel = connection.createChannel();\n\n        /**\n         * \u58f0\u660e\u4ea4\u6362\u673a\n         * \u53c2\u65701\uff1a\u4ea4\u6362\u673a\u540d\u79f0\n         * \u53c2\u65702\uff1a\u4ea4\u6362\u673a\u7c7b\u578b\uff0cfanout\u3001topic\u3001direct\u3001headers\n         * \u53c2\u65703\uff1a\u662f\u5426\u5b9a\u4e49\u6301\u4e45\u5316\n         * \u53c2\u65704\uff1a\u662f\u5426\u5728\u4e0d\u4f7f\u7528\u7684\u65f6\u5019\u81ea\u52a8\u5220\u9664\n         */\n        channel.exchangeDeclare(FANOUT_EXCHAGE, BuiltinExchangeType.FANOUT,true,true,null);\n\n        // \u58f0\u660e\uff08\u521b\u5efa\uff09\u961f\u5217\n        /**\n         * \u53c2\u65701\uff1a\u961f\u5217\u540d\u79f0\n         * \u53c2\u65702\uff1a\u662f\u5426\u5b9a\u4e49\u6301\u4e45\u5316\u961f\u5217\n         * \u53c2\u65703\uff1a\u662f\u5426\u72ec\u5360\u672c\u6b21\u8fde\u63a5\n         * \u53c2\u65704\uff1a\u662f\u5426\u5728\u4e0d\u4f7f\u7528\u7684\u65f6\u5019\u81ea\u52a8\u5220\u9664\u961f\u5217\n         * \u53c2\u65705\uff1a\u961f\u5217\u5176\u5b83\u53c2\u6570\n         */\n        channel.queueDeclare(FANOUT_QUEUE_1, true, false, false, null);\n        channel.queueDeclare(FANOUT_QUEUE_2, true, false, false, null);\n\n        //\u961f\u5217\u7ed1\u5b9a\u4ea4\u6362\u673a\n        channel.queueBind(FANOUT_QUEUE_1, FANOUT_EXCHAGE, "");\n        channel.queueBind(FANOUT_QUEUE_2, FANOUT_EXCHAGE, "");\n\n        for (int i = 1; i <= 10; i++) {\n            // \u53d1\u9001\u4fe1\u606f\n            String message = "\u4f60\u597d\uff1b\u5c0f\u5154\u5b50\uff01\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f--" + i;\n            /**\n             * \u53c2\u65701\uff1a\u4ea4\u6362\u673a\u540d\u79f0\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u5219\u4f7f\u7528\u9ed8\u8ba4Default Exchage\n             * \u53c2\u65702\uff1a\u8def\u7531key,\u7b80\u5355\u6a21\u5f0f\u53ef\u4ee5\u4f20\u9012\u961f\u5217\u540d\u79f0\n             * \u53c2\u65703\uff1a\u6d88\u606f\u5176\u5b83\u5c5e\u6027\n             * \u53c2\u65704\uff1a\u6d88\u606f\u5185\u5bb9\n             */\n            channel.basicPublish(FANOUT_EXCHAGE, "", null, message.getBytes());\n            System.out.println("\u5df2\u53d1\u9001\u6d88\u606f\uff1a" + message);\n        }\n\n        // \u5173\u95ed\u8d44\u6e90\n        channel.close();\n        connection.close();\n    }\n}\n')),(0,r.kt)("h5",{id:"b\u6d88\u8d39\u80051"},"b\u3001\u6d88\u8d39\u80051"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.publish;\n\nimport com.rabbitmq.client.*;\n\nimport java.io.IOException;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\npublic class Consumer1 {\n    //\u4ea4\u6362\u673a\u540d\u79f0\n    static final String FANOUT_EXCHAGE = "fanout_exchange";\n    //\u961f\u5217\u540d\u79f0\n    static final String FANOUT_QUEUE_1 = "fanout_queue_1";\n    //\u961f\u5217\u540d\u79f0\n    static final String FANOUT_QUEUE_2 = "fanout_queue_2";\n\n    public static void main(String[] args) throws Exception {\n        //1\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory=new ConnectionFactory();\n        //\u8fde\u63a5\u7684ip\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7684\u7aef\u53e3\n        connectionFactory.setPort(5672);\n        //\u8bbe\u7f6e\u865a\u62df\u4e3b\u673a\n        connectionFactory.setVirtualHost("/");\n        //\u8bbe\u7f6e\u7528\u6237\u540d\n        connectionFactory.setUsername("itlils");\n        //\u8bbe\u7f6e\u5bc6\u7801\n        connectionFactory.setPassword("itlils");\n\n        //2\u521b\u5efa\u957f\u8fde\u63a5\n        Connection connection = connectionFactory.newConnection();\n        //3\u521b\u5efachannel\n        Channel channel = connection.createChannel();\n\n        //\u58f0\u660e\u961f\u5217\n        //String queue,  \u961f\u5217\u540d\n        // boolean durable, \u6301\u4e45\u5316\n        // boolean exclusive, \u6392\u4ed6\u7684\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.queueDeclare(FANOUT_QUEUE_1,true,false,false,null);\n        channel.queueDeclare(FANOUT_QUEUE_2,true,false,false,null);\n\n        // \u58f0\u660e\u4ea4\u6362\u673a\n        // String exchange,  \u4ea4\u6362\u673a\u540d\u79f0\n        // BuiltinExchangeType type, \u4ea4\u6362\u673a\u7c7b\u578b\n        // boolean durable,  \u6301\u4e45\u5316\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.exchangeDeclare(FANOUT_EXCHAGE, BuiltinExchangeType.FANOUT,true,false,null);\n\n        //\u961f\u5217\u7ed1\u5b9a\u4ea4\u6362\u673a\n        // String queue, \u961f\u5217\u540d\u79f0\n        // String exchange, \u4ea4\u6362\u673a\u540d\u79f0\n        // String routingKey \u8def\u7531\u952e\n        channel.queueBind(FANOUT_QUEUE_1,FANOUT_EXCHAGE,"");\n        channel.queueBind(FANOUT_QUEUE_2,FANOUT_EXCHAGE,"");\n\n\n        //4\u76d1\u542c\u67d0\u4e2a\u961f\u5217\n        // String queue, \u76d1\u542c\u7684\u961f\u5217\u540d\n        // boolean autoAck, \u662f\u5426\u81ea\u52a8\u5e94\u7b54\n        // Consumer callback \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n        com.rabbitmq.client.Consumer consumer=new DefaultConsumer(channel){\n            // \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n            //  String consumerTag, \u6d88\u8d39\u8005\u6807\u7b7e\n            // Envelope envelope, \u4fe1\u5c01 \u4fdd\u5b58\u5f88\u591a\u4fe1\u606f\n            // AMQP.BasicProperties properties, \u5c5e\u6027\n            // byte[] body  \u6d88\u606f\u5b57\u8282\u6570\u7ec4\n            @Override\n            public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body) throws IOException {\n                //\u4e1a\u52a1\u903b\u8f91\n\n                //\u73b0\u5728\u7684\u4e1a\u52a1\u903b\u8f91\u5c31\u662f\u6253\u5370\n//                System.out.println("consumerTag:"+consumerTag);\n//                System.out.println("Exchange:"+envelope.getExchange());\n//                System.out.println("RoutingKey:"+envelope.getRoutingKey());\n//                System.out.println("DeliveryTag:"+envelope.getDeliveryTag()); //\u6d88\u606fid\n\n                System.out.println(new String(body));\n            }\n        };\n        channel.basicConsume(FANOUT_QUEUE_1,true,consumer);\n\n        //5 \u5343\u4e07\u522b\u5173\u95ed\u8fde\u63a5\uff0c\u8981\u4e0d\u7136queue\u6709\u4e86\u6d88\u606f \u63a8\u4e0d\u8fc7\u6765\u4e86\n//        channel.close();\n//        connection.close();\n\n\n\n    }\n}\n')),(0,r.kt)("h5",{id:"c\u6d88\u8d39\u80052"},"c\u3001\u6d88\u8d39\u80052"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.publish;\n\nimport com.rabbitmq.client.*;\n\nimport java.io.IOException;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\npublic class Consumer2 {\n    //\u4ea4\u6362\u673a\u540d\u79f0\n    static final String FANOUT_EXCHAGE = "fanout_exchange";\n    //\u961f\u5217\u540d\u79f0\n    static final String FANOUT_QUEUE_1 = "fanout_queue_1";\n    //\u961f\u5217\u540d\u79f0\n    static final String FANOUT_QUEUE_2 = "fanout_queue_2";\n\n    public static void main(String[] args) throws Exception {\n        //1\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory=new ConnectionFactory();\n        //\u8fde\u63a5\u7684ip\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7684\u7aef\u53e3\n        connectionFactory.setPort(5672);\n        //\u8bbe\u7f6e\u865a\u62df\u4e3b\u673a\n        connectionFactory.setVirtualHost("/");\n        //\u8bbe\u7f6e\u7528\u6237\u540d\n        connectionFactory.setUsername("itlils");\n        //\u8bbe\u7f6e\u5bc6\u7801\n        connectionFactory.setPassword("itlils");\n\n        //2\u521b\u5efa\u957f\u8fde\u63a5\n        Connection connection = connectionFactory.newConnection();\n        //3\u521b\u5efachannel\n        Channel channel = connection.createChannel();\n\n        //\u58f0\u660e\u961f\u5217\n        //String queue,  \u961f\u5217\u540d\n        // boolean durable, \u6301\u4e45\u5316\n        // boolean exclusive, \u6392\u4ed6\u7684\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.queueDeclare(FANOUT_QUEUE_1,true,false,false,null);\n        channel.queueDeclare(FANOUT_QUEUE_2,true,false,false,null);\n\n        // \u58f0\u660e\u4ea4\u6362\u673a\n        // String exchange,  \u4ea4\u6362\u673a\u540d\u79f0\n        // BuiltinExchangeType type, \u4ea4\u6362\u673a\u7c7b\u578b\n        // boolean durable,  \u6301\u4e45\u5316\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.exchangeDeclare(FANOUT_EXCHAGE, BuiltinExchangeType.FANOUT,true,false,null);\n\n        //\u961f\u5217\u7ed1\u5b9a\u4ea4\u6362\u673a\n        // String queue, \u961f\u5217\u540d\u79f0\n        // String exchange, \u4ea4\u6362\u673a\u540d\u79f0\n        // String routingKey \u8def\u7531\u952e\n        channel.queueBind(FANOUT_QUEUE_1,FANOUT_EXCHAGE,"");\n        channel.queueBind(FANOUT_QUEUE_2,FANOUT_EXCHAGE,"");\n\n\n        //4\u76d1\u542c\u67d0\u4e2a\u961f\u5217\n        // String queue, \u76d1\u542c\u7684\u961f\u5217\u540d\n        // boolean autoAck, \u662f\u5426\u81ea\u52a8\u5e94\u7b54\n        // Consumer callback \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n        Consumer consumer=new DefaultConsumer(channel){\n            // \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n            //  String consumerTag, \u6d88\u8d39\u8005\u6807\u7b7e\n            // Envelope envelope, \u4fe1\u5c01 \u4fdd\u5b58\u5f88\u591a\u4fe1\u606f\n            // AMQP.BasicProperties properties, \u5c5e\u6027\n            // byte[] body  \u6d88\u606f\u5b57\u8282\u6570\u7ec4\n            @Override\n            public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body) throws IOException {\n                //\u4e1a\u52a1\u903b\u8f91\n\n                //\u73b0\u5728\u7684\u4e1a\u52a1\u903b\u8f91\u5c31\u662f\u6253\u5370\n//                System.out.println("consumerTag:"+consumerTag);\n//                System.out.println("Exchange:"+envelope.getExchange());\n//                System.out.println("RoutingKey:"+envelope.getRoutingKey());\n//                System.out.println("DeliveryTag:"+envelope.getDeliveryTag()); //\u6d88\u606fid\n\n                System.out.println(new String(body));\n            }\n        };\n        channel.basicConsume(FANOUT_QUEUE_2,true,consumer);\n\n        //5 \u5343\u4e07\u522b\u5173\u95ed\u8fde\u63a5\uff0c\u8981\u4e0d\u7136queue\u6709\u4e86\u6d88\u606f \u63a8\u4e0d\u8fc7\u6765\u4e86\n//        channel.close();\n//        connection.close();\n\n\n\n    }\n}\n')),(0,r.kt)("h4",{id:"3-\u6d4b\u8bd5"},"\uff083\uff09 \u6d4b\u8bd5"),(0,r.kt)("p",null,"\u542f\u52a8\u6240\u6709\u6d88\u8d39\u8005\uff0c\u7136\u540e\u4f7f\u7528\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\uff1b\u5728\u6bcf\u4e2a\u6d88\u8d39\u8005\u5bf9\u5e94\u7684\u63a7\u5236\u53f0\u53ef\u4ee5\u67e5\u770b\u5230\u751f\u4ea7\u8005\u53d1\u9001\u7684\u6240\u6709\u6d88\u606f\uff1b\u5230\u8fbe",(0,r.kt)("strong",{parentName:"p"},"\u5e7f\u64ad"),"\u7684\u6548\u679c\u3002"),(0,r.kt)("p",null,"\u5728\u6267\u884c\u5b8c\u6d4b\u8bd5\u4ee3\u7801\u540e\uff0c\u5176\u5b9e\u5230RabbitMQ\u7684\u7ba1\u7406\u540e\u53f0\u627e\u5230",(0,r.kt)("inlineCode",{parentName:"p"},"Exchanges"),"\u9009\u9879\u5361\uff0c\u70b9\u51fb ",(0,r.kt)("inlineCode",{parentName:"p"},"fanout_exchange")," \u7684\u4ea4\u6362\u673a\uff0c\u53ef\u4ee5\u67e5\u770b\u5230\u5982\u4e0b\u7684\u7ed1\u5b9a\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411212807072-d93ba322.png",alt:"image-20220411212807072"}),"image-20220411212807072"),(0,r.kt)("p",null,"\u6d4b\u8bd5\u53d1\u9001\u4e00\u6761\u6d88\u606f\uff1a"),(0,r.kt)("p",null,"\u4e24\u4e2a\u6d88\u8d39\u8005\u90fd\u63a5\u53d7\u5230\u540c\u6837\u7684\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411212727005-4caee19c.png",alt:"image-20220411212727005"}),"image-20220411212727005"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411212734150-3bcc1d8a.png",alt:"image-20220411212734150"}),"image-20220411212734150"),(0,r.kt)("h4",{id:"4\u5c0f\u7ed3-1"},"\uff084\uff09\u5c0f\u7ed3"),(0,r.kt)("p",null,"\u4ea4\u6362\u673a\u9700\u8981\u4e0e\u961f\u5217\u8fdb\u884c\u7ed1\u5b9a\uff0c\u7ed1\u5b9a\u4e4b\u540e\uff1b\u4e00\u4e2a\u6d88\u606f\u53ef\u4ee5\u88ab\u591a\u4e2a\u6d88\u8d39\u8005\u90fd\u6536\u5230\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\u4e0e\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f\u7684\u533a\u522b")),(0,r.kt)("p",null,"1\u3001\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f\u4e0d\u7528\u5b9a\u4e49\u4ea4\u6362\u673a\uff0c\u800c\u53d1\u5e03/\u8ba2\u9605\u6a21\u5f0f\u9700\u8981\u5b9a\u4e49\u4ea4\u6362\u673a\u3002"),(0,r.kt)("p",null,"2\u3001\u53d1\u5e03/\u8ba2\u9605\u6a21\u5f0f\u7684\u751f\u4ea7\u65b9\u662f\u9762\u5411\u4ea4\u6362\u673a\u53d1\u9001\u6d88\u606f\uff0c\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f\u7684\u751f\u4ea7\u65b9\u662f\u9762\u5411\u961f\u5217\u53d1\u9001\u6d88\u606f(\u5e95\u5c42\u4f7f\u7528\u9ed8\u8ba4\u4ea4\u6362\u673a)\u3002"),(0,r.kt)("p",null,"3\u3001\u53d1\u5e03/\u8ba2\u9605\u6a21\u5f0f\u9700\u8981\u8bbe\u7f6e\u961f\u5217\u548c\u4ea4\u6362\u673a\u7684\u7ed1\u5b9a\uff0c\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f\u4e0d\u9700\u8981\u8bbe\u7f6e\uff0c\u5b9e\u9645\u4e0a\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f\u4f1a\u5c06\u961f\u5217\u7ed1 \u5b9a\u5230\u9ed8\u8ba4\u7684\u4ea4\u6362\u673a \u3002"),(0,r.kt)("h3",{id:"4routing\u8def\u7531\u6a21\u5f0f\u5206\u5e03\u5f0f\u65e5\u5fd7\u6536\u96c6\u7cfb\u7edf"},"4\u3001Routing\u8def\u7531\u6a21\u5f0f\uff08\u5206\u5e03\u5f0f\u65e5\u5fd7\u6536\u96c6\u7cfb\u7edf\uff09"),(0,r.kt)("h4",{id:"1\u6a21\u5f0f\u8bf4\u660e"},"\uff081\uff09\u6a21\u5f0f\u8bf4\u660e"),(0,r.kt)("p",null,"\u8def\u7531\u6a21\u5f0f\u7279\u70b9\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u961f\u5217\u4e0e\u4ea4\u6362\u673a\u7684\u7ed1\u5b9a\uff0c\u4e0d\u80fd\u662f\u4efb\u610f\u7ed1\u5b9a\u4e86\uff0c\u800c\u662f\u8981\u6307\u5b9a\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"li"},"RoutingKey"),"\uff08\u8def\u7531key\uff09"),(0,r.kt)("li",{parentName:"ul"},"\u6d88\u606f\u7684\u53d1\u9001\u65b9\u5728 \u5411 Exchange\u53d1\u9001\u6d88\u606f\u65f6\uff0c\u4e5f\u5fc5\u987b\u6307\u5b9a\u6d88\u606f\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"RoutingKey"),"\u3002"),(0,r.kt)("li",{parentName:"ul"},"Exchange\u4e0d\u518d\u628a\u6d88\u606f\u4ea4\u7ed9\u6bcf\u4e00\u4e2a\u7ed1\u5b9a\u7684\u961f\u5217\uff0c\u800c\u662f\u6839\u636e\u6d88\u606f\u7684",(0,r.kt)("inlineCode",{parentName:"li"},"Routing Key"),"\u8fdb\u884c\u5224\u65ad\uff0c\u53ea\u6709\u961f\u5217\u7684",(0,r.kt)("inlineCode",{parentName:"li"},"Routingkey"),"\u4e0e\u6d88\u606f\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"Routing key"),"\u5b8c\u5168\u4e00\u81f4\uff0c\u624d\u4f1a\u63a5\u6536\u5230\u6d88\u606f")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1556029284397-4b3125ba.png",alt:"1556029284397"}),"1556029284397"),(0,r.kt)("p",null,"\u56fe\u89e3\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"P\uff1a\u751f\u4ea7\u8005\uff0c\u5411Exchange\u53d1\u9001\u6d88\u606f\uff0c\u53d1\u9001\u6d88\u606f\u65f6\uff0c\u4f1a\u6307\u5b9a\u4e00\u4e2arouting key\u3002"),(0,r.kt)("li",{parentName:"ul"},"X\uff1aExchange\uff08\u4ea4\u6362\u673a\uff09\uff0c\u63a5\u6536\u751f\u4ea7\u8005\u7684\u6d88\u606f\uff0c\u7136\u540e\u628a\u6d88\u606f\u9012\u4ea4\u7ed9 \u4e0erouting key\u5b8c\u5168\u5339\u914d\u7684\u961f\u5217"),(0,r.kt)("li",{parentName:"ul"},"C1\uff1a\u6d88\u8d39\u8005\uff0c\u5176\u6240\u5728\u961f\u5217\u6307\u5b9a\u4e86\u9700\u8981routing key \u4e3a error \u7684\u6d88\u606f"),(0,r.kt)("li",{parentName:"ul"},"C2\uff1a\u6d88\u8d39\u8005\uff0c\u5176\u6240\u5728\u961f\u5217\u6307\u5b9a\u4e86\u9700\u8981routing key \u4e3a info\u3001error\u3001warning \u7684\u6d88\u606f")),(0,r.kt)("h4",{id:"2\u4ee3\u7801-2"},"\uff082\uff09\u4ee3\u7801"),(0,r.kt)("p",null,"\u5728\u7f16\u7801\u4e0a\u4e0e ",(0,r.kt)("inlineCode",{parentName:"p"},"Publish/Subscribe\u53d1\u5e03\u4e0e\u8ba2\u9605\u6a21\u5f0f")," \u7684\u533a\u522b\u662f\u4ea4\u6362\u673a\u7684\u7c7b\u578b\u4e3a\uff1aDirect\uff0c\u8fd8\u6709\u961f\u5217\u7ed1\u5b9a\u4ea4\u6362\u673a\u7684\u65f6\u5019\u9700\u8981\u6307\u5b9arouting key\u3002"),(0,r.kt)("h5",{id:"a\u751f\u4ea7\u8005-1"},"a\u3001\u751f\u4ea7\u8005"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.routing;\n\nimport com.rabbitmq.client.BuiltinExchangeType;\nimport com.rabbitmq.client.Channel;\nimport com.rabbitmq.client.Connection;\nimport com.rabbitmq.client.ConnectionFactory;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\npublic class Producer {\n\n    //\u4ea4\u6362\u673a\u540d\u79f0\n    static final String DIRECT_EXCHAGE = "direct_exchange";\n    //\u961f\u5217\u540d\u79f0\n    static final String DIRECT_QUEUE_1 = "direct_queue_1";\n    //\u961f\u5217\u540d\u79f0\n    static final String DIRECT_QUEUE_2 = "direct_queue_2";\n\n    public static void main(String[] args) throws Exception {\n        //1\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory=new ConnectionFactory();\n        //\u8fde\u63a5\u7684ip\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7684\u7aef\u53e3\n        connectionFactory.setPort(5672);\n        //\u8bbe\u7f6e\u865a\u62df\u4e3b\u673a\n        connectionFactory.setVirtualHost("/");\n        //\u8bbe\u7f6e\u7528\u6237\u540d\n        connectionFactory.setUsername("itlils");\n        //\u8bbe\u7f6e\u5bc6\u7801\n        connectionFactory.setPassword("itlils");\n\n        //2\u521b\u5efa\u957f\u8fde\u63a5\n        Connection connection = connectionFactory.newConnection();\n        //3\u521b\u5efachannel\n        Channel channel = connection.createChannel();\n        //\u58f0\u660e\u961f\u5217\n        //String queue,  \u961f\u5217\u540d\n        // boolean durable, \u6301\u4e45\u5316\n        // boolean exclusive, \u6392\u4ed6\u7684\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.queueDeclare(DIRECT_QUEUE_1,true,false,false,null);\n        channel.queueDeclare(DIRECT_QUEUE_2,true,false,false,null);\n\n        // \u58f0\u660e\u4ea4\u6362\u673a\n        // String exchange,  \u4ea4\u6362\u673a\u540d\u79f0\n        // BuiltinExchangeType type, \u4ea4\u6362\u673a\u7c7b\u578b\n        // boolean durable,  \u6301\u4e45\u5316\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.exchangeDeclare(DIRECT_EXCHAGE, BuiltinExchangeType.DIRECT,true,false,null);\n\n        //\u961f\u5217\u7ed1\u5b9a\u4ea4\u6362\u673a\n        // String queue, \u961f\u5217\u540d\u79f0\n        // String exchange, \u4ea4\u6362\u673a\u540d\u79f0\n        // String routingKey \u8def\u7531\u952e\n        channel.queueBind(DIRECT_QUEUE_1,DIRECT_EXCHAGE,"error");\n        channel.queueBind(DIRECT_QUEUE_2,DIRECT_EXCHAGE,"info");\n        channel.queueBind(DIRECT_QUEUE_2,DIRECT_EXCHAGE,"error");\n        channel.queueBind(DIRECT_QUEUE_2,DIRECT_EXCHAGE,"warning");\n\n        //4\u53d1\u6d88\u606f\n        // String exchange,  \u4ea4\u6362\u673a\n        // String routingKey, \u8def\u7531\u952e\n        // AMQP.BasicProperties props, \u5c5e\u6027\n        // byte[] body \u6d88\u606f      string byte[] char[]\u5982\u4f55\u76f8\u4e92\u8f6c\u6362\u7684\uff1f\n        String msg="hello rabbitmq!routing error";\n        channel.basicPublish(DIRECT_EXCHAGE,"error",null,msg.getBytes());\n\n        String msg1="hello rabbitmq!routing info";\n        channel.basicPublish(DIRECT_EXCHAGE,"info",null,msg1.getBytes());\n\n        String msg2="hello rabbitmq!routing warning";\n        channel.basicPublish(DIRECT_EXCHAGE,"warning",null,msg2.getBytes());\n\n        //5\u5173\u95ed\u8fde\u63a5  \u8d44\u6e90\u5173\u95ed\u7684\u987a\u5e8f\uff0c\u5148\u5173\u540e\u51fa\u6765\u7684\u8d44\u6e90\uff0c\u6700\u540e\u5173\uff0c\u7b2c\u4e00\u4e2a\u8d44\u6e90\n        channel.close();\n        connection.close();\n    }\n}\n')),(0,r.kt)("h5",{id:"b\u6d88\u8d39\u80051-1"},"b\u3001\u6d88\u8d39\u80051"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.routing;\n\nimport com.rabbitmq.client.*;\n\nimport java.io.IOException;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\npublic class Consumer1 {\n    //\u4ea4\u6362\u673a\u540d\u79f0\n    static final String DIRECT_EXCHAGE = "direct_exchange";\n    //\u961f\u5217\u540d\u79f0\n    static final String DIRECT_QUEUE_1 = "direct_queue_1";\n    //\u961f\u5217\u540d\u79f0\n    static final String DIRECT_QUEUE_2 = "direct_queue_2";\n\n    public static void main(String[] args) throws Exception {\n        //1\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory=new ConnectionFactory();\n        //\u8fde\u63a5\u7684ip\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7684\u7aef\u53e3\n        connectionFactory.setPort(5672);\n        //\u8bbe\u7f6e\u865a\u62df\u4e3b\u673a\n        connectionFactory.setVirtualHost("/");\n        //\u8bbe\u7f6e\u7528\u6237\u540d\n        connectionFactory.setUsername("itlils");\n        //\u8bbe\u7f6e\u5bc6\u7801\n        connectionFactory.setPassword("itlils");\n\n        //2\u521b\u5efa\u957f\u8fde\u63a5\n        Connection connection = connectionFactory.newConnection();\n        //3\u521b\u5efachannel\n        Channel channel = connection.createChannel();\n\n        //\u58f0\u660e\u961f\u5217\n        //String queue,  \u961f\u5217\u540d\n        // boolean durable, \u6301\u4e45\u5316\n        // boolean exclusive, \u6392\u4ed6\u7684\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.queueDeclare(DIRECT_QUEUE_1,true,false,false,null);\n        channel.queueDeclare(DIRECT_QUEUE_2,true,false,false,null);\n\n        // \u58f0\u660e\u4ea4\u6362\u673a\n        // String exchange,  \u4ea4\u6362\u673a\u540d\u79f0\n        // BuiltinExchangeType type, \u4ea4\u6362\u673a\u7c7b\u578b\n        // boolean durable,  \u6301\u4e45\u5316\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.exchangeDeclare(DIRECT_EXCHAGE, BuiltinExchangeType.DIRECT,true,false,null);\n\n        //\u961f\u5217\u7ed1\u5b9a\u4ea4\u6362\u673a\n        // String queue, \u961f\u5217\u540d\u79f0\n        // String exchange, \u4ea4\u6362\u673a\u540d\u79f0\n        // String routingKey \u8def\u7531\u952e\n        channel.queueBind(DIRECT_QUEUE_1,DIRECT_EXCHAGE,"error");\n        channel.queueBind(DIRECT_QUEUE_2,DIRECT_EXCHAGE,"info");\n        channel.queueBind(DIRECT_QUEUE_2,DIRECT_EXCHAGE,"error");\n        channel.queueBind(DIRECT_QUEUE_2,DIRECT_EXCHAGE,"warning");\n\n\n        //4\u76d1\u542c\u67d0\u4e2a\u961f\u5217\n        // String queue, \u76d1\u542c\u7684\u961f\u5217\u540d\n        // boolean autoAck, \u662f\u5426\u81ea\u52a8\u5e94\u7b54\n        // Consumer callback \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n        com.rabbitmq.client.Consumer consumer=new DefaultConsumer(channel){\n            // \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n            //  String consumerTag, \u6d88\u8d39\u8005\u6807\u7b7e\n            // Envelope envelope, \u4fe1\u5c01 \u4fdd\u5b58\u5f88\u591a\u4fe1\u606f\n            // AMQP.BasicProperties properties, \u5c5e\u6027\n            // byte[] body  \u6d88\u606f\u5b57\u8282\u6570\u7ec4\n            @Override\n            public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body) throws IOException {\n                //\u4e1a\u52a1\u903b\u8f91\n\n                //\u73b0\u5728\u7684\u4e1a\u52a1\u903b\u8f91\u5c31\u662f\u6253\u5370\n//                System.out.println("consumerTag:"+consumerTag);\n//                System.out.println("Exchange:"+envelope.getExchange());\n//                System.out.println("RoutingKey:"+envelope.getRoutingKey());\n//                System.out.println("DeliveryTag:"+envelope.getDeliveryTag()); //\u6d88\u606fid\n\n                System.out.println(new String(body));\n            }\n        };\n        channel.basicConsume(DIRECT_QUEUE_1,true,consumer);\n\n        //5 \u5343\u4e07\u522b\u5173\u95ed\u8fde\u63a5\uff0c\u8981\u4e0d\u7136queue\u6709\u4e86\u6d88\u606f \u63a8\u4e0d\u8fc7\u6765\u4e86\n//        channel.close();\n//        connection.close();\n\n    }\n}\n')),(0,r.kt)("h5",{id:"c\u6d88\u8d39\u80052-1"},"c\u3001\u6d88\u8d39\u80052"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.routing;\n\nimport com.rabbitmq.client.*;\n\nimport java.io.IOException;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\npublic class Consumer2 {\n    //\u4ea4\u6362\u673a\u540d\u79f0\n    static final String DIRECT_EXCHAGE = "direct_exchange";\n    //\u961f\u5217\u540d\u79f0\n    static final String DIRECT_QUEUE_1 = "direct_queue_1";\n    //\u961f\u5217\u540d\u79f0\n    static final String DIRECT_QUEUE_2 = "direct_queue_2";\n\n    public static void main(String[] args) throws Exception {\n        //1\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory=new ConnectionFactory();\n        //\u8fde\u63a5\u7684ip\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7684\u7aef\u53e3\n        connectionFactory.setPort(5672);\n        //\u8bbe\u7f6e\u865a\u62df\u4e3b\u673a\n        connectionFactory.setVirtualHost("/");\n        //\u8bbe\u7f6e\u7528\u6237\u540d\n        connectionFactory.setUsername("itlils");\n        //\u8bbe\u7f6e\u5bc6\u7801\n        connectionFactory.setPassword("itlils");\n\n        //2\u521b\u5efa\u957f\u8fde\u63a5\n        Connection connection = connectionFactory.newConnection();\n        //3\u521b\u5efachannel\n        Channel channel = connection.createChannel();\n\n        //\u58f0\u660e\u961f\u5217\n        //String queue,  \u961f\u5217\u540d\n        // boolean durable, \u6301\u4e45\u5316\n        // boolean exclusive, \u6392\u4ed6\u7684\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.queueDeclare(DIRECT_QUEUE_1,true,false,false,null);\n        channel.queueDeclare(DIRECT_QUEUE_2,true,false,false,null);\n\n        // \u58f0\u660e\u4ea4\u6362\u673a\n        // String exchange,  \u4ea4\u6362\u673a\u540d\u79f0\n        // BuiltinExchangeType type, \u4ea4\u6362\u673a\u7c7b\u578b\n        // boolean durable,  \u6301\u4e45\u5316\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.exchangeDeclare(DIRECT_EXCHAGE, BuiltinExchangeType.DIRECT,true,false,null);\n\n        //\u961f\u5217\u7ed1\u5b9a\u4ea4\u6362\u673a\n        // String queue, \u961f\u5217\u540d\u79f0\n        // String exchange, \u4ea4\u6362\u673a\u540d\u79f0\n        // String routingKey \u8def\u7531\u952e\n        channel.queueBind(DIRECT_QUEUE_1,DIRECT_EXCHAGE,"error");\n        channel.queueBind(DIRECT_QUEUE_2,DIRECT_EXCHAGE,"info");\n        channel.queueBind(DIRECT_QUEUE_2,DIRECT_EXCHAGE,"error");\n        channel.queueBind(DIRECT_QUEUE_2,DIRECT_EXCHAGE,"warning");\n\n\n        //4\u76d1\u542c\u67d0\u4e2a\u961f\u5217\n        // String queue, \u76d1\u542c\u7684\u961f\u5217\u540d\n        // boolean autoAck, \u662f\u5426\u81ea\u52a8\u5e94\u7b54\n        // Consumer callback \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n        Consumer consumer=new DefaultConsumer(channel){\n            // \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n            //  String consumerTag, \u6d88\u8d39\u8005\u6807\u7b7e\n            // Envelope envelope, \u4fe1\u5c01 \u4fdd\u5b58\u5f88\u591a\u4fe1\u606f\n            // AMQP.BasicProperties properties, \u5c5e\u6027\n            // byte[] body  \u6d88\u606f\u5b57\u8282\u6570\u7ec4\n            @Override\n            public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body) throws IOException {\n                //\u4e1a\u52a1\u903b\u8f91\n\n                //\u73b0\u5728\u7684\u4e1a\u52a1\u903b\u8f91\u5c31\u662f\u6253\u5370\n//                System.out.println("consumerTag:"+consumerTag);\n//                System.out.println("Exchange:"+envelope.getExchange());\n//                System.out.println("RoutingKey:"+envelope.getRoutingKey());\n//                System.out.println("DeliveryTag:"+envelope.getDeliveryTag()); //\u6d88\u606fid\n\n                System.out.println(new String(body));\n            }\n        };\n        channel.basicConsume(DIRECT_QUEUE_2,true,consumer);\n\n        //5 \u5343\u4e07\u522b\u5173\u95ed\u8fde\u63a5\uff0c\u8981\u4e0d\u7136queue\u6709\u4e86\u6d88\u606f \u63a8\u4e0d\u8fc7\u6765\u4e86\n//        channel.close();\n//        connection.close();\n\n\n\n    }\n}\n')),(0,r.kt)("h4",{id:"3\u6d4b\u8bd5-1"},"\uff083\uff09\u6d4b\u8bd5"),(0,r.kt)("p",null,"\u542f\u52a8\u6240\u6709\u6d88\u8d39\u8005\uff0c\u7136\u540e\u4f7f\u7528\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\uff1b\u5728\u6d88\u8d39\u8005\u5bf9\u5e94\u7684\u63a7\u5236\u53f0\u53ef\u4ee5\u67e5\u770b\u5230\u751f\u4ea7\u8005\u53d1\u9001\u5bf9\u5e94routing key\u5bf9\u5e94\u961f\u5217\u7684\u6d88\u606f\uff1b\u5230\u8fbe",(0,r.kt)("strong",{parentName:"p"},"\u6309\u7167\u9700\u8981\u63a5\u6536"),"\u7684\u6548\u679c\u3002"),(0,r.kt)("p",null,"\u5728\u6267\u884c\u5b8c\u6d4b\u8bd5\u4ee3\u7801\u540e\uff0c\u5176\u5b9e\u5230RabbitMQ\u7684\u7ba1\u7406\u540e\u53f0\u627e\u5230",(0,r.kt)("inlineCode",{parentName:"p"},"Exchanges"),"\u9009\u9879\u5361\uff0c\u70b9\u51fb ",(0,r.kt)("inlineCode",{parentName:"p"},"direct_exchange")," \u7684\u4ea4\u6362\u673a\uff0c\u53ef\u4ee5\u67e5\u770b\u5230\u5982\u4e0b\u7684\u7ed1\u5b9a\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411214231000-1e1170ad.png",alt:"image-20220411214231000"}),"image-20220411214231000"),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,r.kt)("p",null,"\u7b2c\u4e00\u4e2a\u6d88\u8d39\u8005\u53d7\u5230\u4e00\u6761\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411214259476-edf4f109.png",alt:"image-20220411214259476"}),"image-20220411214259476"),(0,r.kt)("p",null,"\u7b2c\u4e8c\u4e2a\u6d88\u8d39\u8005\u53d7\u5230\u4e09\u6761\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411214316485-00473d19.png",alt:"image-20220411214316485"}),"image-20220411214316485"),(0,r.kt)("h4",{id:"4\u5c0f\u7ed3-2"},"\uff084\uff09\u5c0f\u7ed3"),(0,r.kt)("p",null,"Routing\u6a21\u5f0f\u8981\u6c42\u961f\u5217\u5728\u7ed1\u5b9a\u4ea4\u6362\u673a\u65f6\u8981\u6307\u5b9arouting key\uff0c\u6d88\u606f\u4f1a\u8f6c\u53d1\u5230\u7b26\u5408routing key\u7684\u961f\u5217\u3002"),(0,r.kt)("h3",{id:"5-topics\u901a\u914d\u7b26\u6a21\u5f0f"},"5\u3001 Topics\u901a\u914d\u7b26\u6a21\u5f0f"),(0,r.kt)("h4",{id:"1-\u6a21\u5f0f\u8bf4\u660e-1"},"\uff081\uff09 \u6a21\u5f0f\u8bf4\u660e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'ydlclass.taiyuan.caiwubu.info "\u672c\u6708\u5de5\u8d44\u5927\u5bb6\u6da8\u4e24\u5343\uff01"\nydlclass.taiyuan.renshi.error "\u674e\u8001\u5e08\u643a\u6b3e\u6f5c\u9003\uff01"\nydlclass.beijing.caiwubu.error "\u56e0\u4e3a\u674e\u8001\u5e08\u9003\u4e86\uff0c\u5168\u56fd\u6240\u6709\u6821\u533a\u964d\u85aa\u4e24\u5343\u3002\u4e0d\u884c\u5c31\u6bd5\u4e1a\uff01"\nydlclass.lasa.caiwubu.info "lasa\u6821\u533a\u6210\u7acb\u4e86\uff01"\nydlclass.taiyuan.shitangbu.info "\u592a\u539f\u6821\u533a\u5b66\u751f\u5403\u996d\u514d\u8d39\uff01"\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Topic"),"\u7c7b\u578b\u4e0e",(0,r.kt)("inlineCode",{parentName:"p"},"Direct"),"\u76f8\u6bd4\uff0c\u90fd\u662f\u53ef\u4ee5\u6839\u636e",(0,r.kt)("inlineCode",{parentName:"p"},"RoutingKey"),"\u628a\u6d88\u606f\u8def\u7531\u5230\u4e0d\u540c\u7684\u961f\u5217\u3002\u53ea\u4e0d\u8fc7",(0,r.kt)("inlineCode",{parentName:"p"},"Topic"),"\u7c7b\u578b",(0,r.kt)("inlineCode",{parentName:"p"},"Exchange"),"\u53ef\u4ee5\u8ba9\u961f\u5217\u5728\u7ed1\u5b9a",(0,r.kt)("inlineCode",{parentName:"p"},"Routing key")," \u7684\u65f6\u5019",(0,r.kt)("strong",{parentName:"p"},"\u4f7f\u7528\u901a\u914d\u7b26"),"\uff01"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Routingkey` \u4e00\u822c\u90fd\u662f\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u5355\u8bcd\u7ec4\u6210\uff0c\u591a\u4e2a\u5355\u8bcd\u4e4b\u95f4\u4ee5\u201d.\u201d\u5206\u5272\uff0c\u4f8b\u5982\uff1a `item.insert\n")),(0,r.kt)("p",null,"\u901a\u914d\u7b26\u89c4\u5219\uff1a"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"#"),"\uff1a\u5339\u914d\u4e00\u4e2a\u6216\u591a\u4e2a\u8bcd"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"*"),"\uff1a\u5339\u914d\u4e0d\u591a\u4e0d\u5c11\u6070\u597d1\u4e2a\u8bcd"),(0,r.kt)("p",null,"\u4e3e\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"\u6211\u662f\u592a\u539f\u6821\u533a\u6821\u957f ydlclass.taiyuan.*.*\nitlils \u6211\u662f\u603b\u90e8\u8d22\u52a1\u4e3b\u7ba1 ydlclass.*.caiwubu.*\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1556031362048-af6b62f6.png",alt:"1556031362048"}),"1556031362048"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1556031519931-5f4865a5.png",alt:"1556031519931"}),"1556031519931"),(0,r.kt)("p",null,"\u56fe\u89e3\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u7ea2\u8272Queue\uff1a\u7ed1\u5b9a\u7684\u662f",(0,r.kt)("inlineCode",{parentName:"li"},"usa.#")," \uff0c\u56e0\u6b64\u51e1\u662f\u4ee5 ",(0,r.kt)("inlineCode",{parentName:"li"},"usa."),"\u5f00\u5934\u7684",(0,r.kt)("inlineCode",{parentName:"li"},"routing key")," \u90fd\u4f1a\u88ab\u5339\u914d\u5230"),(0,r.kt)("li",{parentName:"ul"},"\u9ec4\u8272Queue\uff1a\u7ed1\u5b9a\u7684\u662f",(0,r.kt)("inlineCode",{parentName:"li"},"#.news")," \uff0c\u56e0\u6b64\u51e1\u662f\u4ee5 ",(0,r.kt)("inlineCode",{parentName:"li"},".news"),"\u7ed3\u5c3e\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"routing key")," \u90fd\u4f1a\u88ab\u5339\u914d")),(0,r.kt)("h4",{id:"2-\u4ee3\u7801"},"\uff082\uff09 \u4ee3\u7801"),(0,r.kt)("h5",{id:"a\u751f\u4ea7\u8005-2"},"a\u3001\u751f\u4ea7\u8005"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.topic;\n\nimport com.rabbitmq.client.BuiltinExchangeType;\nimport com.rabbitmq.client.Channel;\nimport com.rabbitmq.client.Connection;\nimport com.rabbitmq.client.ConnectionFactory;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\npublic class Producer {\n\n    //\u4ea4\u6362\u673a\u540d\u79f0\n    static final String TOPIC_EXCHAGE = "topic_exchange";\n    //\u961f\u5217\u540d\u79f0\n    static final String TOPIC_QUEUE_1 = "topic_queue_1";\n    //\u961f\u5217\u540d\u79f0\n    static final String TOPIC_QUEUE_2 = "topic_queue_2";\n\n    public static void main(String[] args) throws Exception {\n        //1\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory=new ConnectionFactory();\n        //\u8fde\u63a5\u7684ip\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7684\u7aef\u53e3\n        connectionFactory.setPort(5672);\n        //\u8bbe\u7f6e\u865a\u62df\u4e3b\u673a\n        connectionFactory.setVirtualHost("/");\n        //\u8bbe\u7f6e\u7528\u6237\u540d\n        connectionFactory.setUsername("itlils");\n        //\u8bbe\u7f6e\u5bc6\u7801\n        connectionFactory.setPassword("itlils");\n\n        //2\u521b\u5efa\u957f\u8fde\u63a5\n        Connection connection = connectionFactory.newConnection();\n        //3\u521b\u5efachannel\n        Channel channel = connection.createChannel();\n        //\u58f0\u660e\u961f\u5217\n        //String queue,  \u961f\u5217\u540d\n        // boolean durable, \u6301\u4e45\u5316\n        // boolean exclusive, \u6392\u4ed6\u7684\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.queueDeclare(TOPIC_QUEUE_1,true,false,false,null);\n        channel.queueDeclare(TOPIC_QUEUE_2,true,false,false,null);\n\n        // \u58f0\u660e\u4ea4\u6362\u673a\n        // String exchange,  \u4ea4\u6362\u673a\u540d\u79f0\n        // BuiltinExchangeType type, \u4ea4\u6362\u673a\u7c7b\u578b\n        // boolean durable,  \u6301\u4e45\u5316\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.exchangeDeclare(TOPIC_EXCHAGE, BuiltinExchangeType.TOPIC,true,false,null);\n\n        //\u961f\u5217\u7ed1\u5b9a\u4ea4\u6362\u673a\n        // String queue, \u961f\u5217\u540d\u79f0\n        // String exchange, \u4ea4\u6362\u673a\u540d\u79f0\n        // String routingKey \u8def\u7531\u952e\n        channel.queueBind(TOPIC_QUEUE_1,TOPIC_EXCHAGE,"ydlclass.taiyuan.*.*"); //\u6211\u662f\u592a\u539f\u6821\u533a\u6821\u957f\u7684\u961f\u5217\n        channel.queueBind(TOPIC_QUEUE_2,TOPIC_EXCHAGE,"ydlclass.*.caiwubu.*");//\u6211\u662f\u603b\u90e8\u8d22\u52a1\u4e3b\u7ba1\u7684\u961f\u5217\n\n        //4\u53d1\u6d88\u606f\n        // String exchange,  \u4ea4\u6362\u673a\n        // String routingKey, \u8def\u7531\u952e\n        // AMQP.BasicProperties props, \u5c5e\u6027\n        // byte[] body \u6d88\u606f      string byte[] char[]\u5982\u4f55\u76f8\u4e92\u8f6c\u6362\u7684\uff1f\n        String msg1="hello rabbitmq!topic  \u672c\u6708\u5de5\u8d44\u5927\u5bb6\u6da8\u4e24\u5343\uff01";\n        channel.basicPublish(TOPIC_EXCHAGE,"ydlclass.taiyuan.caiwubu.info",null,msg1.getBytes());\n\n        String msg2="hello rabbitmq!topic \u674e\u8001\u5e08\u643a\u6b3e\u6f5c\u9003\uff01";\n        channel.basicPublish(TOPIC_EXCHAGE,"ydlclass.taiyuan.renshi.error",null,msg2.getBytes());\n\n        String msg3="hello rabbitmq!topic  \u56e0\u4e3a\u674e\u8001\u5e08\u9003\u4e86\uff0c\u5168\u56fd\u6240\u6709\u6821\u533a\u964d\u85aa\u4e24\u5343\u3002\u4e0d\u884c\u5c31\u6bd5\u4e1a\uff01";\n        channel.basicPublish(TOPIC_EXCHAGE,"ydlclass.beijing.caiwubu.error",null,msg3.getBytes());\n\n        //5\u5173\u95ed\u8fde\u63a5  \u8d44\u6e90\u5173\u95ed\u7684\u987a\u5e8f\uff0c\u5148\u5173\u540e\u51fa\u6765\u7684\u8d44\u6e90\uff0c\u6700\u540e\u5173\uff0c\u7b2c\u4e00\u4e2a\u8d44\u6e90\n        channel.close();\n        connection.close();\n    }\n}\n')),(0,r.kt)("h5",{id:"b\u6d88\u8d39\u80051-2"},"b\u3001\u6d88\u8d39\u80051"),(0,r.kt)("p",null,"\u63a5\u6536\u4e24\u79cd\u7c7b\u578b\u7684\u6d88\u606f\uff1a\u66f4\u65b0\u5546\u54c1\u548c\u5220\u9664\u5546\u54c1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.topic;\n\nimport com.rabbitmq.client.*;\n\nimport java.io.IOException;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\npublic class Consumer1 {\n    //\u4ea4\u6362\u673a\u540d\u79f0\n    static final String TOPIC_EXCHAGE = "topic_exchange";\n    //\u961f\u5217\u540d\u79f0\n    static final String TOPIC_QUEUE_1 = "topic_queue_1";\n    //\u961f\u5217\u540d\u79f0\n    static final String TOPIC_QUEUE_2 = "topic_queue_2";\n\n    public static void main(String[] args) throws Exception {\n        //1\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory=new ConnectionFactory();\n        //\u8fde\u63a5\u7684ip\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7684\u7aef\u53e3\n        connectionFactory.setPort(5672);\n        //\u8bbe\u7f6e\u865a\u62df\u4e3b\u673a\n        connectionFactory.setVirtualHost("/");\n        //\u8bbe\u7f6e\u7528\u6237\u540d\n        connectionFactory.setUsername("itlils");\n        //\u8bbe\u7f6e\u5bc6\u7801\n        connectionFactory.setPassword("itlils");\n\n        //2\u521b\u5efa\u957f\u8fde\u63a5\n        Connection connection = connectionFactory.newConnection();\n        //3\u521b\u5efachannel\n        Channel channel = connection.createChannel();\n\n        //\u58f0\u660e\u961f\u5217\n        //String queue,  \u961f\u5217\u540d\n        // boolean durable, \u6301\u4e45\u5316\n        // boolean exclusive, \u6392\u4ed6\u7684\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.queueDeclare(TOPIC_QUEUE_1,true,false,false,null);\n        channel.queueDeclare(TOPIC_QUEUE_2,true,false,false,null);\n\n        // \u58f0\u660e\u4ea4\u6362\u673a\n        // String exchange,  \u4ea4\u6362\u673a\u540d\u79f0\n        // BuiltinExchangeType type, \u4ea4\u6362\u673a\u7c7b\u578b\n        // boolean durable,  \u6301\u4e45\u5316\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.exchangeDeclare(TOPIC_EXCHAGE, BuiltinExchangeType.TOPIC,true,false,null);\n\n        //\u961f\u5217\u7ed1\u5b9a\u4ea4\u6362\u673a\n        // String queue, \u961f\u5217\u540d\u79f0\n        // String exchange, \u4ea4\u6362\u673a\u540d\u79f0\n        // String routingKey \u8def\u7531\u952e\n        channel.queueBind(TOPIC_QUEUE_1,TOPIC_EXCHAGE,"ydlclass.taiyuan.*.*"); //\u6211\u662f\u592a\u539f\u6821\u533a\u6821\u957f\u7684\u961f\u5217\n        channel.queueBind(TOPIC_QUEUE_2,TOPIC_EXCHAGE,"ydlclass.*.caiwubu.*");//\u6211\u662f\u603b\u90e8\u8d22\u52a1\u4e3b\u7ba1\u7684\u961f\u5217\n\n\n        //4\u76d1\u542c\u67d0\u4e2a\u961f\u5217\n        // String queue, \u76d1\u542c\u7684\u961f\u5217\u540d\n        // boolean autoAck, \u662f\u5426\u81ea\u52a8\u5e94\u7b54\n        // Consumer callback \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n        Consumer consumer=new DefaultConsumer(channel){\n            // \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n            //  String consumerTag, \u6d88\u8d39\u8005\u6807\u7b7e\n            // Envelope envelope, \u4fe1\u5c01 \u4fdd\u5b58\u5f88\u591a\u4fe1\u606f\n            // AMQP.BasicProperties properties, \u5c5e\u6027\n            // byte[] body  \u6d88\u606f\u5b57\u8282\u6570\u7ec4\n            @Override\n            public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body) throws IOException {\n                //\u4e1a\u52a1\u903b\u8f91\n\n                //\u73b0\u5728\u7684\u4e1a\u52a1\u903b\u8f91\u5c31\u662f\u6253\u5370\n//                System.out.println("consumerTag:"+consumerTag);\n//                System.out.println("Exchange:"+envelope.getExchange());\n//                System.out.println("RoutingKey:"+envelope.getRoutingKey());\n//                System.out.println("DeliveryTag:"+envelope.getDeliveryTag()); //\u6d88\u606fid\n\n                System.out.println(new String(body));\n            }\n        };\n        channel.basicConsume(TOPIC_QUEUE_1,true,consumer);\n\n        //5 \u5343\u4e07\u522b\u5173\u95ed\u8fde\u63a5\uff0c\u8981\u4e0d\u7136queue\u6709\u4e86\u6d88\u606f \u63a8\u4e0d\u8fc7\u6765\u4e86\n//        channel.close();\n//        connection.close();\n\n\n\n    }\n}\n')),(0,r.kt)("h5",{id:"c\u6d88\u8d39\u80052-2"},"c\u3001\u6d88\u8d39\u80052"),(0,r.kt)("p",null,"\u63a5\u6536\u6240\u6709\u7c7b\u578b\u7684\u6d88\u606f\uff1a\u65b0\u589e\u5546\u54c1\uff0c\u66f4\u65b0\u5546\u54c1\u548c\u5220\u9664\u5546\u54c1\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.topic;\n\nimport com.rabbitmq.client.*;\n\nimport java.io.IOException;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\npublic class Consumer2 {\n    //\u4ea4\u6362\u673a\u540d\u79f0\n    static final String TOPIC_EXCHAGE = "topic_exchange";\n    //\u961f\u5217\u540d\u79f0\n    static final String TOPIC_QUEUE_1 = "topic_queue_1";\n    //\u961f\u5217\u540d\u79f0\n    static final String TOPIC_QUEUE_2 = "topic_queue_2";\n\n    public static void main(String[] args) throws Exception {\n        //1\u521b\u5efa\u8fde\u63a5\u5de5\u5382\n        ConnectionFactory connectionFactory=new ConnectionFactory();\n        //\u8fde\u63a5\u7684ip\n        connectionFactory.setHost("localhost");\n        //\u8fde\u63a5\u7684\u7aef\u53e3\n        connectionFactory.setPort(5672);\n        //\u8bbe\u7f6e\u865a\u62df\u4e3b\u673a\n        connectionFactory.setVirtualHost("/");\n        //\u8bbe\u7f6e\u7528\u6237\u540d\n        connectionFactory.setUsername("itlils");\n        //\u8bbe\u7f6e\u5bc6\u7801\n        connectionFactory.setPassword("itlils");\n\n        //2\u521b\u5efa\u957f\u8fde\u63a5\n        Connection connection = connectionFactory.newConnection();\n        //3\u521b\u5efachannel\n        Channel channel = connection.createChannel();\n\n        //\u58f0\u660e\u961f\u5217\n        //String queue,  \u961f\u5217\u540d\n        // boolean durable, \u6301\u4e45\u5316\n        // boolean exclusive, \u6392\u4ed6\u7684\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.queueDeclare(TOPIC_QUEUE_1,true,false,false,null);\n        channel.queueDeclare(TOPIC_QUEUE_2,true,false,false,null);\n\n        // \u58f0\u660e\u4ea4\u6362\u673a\n        // String exchange,  \u4ea4\u6362\u673a\u540d\u79f0\n        // BuiltinExchangeType type, \u4ea4\u6362\u673a\u7c7b\u578b\n        // boolean durable,  \u6301\u4e45\u5316\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        channel.exchangeDeclare(TOPIC_EXCHAGE, BuiltinExchangeType.TOPIC,true,false,null);\n\n        //\u961f\u5217\u7ed1\u5b9a\u4ea4\u6362\u673a\n        // String queue, \u961f\u5217\u540d\u79f0\n        // String exchange, \u4ea4\u6362\u673a\u540d\u79f0\n        // String routingKey \u8def\u7531\u952e\n        channel.queueBind(TOPIC_QUEUE_1,TOPIC_EXCHAGE,"ydlclass.taiyuan.*.*"); //\u6211\u662f\u592a\u539f\u6821\u533a\u6821\u957f\u7684\u961f\u5217\n        channel.queueBind(TOPIC_QUEUE_2,TOPIC_EXCHAGE,"ydlclass.*.caiwubu.*");//\u6211\u662f\u603b\u90e8\u8d22\u52a1\u4e3b\u7ba1\u7684\u961f\u5217\n\n\n        //4\u76d1\u542c\u67d0\u4e2a\u961f\u5217\n        // String queue, \u76d1\u542c\u7684\u961f\u5217\u540d\n        // boolean autoAck, \u662f\u5426\u81ea\u52a8\u5e94\u7b54\n        // Consumer callback \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n        Consumer consumer=new DefaultConsumer(channel){\n            // \u56de\u8c03\u51fd\u6570\uff0c\u6536\u5230\u6d88\u606f\uff0c\u6211\u8981\u5e72\u5565\n            //  String consumerTag, \u6d88\u8d39\u8005\u6807\u7b7e\n            // Envelope envelope, \u4fe1\u5c01 \u4fdd\u5b58\u5f88\u591a\u4fe1\u606f\n            // AMQP.BasicProperties properties, \u5c5e\u6027\n            // byte[] body  \u6d88\u606f\u5b57\u8282\u6570\u7ec4\n            @Override\n            public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body) throws IOException {\n                //\u4e1a\u52a1\u903b\u8f91\n\n                //\u73b0\u5728\u7684\u4e1a\u52a1\u903b\u8f91\u5c31\u662f\u6253\u5370\n//                System.out.println("consumerTag:"+consumerTag);\n//                System.out.println("Exchange:"+envelope.getExchange());\n//                System.out.println("RoutingKey:"+envelope.getRoutingKey());\n//                System.out.println("DeliveryTag:"+envelope.getDeliveryTag()); //\u6d88\u606fid\n\n                System.out.println(new String(body));\n            }\n        };\n        channel.basicConsume(TOPIC_QUEUE_2,true,consumer);\n\n        //5 \u5343\u4e07\u522b\u5173\u95ed\u8fde\u63a5\uff0c\u8981\u4e0d\u7136queue\u6709\u4e86\u6d88\u606f \u63a8\u4e0d\u8fc7\u6765\u4e86\n//        channel.close();\n//        connection.close();\n\n\n\n    }\n}\n')),(0,r.kt)("h4",{id:"3\u6d4b\u8bd5-2"},"\uff083\uff09\u6d4b\u8bd5"),(0,r.kt)("p",null,"\u542f\u52a8\u6240\u6709\u6d88\u8d39\u8005\uff0c\u7136\u540e\u4f7f\u7528\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\uff1b\u5728\u6d88\u8d39\u8005\u5bf9\u5e94\u7684\u63a7\u5236\u53f0\u53ef\u4ee5\u67e5\u770b\u5230\u751f\u4ea7\u8005\u53d1\u9001\u5bf9\u5e94routing key\u5bf9\u5e94\u961f\u5217\u7684\u6d88\u606f\uff1b\u5230\u8fbe",(0,r.kt)("strong",{parentName:"p"},"\u6309\u7167\u9700\u8981\u63a5\u6536"),"\u7684\u6548\u679c\uff1b\u5e76\u4e14\u8fd9\u4e9brouting key\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26\u3002"),(0,r.kt)("p",null,"\u5728\u6267\u884c\u5b8c\u6d4b\u8bd5\u4ee3\u7801\u540e\uff0c\u5176\u5b9e\u5230RabbitMQ\u7684\u7ba1\u7406\u540e\u53f0\u627e\u5230",(0,r.kt)("inlineCode",{parentName:"p"},"Exchanges"),"\u9009\u9879\u5361\uff0c\u70b9\u51fb ",(0,r.kt)("inlineCode",{parentName:"p"},"topic_exchange")," \u7684\u4ea4\u6362\u673a\uff0c\u53ef\u4ee5\u67e5\u770b\u5230\u5982\u4e0b\u7684\u7ed1\u5b9a\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411220413658-af621fe7.png",alt:"image-20220411220413658"}),"image-20220411220413658"),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,r.kt)("p",null,"\u6d88\u8d39\u80051 \u63a5\u53d72\u6761\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411220433328-8c0bb510.png",alt:"image-20220411220433328"}),"image-20220411220433328"),(0,r.kt)("p",null,"\u6d88\u8d39\u80052 \u63a5\u53d72\u6761\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220411220453524-41faca02.png",alt:"image-20220411220453524"}),"image-20220411220453524"),(0,r.kt)("h4",{id:"4\u5c0f\u7ed3-3"},"\uff084\uff09\u5c0f\u7ed3"),(0,r.kt)("p",null,"Topic\u4e3b\u9898\u6a21\u5f0f\u53ef\u4ee5\u5b9e\u73b0 ",(0,r.kt)("inlineCode",{parentName:"p"},"Publish/Subscribe\u53d1\u5e03\u4e0e\u8ba2\u9605\u6a21\u5f0f")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"Routing\u8def\u7531\u6a21\u5f0f")," \u7684\u529f\u80fd\uff1b\u53ea\u662fTopic\u5728\u914d\u7f6erouting key \u7684\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26\uff0c\u663e\u5f97\u66f4\u52a0\u7075\u6d3b\u3002"),(0,r.kt)("h3",{id:"6-\u6a21\u5f0f\u603b\u7ed3"},"6\u3001 \u6a21\u5f0f\u603b\u7ed3"),(0,r.kt)("p",null,"RabbitMQ\u5de5\u4f5c\u6a21\u5f0f\uff1a"),(0,r.kt)("h4",{id:"1\u7b80\u5355\u6a21\u5f0f-helloworld"},(0,r.kt)("strong",{parentName:"h4"},"\uff081\uff09\u7b80\u5355\u6a21\u5f0f HelloWorld")),(0,r.kt)("p",null,"\u4e00\u4e2a\u751f\u4ea7\u8005\u3001\u4e00\u4e2a\u6d88\u8d39\u8005\uff0c\u4e0d\u9700\u8981\u8bbe\u7f6e\u4ea4\u6362\u673a\uff08\u4f7f\u7528\u9ed8\u8ba4\u7684\u4ea4\u6362\u673a\uff09\u3002"),(0,r.kt)("h4",{id:"2\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f-work-queue"},(0,r.kt)("strong",{parentName:"h4"},"\uff082\uff09\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f Work Queue")),(0,r.kt)("p",null,"\u4e00\u4e2a\u751f\u4ea7\u8005\u3001\u591a\u4e2a\u6d88\u8d39\u8005\uff08\u7ade\u4e89\u5173\u7cfb\uff09\uff0c\u4e0d\u9700\u8981\u8bbe\u7f6e\u4ea4\u6362\u673a\uff08\u4f7f\u7528\u9ed8\u8ba4\u7684\u4ea4\u6362\u673a\uff09\u3002"),(0,r.kt)("h4",{id:"3\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f-publishsubscribe"},(0,r.kt)("strong",{parentName:"h4"},"\uff083\uff09\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f Publish/subscribe")),(0,r.kt)("p",null,"\u9700\u8981\u8bbe\u7f6e\u7c7b\u578b\u4e3afanout\u7684\u4ea4\u6362\u673a\uff0c\u5e76\u4e14\u4ea4\u6362\u673a\u548c\u961f\u5217\u8fdb\u884c\u7ed1\u5b9a\uff0c\u5f53\u53d1\u9001\u6d88\u606f\u5230\u4ea4\u6362\u673a\u540e\uff0c\u4ea4\u6362\u673a\u4f1a\u5c06\u6d88\u606f\u53d1\u9001\u5230\u7ed1\u5b9a\u7684\u961f\u5217\u3002"),(0,r.kt)("h4",{id:"4\u8def\u7531\u6a21\u5f0f-routing"},(0,r.kt)("strong",{parentName:"h4"},"\uff084\uff09\u8def\u7531\u6a21\u5f0f Routing")),(0,r.kt)("p",null,"\u9700\u8981\u8bbe\u7f6e\u7c7b\u578b\u4e3adirect\u7684\u4ea4\u6362\u673a\uff0c\u4ea4\u6362\u673a\u548c\u961f\u5217\u8fdb\u884c\u7ed1\u5b9a\uff0c\u5e76\u4e14\u6307\u5b9arouting key\uff0c\u5f53\u53d1\u9001\u6d88\u606f\u5230\u4ea4\u6362\u673a\u540e\uff0c\u4ea4\u6362\u673a\u4f1a\u6839\u636erouting key\u5c06\u6d88\u606f\u53d1\u9001\u5230\u5bf9\u5e94\u7684\u961f\u5217\u3002"),(0,r.kt)("h4",{id:"5\u901a\u914d\u7b26\u6a21\u5f0f-topic"},(0,r.kt)("strong",{parentName:"h4"},"\uff085\uff09\u901a\u914d\u7b26\u6a21\u5f0f Topic")),(0,r.kt)("p",null,"\u9700\u8981\u8bbe\u7f6e\u7c7b\u578b\u4e3atopic\u7684\u4ea4\u6362\u673a\uff0c\u4ea4\u6362\u673a\u548c\u961f\u5217\u8fdb\u884c\u7ed1\u5b9a\uff0c\u5e76\u4e14\u6307\u5b9a\u901a\u914d\u7b26\u65b9\u5f0f\u7684routing key\uff0c\u5f53\u53d1\u9001\u6d88\u606f\u5230\u4ea4\u6362\u673a\u540e\uff0c\u4ea4\u6362\u673a\u4f1a\u6839\u636erouting key\u5c06\u6d88\u606f\u53d1\u9001\u5230\u5bf9\u5e94\u7684\u961f\u5217\u3002"),(0,r.kt)("h2",{id:"\u7b2c\u516d\u7ae0-spring-\u6574\u5408rabbitmq-\u4e86\u89e3"},"\u7b2c\u516d\u7ae0 Spring \u6574\u5408RabbitMQ-\u4e86\u89e3"),(0,r.kt)("h3",{id:"1\u642d\u5efa\u751f\u4ea7\u8005\u5de5\u7a0b"},"1\u3001\u642d\u5efa\u751f\u4ea7\u8005\u5de5\u7a0b"),(0,r.kt)("h4",{id:"1\u521b\u5efa\u5de5\u7a0b-1"},"\uff081\uff09\u521b\u5efa\u5de5\u7a0b"),(0,r.kt)("p",null,"spring-rabbitmq-producer"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320222056543-22a9b177.png",alt:"image-20200320222056543"}),"image-20200320222056543"),(0,r.kt)("h4",{id:"2\u6dfb\u52a0\u4f9d\u8d56-1"},"\uff082\uff09\u6dfb\u52a0\u4f9d\u8d56"),(0,r.kt)("p",null,"\u4fee\u6539pom.xml\u6587\u4ef6\u5185\u5bb9\u4e3a\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.ydlclass</groupId>\n    <artifactId>spring-rabbitmq-producer</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework</groupId>\n            <artifactId>spring-context</artifactId>\n            <version>5.1.7.RELEASE</version>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.amqp</groupId>\n            <artifactId>spring-rabbit</artifactId>\n            <version>2.1.8.RELEASE</version>\n        </dependency>\n\n        <dependency>\n            <groupId>junit</groupId>\n            <artifactId>junit</artifactId>\n            <version>4.12</version>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework</groupId>\n            <artifactId>spring-test</artifactId>\n            <version>5.1.7.RELEASE</version>\n        </dependency>\n    </dependencies>\n\n        <build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.8.0</version>\n                <configuration>\n                    <source>1.8</source>\n                    <target>1.8</target>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n')),(0,r.kt)("h4",{id:"3-\u914d\u7f6e\u6574\u5408"},"\uff083\uff09 \u914d\u7f6e\u6574\u5408"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u521b\u5efa",(0,r.kt)("inlineCode",{parentName:"li"},"resources\\rabbitmq.properties"),"\u8fde\u63a5\u53c2\u6570\u7b49\u914d\u7f6e\u6587\u4ef6\uff1b")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"rabbitmq.host=localhost\nrabbitmq.port=5672\nrabbitmq.username=itlils\nrabbitmq.password=itlils\nrabbitmq.virtual-host=/\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u521b\u5efa ",(0,r.kt)("inlineCode",{parentName:"li"},"resources\\spring-rabbitmq.xml")," \u6574\u5408\u914d\u7f6e\u6587\u4ef6\uff1b")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xmlns:rabbit="http://www.springframework.org/schema/rabbit"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans.xsd\n       http://www.springframework.org/schema/context\n       https://www.springframework.org/schema/context/spring-context.xsd\n       http://www.springframework.org/schema/rabbit\n       http://www.springframework.org/schema/rabbit/spring-rabbit.xsd">\n    \x3c!--\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6--\x3e\n    <context:property-placeholder location="classpath:rabbitmq.properties"/>\n\n    \x3c!-- \u5b9a\u4e49rabbitmq connectionFactory --\x3e\n    <rabbit:connection-factory id="connectionFactory"\n                               host="${rabbitmq.host}"\n                               port="${rabbitmq.port}"\n                               username="${rabbitmq.username}"\n                               password="${rabbitmq.password}"\n                               virtual-host="${rabbitmq.virtual-host}"/>\n    \x3c!--\u5b9a\u4e49\u7ba1\u7406\u4ea4\u6362\u673a\u3001\u961f\u5217--\x3e\n    <rabbit:admin connection-factory="connectionFactory"/>\n\n    \x3c!--\u5b9a\u4e49\u6301\u4e45\u5316\u961f\u5217\uff0c\u4e0d\u5b58\u5728\u5219\u81ea\u52a8\u521b\u5efa\uff1b\u4e0d\u7ed1\u5b9a\u5230\u4ea4\u6362\u673a\u5219\u7ed1\u5b9a\u5230\u9ed8\u8ba4\u4ea4\u6362\u673a\n    \u9ed8\u8ba4\u4ea4\u6362\u673a\u7c7b\u578b\u4e3adirect\uff0c\u540d\u5b57\u4e3a\uff1a""\uff0c\u8def\u7531\u952e\u4e3a\u961f\u5217\u7684\u540d\u79f0\n    --\x3e\n    <rabbit:queue id="ydlqueue" name="ydlqueue" auto-declare="true"/>\n\n    \x3c!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\u5e7f\u64ad\uff1b\u6240\u6709\u961f\u5217\u90fd\u80fd\u6536\u5230\u6d88\u606f~~~~~~~~~~~~~~~~~~~~~~~~~~~~ --\x3e\n    \x3c!--\u5b9a\u4e49\u5e7f\u64ad\u4ea4\u6362\u673a\u4e2d\u7684\u6301\u4e45\u5316\u961f\u5217\uff0c\u4e0d\u5b58\u5728\u5219\u81ea\u52a8\u521b\u5efa--\x3e\n    <rabbit:queue id="spring_fanout_queue_1" name="spring_fanout_queue_1" auto-declare="true" auto-delete="false" durable="true"/>\n    \x3c!--\u5b9a\u4e49\u5e7f\u64ad\u4ea4\u6362\u673a\u4e2d\u7684\u6301\u4e45\u5316\u961f\u5217\uff0c\u4e0d\u5b58\u5728\u5219\u81ea\u52a8\u521b\u5efa--\x3e\n    <rabbit:queue id="spring_fanout_queue_2" name="spring_fanout_queue_2" auto-declare="true"/>\n\n    \x3c!--\u5b9a\u4e49\u5e7f\u64ad\u7c7b\u578b\u4ea4\u6362\u673a\uff1b\u5e76\u7ed1\u5b9a\u4e0a\u8ff0\u4e24\u4e2a\u961f\u5217--\x3e\n    <rabbit:fanout-exchange id="spring_fanout_exchange" name="spring_fanout_exchange" auto-declare="true">\n        <rabbit:bindings>\n            <rabbit:binding queue="spring_fanout_queue_1"/>\n            <rabbit:binding queue="spring_fanout_queue_2"/>\n        </rabbit:bindings>\n    </rabbit:fanout-exchange>\n\n    \x3c!-- routing \u6a21\u5f0f--\x3e\n    <rabbit:queue id="spring_direct_queue_1" name="spring_direct_queue_1" auto-declare="true"/>\n    <rabbit:queue id="spring_direct_queue_2" name="spring_direct_queue_2" auto-declare="true"/>\n\n    <rabbit:direct-exchange id="spring_direct_exchange" name="spring_direct_exchange" auto-declare="true">\n        <rabbit:bindings>\n            <rabbit:binding queue="spring_direct_queue_1" key="error"></rabbit:binding>\n            <rabbit:binding queue="spring_direct_queue_2" key="info"></rabbit:binding>\n            <rabbit:binding queue="spring_direct_queue_2" key="error"></rabbit:binding>\n            <rabbit:binding queue="spring_direct_queue_2" key="warning"></rabbit:binding>\n        </rabbit:bindings>\n    </rabbit:direct-exchange>\n\n\n    \x3c!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~\u901a\u914d\u7b26\uff1b*\u5339\u914d\u4e00\u4e2a\u5355\u8bcd\uff0c#\u5339\u914d\u591a\u4e2a\u5355\u8bcd ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ --\x3e\n    <rabbit:queue id="spring_topic_queue_1" name="spring_topic_queue_1" auto-declare="true"/>\n    <rabbit:queue id="spring_topic_queue_2" name="spring_topic_queue_2" auto-declare="true"/>\n\n    <rabbit:topic-exchange id="spring_topic_exchange" name="spring_topic_exchange">\n        <rabbit:bindings>\n            <rabbit:binding queue="spring_topic_queue_1" pattern="ydlclass.taiyuan.*.*"></rabbit:binding>\n            <rabbit:binding queue="spring_topic_queue_2" pattern="ydlclass.*.caiwubu.*"></rabbit:binding>\n        </rabbit:bindings>\n    </rabbit:topic-exchange>\n\n    \x3c!--\u5b9a\u4e49rabbitTemplate\u5bf9\u8c61\u64cd\u4f5c\u53ef\u4ee5\u5728\u4ee3\u7801\u4e2d\u65b9\u4fbf\u53d1\u9001\u6d88\u606f--\x3e\n    <rabbit:template id="rabbitTemplate" connection-factory="connectionFactory"/>\n</beans>\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6ce8\u610f"),"\uff1a"),(0,r.kt)("p",null,"xxxtemplate\u4f5c\u7528\u5c31\u662f\u5e2e\u6211\u4eec\u548c\u7b2c\u4e09\u65b9\u7ec4\u4ef6\u952e\u8fde\u63a5\uff0c\u65ad\u94fe\u63a5\u3002\u6211\u4eec\u53ea\u9700\u8981\u5173\u6ce8\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u5373\u53ef\u3002"),(0,r.kt)("h4",{id:"4\u53d1\u9001\u6d88\u606f"},"\uff084\uff09\u53d1\u9001\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413210312813-86100d12.png",alt:"image-20220413210312813"}),"image-20220413210312813"),(0,r.kt)("p",null,"\u521b\u5efa\u6d4b\u8bd5\u6587\u4ef6 test\\java\\com\\ydlclass\\rabbitmq\\ProducerTest.java"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.amqp.rabbit.core.RabbitTemplate;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.test.context.ContextConfiguration;\nimport org.springframework.test.context.junit4.SpringJUnit4ClassRunner;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations = "classpath:spring-rabbitmq.xml")\npublic class ProducerTest {\n    @Autowired\n    RabbitTemplate rabbitTemplate;\n\n    //\u7b80\u5355\u6a21\u5f0f\u53d1\u9001\n    @Test\n    public void helloTest(){\n        // String exchange,  \u4ea4\u6362\u673a\n        // String routingKey,  \u8def\u7531\u952e\n        // Object message     Object\u6d88\u606f\u4f53 User car lunchuan\n        String msg="hello rabbitmq!";\n        rabbitTemplate.convertAndSend("","ydlqueue",msg);\n    }\n\n    //\u6d4b\u8bd5\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\n    @Test\n    public void publishTest(){\n        String msg="hello rabbitmq! publish";\n        rabbitTemplate.convertAndSend("spring_fanout_exchange","",msg);\n    }\n\n    //\u6d4b\u8bd5routing\u6a21\u5f0f\n    @Test\n    public void routingTest(){\n        String msg="hello rabbitmq!routing error";\n        rabbitTemplate.convertAndSend("spring_direct_exchange","error",msg);\n\n        String msg1="hello rabbitmq!routing info";\n        rabbitTemplate.convertAndSend("spring_direct_exchange","info",msg1);\n\n        String msg2="hello rabbitmq!routing warning";\n        rabbitTemplate.convertAndSend("spring_direct_exchange","warning",msg2);\n    }\n\n    //\u6d4b\u8bd5topic\u6a21\u5f0f\n    @Test\n    public void topicTest(){\n        String msg1="hello rabbitmq!topic  \u672c\u6708\u5de5\u8d44\u5927\u5bb6\u6da8\u4e24\u5343\uff01";\n        rabbitTemplate.convertAndSend("spring_topic_exchange","ydlclass.taiyuan.caiwubu.info",msg1);\n\n        String msg2="hello rabbitmq!topic \u674e\u8001\u5e08\u643a\u6b3e\u6f5c\u9003\uff01";\n        rabbitTemplate.convertAndSend("spring_topic_exchange","ydlclass.taiyuan.renshi.error",msg2);\n\n        String msg3="hello rabbitmq!topic  \u56e0\u4e3a\u674e\u8001\u5e08\u9003\u4e86\uff0c\u5168\u56fd\u6240\u6709\u6821\u533a\u964d\u85aa\u4e24\u5343\u3002\u4e0d\u884c\u5c31\u6bd5\u4e1a\uff01";\n        rabbitTemplate.convertAndSend("spring_topic_exchange","ydlclass.beijing.caiwubu.error",msg3);\n    }\n\n}\n')),(0,r.kt)("p",null,"\u53d1\u5e03\u8ba2\u9605\uff1a"),(0,r.kt)("p",null,"\u53d1\u9001\u8005"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413211130569-cbb13308.png",alt:"image-20220413211130569"}),"image-20220413211130569"),(0,r.kt)("p",null,"\u961f\u5217\uff1a\u4e24\u4e2a\u961f\u5217\u90fd\u6709\u4e00\u6761\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413211231511-7448120c.png",alt:"image-20220413211231511"}),"image-20220413211231511"),(0,r.kt)("p",null,"\u8def\u7531\u6a21\u5f0f\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413212246642-12850ddb.png",alt:"image-20220413212246642"}),"image-20220413212246642"),(0,r.kt)("p",null,"\u961f\u52171\u53ea\u67091\u6761\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413212324693-ee3bfce9.png",alt:"image-20220413212324693"}),"image-20220413212324693"),(0,r.kt)("p",null,"\u961f\u52172\u67093\u6761\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413212349991-7afe9e22.png",alt:"image-20220413212349991"}),"image-20220413212349991"),(0,r.kt)("p",null,"topic\u6a21\u5f0f\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413213316120-9a5638cf.png",alt:"image-20220413213316120"}),"image-20220413213316120"),(0,r.kt)("p",null,"\u961f\u52171 2\u6761\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413213334943-f6c4e0da.png",alt:"image-20220413213334943"}),"image-20220413213334943"),(0,r.kt)("p",null,"\u961f\u52172 2\u6761\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413213345957-8a6ac58c.png",alt:"image-20220413213345957"}),"image-20220413213345957"),(0,r.kt)("h3",{id:"2\u642d\u5efa\u6d88\u8d39\u8005\u5de5\u7a0b"},"2\u3001\u642d\u5efa\u6d88\u8d39\u8005\u5de5\u7a0b"),(0,r.kt)("h4",{id:"1\u521b\u5efa\u5de5\u7a0b-2"},"\uff081\uff09\u521b\u5efa\u5de5\u7a0b"),(0,r.kt)("p",null,"spring-rabbitmq-consumer"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413215506816-413652ef.png",alt:"image-20220413215506816"}),"image-20220413215506816"),(0,r.kt)("h4",{id:"2\u6dfb\u52a0\u4f9d\u8d56-2"},"\uff082\uff09\u6dfb\u52a0\u4f9d\u8d56"),(0,r.kt)("p",null,"\u4fee\u6539pom.xml\u6587\u4ef6\u5185\u5bb9\u4e3a\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>com.ydlclass</groupId>\n    <artifactId>spring-rabbitmq-consumer</artifactId>\n    <version>1.0-SNAPSHOT</version>\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework</groupId>\n            <artifactId>spring-context</artifactId>\n            <version>5.1.7.RELEASE</version>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework.amqp</groupId>\n            <artifactId>spring-rabbit</artifactId>\n            <version>2.1.8.RELEASE</version>\n        </dependency>\n\n        <dependency>\n            <groupId>junit</groupId>\n            <artifactId>junit</artifactId>\n            <version>4.12</version>\n        </dependency>\n\n        <dependency>\n            <groupId>org.springframework</groupId>\n            <artifactId>spring-test</artifactId>\n            <version>5.1.7.RELEASE</version>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.apache.maven.plugins</groupId>\n                <artifactId>maven-compiler-plugin</artifactId>\n                <version>3.8.0</version>\n                <configuration>\n                    <source>1.8</source>\n                    <target>1.8</target>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n</project>\n')),(0,r.kt)("h4",{id:"3-\u914d\u7f6e\u6574\u5408-1"},"\uff083\uff09 \u914d\u7f6e\u6574\u5408"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u521b\u5efa",(0,r.kt)("inlineCode",{parentName:"li"},"resources\\rabbitmq.properties"),"\u8fde\u63a5\u53c2\u6570\u7b49\u914d\u7f6e\u6587\u4ef6\uff1b")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"rabbitmq.host=localhost\nrabbitmq.port=5672\nrabbitmq.username=itlils\nrabbitmq.password=itlils\nrabbitmq.virtual-host=/\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u521b\u5efa resources\\spring-rabbitmq.xml` \u6574\u5408\u914d\u7f6e\u6587\u4ef6\uff1b")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xmlns:rabbit="http://www.springframework.org/schema/rabbit"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans.xsd\n       http://www.springframework.org/schema/context\n       https://www.springframework.org/schema/context/spring-context.xsd\n       http://www.springframework.org/schema/rabbit\n       http://www.springframework.org/schema/rabbit/spring-rabbit.xsd">\n    \x3c!--\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6--\x3e\n    <context:property-placeholder location="classpath:rabbitmq.properties"/>\n\n    \x3c!-- \u5b9a\u4e49rabbitmq connectionFactory --\x3e\n    <rabbit:connection-factory id="connectionFactory"\n                               host="${rabbitmq.host}"\n                               port="${rabbitmq.port}"\n                               username="${rabbitmq.username}"\n                               password="${rabbitmq.password}"\n                               virtual-host="${rabbitmq.virtual-host}"/>\n\n    <bean id="springQueueListener" class="com.ydlclass.rabbitmq.listener.SpringQueueListener"/>\n\x3c!--    <bean id="fanoutListener1" class="com.ydlclass.rabbitmq.listener.FanoutListener1"/>--\x3e\n\x3c!--    <bean id="fanoutListener2" class="com.ydlclass.rabbitmq.listener.FanoutListener2"/>--\x3e\n\x3c!--    <bean id="topicListenerStar" class="com.ydlclass.rabbitmq.listener.TopicListenerStar"/>--\x3e\n\x3c!--    <bean id="topicListenerWell" class="com.ydlclass.rabbitmq.listener.TopicListenerWell"/>--\x3e\n\x3c!--    <bean id="topicListenerWell2" class="com.ydlclass.rabbitmq.listener.TopicListenerWell2"/>--\x3e\n\n    <rabbit:listener-container connection-factory="connectionFactory" auto-declare="true">\n        <rabbit:listener ref="springQueueListener" queue-names="ydlqueue"/>\n\x3c!--        <rabbit:listener ref="fanoutListener1" queue-names="spring_fanout_queue_1"/>--\x3e\n\x3c!--        <rabbit:listener ref="fanoutListener2" queue-names="spring_fanout_queue_2"/>--\x3e\n\x3c!--        <rabbit:listener ref="topicListenerStar" queue-names="spring_topic_queue_star"/>--\x3e\n\x3c!--        <rabbit:listener ref="topicListenerWell" queue-names="spring_topic_queue_well"/>--\x3e\n\x3c!--        <rabbit:listener ref="topicListenerWell2" queue-names="spring_topic_queue_well2"/>--\x3e\n    </rabbit:listener-container>\n</beans>\n')),(0,r.kt)("h4",{id:"4-\u6d88\u606f\u76d1\u542c\u5668"},"\uff084\uff09 \u6d88\u606f\u76d1\u542c\u5668"),(0,r.kt)("h5",{id:"a\u961f\u5217\u76d1\u542c\u5668"},"a\u3001\u961f\u5217\u76d1\u542c\u5668"),(0,r.kt)("p",null,"\u521b\u5efa ",(0,r.kt)("inlineCode",{parentName:"p"},"spring-rabbitmq-consumer\\src\\main\\java\\com\\ydlclass\\rabbitmq\\listener\\SpringQueueListener.java")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.rabbitmq.listener;\n\nimport org.springframework.amqp.core.Message;\nimport org.springframework.amqp.core.MessageListener;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n//\u7f3a\u5565\u8865\u5565 \u5e72\u5c31\u5b8c\u4e8b\npublic class SpringQueueListener implements MessageListener {\n    //\u6709\u4e86\u6d88\u606f \u505a\u4ec0\u4e48\n    @Override\n    public void onMessage(Message message) {\n        //\u4e1a\u52a1\u903b\u8f91\n        byte[] body = message.getBody();\n        System.out.println(new String(body));\n    }\n}\n")),(0,r.kt)("p",null,"\u4e3a\u4e86\u8ba9spring\u5bb9\u5668\u4e00\u76f4\u8fd0\u884c\uff0c\u6211\u4eec\u9700\u8981\u5728\u6d4b\u8bd5\u7c7b\u4e2d\uff0c\u542f\u52a8spring\u5bb9\u5668\uff1acom.ydlclass.rabbimq"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.test.context.ContextConfiguration;\nimport org.springframework.test.context.junit4.SpringJUnit4ClassRunner;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations = "classpath:spring-rabbitmq.xml")\npublic class ConsumerTest {\n\n    @Test\n    public void consumerTest(){\n        while (true){\n\n        }\n    }\n}\n')),(0,r.kt)("h5",{id:"b\u5e7f\u64ad\u76d1\u542c\u56681"},"b\u3001\u5e7f\u64ad\u76d1\u542c\u56681"),(0,r.kt)("p",null,"\u521b\u5efa ",(0,r.kt)("inlineCode",{parentName:"p"},"spring-rabbitmq-consumer\\src\\main\\java\\com\\ydlclass\\rabbitmq\\listener\\FanoutListener1.java")),(0,r.kt)("h5",{id:"c\u5e7f\u64ad\u76d1\u542c\u56682"},"c\u3001\u5e7f\u64ad\u76d1\u542c\u56682"),(0,r.kt)("p",null,"\u521b\u5efa ",(0,r.kt)("inlineCode",{parentName:"p"},"spring-rabbitmq-consumer\\src\\main\\java\\com\\ydlclass\\rabbitmq\\listener\\FanoutListener2.java")),(0,r.kt)("h5",{id:"d\u661f\u53f7\u901a\u914d\u7b26\u76d1\u542c\u5668"},"d\u3001\u661f\u53f7\u901a\u914d\u7b26\u76d1\u542c\u5668"),(0,r.kt)("p",null,"\u521b\u5efa ",(0,r.kt)("inlineCode",{parentName:"p"},"spring-rabbitmq-consumer\\src\\main\\java\\com\\ydlclass\\rabbitmq\\listener\\TopicListenerStar.java")),(0,r.kt)("h5",{id:"e\u4e95\u53f7\u901a\u914d\u7b26\u76d1\u542c\u5668"},"e\u3001\u4e95\u53f7\u901a\u914d\u7b26\u76d1\u542c\u5668"),(0,r.kt)("p",null,"\u521b\u5efa ",(0,r.kt)("inlineCode",{parentName:"p"},"spring-rabbitmq-consumer\\src\\main\\java\\com\\ydlclass\\rabbitmq\\listener\\TopicListenerWell.java")),(0,r.kt)("h5",{id:"f\u4e95\u53f7\u901a\u914d\u7b26\u76d1\u542c\u56682"},"f\u3001\u4e95\u53f7\u901a\u914d\u7b26\u76d1\u542c\u56682"),(0,r.kt)("p",null,"\u521b\u5efa ",(0,r.kt)("inlineCode",{parentName:"p"},"spring-rabbitmq-consumer\\src\\main\\java\\com\\ydlclass\\rabbitmq\\listener\\TopicListenerWell2.java")),(0,r.kt)("p",null,"\u6d4b\u8bd5\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413215534196-0ac570bd.png",alt:"image-20220413215534196"}),"image-20220413215534196"),(0,r.kt)("h2",{id:"\u7b2c\u4e03\u7ae0-spring-boot\u6574\u5408rabbitmq"},"\u7b2c\u4e03\u7ae0 Spring Boot\u6574\u5408RabbitMQ"),(0,r.kt)("h3",{id:"1-\u7b80\u4ecb"},"1\u3001 \u7b80\u4ecb"),(0,r.kt)("p",null,"\u5728Spring\u9879\u76ee\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528Spring-Rabbit\u53bb\u64cd\u4f5cRabbitMQ ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/spring-projects/spring-amqp"},"https://github.com/spring-projects/spring-amqpopen in new window")),(0,r.kt)("p",null,"\u5c24\u5176\u662f\u5728spring boot\u9879\u76ee\u4e2d\u53ea\u9700\u8981\u5f15\u5165\u5bf9\u5e94\u7684amqp\u542f\u52a8\u5668\u4f9d\u8d56\u5373\u53ef\uff0c\u65b9\u4fbf\u7684\u4f7f\u7528RabbitTemplate\u53d1\u9001\u6d88\u606f\uff0c\u4f7f\u7528\u6ce8\u89e3\u63a5\u6536\u6d88\u606f\u3002"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"\u4e00\u822c\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d"),"\uff1a"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u751f\u4ea7\u8005\u5de5\u7a0b\uff1a")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"application.yml\u6587\u4ef6\u914d\u7f6eRabbitMQ\u76f8\u5173\u4fe1\u606f\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u5728\u751f\u4ea7\u8005\u5de5\u7a0b\u4e2d\u7f16\u5199\u914d\u7f6e\u7c7b\uff0c\u7528\u4e8e\u521b\u5efa\u4ea4\u6362\u673a\u548c\u961f\u5217\uff0c\u5e76\u8fdb\u884c\u7ed1\u5b9a"),(0,r.kt)("li",{parentName:"ol"},"\u6ce8\u5165RabbitTemplate\u5bf9\u8c61\uff0c\u901a\u8fc7RabbitTemplate\u5bf9\u8c61\u53d1\u9001\u6d88\u606f\u5230\u4ea4\u6362\u673a")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6d88\u8d39\u8005\u5de5\u7a0b\uff1a")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"application.yml\u6587\u4ef6\u914d\u7f6eRabbitMQ\u76f8\u5173\u4fe1\u606f"),(0,r.kt)("li",{parentName:"ol"},"\u521b\u5efa\u6d88\u606f\u5904\u7406\u7c7b\uff0c\u7528\u4e8e\u63a5\u6536\u961f\u5217\u4e2d\u7684\u6d88\u606f\u5e76\u8fdb\u884c\u5904\u7406")),(0,r.kt)("h3",{id:"2\u642d\u5efa\u751f\u4ea7\u8005\u5de5\u7a0b"},"2\u3001\u642d\u5efa\u751f\u4ea7\u8005\u5de5\u7a0b"),(0,r.kt)("h4",{id:"1-\u521b\u5efa\u5de5\u7a0b"},"\uff081\uff09 \u521b\u5efa\u5de5\u7a0b"),(0,r.kt)("p",null,"\u521b\u5efa\u751f\u4ea7\u8005\u5de5\u7a0bspringboot-rabbitmq-producer"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413222931239-b56a680b.png",alt:"image-20220413222931239"}),"image-20220413222931239"),(0,r.kt)("h4",{id:"2-\u6dfb\u52a0\u4f9d\u8d56"},"\uff082\uff09 \u6dfb\u52a0\u4f9d\u8d56"),(0,r.kt)("p",null,"\u4fee\u6539pom.xml\u6587\u4ef6\u5185\u5bb9\u4e3a\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.1.4.RELEASE</version>\n    </parent>\n    <groupId>com.ydlclass</groupId>\n    <artifactId>springboot-rabbitmq-producer</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-amqp</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n        </dependency>\n    </dependencies>\n</project>\n')),(0,r.kt)("h4",{id:"3-\u542f\u52a8\u7c7b"},"\uff083\uff09 \u542f\u52a8\u7c7b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.rabbitmq;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@SpringBootApplication\npublic class ProducerApp {\n    public static void main(String[] args) {\n        SpringApplication.run(ProducerApp.class,args);\n    }\n}\n")),(0,r.kt)("h4",{id:"4\u914d\u7f6erabbitmq"},"\uff084\uff09\u914d\u7f6eRabbitMQ"),(0,r.kt)("h5",{id:"a\u914d\u7f6e\u6587\u4ef6"},"a\u3001\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("p",null,"\u521b\u5efaapplication.yml\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  rabbitmq:\n    host: localhost\n    port: 5672\n    virtual-host: /\n    username: itlils\n    password: itlils\n")),(0,r.kt)("h5",{id:"b\u7ed1\u5b9a\u4ea4\u6362\u673a\u548c\u961f\u5217"},"b\u3001\u7ed1\u5b9a\u4ea4\u6362\u673a\u548c\u961f\u5217"),(0,r.kt)("p",null,"\u521b\u5efaRabbitMQ\u961f\u5217\u4e0e\u4ea4\u6362\u673a\u7ed1\u5b9a\u7684\u914d\u7f6e\u7c7bcom.ydlclass.rabbitmq.config.RabbitMQConfig"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.rabbitmq.config;\n\nimport org.springframework.amqp.core.*;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@Configuration\npublic class RabbitConfig {\n\n    @Bean("boot_hello_queue")\n    public Queue queue(){\n        //String queue,  \u961f\u5217\u540d\n        // boolean durable, \u6301\u4e45\u5316\n        // boolean exclusive, \u6392\u4ed6\u7684\n        // boolean autoDelete, \u81ea\u52a8\u5220\u9664\n        // Map<String, Object> arguments \u5c5e\u6027\n        return new Queue("boot_hello_queue",true,false,false,null);\n    }\n\n    //\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\n    //\u4ea4\u6362\u673a\u540d\u79f0\n   public static final String FANOUT_EXCHAGE = "boot_fanout_exchange";\n    //\u961f\u5217\u540d\u79f0\n    public static final String FANOUT_QUEUE_1 = "boot_fanout_queue_1";\n    //\u961f\u5217\u540d\u79f0\n    public static final String FANOUT_QUEUE_2 = "boot_fanout_queue_2";\n\n    @Bean(FANOUT_QUEUE_1)\n    public Queue FANOUT_QUEUE_1(){\n        return new Queue(FANOUT_QUEUE_1,true,false,false,null);\n    }\n    @Bean(FANOUT_QUEUE_2)\n    public Queue FANOUT_QUEUE_2(){\n        return new Queue(FANOUT_QUEUE_2,true,false,false,null);\n    }\n    @Bean(FANOUT_EXCHAGE)\n    public Exchange FANOUT_EXCHAGE(){\n        return ExchangeBuilder.fanoutExchange(FANOUT_EXCHAGE).durable(true).build();\n    }\n    @Bean\n    public Binding FANOUT_QUEUE_1_FANOUT_EXCHAGE(@Qualifier(FANOUT_QUEUE_1) Queue queue,\n                                                 @Qualifier(FANOUT_EXCHAGE) Exchange exchange){\n        return BindingBuilder.bind(queue).to(exchange).with("").noargs();\n    }\n    @Bean\n    public Binding FANOUT_QUEUE_2_FANOUT_EXCHAGE(@Qualifier(FANOUT_QUEUE_2) Queue queue,\n                                                 @Qualifier(FANOUT_EXCHAGE) Exchange exchange){\n        return BindingBuilder.bind(queue).to(exchange).with("").noargs();\n    }\n\n    //\u4f5c\u4e1a\n    //routing\u6a21\u5f0f\n\n    //topic\u6a21\u5f0f\n\n\n}\n')),(0,r.kt)("p",null,"\u6d4b\u8bd5\u7c7b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'package com.ydlclass.rabbitmq;\n\nimport com.ydlclass.rabbitmq.config.RabbitConfig;\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.amqp.rabbit.core.RabbitTemplate;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.boot.test.context.SpringBootTest;\nimport org.springframework.test.context.junit4.SpringRunner;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@RunWith(SpringRunner.class)\n@SpringBootTest(classes = ProducerApp.class)\npublic class ProducerTest {\n\n    @Autowired\n    RabbitTemplate rabbitTemplate;\n\n    @Test\n    public void helloTest(){\n        String msg="hello rabbitmq!";\n        rabbitTemplate.convertAndSend("","boot_hello_queue",msg);\n    }\n\n    @Test\n    public void publishTest(){\n        String msg="hello rabbitmq!publishTest";\n        rabbitTemplate.convertAndSend(RabbitConfig.FANOUT_EXCHAGE,"",msg);\n    }\n\n    //\u4f5c\u4e1a routing\n    //topic\n}\n')),(0,r.kt)("p",null,"\u7b80\u5355\u6a21\u5f0f\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413221046286-35eb38b7.png",alt:"image-20220413221046286"}),"image-20220413221046286"),(0,r.kt)("p",null,"\u53d1\u5e03\u8ba2\u9605\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413222539201-769338b4.png",alt:"image-20220413222539201"}),"image-20220413222539201"),(0,r.kt)("p",null,"\u6bcf\u4e2a\u961f\u5217\u90fd\u6709\u4e00\u6761\u6d88\u606f\u4e86"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413222558184-c6db4b62.png",alt:"image-20220413222558184"}),"image-20220413222558184"),(0,r.kt)("p",null," ",(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413222609681-d010ab71.png",alt:"image-20220413222609681"})),(0,r.kt)("h3",{id:"3\u642d\u5efa\u6d88\u8d39\u8005\u5de5\u7a0b"},"3\u3001\u642d\u5efa\u6d88\u8d39\u8005\u5de5\u7a0b"),(0,r.kt)("h4",{id:"1-\u521b\u5efa\u5de5\u7a0b-1"},"\uff081\uff09 \u521b\u5efa\u5de5\u7a0b"),(0,r.kt)("p",null,"\u521b\u5efa\u6d88\u8d39\u8005\u5de5\u7a0bspringboot-rabbitmq-consumer"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220413233208158-458a7865.png",alt:"image-20220413233208158"}),"image-20220413233208158"),(0,r.kt)("h4",{id:"2-\u6dfb\u52a0\u4f9d\u8d56-1"},"\uff082\uff09 \u6dfb\u52a0\u4f9d\u8d56"),(0,r.kt)("p",null,"\u4fee\u6539pom.xml\u6587\u4ef6\u5185\u5bb9\u4e3a\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.1.4.RELEASE</version>\n    </parent>\n    <groupId>com.ydlclass</groupId>\n    <artifactId>springboot-rabbitmq-consumer</artifactId>\n    <version>1.0-SNAPSHOT</version>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-amqp</artifactId>\n        </dependency>\n    </dependencies>\n\n</project>\n')),(0,r.kt)("h4",{id:"3-\u542f\u52a8\u7c7b-1"},"\uff083\uff09 \u542f\u52a8\u7c7b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.rabbitmq;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@SpringBootApplication\npublic class ConsumerApp {\n    public static void main(String[] args) {\n        SpringApplication.run(ConsumerApp.class,args);\n    }\n}\n")),(0,r.kt)("h4",{id:"4-\u914d\u7f6erabbitmq"},"\uff084\uff09 \u914d\u7f6eRabbitMQ"),(0,r.kt)("p",null,"\u521b\u5efaapplication.yml\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"spring:\n  rabbitmq:\n    host: localhost\n    port: 5672\n    virtual-host: /\n    username: itlils\n    password: itlils\n")),(0,r.kt)("h4",{id:"5-\u6d88\u606f\u76d1\u542c\u5904\u7406\u7c7b"},"\uff085\uff09 \u6d88\u606f\u76d1\u542c\u5904\u7406\u7c7b"),(0,r.kt)("p",null,"\u7f16\u5199\u6d88\u606f\u76d1\u542c\u5668com.ydlclass.rabbitmq.listener.MyListener"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"package com.ydlclass.rabbitmq.listener;\n\nimport com.ydlclass.rabbitmq.config.RabbitConfig;\nimport org.springframework.amqp.core.Message;\nimport org.springframework.amqp.core.MessageProperties;\nimport org.springframework.amqp.rabbit.annotation.RabbitListener;\nimport org.springframework.stereotype.Component;\n\n/**\n * @Created by IT\u674e\u8001\u5e08\n * \u516c\u4e3b\u53f7 \u201c\u5143\u52a8\u529b\u8bfe\u5802\u201d\n * \u4e2a\u4eba\u5fae itlils\n */\n@Component\npublic class MyListener {\n\n    @RabbitListener(queues = RabbitConfig.FANOUT_QUEUE_1)\n    public void receiveMsg(Message message){\n        //\u4e1a\u52a1\u903b\u8f91\n        byte[] body = message.getBody();\n        System.out.println(new String(body));\n\n        MessageProperties messageProperties = message.getMessageProperties(); //\u53c2\u6570\n        System.out.println(messageProperties.getMessageId());\n        System.out.println(messageProperties.getDeliveryTag());\n        System.out.println(messageProperties.getReceivedRoutingKey());\n        System.out.println(messageProperties.getConsumerTag());\n    }\n\n}\n")),(0,r.kt)("h3",{id:"4-\u6d4b\u8bd5"},"4\u3001 \u6d4b\u8bd5"),(0,r.kt)("p",null,"\u5148\u8fd0\u884c\u4e0a\u8ff0\u6d4b\u8bd5\u7a0b\u5e8f\uff08\u4ea4\u6362\u673a\u548c\u961f\u5217\u624d\u80fd\u5148\u88ab\u58f0\u660e\u548c\u7ed1\u5b9a\uff09\uff0c\u7136\u540e\u542f\u52a8\u6d88\u8d39\u8005\uff1b\u5728\u6d88\u8d39\u8005\u5de5\u7a0bspringboot-rabbitmq-consumer\u4e2d\u63a7\u5236\u53f0\u67e5\u770b\u662f\u5426\u63a5\u6536\u5230\u5bf9\u5e94\u6d88\u606f\u3002"),(0,r.kt)("p",null,"\u53e6\u5916\uff1b\u4e5f\u53ef\u4ee5\u5728RabbitMQ\u7684\u7ba1\u7406\u63a7\u5236\u53f0\u4e2d\u67e5\u770b\u5230\u4ea4\u6362\u673a\u4e0e\u961f\u5217\u7684\u7ed1\u5b9a\u3002"),(0,r.kt)("h1",{id:"rabbitmq\u9ad8\u7ea7-\u5b66\u4e60\u76ee\u6807"},"RabbitMQ\u9ad8\u7ea7 \u5b66\u4e60\u76ee\u6807"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u638c\u63e1RabbitMQ \u9ad8\u7ea7\u7279\u6027")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u7406\u89e3RabbitMQ \u5e94\u7528\u95ee\u9898")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u80fd\u591f\u642d\u5efaRabbitMQ \u96c6\u7fa4"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320230112442-9919b2e6.png",alt:"image-20200320230112442"}),"image-20200320230112442"))),(0,r.kt)("h2",{id:"\u7b2c\u4e00\u7ae0-rabbitmq-\u9ad8\u7ea7\u7279\u6027"},"\u7b2c\u4e00\u7ae0 RabbitMQ \u9ad8\u7ea7\u7279\u6027"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200320180217097-f868c655.png",alt:"image-20200616093631383"}),"image-20200616093631383"),(0,r.kt)("h3",{id:"1\u6d88\u606f\u53ef\u9760\u6027\u6295\u9012"},"1\u3001\u6d88\u606f\u53ef\u9760\u6027\u6295\u9012"),(0,r.kt)("p",null,"\u5728\u4f7f\u7528 RabbitMQ \u7684\u65f6\u5019\uff0c\u4f5c\u4e3a\u6d88\u606f\u53d1\u9001\u65b9\u5e0c\u671b\u675c\u7edd\u4efb\u4f55\u6d88\u606f\u4e22\u5931\u6216\u8005\u6295\u9012\u5931\u8d25\u573a\u666f\u3002RabbitMQ \u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e24\u79cd\u65b9\u5f0f\u7528\u6765\u63a7\u5236\u6d88\u606f\u7684\u6295\u9012\u53ef\u9760\u6027\u6a21\u5f0f\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"confirm ",(0,r.kt)("strong",{parentName:"li"},"\u786e\u8ba4\u6a21\u5f0f")),(0,r.kt)("li",{parentName:"ul"},"return ",(0,r.kt)("strong",{parentName:"li"},"\u9000\u56de\u6a21\u5f0f"))),(0,r.kt)("p",null,"rabbitmq \u6574\u4e2a\u6d88\u606f\u6295\u9012\u7684\u8def\u5f84\u4e3a\uff1a"),(0,r.kt)("p",null," ",(0,r.kt)("strong",{parentName:"p"},"producer ---\x3e rabbitmq broker ---\x3e exchange ---\x3e queue ---\x3e consumer")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u6d88\u606f\u4ece producer \u5230 exchange \u5219\u4f1a\u8fd4\u56de\u4e00\u4e2a confirmCallback \u3002"),(0,r.kt)("li",{parentName:"ul"},"\u6d88\u606f\u4ece exchange \u5230 queue \u6295\u9012\u5931\u8d25\u5219\u4f1a\u8fd4\u56de\u4e00\u4e2a returnCallback \u3002")),(0,r.kt)("p",null,"\u6211\u4eec\u5c06\u5229\u7528\u8fd9\u4e24\u4e2a callback \u63a7\u5236\u6d88\u606f\u7684\u53ef\u9760\u6027\u6295\u9012"),(0,r.kt)("h4",{id:"1confirm\u786e\u8ba4\u6a21\u5f0f\u4ee3\u7801\u5b9e\u73b0"},"\uff081\uff09confirm\u786e\u8ba4\u6a21\u5f0f\u4ee3\u7801\u5b9e\u73b0"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u521b\u5efamaven\u5de5\u7a0b\uff0c\u6d88\u606f\u7684\u751f\u4ea7\u8005\u5de5\u7a0b\uff0c\u9879\u76ee\u6a21\u5757\u540d\u79f0\uff1arabbitmq-producer-spring")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u6dfb\u52a0\u4f9d\u8d56"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```xml\n<dependencies>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-context</artifactId>\n        <version>5.1.7.RELEASE</version>\n    </dependency>\n\n    <dependency>\n        <groupId>org.springframework.amqp</groupId>\n        <artifactId>spring-rabbit</artifactId>\n        <version>2.1.8.RELEASE</version>\n    </dependency>\n    <dependency>\n        <groupId>junit</groupId>\n        <artifactId>junit</artifactId>\n        <version>4.12</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-test</artifactId>\n        <version>5.1.7.RELEASE</version>\n    </dependency>\n</dependencies>\n\n<build>\n    <plugins>\n        <plugin>\n            <groupId>org.apache.maven.plugins</groupId>\n            <artifactId>maven-compiler-plugin</artifactId>\n            <version>3.8.0</version>\n            <configuration>\n                <source>1.8</source>\n                <target>1.8</target>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n```\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"\u5728 resources \u76ee\u5f55\u4e0b\u521b\u5efa rabbitmq.properties \u914d\u7f6e\u6587\u4ef6\uff0c\u6dfb\u52a0\u8fde\u63a5RabbitMQ\u76f8\u5173\u4fe1\u606f")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```properties\nrabbitmq.host=localhost\nrabbitmq.port=5672\nrabbitmq.username=guest\nrabbitmq.password=guest\nrabbitmq.virtual-host=/\n```\n")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"\u5728 resources \u76ee\u5f55\u4e0b\u521b\u5efa spring-rabbitmq-producer.xml \u914d\u7f6e\u6587\u4ef6\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```xml\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xmlns:rabbit="http://www.springframework.org/schema/rabbit"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n                 http://www.springframework.org/schema/beans/spring-beans.xsd\n                 http://www.springframework.org/schema/context\n                 https://www.springframework.org/schema/context/spring-context.xsd\n                 http://www.springframework.org/schema/rabbit\n                 http://www.springframework.org/schema/rabbit/spring-rabbit.xsd">\n    \x3c!--\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6--\x3e\n    <context:property-placeholder location="classpath:rabbitmq.properties"/>\n\n    \x3c!-- \u5b9a\u4e49rabbitmq connectionFactory  1. \u8bbe\u7f6e  publisher-confirms="true" --\x3e\n    <rabbit:connection-factory id="connectionFactory" host="${rabbitmq.host}"\n                               port="${rabbitmq.port}"\n                               username="${rabbitmq.username}"\n                               password="${rabbitmq.password}"\n                               virtual-host="${rabbitmq.virtual-host}"\n                               \n                               publisher-confirms="true"\n                               />\n    \x3c!--\u5b9a\u4e49\u7ba1\u7406\u4ea4\u6362\u673a\u3001\u961f\u5217--\x3e\n    <rabbit:admin connection-factory="connectionFactory"/>\n\n    \x3c!--\u5b9a\u4e49rabbitTemplate\u5bf9\u8c61\u64cd\u4f5c\u53ef\u4ee5\u5728\u4ee3\u7801\u4e2d\u65b9\u4fbf\u53d1\u9001\u6d88\u606f--\x3e\n    <rabbit:template id="rabbitTemplate" connection-factory="connectionFactory"/>\n\n    \x3c!--2. \u6d88\u606f\u53ef\u9760\u6027\u6295\u9012\uff08\u751f\u4ea7\u7aef\uff09--\x3e\n   <rabbit:queue id="test_queue_confirm" name="test_queue_confirm"></rabbit:queue>\n    <rabbit:direct-exchange name="test_exchange_confirm">\n        <rabbit:bindings>\n            <rabbit:binding queue="test_queue_confirm" key="confirm">                          </rabbit:binding>\n        </rabbit:bindings>\n    </rabbit:direct-exchange>\n    \n</beans>\n```\n')),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"\u7f16\u5199\u6d4b\u8bd5\u4ee3\u7801 com.ydlclass.producer")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```java\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations = "classpath:spring-rabbitmq-producer.xml")\npublic class ProducerTest {\n\n    @Autowired\n    private RabbitTemplate rabbitTemplate;\n\n    /**\n     * \u786e\u8ba4\u6a21\u5f0f\uff1a\n     * \u6b65\u9aa4\uff1a\n     * 1. \u786e\u8ba4\u6a21\u5f0f\u5f00\u542f\uff1aConnectionFactory\u4e2d\u5f00\u542fpublisher-confirms="true"\n     * 2. \u5728rabbitTemplate\u5b9a\u4e49ConfirmCallBack\u56de\u8c03\u51fd\u6570\n     */\n    @Test\n    public void testConfirm() {\n\n        //2. \u5b9a\u4e49\u56de\u8c03 **\n        rabbitTemplate.setConfirmCallback(new RabbitTemplate.ConfirmCallback() {\n            /**\n             *\n             * @param correlationData \u76f8\u5173\u914d\u7f6e\u4fe1\u606f\n             * @param ack   exchange\u4ea4\u6362\u673a \u662f\u5426\u6210\u529f\u6536\u5230\u4e86\u6d88\u606f\u3002true \u6210\u529f\uff0cfalse\u4ee3\u8868\u5931\u8d25\n             * @param cause \u5931\u8d25\u539f\u56e0\n             */\n            @Override\n            public void confirm(CorrelationData correlationData, boolean ack, String cause) {\n                System.out.println("confirm\u65b9\u6cd5\u88ab\u6267\u884c\u4e86....");\n\n                if (ack) {\n                    //\u63a5\u6536\u6210\u529f\n                    System.out.println("\u63a5\u6536\u6210\u529f\u6d88\u606f" + cause);\n                } else {\n                    //\u63a5\u6536\u5931\u8d25\n                    System.out.println("\u63a5\u6536\u5931\u8d25\u6d88\u606f" + cause);\n                    //\u505a\u4e00\u4e9b\u5904\u7406\uff0c\u8ba9\u6d88\u606f\u518d\u6b21\u53d1\u9001\u3002\n                }\n            }\n        });\n\n        //3. \u53d1\u9001\u6d88\u606f\n        rabbitTemplate.convertAndSend("test_exchange_confirm111", "confirm", "message confirm....");\n    }\n}\n```\n')),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u6d4b\u8bd5\u7ed3\u679c"),(0,r.kt)("p",{parentName:"li"},"\u6210\u529f\uff1a"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714120818639-d5d2bd3b.png",alt:"image-20220714120818639"}),"image-20220714120818639"),(0,r.kt)("p",{parentName:"li"},"\u5931\u8d25\uff1a"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714120929607-e9b31074.png",alt:"image-20220714120929607"}),"image-20220714120929607"))),(0,r.kt)("h4",{id:"2-return\u9000\u56de\u6a21\u5f0f\u4ee3\u7801\u5b9e\u73b0"},"\uff082\uff09 return\u9000\u56de\u6a21\u5f0f\u4ee3\u7801\u5b9e\u73b0"),(0,r.kt)("p",null,"\u56de\u9000\u6a21\u5f0f\uff1a \u5f53\u6d88\u606f\u53d1\u9001\u7ed9Exchange\u540e\uff0cExchange\u8def\u7531\u5230Queue\u5931\u8d25\u662f \u624d\u4f1a\u6267\u884c ReturnCallBack\uff0c\u5177\u4f53\u5b9e\u73b0\u5982\u4e0b\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5728 spring-rabbitmq-producer.xml \u914d\u7f6e\u6587\u4ef6\uff0c\u5728 ",(0,r.kt)("strong",{parentName:"li"},"rabbit:connection-factory"),"\u8282\u70b9 \u6dfb\u52a0\u914d\u7f6e\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```text\npublisher-returns="true"\n```\n')),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"\u7f16\u5199\u6d4b\u8bd5\u65b9\u6cd5")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```java\n/**\n * \u6b65\u9aa4\uff1a\n * 1. \u5f00\u542f\u56de\u9000\u6a21\u5f0f:publisher-returns="true"\n * 2. \u8bbe\u7f6eReturnCallBack\n * 3. \u8bbe\u7f6eExchange\u5904\u7406\u6d88\u606f\u7684\u6a21\u5f0f\uff1a\n *  1. \u5982\u679c\u6d88\u606f\u6ca1\u6709\u8def\u7531\u5230Queue\uff0c\u5219\u4e22\u5f03\u6d88\u606f\uff08\u9ed8\u8ba4\uff09\n *  2. \u5982\u679c\u6d88\u606f\u6ca1\u6709\u8def\u7531\u5230Queue\uff0c\u8fd4\u56de\u7ed9\u6d88\u606f\u53d1\u9001\u65b9ReturnCallBack\n */\n\n@Test\npublic void testReturn() {\n\n    //\u8bbe\u7f6e\u4ea4\u6362\u673a\u5904\u7406\u5931\u8d25\u6d88\u606f\u7684\u6a21\u5f0f\n    rabbitTemplate.setMandatory(true);\n\n    //2.\u8bbe\u7f6eReturnCallBack\n    rabbitTemplate.setReturnCallback(new RabbitTemplate.ReturnCallback() {\n        /**\n         *\n         * @param message   \u6d88\u606f\u5bf9\u8c61\n         * @param replyCode \u9519\u8bef\u7801\n         * @param replyText \u9519\u8bef\u4fe1\u606f\n         * @param exchange  \u4ea4\u6362\u673a\n         * @param routingKey \u8def\u7531\u952e\n         */\n        @Override\n        public void returnedMessage(Message message, int replyCode, String replyText, String exchange, String routingKey) {\n            System.out.println("return \u6267\u884c\u4e86....");\n\n            System.out.println(message);\n            System.out.println(replyCode);\n            System.out.println(replyText);\n            System.out.println(exchange);\n            System.out.println(routingKey);\n\n            //\u5904\u7406\n        }\n    });\n\n\n    //3. \u53d1\u9001\u6d88\u606f   \n    rabbitTemplate.convertAndSend("test_exchange_confirm", "confirm", "message confirm....");\n}\n```\n\n\u8bbe\u7f6e routingKey \u4e3a\u4e00\u4e2a\u4e0d\u7b26\u5408\u89c4\u5219\u7684key\uff0c\u89c2\u5bdf\u63a7\u5236\u53f0\u6253\u5370\u7ed3\u679c\u3002\n\n\u6210\u529f\uff1a\n\n![image-20220714133207266](https://www.ydlclass.com/doc21xnv/assets/image-20220714133207266-a43b3bda.png)image-20220714133207266\n\n\u5931\u8d25\uff1a\n\n![image-20220714133352530](https://www.ydlclass.com/doc21xnv/assets/image-20220714133352530-c340e440.png)image-20220714133352530\n')),(0,r.kt)("h4",{id:"3\u5c0f\u7ed3"},"\uff083\uff09\u5c0f\u7ed3"),(0,r.kt)("p",null,"\u5bf9\u4e8e\u786e\u8ba4\u6a21\u5f0f\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'\u8bbe\u7f6eConnectionFactory\u7684publisher-confirms="true" \u5f00\u542f \u786e\u8ba4\u6a21\u5f0f\u3002'),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528rabbitTemplate.setConfirmCallback\u8bbe\u7f6e\u56de\u8c03\u51fd\u6570\u3002\u5f53\u6d88\u606f\u53d1\u9001\u5230exchange\u540e\u56de\u8c03confirm\u65b9\u6cd5\u3002\u5728\u65b9\u6cd5\u4e2d\u5224\u65adack\uff0c\u5982\u679c\u4e3atrue\uff0c\u5219\u53d1\u9001\u6210\u529f\uff0c\u5982\u679c\u4e3afalse\uff0c\u5219\u53d1\u9001\u5931\u8d25\uff0c\u9700\u8981\u5904\u7406\u3002")),(0,r.kt)("p",null,"\u5bf9\u4e8e\u9000\u56de\u6a21\u5f0f"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'\u8bbe\u7f6eConnectionFactory\u7684publisher-returns="true" \u5f00\u542f \u9000\u56de\u6a21\u5f0f\u3002'),(0,r.kt)("li",{parentName:"ul"},"\u4f7f\u7528rabbitTemplate.setReturnCallback\u8bbe\u7f6e\u9000\u56de\u51fd\u6570\uff0c\u5f53\u6d88\u606f\u4eceexchange\u8def\u7531\u5230queue\u5931\u8d25\u540e\uff0c\u5982\u679c\u8bbe\u7f6e\u4e86rabbitTemplate.setMandatory(true)\u53c2\u6570\uff0c\u5219\u4f1a\u5c06\u6d88\u606f\u9000\u56de\u7ed9producer\u3002\u5e76\u6267\u884c\u56de\u8c03\u51fd\u6570returnedMessage\u3002")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5728RabbitMQ\u4e2d\u4e5f\u63d0\u4f9b\u4e86\u4e8b\u52a1\u673a\u5236\uff0c\u4f46\u662f\u6027\u80fd\u8f83\u5dee\uff0c\u6b64\u5904\u4e0d\u505a\u8bb2\u89e3\u3002"),(0,r.kt)("p",{parentName:"blockquote"},"\u4f7f\u7528channel\u5217\u65b9\u6cd5\uff0c\u5b8c\u6210\u4e8b\u52a1\u63a7\u5236\uff1a"),(0,r.kt)("p",{parentName:"blockquote"},"txSelect(), \u7528\u4e8e\u5c06\u5f53\u524dchannel\u8bbe\u7f6e\u6210transaction\u6a21\u5f0f"),(0,r.kt)("p",{parentName:"blockquote"},"txCommit()\uff0c\u7528\u4e8e\u63d0\u4ea4\u4e8b\u52a1"),(0,r.kt)("p",{parentName:"blockquote"},"txRollback(),\u7528\u4e8e\u56de\u6eda\u4e8b\u52a1")),(0,r.kt)("h3",{id:"2consumer-ack"},"2\u3001Consumer ACK"),(0,r.kt)("p",null,"ack\u6307 ",(0,r.kt)("strong",{parentName:"p"},"Acknowledge"),"\uff0c\u786e\u8ba4\u3002 \u8868\u793a\u6d88\u8d39\u7aef\u6536\u5230\u6d88\u606f\u540e\u7684\u786e\u8ba4\u65b9\u5f0f\u3002"),(0,r.kt)("p",null,"\u6709\u4e09\u79cd\u786e\u8ba4\u65b9\u5f0f\uff1a"),(0,r.kt)("p",null,'\u2022 \u81ea\u52a8\u786e\u8ba4\uff1aacknowledge="',(0,r.kt)("strong",{parentName:"p"},"none"),'"'),(0,r.kt)("p",null,'\u2022 \u624b\u52a8\u786e\u8ba4\uff1aacknowledge="',(0,r.kt)("strong",{parentName:"p"},"manual"),'"'),(0,r.kt)("p",null,'\u2022 \u6839\u636e\u5f02\u5e38\u60c5\u51b5\u786e\u8ba4\uff1aacknowledge="',(0,r.kt)("strong",{parentName:"p"},"auto"),'"\uff0c\uff08\u8fd9\u79cd\u65b9\u5f0f\u4f7f\u7528\u9ebb\u70e6\uff0c\u4e0d\u4f5c\u8bb2\u89e3\uff09'),(0,r.kt)("p",null,"\u5176\u4e2d\u81ea\u52a8\u786e\u8ba4\u662f\u6307\uff0c\u5f53\u6d88\u606f\u4e00\u65e6\u88abConsumer\u63a5\u6536\u5230\uff0c\u5219\u81ea\u52a8\u786e\u8ba4\u6536\u5230\uff0c\u5e76\u5c06\u76f8\u5e94 message \u4ece RabbitMQ \u7684\u6d88\u606f\u7f13\u5b58\u4e2d\u79fb\u9664\u3002\u4f46\u662f\u5728\u5b9e\u9645\u4e1a\u52a1\u5904\u7406\u4e2d\uff0c\u5f88\u53ef\u80fd\u6d88\u606f\u63a5\u6536\u5230\uff0c\u4e1a\u52a1\u5904\u7406\u51fa\u73b0\u5f02\u5e38\uff0c\u90a3\u4e48\u8be5\u6d88\u606f\u5c31\u4f1a\u4e22\u5931\u3002"),(0,r.kt)("p",null,"\u5982\u679c\u8bbe\u7f6e\u4e86\u624b\u52a8\u786e\u8ba4\u65b9\u5f0f\uff0c\u5219\u9700\u8981\u5728\u4e1a\u52a1\u5904\u7406\u6210\u529f\u540e\uff0c\u8c03\u7528channel.basicAck()\uff0c\u624b\u52a8\u7b7e\u6536\uff0c\u5982\u679c\u51fa\u73b0\u5f02\u5e38\uff0c\u5219\u8c03\u7528channel.basicNack()\u65b9\u6cd5\uff0c\u8ba9\u5176\u81ea\u52a8\u91cd\u65b0\u53d1\u9001\u6d88\u606f\u3002"),(0,r.kt)("h4",{id:"1\u4ee3\u7801\u5b9e\u73b0"},"\uff081\uff09\u4ee3\u7801\u5b9e\u73b0"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u521b\u5efamaven\u5de5\u7a0b\uff0c\u6d88\u606f\u7684\u6d88\u8d39\u8005\u5de5\u7a0b\uff0c\u9879\u76ee\u6a21\u5757\u540d\u79f0\uff1arabbitmq-consumer-spring")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u6dfb\u52a0\u4f9d\u8d56"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```xml\n<dependencies>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-context</artifactId>\n        <version>5.1.7.RELEASE</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework.amqp</groupId>\n        <artifactId>spring-rabbit</artifactId>\n        <version>2.1.8.RELEASE</version>\n    </dependency>\n    <dependency>\n        <groupId>junit</groupId>\n        <artifactId>junit</artifactId>\n        <version>4.12</version>\n    </dependency>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-test</artifactId>\n        <version>5.1.7.RELEASE</version>\n    </dependency>\n</dependencies>\n\n<build>\n    <plugins>\n        <plugin>\n            <groupId>org.apache.maven.plugins</groupId>\n            <artifactId>maven-compiler-plugin</artifactId>\n            <version>3.8.0</version>\n            <configuration>\n                <source>1.8</source>\n                <target>1.8</target>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n```\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"\u5728 resources \u76ee\u5f55\u4e0b\u521b\u5efa rabbitmq.properties \u914d\u7f6e\u6587\u4ef6\uff0c\u6dfb\u52a0\u94fe\u63a5RabbitMQ\u76f8\u5173\u4fe1\u606f")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```properties\nrabbitmq.host=localhost\nrabbitmq.port=5672\nrabbitmq.username=guest\nrabbitmq.password=guest\nrabbitmq.virtual-host=/\n```\n")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"\u5728 resources \u76ee\u5f55\u4e0b\u521b\u5efa spring-rabbitmq-consumer.xml \u914d\u7f6e\u6587\u4ef6\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```xml\n<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xmlns:context="http://www.springframework.org/schema/context"\n       xmlns:rabbit="http://www.springframework.org/schema/rabbit"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n             http://www.springframework.org/schema/beans/spring-beans.xsd\n             http://www.springframework.org/schema/context\n             https://www.springframework.org/schema/context/spring-context.xsd\n             http://www.springframework.org/schema/rabbit\n             http://www.springframework.org/schema/rabbit/spring-rabbit.xsd">\n    \x3c!--\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6--\x3e\n    <context:property-placeholder location="classpath:rabbitmq.properties"/>\n\n    \x3c!-- \u5b9a\u4e49rabbitmq connectionFactory --\x3e\n    <rabbit:connection-factory id="connectionFactory" host="${rabbitmq.host}"\n                               port="${rabbitmq.port}"\n                               username="${rabbitmq.username}"\n                               password="${rabbitmq.password}"\n                               virtual-host="${rabbitmq.virtual-host}"/>\n\n\n    <context:component-scan base-package="com.ydlclass.listener" />\n\n    \x3c!--\u5b9a\u4e49\u76d1\u542c\u5668\u5bb9\u5668  \u6dfb\u52a0  acknowledge="manual" \u624b\u52a8--\x3e\n    <rabbit:listener-container connection-factory="connectionFactory" acknowledge="manual">\n        <rabbit:listener ref="ackListener" queue-names="test_queue_confirm"/>\n    </rabbit:listener-container>\n\n</beans>\n```\n')),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"\u7f16\u5199ackListener \u76d1\u542c\u7c7b\u5b9e\u73b0ChannelAwareMessageListener\u63a5\u53e3")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```java\npackage com.ydlclass.listener;\n\nimport com.rabbitmq.client.Channel;\nimport org.springframework.amqp.core.Message;\nimport org.springframework.amqp.core.MessageListener;\nimport org.springframework.amqp.rabbit.listener.api.ChannelAwareMessageListener;\nimport org.springframework.stereotype.Component;\n\nimport java.io.IOException;\n\n/**\n * Consumer ACK\u673a\u5236\uff1a\n *  1. \u8bbe\u7f6e\u624b\u52a8\u7b7e\u6536\u3002acknowledge="manual"\n *  2. \u8ba9\u76d1\u542c\u5668\u7c7b\u5b9e\u73b0ChannelAwareMessageListener\u63a5\u53e3\n *  3. \u5982\u679c\u6d88\u606f\u6210\u529f\u5904\u7406\uff0c\u5219\u8c03\u7528channel\u7684 basicAck()\u7b7e\u6536\n *  4. \u5982\u679c\u6d88\u606f\u5904\u7406\u5931\u8d25\uff0c\u5219\u8c03\u7528channel\u7684basicNack()\u62d2\u7edd\u7b7e\u6536\uff0cbroker\u91cd\u65b0\u53d1\u9001\u7ed9consumer\n */\n@Component\npublic class AckListener implements ChannelAwareMessageListener {\n\n    @Override\n    public void onMessage(Message message, Channel channel) throws Exception {\n        long deliveryTag = message.getMessageProperties().getDeliveryTag();\n\n        try {\n            //1.\u63a5\u6536\u8f6c\u6362\u6d88\u606f\n            System.out.println(new String(message.getBody()));\n\n            //2. \u5904\u7406\u4e1a\u52a1\u903b\u8f91\n            System.out.println("\u5904\u7406\u4e1a\u52a1\u903b\u8f91...");\n            int i = 3/0;//\u51fa\u73b0\u9519\u8bef\n            //3. \u624b\u52a8\u7b7e\u6536\n            channel.basicAck(deliveryTag,true);\n        } catch (Exception e) {\n            //e.printStackTrace();\n\n            //4.\u62d2\u7edd\u7b7e\u6536\n            /*\n            \u7b2c\u4e09\u4e2a\u53c2\u6570\uff1arequeue\uff1a\u91cd\u56de\u961f\u5217\u3002\u5982\u679c\u8bbe\u7f6e\u4e3atrue\uff0c\u5219\u6d88\u606f\u91cd\u65b0\u56de\u5230queue\uff0cbroker\u4f1a\u91cd\u65b0\u53d1\u9001\u8be5\u6d88\u606f\u7ed9\u6d88\u8d39\u7aef\n             */\n            channel.basicNack(deliveryTag,true,true);\n            // \u4e86\u89e3\n            //channel.basicReject(deliveryTag,true);\n        }\n    }\n}\n```\n')),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},"\u7f16\u5199\u6d4b\u8bd5\u7c7b\uff0c\u542f\u52a8\u5bb9\u5668\u76d1\u542cMQ\u961f\u5217 com.ydlclass.rabbimq")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```java\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations = "classpath:spring-rabbitmq-consumer.xml")\npublic class ConsumerTest {\n\n    @Test\n    public void test(){\n        while (true){\n\n        }\n    }\n}\n```\n')),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714135710130-04d1062b.png",alt:"image-20220714135710130"}),"image-20220714135710130"),(0,r.kt)("h4",{id:"2\u5c0f\u7ed3"},"\uff082\uff09\u5c0f\u7ed3"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5728rabbit:listener-container\u6807\u7b7e\u4e2d\u8bbe\u7f6eacknowledge\u5c5e\u6027\uff0c\u8bbe\u7f6eack\u65b9\u5f0f none\uff1a\u81ea\u52a8\u786e\u8ba4\uff0cmanual\uff1a\u624b\u52a8\u786e\u8ba4"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u5728\u6d88\u8d39\u7aef\u6ca1\u6709\u51fa\u73b0\u5f02\u5e38\uff0c\u5219\u8c03\u7528channel.basicAck(deliveryTag,false);\u65b9\u6cd5\u786e\u8ba4\u7b7e\u6536\u6d88\u606f"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u51fa\u73b0\u5f02\u5e38\uff0c\u5219\u5728catch\u4e2d\u8c03\u7528 basicNack\u6216 basicReject\uff0c\u62d2\u7edd\u6d88\u606f\uff0c\u8ba9MQ\u91cd\u65b0\u53d1\u9001\u6d88\u606f\u3002")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5982\u4f55\u4fdd\u8bc1\u6d88\u606f\u7684\u9ad8\u53ef\u9760\u6027\u4f20\u8f93\uff1f"),(0,r.kt)("p",{parentName:"blockquote"},"1.\u6301\u4e45\u5316"),(0,r.kt)("p",{parentName:"blockquote"},"\u2022 exchange\u8981\u6301\u4e45\u5316"),(0,r.kt)("p",{parentName:"blockquote"},"\u2022 queue\u8981\u6301\u4e45\u5316"),(0,r.kt)("p",{parentName:"blockquote"},"\u2022 message\u8981\u6301\u4e45\u5316"),(0,r.kt)("p",{parentName:"blockquote"},"2.\u751f\u4ea7\u65b9\u786e\u8ba4Confirm"),(0,r.kt)("p",{parentName:"blockquote"},"3.\u6d88\u8d39\u65b9\u786e\u8ba4Ack"),(0,r.kt)("p",{parentName:"blockquote"},"4.Broker\u9ad8\u53ef\u7528")),(0,r.kt)("h3",{id:"3\u6d88\u8d39\u7aef\u9650\u6d41"},"3\u3001\u6d88\u8d39\u7aef\u9650\u6d41"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569164559749-062868bd.png",alt:"1569164559749"}),"1569164559749"),(0,r.kt)("p",null,"\u5982\u4e0a\u56fe\u6240\u793a\uff1a\u5982\u679c\u5728A\u7cfb\u7edf\u4e2d\u9700\u8981\u7ef4\u62a4\u76f8\u5173\u7684\u4e1a\u52a1\u529f\u80fd\uff0c\u53ef\u80fd\u9700\u8981\u5c06A\u7cfb\u7edf\u7684\u670d\u52a1\u505c\u6b62\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u6d88\u606f\u7684\u751f\u4ea7\u8005\u8fd8\u662f\u4e00\u76f4\u4f1a\u5411MQ\u4e2d\u53d1\u9001\u5f85\u5904\u7406\u7684\u6d88\u606f\uff0c\u6d88\u8d39\u8005\u6b64\u65f6\u670d\u52a1\u5df2\u7ecf\u5173\u95ed\uff0c\u5bfc\u81f4\u5927\u91cf\u7684\u6d88\u606f\u90fd\u4f1a\u5728MQ\u4e2d\u7d2f\u79ef\u3002\u5982\u679c\u5f53A\u7cfb\u7edf\u6210\u529f\u542f\u52a8\u540e\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6d88\u606f\u7684\u6d88\u8d39\u8005\u4f1a\u4e00\u6b21\u6027\u5c06MQ\u4e2d\u7d2f\u79ef\u7684\u5927\u91cf\u7684\u6d88\u606f\u5168\u90e8\u62c9\u53d6\u5230\u81ea\u5df1\u7684\u670d\u52a1\uff0c\u5bfc\u81f4\u670d\u52a1\u5728\u77ed\u65f6\u95f4\u5185\u4f1a\u5904\u7406\u5927\u91cf\u7684\u4e1a\u52a1\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7cfb\u7edf\u670d\u52a1\u7684\u5d29\u6e83\u3002 \u6240\u4ee5\u6d88\u8d39\u7aef\u9650\u6d41\u662f\u975e\u5e38\u6709\u5fc5\u8981\u7684\u3002"),(0,r.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7MQ\u4e2d\u7684 listener-container \u914d\u7f6e\u5c5e\u6027 perfetch = 1,\u8868\u793a\u6d88\u8d39\u7aef\u6bcf\u6b21\u4ecemq\u62c9\u53bb\u4e00\u6761\u6d88\u606f\u6765\u6d88\u8d39\uff0c\u76f4\u5230\u624b\u52a8\u786e\u8ba4\u6d88\u8d39\u5b8c\u6bd5\u540e\uff0c\u624d\u4f1a\u7ee7\u7eed\u62c9\u53bb\u4e0b\u4e00\u6761\u6d88\u606f\u3002"),(0,r.kt)("h4",{id:"1\u4ee3\u7801\u5b9e\u73b0-1"},"\uff081\uff09\u4ee3\u7801\u5b9e\u73b0"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u7f16\u5199 QosListener \u76d1\u542c\u7c7b\uff0c\u4fdd\u8bc1\u5f53\u524d\u7684\u76d1\u542c\u7c7b\u6d88\u606f\u5904\u7406\u673a\u5236\u662f ACK \u4e3a\u624b\u52a8\u65b9\u5f0f")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"```java\n@Component\npublic class QosListener implements ChannelAwareMessageListener {\n\n    @Override\n    public void onMessage(Message message, Channel channel) throws Exception {\n\n        Thread.sleep(1000);\n        //1.\u83b7\u53d6\u6d88\u606f\n        System.out.println(new String(message.getBody()));\n        //2. \u5904\u7406\u4e1a\u52a1\u903b\u8f91\n        //3. \u7b7e\u6536\n        channel.basicAck(message.getMessageProperties().getDeliveryTag(),true);\n    }\n}\n```\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"\u5728\u914d\u7f6e\u6587\u4ef6\u7684 listener-container \u914d\u7f6e\u5c5e\u6027\u4e2d\u6dfb\u52a0\u914d\u7f6e")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```xml\n<rabbit:listener-container connection-factory="connectionFactory" acknowledge="manual" prefetch="1" >\n    \n<rabbit:listener ref="qosListener" queue-names="test_queue_confirm"/>\n```\n\n> \u914d\u7f6e\u8bf4\u660e\uff1a\n>\n> perfetch = 1,\u8868\u793a\u6d88\u8d39\u7aef\u6bcf\u6b21\u4ecemq\u62c9\u53bb\u4e00\u6761\u6d88\u606f\u6765\u6d88\u8d39\uff0c\u76f4\u5230\u624b\u52a8\u786e\u8ba4\u6d88\u8d39\u5b8c\u6bd5\u540e\uff0c\u624d\u4f1a\u7ee7\u7eed\u62c9\u53bb\u4e0b\u4e00\u6761\u6d88\u606f\u3002\n')),(0,r.kt)("p",null,"3.\u751f\u4ea7\u8005\uff0c\u8fde\u53d110\u6761\u6d88\u606f."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'    @Test\n    public void testSend() {\n        for (int i = 0; i < 10; i++) {\n            //\u53d1\u9001\u6d88\u606f\n            rabbitTemplate.convertAndSend("test_exchange_confirm", "confirm", "message confirm....");\n        }\n    }\n')),(0,r.kt)("h4",{id:"2\u5c0f\u7ed3-1"},"\uff082\uff09\u5c0f\u7ed3"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5728",(0,r.kt)("a",{parentName:"li",href:"rabbit:listener-container"},"rabbit:listener-container")," \u4e2d\u914d\u7f6e prefetch\u5c5e\u6027\u8bbe\u7f6e\u6d88\u8d39\u7aef\u4e00\u6b21\u62c9\u53d6\u591a\u5c11\u6d88\u606f"),(0,r.kt)("li",{parentName:"ul"},'\u6d88\u8d39\u7aef\u7684\u786e\u8ba4\u6a21\u5f0f\u4e00\u5b9a\u4e3a\u624b\u52a8\u786e\u8ba4\u3002acknowledge="manual"')),(0,r.kt)("h3",{id:"4ttl"},"4\u3001TTL"),(0,r.kt)("p",null,"\u8bbe\u7f6e\u961f\u5217\u53c2\u6570\u3001\u4ea4\u6362\u673a\u53c2\u6570\u3001\u53d1\u6d88\u606f\u90fd\u53ef\u4ee5\u7528\u9875\u9762\u3002"),(0,r.kt)("p",null,"\u4e5f\u80fd\u7528\u4ee3\u7801\u3002"),(0,r.kt)("p",null,"TTL \u5168\u79f0 Time To Live\uff08\u5b58\u6d3b\u65f6\u95f4/\u8fc7\u671f\u65f6\u95f4\uff09\u3002\u5f53\u6d88\u606f\u5230\u8fbe\u5b58\u6d3b\u65f6\u95f4\u540e\uff0c\u8fd8\u6ca1\u6709\u88ab\u6d88\u8d39\uff0c\u4f1a\u88ab\u81ea\u52a8\u6e05\u9664\u3002"),(0,r.kt)("p",null,"RabbitMQ\u53ef\u4ee5\u5bf9\u6d88\u606f\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u4e5f\u53ef\u4ee5\u5bf9\u6574\u4e2a\u961f\u5217\uff08Queue\uff09\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569166173852-583364b2.png",alt:"1569166173852"}),"1569166173852"),(0,r.kt)("p",null,"\u53ef\u4ee5\u5728RabbitMQ\u7ba1\u7406\u63a7\u5236\u53f0\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\uff0c\u6b64\u5904\u4e0d\u505a\u91cd\u70b9\u8bb2\u89e3\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u4e00\u8d77\u505a\u4e00\u4e0b"),"\uff1a"),(0,r.kt)("p",null,"\u521b\u5efa\u961f\u5217 test_queue_ttl \u8bbe\u7f6ettl\u4e3a10\u79d2"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200321000505022-3d21d748.png",alt:"image-20200321000505022"}),"image-20200321000505022"),(0,r.kt)("p",null,"\u521b\u5efa\u4ea4\u6362\u673atest_exchange_ttl \u7ed1\u5b9a \u961f\u5217"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20200321000710192-0dad458c.png",alt:"image-20200321000710192"}),"image-20200321000710192"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714141856963-34e53d20.png",alt:"image-20220714141856963"}),"image-20220714141856963"),(0,r.kt)("p",null,"\u5411\u4ea4\u6362\u673a\u53d1\u4e00\u4e2a\u6d88\u606f"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714142043712-98552c4c.png",alt:"image-20220714142043712"}),"image-20220714142043712"),(0,r.kt)("p",null,"\u67e5\u770b\u961f\u5217\u6d88\u606f\uff0c\u8fc710\u79d2\u5220\u9664"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714142021614-3081f2f6.png",alt:"image-20220714142021614"}),"image-20220714142021614"),(0,r.kt)("h4",{id:"1\u4ee3\u7801\u5b9e\u73b0-2"},"\uff081\uff09\u4ee3\u7801\u5b9e\u73b0"),(0,r.kt)("h5",{id:"a\u8bbe\u7f6e\u961f\u5217\u7684\u8fc7\u671f\u65f6\u95f4"},"a\u3001\u8bbe\u7f6e\u961f\u5217\u7684\u8fc7\u671f\u65f6\u95f4"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5728\u6d88\u606f\u7684\u751f\u4ea7\u65b9\u4e2d\uff0c\u5728 spring-rabbitmq-producer.xml \u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```xml\n\x3c!--ttl--\x3e\n<rabbit:queue name="test_queue_ttl" id="test_queue_ttl">\n    \x3c!--\u8bbe\u7f6equeue\u7684\u53c2\u6570--\x3e\n    <rabbit:queue-arguments>\n        \x3c!--x-message-ttl\u6307\u961f\u5217\u7684\u8fc7\u671f\u65f6\u95f4--\x3e\n        <entry key="x-message-ttl" value="10000" value-type="java.lang.Integer"/>\n    </rabbit:queue-arguments>\n</rabbit:queue>\n\n<rabbit:topic-exchange name="test_exchange_ttl" >\n    <rabbit:bindings>\n        <rabbit:binding pattern="ydl.#" queue="test_queue_ttl"></rabbit:binding>\n    </rabbit:bindings>\n</rabbit:topic-exchange>\n```\n')),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"\u7f16\u5199\u53d1\u9001\u6d88\u606f\u6d4b\u8bd5\u65b9\u6cd5")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```java\n    @Test\n    public void ttlTest(){\n        for (int i = 0; i < 10; i++) {\n            rabbitTemplate.convertAndSend("test_exchange_ttl","ydl.itlils","hello ttl"+i);\n        }\n    }\n```\n\n\u6d4b\u8bd5\u7ed3\u679c\uff1a\u5f53\u6d88\u606f\u53d1\u9001\u6210\u529f\u540e\uff0c\u8fc710s\u540e\u5728RabbitMQ\u7684\u7ba1\u7406\u63a7\u5236\u53f0\u4f1a\u770b\u5230\u6d88\u606f\u4f1a\u81ea\u52a8\u5220\u9664\u3002\n')),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714142521691-9ddf683b.png",alt:"image-20220714142521691"}),"image-20220714142521691"),(0,r.kt)("h5",{id:"b\u8bbe\u7f6e\u5355\u4e2a\u6d88\u606f\u7684\u8fc7\u671f\u65f6\u95f4"},"b\u3001\u8bbe\u7f6e\u5355\u4e2a\u6d88\u606f\u7684\u8fc7\u671f\u65f6\u95f4"),(0,r.kt)("p",null,"\u7f16\u5199\u4ee3\u7801\u6d4b\u8bd5\uff0c\u5e76\u4e14\u8bbe\u7f6e\u961f\u5217\u7684\u8fc7\u671f\u65f6\u95f4\u4e3a10s\uff0c \u5355\u4e2a\u6d88\u606f\u7684\u8fc7\u671f\u65f6\u95f4\u4e3a5s"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'    @Test\n    public void testTtl2() {\n\n        // \u6d88\u606f\u540e\u5904\u7406\u5bf9\u8c61\uff0c\u8bbe\u7f6e\u4e00\u4e9b\u6d88\u606f\u7684\u53c2\u6570\u4fe1\u606f\n        MessagePostProcessor messagePostProcessor = new MessagePostProcessor() {\n            @Override\n            public Message postProcessMessage(Message message) throws AmqpException {\n                //1.\u8bbe\u7f6emessage\u7684\u4fe1\u606f\n                message.getMessageProperties().setExpiration("5000");//\u6d88\u606f\u7684\u8fc7\u671f\u65f6\u95f4\n                //2.\u8fd4\u56de\u8be5\u6d88\u606f\n                return message;\n            }\n        };\n\n        //\u6d88\u606f\u5355\u72ec\u8fc7\u671f\n        rabbitTemplate.convertAndSend("test_exchange_ttl",\n                "ttl.hehe", "message ttl....",messagePostProcessor);\n\n        for (int i = 0; i < 10; i++) {\n            if(i == 5){\n                //\u6d88\u606f\u5355\u72ec\u8fc7\u671f\n                rabbitTemplate.convertAndSend("test_exchange_ttl", "ttl.hehe", "message ttl....",messagePostProcessor);\n            }else{\n                //\u4e0d\u8fc7\u671f\u7684\u6d88\u606f\n                rabbitTemplate.convertAndSend("test_exchange_ttl", "ttl.hehe", "message ttl....");\n\n            }\n        }\n    }\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5982\u679c\u8bbe\u7f6e\u4e86\u6d88\u606f\u7684\u8fc7\u671f\u65f6\u95f4\uff0c\u4e5f\u8bbe\u7f6e\u4e86\u961f\u5217\u7684\u8fc7\u671f\u65f6\u95f4\uff0c\u5b83\u4ee5\u65f6\u95f4\u77ed\u7684\u4e3a\u51c6\u3002"),(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"\u961f\u5217\u8fc7\u671f\u540e\uff0c\u4f1a\u5c06\u961f\u5217\u6240\u6709\u6d88\u606f\u5168\u90e8\u79fb\u9664\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u6d88\u606f\u8fc7\u671f\u540e\uff0c\u53ea\u6709\u6d88\u606f\u5728\u961f\u5217\u9876\u7aef\uff0c\u624d\u4f1a\u5224\u65ad\u5176\u662f\u5426\u8fc7\u671f(\u79fb\u9664\u6389)"))),(0,r.kt)("p",null,"5s"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714143016960-7b954414.png",alt:"image-20220714143016960"}),"image-20220714143016960"),(0,r.kt)("p",null,"20s"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714143257013-53b83dc2.png",alt:"image-20220714143257013"}),"image-20220714143257013"),(0,r.kt)("p",null,"5 10 5 10"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714143611629-d8ef4d4d.png",alt:"image-20220714143611629"}),"image-20220714143611629"),(0,r.kt)("h4",{id:"2\u5c0f\u7ed3-2"},"\uff082\uff09\u5c0f\u7ed3"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u8bbe\u7f6e\u961f\u5217\u8fc7\u671f\u65f6\u95f4\u4f7f\u7528\u53c2\u6570\uff1ax-message-ttl\uff0c\u5355\u4f4d\uff1ams(\u6beb\u79d2)\uff0c\u4f1a\u5bf9\u6574\u4e2a\u961f\u5217\u6d88\u606f\u7edf\u4e00\u8fc7\u671f\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u8bbe\u7f6e\u6d88\u606f\u8fc7\u671f\u65f6\u95f4\u4f7f\u7528\u53c2\u6570\uff1aexpiration\u3002\u5355\u4f4d\uff1ams(\u6beb\u79d2)\uff0c\u5f53\u8be5\u6d88\u606f\u5728\u961f\u5217\u5934\u90e8\u65f6\uff08\u6d88\u8d39\u65f6\uff09\uff0c\u4f1a\u5355\u72ec\u5224\u65ad\u8fd9\u4e00\u6d88\u606f\u662f\u5426\u8fc7\u671f\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5982\u679c\u4e24\u8005\u90fd\u8fdb\u884c\u4e86\u8bbe\u7f6e\uff0c\u4ee5\u65f6\u95f4\u77ed\u7684\u4e3a\u51c6\u3002")),(0,r.kt)("h3",{id:"5\u6b7b\u4fe1\u961f\u5217"},"5\u3001\u6b7b\u4fe1\u961f\u5217"),(0,r.kt)("p",null,"\u6b7b\u4fe1\u961f\u5217\uff0c\u82f1\u6587\u7f29\u5199\uff1aDLX \u3002Dead Letter Exchange\uff08\u6b7b\u4fe1\u4ea4\u6362\u673a\uff09\uff0c\u5f53\u6d88\u606f\u6210\u4e3aDead message\u540e\uff0c\u53ef\u4ee5\u88ab\u91cd\u65b0\u53d1\u9001\u5230\u53e6\u4e00\u4e2a\u4ea4\u6362\u673a\uff0c\u8fd9\u4e2a\u4ea4\u6362\u673a\u5c31\u662fDLX\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569167524589-e80fd907.png",alt:"1569167524589"}),"1569167524589"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6d88\u606f\u6210\u4e3a\u6b7b\u4fe1\u7684\u4e09\u79cd\u60c5\u51b5\uff1a")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u961f\u5217\u6d88\u606f\u957f\u5ea6\u5230\u8fbe\u9650\u5236\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u6d88\u8d39\u8005\u62d2\u63a5\u6d88\u8d39\u6d88\u606f\uff0cbasicNack/basicReject,\u5e76\u4e14\u4e0d\u628a\u6d88\u606f\u91cd\u65b0\u653e\u5165\u539f\u76ee\u6807\u961f\u5217,requeue=false\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u539f\u961f\u5217\u5b58\u5728\u6d88\u606f\u8fc7\u671f\u8bbe\u7f6e\uff0c\u6d88\u606f\u5230\u8fbe\u8d85\u65f6\u65f6\u95f4\u672a\u88ab\u6d88\u8d39\uff1b")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u961f\u5217\u7ed1\u5b9a\u6b7b\u4fe1\u4ea4\u6362\u673a\uff1a")),(0,r.kt)("p",null,"\u7ed9\u961f\u5217\u8bbe\u7f6e\u53c2\u6570\uff1a x-dead-letter-exchange \u548c x-dead-letter-routing-key"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569167616750-2d418fa9.png",alt:"1569167616750"}),"1569167616750"),(0,r.kt)("h4",{id:"1\u4ee3\u7801\u5b9e\u73b0-3"},"\uff081\uff09\u4ee3\u7801\u5b9e\u73b0"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728\u6d88\u606f\u7684\u751f\u4ea7\u65b9\u4e2d\uff0c\u5728 spring-rabbitmq-producer.xml \u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u58f0\u660e\u6b63\u5e38\u7684\u961f\u5217(test_queue_dlx)\u548c\u4ea4\u6362\u673a(test_exchange_dlx)")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'    ```xml\n    <rabbit:queue name="test_queue_dlx" id="test_queue_dlx">\n    </rabbit:queue>\n    <rabbit:topic-exchange name="test_exchange_dlx">\n        <rabbit:bindings>\n            <rabbit:binding pattern="test.dlx.#" queue="test_queue_dlx"></rabbit:binding>\n        </rabbit:bindings>\n    </rabbit:topic-exchange>\n    ```\n\n- \u58f0\u660e\u6b7b\u4fe1\u961f\u5217(queue_dlx)\u548c\u6b7b\u4fe1\u4ea4\u6362\u673a(exchange_dlx)\n\n    \n\n    ```xml\n    <rabbit:queue name="queue_dlx" id="queue_dlx"></rabbit:queue>\n    <rabbit:topic-exchange name="exchange_dlx">\n        <rabbit:bindings>\n            <rabbit:binding pattern="dlx.#" queue="queue_dlx"></rabbit:binding>\n        </rabbit:bindings>\n    </rabbit:topic-exchange>\n    ```\n\n- \u6b63\u5e38\u961f\u5217\u7ed1\u5b9a\u6b7b\u4fe1\u4ea4\u6362\u673a\uff0c\u5e76\u8bbe\u7f6e\u76f8\u5173\u53c2\u6570\u4fe1\u606f\n\n    \n\n    ```xml\n    <rabbit:queue name="test_queue_dlx" id="test_queue_dlx">\n        \x3c!--3. \u6b63\u5e38\u961f\u5217\u7ed1\u5b9a\u6b7b\u4fe1\u4ea4\u6362\u673a--\x3e\n        <rabbit:queue-arguments>\n            \x3c!--3.1 x-dead-letter-exchange\uff1a\u6b7b\u4fe1\u4ea4\u6362\u673a\u540d\u79f0--\x3e\n            <entry key="x-dead-letter-exchange" value="exchange_dlx" />\n    \n            \x3c!--3.2 x-dead-letter-routing-key\uff1a\u53d1\u9001\u7ed9\u6b7b\u4fe1\u4ea4\u6362\u673a\u7684routingkey--\x3e\n            <entry key="x-dead-letter-routing-key" value="dlx.hehe" />\n    \n            \x3c!--4.1 \u8bbe\u7f6e\u961f\u5217\u7684\u8fc7\u671f\u65f6\u95f4 ttl--\x3e\n            <entry key="x-message-ttl" value="10000" value-type="java.lang.Integer" />\n            \x3c!--4.2 \u8bbe\u7f6e\u961f\u5217\u7684\u957f\u5ea6\u9650\u5236 max-length --\x3e\n            <entry key="x-max-length" value="10" value-type="java.lang.Integer" />\n        </rabbit:queue-arguments>\n    </rabbit:queue>\n    <rabbit:topic-exchange name="test_exchange_dlx">\n        <rabbit:bindings>\n            <rabbit:binding pattern="test.dlx.#" queue="test_queue_dlx"></rabbit:binding>\n        </rabbit:bindings>\n    </rabbit:topic-exchange>\n    ```\n')),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"\u7f16\u5199\u6d4b\u8bd5\u65b9\u6cd5")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```java\n    /**\n     * \u53d1\u9001\u6d4b\u8bd5\u6b7b\u4fe1\u6d88\u606f\uff1a\n     *  1. \u8fc7\u671f\u65f6\u95f4\n     *  2. \u957f\u5ea6\u9650\u5236\n     *  3. \u6d88\u606f\u62d2\u6536\n     */\n    @Test\n    public void testDlx(){\n        //1. \u6d4b\u8bd5\u8fc7\u671f\u65f6\u95f4\uff0c\u6b7b\u4fe1\u6d88\u606f\n        rabbitTemplate.convertAndSend("test_exchange_dlx",\n                                      "test.dlx.haha","\u6211\u662f\u4e00\u6761\u6d88\u606f\uff0c\u6211\u4f1a\u6b7b\u5417\uff1f");\n\n        //2. \u6d4b\u8bd5\u957f\u5ea6\u9650\u5236\u540e\uff0c\u6d88\u606f\u6b7b\u4fe1\n       for (int i = 0; i < 20; i++) {\n            rabbitTemplate.convertAndSend("test_exchange_dlx",\n                                          "test.dlx.haha","\u6211\u662f\u4e00\u6761\u6d88\u606f\uff0c\u6211\u4f1a\u6b7b\u5417\uff1f");\n        }\n\n        //3. \u6d4b\u8bd5\u6d88\u606f\u62d2\u6536\n        rabbitTemplate.convertAndSend("test_exchange_dlx",\n                                      "test.dlx.haha","\u6211\u662f\u4e00\u6761\u6d88\u606f\uff0c\u6211\u4f1a\u6b7b\u5417\uff1f");\n\n    }\n```\n')),(0,r.kt)("p",null,"3\u6d88\u606f\u62d2\u7edd\u63a5\u53d7\u6d88\u8d39\u8005\u589e\u52a0\u76d1\u542c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.listener;\n\n/**\n * creste by ydlclass.itcast\n */\n\nimport com.rabbitmq.client.Channel;\nimport org.springframework.amqp.core.Message;\nimport org.springframework.amqp.rabbit.listener.api.ChannelAwareMessageListener;\nimport org.springframework.stereotype.Component;\n\n/**\n * Consumer ACK\u673a\u5236\uff1a\n *  1. \u8bbe\u7f6e\u624b\u52a8\u7b7e\u6536\u3002acknowledge="manual"\n *  2. \u8ba9\u76d1\u542c\u5668\u7c7b\u5b9e\u73b0ChannelAwareMessageListener\u63a5\u53e3\n *  3. \u5982\u679c\u6d88\u606f\u6210\u529f\u5904\u7406\uff0c\u5219\u8c03\u7528channel\u7684 basicAck()\u7b7e\u6536\n *  4. \u5982\u679c\u6d88\u606f\u5904\u7406\u5931\u8d25\uff0c\u5219\u8c03\u7528channel\u7684basicNack()\u62d2\u7edd\u7b7e\u6536\uff0cbroker\u91cd\u65b0\u53d1\u9001\u7ed9consumer\n */\n@Component\npublic class DlxListener implements ChannelAwareMessageListener {\n\n    @Override\n    public void onMessage(Message message, Channel channel) throws Exception {\n        long deliveryTag = message.getMessageProperties().getDeliveryTag();\n\n        try {\n            //1.\u63a5\u6536\u8f6c\u6362\u6d88\u606f\n            System.out.println(new String(message.getBody()));\n\n            //2. \u5904\u7406\u4e1a\u52a1\u903b\u8f91\n            System.out.println("\u5904\u7406\u4e1a\u52a1\u903b\u8f91...");\n            int i = 3/0;//\u51fa\u73b0\u9519\u8bef\n            //3. \u624b\u52a8\u7b7e\u6536\n            channel.basicAck(deliveryTag,true);\n        } catch (Exception e) {\n            //e.printStackTrace();\n            System.out.println("\u62d2\u7edd\u63a5\u53d7");\n            //4.\u62d2\u7edd\u7b7e\u6536\n            /*\n            \u7b2c\u4e09\u4e2a\u53c2\u6570\uff1arequeue\uff1a\u91cd\u56de\u961f\u5217\u3002\u5982\u679c\u8bbe\u7f6e\u4e3atrue\uff0c\u5219\u6d88\u606f\u91cd\u65b0\u56de\u5230queue\uff0cbroker\u4f1a\u91cd\u65b0\u53d1\u9001\u8be5\u6d88\u606f\u7ed9\u6d88\u8d39\u7aef\n             */\n            channel.basicNack(deliveryTag,true,false);\n            // \u4e86\u89e3\n            //channel.basicReject(deliveryTag,true);\n        }\n    }\n}\n')),(0,r.kt)("p",null,"\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},' <rabbit:listener ref="dlxListener" queue-names="test_queue_dlx"/>\n')),(0,r.kt)("h4",{id:"2\u5c0f\u7ed3-3"},"\uff082\uff09\u5c0f\u7ed3"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u6b7b\u4fe1\u4ea4\u6362\u673a\u548c\u6b7b\u4fe1\u961f\u5217\u548c\u666e\u901a\u7684\u6ca1\u6709\u533a\u522b"),(0,r.kt)("li",{parentName:"ol"},"\u5f53\u6d88\u606f\u6210\u4e3a\u6b7b\u4fe1\u540e\uff0c\u5982\u679c\u8be5\u961f\u5217\u7ed1\u5b9a\u4e86\u6b7b\u4fe1\u4ea4\u6362\u673a\uff0c\u5219\u6d88\u606f\u4f1a\u88ab\u6b7b\u4fe1\u4ea4\u6362\u673a\u91cd\u65b0\u8def\u7531\u5230\u6b7b\u4fe1\u961f\u5217"),(0,r.kt)("li",{parentName:"ol"},"\u6d88\u606f\u6210\u4e3a\u6b7b\u4fe1\u7684\u4e09\u79cd\u60c5\u51b5\uff1a",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u961f\u5217\u6d88\u606f\u957f\u5ea6\u5230\u8fbe\u9650\u5236\uff1b"),(0,r.kt)("li",{parentName:"ul"},"\u6d88\u8d39\u8005\u62d2\u63a5\u6d88\u8d39\u6d88\u606f\uff0c\u5e76\u4e14\u4e0d\u91cd\u56de\u961f\u5217\uff1b"),(0,r.kt)("li",{parentName:"ul"},"\u539f\u961f\u5217\u5b58\u5728\u6d88\u606f\u8fc7\u671f\u8bbe\u7f6e\uff0c\u6d88\u606f\u5230\u8fbe\u8d85\u65f6\u65f6\u95f4\u672a\u88ab\u6d88\u8d39\uff1b")))),(0,r.kt)("h3",{id:"6\u5ef6\u8fdf\u961f\u5217-\u91cd\u70b9"},"6\u3001\u5ef6\u8fdf\u961f\u5217-\u91cd\u70b9"),(0,r.kt)("p",null,"\u5ef6\u8fdf\u961f\u5217\uff0c\u5373\u6d88\u606f\u8fdb\u5165\u961f\u5217\u540e\u4e0d\u4f1a\u7acb\u5373\u88ab\u6d88\u8d39\uff0c\u53ea\u6709\u5230\u8fbe\u6307\u5b9a\u65f6\u95f4\u540e\uff0c\u624d\u4f1a\u88ab\u6d88\u8d39\u3002"),(0,r.kt)("p",null,"\u63d0\u51fa\u9700\u6c42\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u4e0b\u5355\u540e\uff0c30\u5206\u949f\u672a\u652f\u4ed8\uff0c\u53d6\u6d88\u8ba2\u5355\uff0c\u56de\u6eda\u5e93\u5b58\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u65b0\u7528\u6237\u6ce8\u518c\u6210\u529f7\u5929\u540e\uff0c\u53d1\u9001\u77ed\u4fe1\u95ee\u5019\u3002")),(0,r.kt)("p",null,"\u5b9e\u73b0\u65b9\u5f0f\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5b9a\u65f6\u5668\uff08\u4e0d\u4f18\u96c5\uff01\uff09"),(0,r.kt)("li",{parentName:"ol"},"\u5ef6\u8fdf\u961f\u5217")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569168202661-0a8e43b4.png",alt:"1569168202661"}),"1569168202661"),(0,r.kt)("p",null,"\u6ce8\u610f\uff1a\u5728RabbitMQ\u4e2d\u5e76\u672a\u63d0\u4f9b\u5ef6\u8fdf\u961f\u5217\u529f\u80fd\u3002"),(0,r.kt)("p",null,"\u4f46\u662f\u53ef\u4ee5\u4f7f\u7528\uff1a",(0,r.kt)("strong",{parentName:"p"},"TTL+\u6b7b\u4fe1\u961f\u5217")," \u7ec4\u5408\u5b9e\u73b0\u5ef6\u8fdf\u961f\u5217\u7684\u6548\u679c\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569168255196-259b14b4.png",alt:"1569168255196"}),"1569168255196"),(0,r.kt)("h4",{id:"1\u4ee3\u7801\u5b9e\u73b0-4"},"\uff081\uff09\u4ee3\u7801\u5b9e\u73b0"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5728\u6d88\u606f\u7684\u751f\u4ea7\u65b9\u4e2d\uff0c\u5728 spring-rabbitmq-producer.xml \u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```xml\n\x3c!-- 1. \u5b9a\u4e49\u6b63\u5e38\u4ea4\u6362\u673a\uff08order_exchange\uff09\u548c\u961f\u5217(order_queue)--\x3e\n<rabbit:queue id="order_queue" name="order_queue">\n    \x3c!-- 3. \u7ed1\u5b9a\uff0c\u8bbe\u7f6e\u6b63\u5e38\u961f\u5217\u8fc7\u671f\u65f6\u95f4\u4e3a30\u5206\u949f--\x3e\n    <rabbit:queue-arguments>\n        <entry key="x-dead-letter-exchange" value="order_exchange_dlx" />\n        <entry key="x-dead-letter-routing-key" value="dlx.order.cancel" />\n        <entry key="x-message-ttl" value="10000" value-type="java.lang.Integer" />\n    </rabbit:queue-arguments>\n</rabbit:queue>\n<rabbit:topic-exchange name="order_exchange">\n    <rabbit:bindings>\n        <rabbit:binding pattern="order.#" queue="order_queue"></rabbit:binding>\n    </rabbit:bindings>\n</rabbit:topic-exchange>\n\n\x3c!--  2. \u5b9a\u4e49\u6b7b\u4fe1\u4ea4\u6362\u673a\uff08order_exchange_dlx\uff09\u548c\u961f\u5217(order_queue_dlx)--\x3e\n<rabbit:queue id="order_queue_dlx" name="order_queue_dlx"></rabbit:queue>\n<rabbit:topic-exchange name="order_exchange_dlx">\n    <rabbit:bindings>\n        <rabbit:binding pattern="dlx.order.#" queue="order_queue_dlx"></rabbit:binding>\n    </rabbit:bindings>\n</rabbit:topic-exchange>\n```\n')),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"\u7f16\u5199\u6d4b\u8bd5\u65b9\u6cd5")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'```java\n@Test\npublic  void testDelay() throws InterruptedException {\n    //1.\u53d1\u9001\u8ba2\u5355\u6d88\u606f\u3002 \u5c06\u6765\u662f\u5728\u8ba2\u5355\u7cfb\u7edf\u4e2d\uff0c\u4e0b\u5355\u6210\u529f\u540e\uff0c\u53d1\u9001\u6d88\u606f\n    rabbitTemplate.convertAndSend("order_exchange",\n                                  "order.msg","\u8ba2\u5355\u4fe1\u606f\uff1aid=1,time=2022\u5e74");\n\n    //2.\u6253\u5370\u5012\u8ba1\u65f610\u79d2\n    for (int i = 10; i > 0 ; i--) {\n        System.out.println(i+"...");\n        Thread.sleep(1000);\n    }\n}\n```\n')),(0,r.kt)("p",null,"3\u6d88\u8d39\u8005"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'package com.ydlclass.listener;\n\n/**\n * creste by ydlclass.itcast\n */\n\nimport com.rabbitmq.client.Channel;\nimport org.springframework.amqp.core.Message;\nimport org.springframework.amqp.rabbit.listener.api.ChannelAwareMessageListener;\nimport org.springframework.stereotype.Component;\n\n/**\n * Consumer ACK\u673a\u5236\uff1a\n *  1. \u8bbe\u7f6e\u624b\u52a8\u7b7e\u6536\u3002acknowledge="manual"\n *  2. \u8ba9\u76d1\u542c\u5668\u7c7b\u5b9e\u73b0ChannelAwareMessageListener\u63a5\u53e3\n *  3. \u5982\u679c\u6d88\u606f\u6210\u529f\u5904\u7406\uff0c\u5219\u8c03\u7528channel\u7684 basicAck()\u7b7e\u6536\n *  4. \u5982\u679c\u6d88\u606f\u5904\u7406\u5931\u8d25\uff0c\u5219\u8c03\u7528channel\u7684basicNack()\u62d2\u7edd\u7b7e\u6536\uff0cbroker\u91cd\u65b0\u53d1\u9001\u7ed9consumer\n */\n@Component\npublic class OrderListener implements ChannelAwareMessageListener {\n\n    @Override\n    public void onMessage(Message message, Channel channel) throws Exception {\n        long deliveryTag = message.getMessageProperties().getDeliveryTag();\n\n        try {\n            //1.\u63a5\u6536\u8f6c\u6362\u6d88\u606f\n            System.out.println(new String(message.getBody()));\n\n            //2. \u5904\u7406\u4e1a\u52a1\u903b\u8f91\n            System.out.println("\u5904\u7406\u4e1a\u52a1\u903b\u8f91...");\n            System.out.println("\u67e5\u8be2\u6570\u636e\u5e93\u3002\u3002\u3002");\n            System.out.println("\u67e5\u770b\u652f\u4ed8\u72b6\u6001\u3002\u3002\u3002");\n\n            //3. \u624b\u52a8\u7b7e\u6536\n            channel.basicAck(deliveryTag,true);\n        } catch (Exception e) {\n            //e.printStackTrace();\n            System.out.println("\u62d2\u7edd\u63a5\u53d7");\n            //4.\u62d2\u7edd\u7b7e\u6536\n            /*\n            \u7b2c\u4e09\u4e2a\u53c2\u6570\uff1arequeue\uff1a\u91cd\u56de\u961f\u5217\u3002\u5982\u679c\u8bbe\u7f6e\u4e3atrue\uff0c\u5219\u6d88\u606f\u91cd\u65b0\u56de\u5230queue\uff0cbroker\u4f1a\u91cd\u65b0\u53d1\u9001\u8be5\u6d88\u606f\u7ed9\u6d88\u8d39\u7aef\n             */\n            channel.basicNack(deliveryTag,true,false);\n            // \u4e86\u89e3\n            //channel.basicReject(deliveryTag,true);\n        }\n    }\n}\n')),(0,r.kt)("p",null,"\u914d\u7f6e\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'<rabbit:listener ref="orderListener" queue-names="order_queue_dlx"/>\n')),(0,r.kt)("h4",{id:"2-\u5c0f\u7ed3"},"\uff082\uff09 \u5c0f\u7ed3"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5ef6\u8fdf\u961f\u5217 \u6307\u6d88\u606f\u8fdb\u5165\u961f\u5217\u540e\uff0c\u53ef\u4ee5\u88ab\u5ef6\u8fdf\u4e00\u5b9a\u65f6\u95f4\uff0c\u518d\u8fdb\u884c\u6d88\u8d39\u3002"),(0,r.kt)("li",{parentName:"ol"},"RabbitMQ\u6ca1\u6709\u63d0\u4f9b\u5ef6\u8fdf\u961f\u5217\u529f\u80fd\uff0c\u4f46\u662f\u53ef\u4ee5\u4f7f\u7528 \uff1a ",(0,r.kt)("strong",{parentName:"li"},"TTL + DLX")," \u6765\u5b9e\u73b0\u5ef6\u8fdf\u961f\u5217\u6548\u679c\u3002")),(0,r.kt)("h3",{id:"7\u65e5\u5fd7\u4e0e\u76d1\u63a7-\u4e86\u89e3"},"7\u3001\u65e5\u5fd7\u4e0e\u76d1\u63a7-\u4e86\u89e3"),(0,r.kt)("h4",{id:"1rabbitmq\u65e5\u5fd7"},"\uff081\uff09RabbitMQ\u65e5\u5fd7"),(0,r.kt)("p",null,"RabbitMQ\u9ed8\u8ba4\u65e5\u5fd7\u5b58\u653e\u8def\u5f84\uff1a"),(0,r.kt)("p",null," Linux \u4e0b/var /log/rabbitmq/",(0,r.kt)("a",{parentName:"p",href:"mailto:rabbit@xxx.log"},"rabbit@xxx.log")),(0,r.kt)("p",null," windows\u4e0bC:\\Users\\Administrator\\AppData\\Roaming\\RabbitMQ\\log"),(0,r.kt)("p",null,"RabbitMQ \u65e5\u5fd7\u6240\u5728\u7684\u76ee\u5f55\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569168718549-49512116.png",alt:"1569168718549"}),"1569168718549"),(0,r.kt)("p",null,"RabbitMQ\u65e5\u5fd7\u8be6\u7ec6\u4fe1\u606f\uff1a"),(0,r.kt)("p",null,"\u65e5\u5fd7\u5305\u542b\u4e86RabbitMQ\u7684\u7248\u672c\u53f7\u3001Erlang\u7684\u7248\u672c\u53f7\u3001RabbitMQ\u670d\u52a1\u8282\u70b9\u540d\u79f0\u3001cookie\u7684hash\u503c\u3001RabbitMQ\u914d\u7f6e\u6587\u4ef6\u5730\u5740\u3001\u5185\u5b58\u9650\u5236\u3001\u78c1\u76d8\u9650\u5236\u3001\u9ed8\u8ba4\u8d26\u6237guest\u7684\u521b\u5efa\u4ee5\u53ca\u6743\u9650\u914d\u7f6e\u7b49\u7b49\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714151931414-b29a5e65.png",alt:"image-20220714151931414"}),"image-20220714151931414"),(0,r.kt)("h4",{id:"2web\u7ba1\u63a7\u53f0\u76d1\u63a7"},"\uff082\uff09web\u7ba1\u63a7\u53f0\u76d1\u63a7"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6ce8\u610fwindows\u4e0b"),"\uff1a\u8fdb\u5165sbin\u76ee\u5f55\uff0c\u547d\u4ee4\u540e\u52a0\u201c.bat\u201d\u3002\u5982rabbitmqctl.bat"),(0,r.kt)("p",null,"\u76f4\u63a5\u8bbf\u95ee\u5f53\u524d\u7684IP:15672\uff0c\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\uff08\u9ed8\u8ba4\u662f guest\uff09\uff0c\u5c31\u53ef\u4ee5\u67e5\u770bRabbitMQ\u7684\u7ba1\u7406\u63a7\u5236\u53f0\u3002\u5f53\u7136\u4e5f\u53ef\u901a\u8fc7\u547d\u4ee4\u7684\u5f62\u5f0f\u6765\u67e5\u770b\u3002\u5982\u4e0b\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u67e5\u770b\u961f\u5217\uff1arabbitmqctl list_queues"),(0,r.kt)("p",{parentName:"li"},"  \u5bf9\u5e94\u7ba1\u7406\u63a7\u5236\u53f0\u7684\u9875\u9762\u5982\u4e0b\uff1a"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/image-20220714152127778-fc84dbcc.png",alt:"image-20220714152127778"}),"image-20220714152127778")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u67e5\u770b\u7528\u6237\uff1a rabbitmqctl list_users")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u67e5\u770b\u8fde\u63a5\uff1arabbitmqctl list_connections"))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5176\u5b83\u76f8\u5173\u547d\u4ee4\uff08\u4e86\u89e3\uff09\uff1a"),(0,r.kt)("p",{parentName:"blockquote"},"\u67e5\u770bexchanges\uff1arabbitmqctl list_exchanges"),(0,r.kt)("p",{parentName:"blockquote"},"\u67e5\u770b\u6d88\u8d39\u8005\u4fe1\u606f\uff1arabbitmqctl list_consumers"),(0,r.kt)("p",{parentName:"blockquote"},"\u67e5\u770b\u73af\u5883\u53d8\u91cf\uff1arabbitmqctl environment"),(0,r.kt)("p",{parentName:"blockquote"},"\u67e5\u770b\u672a\u88ab\u786e\u8ba4\u7684\u961f\u5217\uff1arabbitmqctl list_queues name messages_unacknowledged"),(0,r.kt)("p",{parentName:"blockquote"},"\u67e5\u770b\u5355\u4e2a\u961f\u5217\u7684\u5185\u5b58\u4f7f\u7528\uff1arabbitmqctl list_queues name memory"),(0,r.kt)("p",{parentName:"blockquote"},"\u67e5\u770b\u51c6\u5907\u5c31\u7eea\u7684\u961f\u5217\uff1arabbitmqctl list_queues name messages_ready")),(0,r.kt)("h3",{id:"8\u6d88\u606f\u8ffd\u8e2a-\u4e86\u89e3"},"8\u3001\u6d88\u606f\u8ffd\u8e2a-\u4e86\u89e3"),(0,r.kt)("p",null,"\u5728\u4f7f\u7528\u4efb\u4f55\u6d88\u606f\u4e2d\u95f4\u4ef6\u7684\u8fc7\u7a0b\u4e2d\uff0c\u96be\u514d\u4f1a\u51fa\u73b0\u67d0\u6761\u6d88\u606f\u5f02\u5e38\u4e22\u5931\u7684\u60c5\u51b5\u3002\u5bf9\u4e8eRabbitMQ\u800c\u8a00\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u751f\u4ea7\u8005\u6216\u6d88\u8d39\u8005\u4e0eRabbitMQ\u65ad\u5f00\u4e86\u8fde\u63a5\uff0c\u800c\u5b83\u4eec\u4e0eRabbitMQ\u53c8\u91c7\u7528\u4e86\u4e0d\u540c\u7684\u786e\u8ba4\u673a\u5236\uff1b\u4e5f\u6709\u53ef\u80fd\u662f\u56e0\u4e3a\u4ea4\u6362\u5668\u4e0e\u961f\u5217\u4e4b\u95f4\u4e0d\u540c\u7684\u8f6c\u53d1\u7b56\u7565\uff1b\u751a\u81f3\u662f\u4ea4\u6362\u5668\u5e76\u6ca1\u6709\u4e0e\u4efb\u4f55\u961f\u5217\u8fdb\u884c\u7ed1\u5b9a\uff0c\u751f\u4ea7\u8005\u53c8\u4e0d\u611f\u77e5\u6216\u8005\u6ca1\u6709\u91c7\u53d6\u76f8\u5e94\u7684\u63aa\u65bd\uff1b\u53e6\u5916RabbitMQ\u672c\u8eab\u7684\u96c6\u7fa4\u7b56\u7565\u4e5f\u53ef\u80fd\u5bfc\u81f4\u6d88\u606f\u7684\u4e22\u5931\u3002\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u6709\u4e00\u4e2a\u8f83\u597d\u7684\u673a\u5236\u8ddf\u8e2a\u8bb0\u5f55\u6d88\u606f\u7684\u6295\u9012\u8fc7\u7a0b\uff0c\u4ee5\u6b64\u534f\u52a9\u5f00\u53d1\u548c\u8fd0\u7ef4\u4eba\u5458\u8fdb\u884c\u95ee\u9898\u7684\u5b9a\u4f4d\u3002"),(0,r.kt)("p",null,"\u5728RabbitMQ\u4e2d\u53ef\u4ee5\u4f7f\u7528Firehose\u548crabbitmq_tracing\u63d2\u4ef6\u529f\u80fd\u6765\u5b9e\u73b0\u6d88\u606f\u8ffd\u8e2a\u3002"),(0,r.kt)("h4",{id:"1\u6d88\u606f\u8ffd\u8e2a-firehose"},"\uff081\uff09\u6d88\u606f\u8ffd\u8e2a-Firehose"),(0,r.kt)("p",null,"firehose\u7684\u673a\u5236\u662f\u5c06\u751f\u4ea7\u8005\u6295\u9012\u7ed9rabbitmq\u7684\u6d88\u606f\uff0crabbitmq\u6295\u9012\u7ed9\u6d88\u8d39\u8005\u7684\u6d88\u606f\u6309\u7167\u6307\u5b9a\u7684\u683c\u5f0f\u53d1\u9001\u5230\u9ed8\u8ba4\u7684exchange\u4e0a\u3002\u8fd9\u4e2a\u9ed8\u8ba4\u7684exchange\u7684\u540d\u79f0\u4e3a ",(0,r.kt)("strong",{parentName:"p"},"amq.rabbitmq.trace"),"\uff0c\u5b83\u662f\u4e00\u4e2a",(0,r.kt)("strong",{parentName:"p"},"topic"),"\u7c7b\u578b\u7684",(0,r.kt)("strong",{parentName:"p"},"exchange"),"\u3002\u53d1\u9001\u5230\u8fd9\u4e2aexchange\u4e0a\u7684\u6d88\u606f\u7684routing key\u4e3a publish.exchangename \u548c deliver.queuename\u3002\u5176\u4e2dexchangename\u548cqueuename\u4e3a\u5b9e\u9645exchange\u548cqueue\u7684\u540d\u79f0\uff0c\u5206\u522b\u5bf9\u5e94\u751f\u4ea7\u8005\u6295\u9012\u5230exchange\u7684\u6d88\u606f\uff0c\u548c\u6d88\u8d39\u8005\u4ecequeue\u4e0a\u83b7\u53d6\u7684\u6d88\u606f\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569201204959-dde46343.png",alt:"1569201204959"}),"1569201204959"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a\u6253\u5f00 trace \u4f1a\u5f71\u54cd\u6d88\u606f\u5199\u5165\u529f\u80fd\uff0c\u9002\u5f53\u6253\u5f00\u540e\u8bf7\u5173\u95ed\u3002")),(0,r.kt)("p",null,"rabbitmqctl trace_on\uff1a\u5f00\u542fFirehose\u547d\u4ee4"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u6d88\u606f\u8ffd\u8e2a\u9a8c\u8bc1\uff1a")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2a\u961f\u5217 ",(0,r.kt)("strong",{parentName:"p"},"test_trace"),"\uff0c\u5e76\u5c06\u5f53\u524d\u7684\u961f\u5217\u7ed1\u5b9a\u5230 ",(0,r.kt)("strong",{parentName:"p"},"amq.rabbitmq.trace")," \u4ea4\u6362\u673a\u4e0a\uff0c\u8bbe\u7f6eRoutingKey\u4e3a\uff1a",(0,r.kt)("strong",{parentName:"p"},"#")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569201672175-736f2200.png",alt:"1569201672175"}),"1569201672175")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u672a\u5f00\u542f\u6d88\u606f\u8ffd\u8e2a\u4e4b\u524d\uff0c\u6211\u4eec\u53d1\u9001\u4e00\u4e2a\u6d88\u606f"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569201776723-7acd3ef5.png",alt:"1569201776723"}),"1569201776723"),(0,r.kt)("p",{parentName:"li"},"\u5f53\u524d\u6d88\u606f\u53d1\u9001\u6210\u529f\u540e\uff0c\u5728\u63a7\u5236\u53f0\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f53\u524d\u6d88\u606f\u7684\u5177\u4f53\u4fe1\u606f")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u8bbe\u7f6e",(0,r.kt)("strong",{parentName:"p"},"\u5f00\u542f\u6d88\u606f\u8ffd\u8e2a"),"\uff0c\u5728\u53d1\u9001\u4e00\u6761\u6d88\u606f"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569201317013-397a5f8c.png",alt:"1569201317013"}),"1569201317013"),(0,r.kt)("p",{parentName:"li"},"\u5b8c\u6574\u7684\u6d88\u606f\u5185\u5bb9\uff1a"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569202059745-3d93708c.png",alt:"1569202059745"}),"1569202059745"))),(0,r.kt)("p",null,"\u6211\u4eec\u53d1\u73b0\u5f53\u524d\u6d88\u606f\u4e5f\u6b63\u5e38\u5b58\u5728\uff0c\u5e76\u4e14\u5f00\u542f\u6d88\u606f\u8ffd\u8e2a\u540e\uff0c\u4f1a\u591a\u51fa\u4e00\u6761\u6d88\u606f\u662f ",(0,r.kt)("strong",{parentName:"p"},"amq.rabbitmq.trace")," \u4ea4\u6362\u673a\u53d1\u7ed9\u5f53\u524d\u961f\u5217\u7684\u6d88\u606f\uff0c\u6d88\u606f\u4e2d\u7684\u5185\u5bb9\u662f\u6bd4\u8f83\u5b8c\u6574\u7684\u3002"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5efa\u8bae\uff1a\u5728\u5f00\u53d1\u9636\u6bb5\u6211\u4eec\u53ef\u4ee5\u5f00\u542f\u6d88\u606f\u8ffd\u8e2a\uff0c\u5728\u5b9e\u9645\u751f\u4ea7\u73af\u5883\u5efa\u8bae\u5c06\u5176\u5173\u95ed"),(0,r.kt)("p",{parentName:"blockquote"},"rabbitmqctl trace_off\uff1a\u5173\u95edFirehose\u547d\u4ee4")),(0,r.kt)("h4",{id:"2-\u6d88\u606f\u8ffd\u8e2a-rabbitmq_tracing"},"\uff082\uff09 \u6d88\u606f\u8ffd\u8e2a-rabbitmq_tracing"),(0,r.kt)("p",null,"rabbitmq_tracing\u548cFirehose\u5728\u5b9e\u73b0\u4e0a\u5982\u51fa\u4e00\u8f99\uff0c\u53ea\u4e0d\u8fc7rabbitmq_tracing\u7684\u65b9\u5f0f\u6bd4Firehose\u591a\u4e86\u4e00\u5c42GUI\u7684\u5305\u88c5\uff0c\u66f4\u5bb9\u6613\u4f7f\u7528\u548c\u7ba1\u7406\u3002"),(0,r.kt)("p",null,"\u542f\u7528\u63d2\u4ef6\uff1arabbitmq-plugins enable rabbitmq_tracing"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569202861087-f0450a8a.png",alt:"1569202861087"}),"1569202861087"),(0,r.kt)("p",null,"\u53d1\u9001\u6d88\u606f\u6210\u529f\u540e\uff0c\u6211\u4eec\u70b9\u51fb\u65e5\u5fd7\u6587\u4ef6\uff0c\u8981\u6c42\u8f93\u5165RabbitMQ\u7684\u767b\u5f55\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569203000215-8bca3152.png",alt:"1569203000215"}),"1569203000215"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u5efa\u8bae\uff1a\u5728\u5f00\u53d1\u9636\u6bb5\u6211\u4eec\u53ef\u4ee5\u5f00\u542f\u6d88\u606f\u8ffd\u8e2a\u63d2\u4ef6\uff0c\u5728\u5b9e\u9645\u751f\u4ea7\u73af\u5883\u4e0d\u5efa\u8bae\u5efa\u8bae\u5f00\u542f\uff0c\u9664\u975e\u662f\u975e\u5e38\u7279\u6b8a\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u5927\u5bb6\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u9009\u62e9\u5f00\u542f\u5373\u53ef\u3002")),(0,r.kt)("h2",{id:"\u7b2c\u4e8c\u7ae0-rabbitmq\u5e94\u7528\u95ee\u9898-\u9762\u8bd5"},"\u7b2c\u4e8c\u7ae0 RabbitMQ\u5e94\u7528\u95ee\u9898-\u9762\u8bd5"),(0,r.kt)("h3",{id:"1\u6d88\u606f\u53ef\u9760\u6027\u4fdd\u969c"},"1\u3001\u6d88\u606f\u53ef\u9760\u6027\u4fdd\u969c"),(0,r.kt)("p",null,"\u63d0\u51fa\u9700\u6c42\uff1a\u5982\u4f55\u80fd\u591f\u4fdd\u8bc1\u6d88\u606f\u7684 100% \u53d1\u9001\u6210\u529f\uff1f"),(0,r.kt)("p",null,"\u9996\u5148\u5927\u5bb6\u8981\u660e\u786e\u4efb\u4f55\u4e00\u4e2a\u7cfb\u7edf\u90fd\u4e0d\u80fd\u4fdd\u8bc1\u6d88\u606f\u7684 100% \u6295\u9012\u6210\u529f\uff0c\u6211\u4eec\u662f\u53ef\u4ee5\u4fdd\u8bc1\u6d88\u606f\u4ee5\u6700\u9ad8\u6700\u53ef\u9760\u7684\u53d1\u9001\u7ed9\u76ee\u6807\u65b9\u3002"),(0,r.kt)("p",null,"\u5728RabbitMQ\u4e2d\u91c7\u7528 ",(0,r.kt)("strong",{parentName:"p"},"\u6d88\u606f\u8865\u5145\u673a\u5236")," \u6765\u4fdd\u8bc1\u6d88\u606f\u7684\u53ef\u9760\u6027"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569203830553-12ba52fc.png",alt:"1569203830553"}),"1569203830553"),(0,r.kt)("p",null,"\u6d88\u606f\u52fe\u5151"),(0,r.kt)("p",null,"\u6b65\u9aa4\u5206\u6790\uff1a"),(0,r.kt)("p",null,"\u53c2\u4e0e\u90e8\u5206\uff1a\u6d88\u606f\u751f\u4ea7\u8005\u3001\u6d88\u606f\u6d88\u8d39\u8005\u3001\u6570\u636e\u5e93\u3001\u4e09\u4e2a\u961f\u5217\uff08Q1\u3001Q2\u3001Q3\uff09\u3001\u4ea4\u6362\u673a\u3001\u56de\u8c03\u68c0\u67e5\u670d\u52a1\u3001\u5b9a\u65f6\u68c0\u67e5\u670d\u52a1"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u6d88\u606f\u7684\u751f\u4ea7\u8005\u5c06\u4e1a\u52a1\u6570\u636e\u5b58\u5230\u6570\u636e\u5e93\u4e2d"),(0,r.kt)("li",{parentName:"ol"},"\u53d1\u9001\u6d88\u606f\u7ed9 \u961f\u5217Q1"),(0,r.kt)("li",{parentName:"ol"},"\u6d88\u606f\u7684\u751f\u4ea7\u8005\u7b49\u5f85\u4e00\u5b9a\u7684\u65f6\u95f4\u540e\uff0c\u5728\u53d1\u9001\u4e00\u4e2a\u5ef6\u8fdf\u6d88\u606f\u7ed9\u961f\u5217 Q3"),(0,r.kt)("li",{parentName:"ol"},"\u6d88\u606f\u7684\u6d88\u8d39\u65b9\u76d1\u542c Q1 \u961f\u5217\u6d88\u606f\uff0c\u6210\u529f\u63a5\u6536\u540e"),(0,r.kt)("li",{parentName:"ol"},"\u6d88\u606f\u7684\u6d88\u8d39\u65b9\u4f1a \u53d1\u9001 \u4e00\u6761\u786e\u8ba4\u6d88\u606f\u7ed9 \u961f\u5217Q2"),(0,r.kt)("li",{parentName:"ol"},"\u56de\u8c03\u68c0\u67e5\u670d\u52a1\u76d1\u542c \u961f\u5217Q2 \u53d1\u9001\u7684\u786e\u8ba4\u6d88\u606f"),(0,r.kt)("li",{parentName:"ol"},"\u56de\u8c03\u68c0\u67e5\u670d\u52a1\u63a5\u6536\u5230\u786e\u8ba4\u6d88\u606f\u540e\uff0c\u5c06\u6d88\u606f\u5199\u5165\u5230 \u6d88\u606f\u7684\u6570\u636e\u5e93\u8868\u4e2d"),(0,r.kt)("li",{parentName:"ol"},"\u56de\u8c03\u68c0\u67e5\u670d\u52a1\u540c\u65f6\u4e5f\u4f1a\u76d1\u542c \u961f\u5217Q3\u5ef6\u8fdf\u6d88\u606f\uff0c \u5982\u679c\u63a5\u6536\u5230\u6d88\u606f\u4f1a\u548c\u6570\u636e\u5e93\u6bd4\u5bf9\u6d88\u606f\u7684\u552f\u4e00\u6807\u8bc6"),(0,r.kt)("li",{parentName:"ol"},"\u5982\u679c\u53d1\u73b0\u6ca1\u6709\u63a5\u6536\u5230\u786e\u8ba4\u6d88\u606f\uff0c\u90a3\u4e48\u56de\u8c03\u68c0\u67e5\u670d\u52a1\u5c31\u4f1a\u8fdc\u7a0b\u8c03\u7528 \u6d88\u606f\u751f\u4ea7\u8005\uff0c\u91cd\u65b0\u53d1\u9001\u6d88\u606f"),(0,r.kt)("li",{parentName:"ol"},"\u91cd\u65b0\u6267\u884c 2-7 \u6b65\u9aa4\uff0c\u4fdd\u8bc1\u6d88\u606f\u7684\u53ef\u9760\u6027\u4f20\u8f93"),(0,r.kt)("li",{parentName:"ol"},"\u5982\u679c\u53d1\u9001\u6d88\u606f\u548c\u5ef6\u8fdf\u6d88\u606f\u90fd\u51fa\u73b0\u5f02\u5e38\uff0c\u5b9a\u65f6\u68c0\u67e5\u670d\u52a1\u4f1a\u76d1\u63a7 \u6d88\u606f\u5e93\u4e2d\u7684\u6d88\u606f\u6570\u636e\uff0c\u5982\u679c\u53d1\u73b0\u4e0d\u4e00\u81f4\u7684\u6d88\u606f\u7136\u540e\u8fdc\u7a0b\u8c03\u7528\u6d88\u606f\u7684\u751f\u4ea7\u8005\u91cd\u65b0\u53d1\u9001\u6d88\u606f\u3002")),(0,r.kt)("h3",{id:"2-\u6d88\u606f\u5e42\u7b49\u6027\u5904\u7406"},"2\u3001 \u6d88\u606f\u5e42\u7b49\u6027\u5904\u7406"),(0,r.kt)("p",null,"\u5e42\u7b49\u6027\u6307\u4e00\u6b21\u548c\u591a\u6b21\u8bf7\u6c42\u67d0\u4e00\u4e2a\u8d44\u6e90\uff0c\u5bf9\u4e8e\u8d44\u6e90\u672c\u8eab\u5e94\u8be5\u5177\u6709\u540c\u6837\u7684\u7ed3\u679c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5176\u4efb\u610f\u591a\u6b21\u6267\u884c\u5bf9\u8d44\u6e90\u672c\u8eab\u6240\u4ea7\u751f\u7684\u5f71\u54cd\u5747\u4e0e\u4e00\u6b21\u6267\u884c\u7684\u5f71\u54cd\u76f8\u540c\u3002"),(0,r.kt)("p",null,"\u5728MQ\u4e2d\u6307\uff0c\u6d88\u8d39\u591a\u6761\u76f8\u540c\u7684\u6d88\u606f\uff0c\u5f97\u5230\u4e0e\u6d88\u8d39\u8be5\u6d88\u606f\u4e00\u6b21\u76f8\u540c\u7684\u7ed3\u679c\u3002"),(0,r.kt)("p",null,"\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 ",(0,r.kt)("strong",{parentName:"p"},"\u4e50\u89c2\u9501\u673a\u5236")," \u4fdd\u8bc1\u6d88\u606f\u7684\u5e42\u7b49\u64cd\u4f5c"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1569210134160-a4f5d228.png",alt:"1569210134160"}),"1569210134160"),(0,r.kt)("h3",{id:"3rabbitmq\u96c6\u7fa4\u642d\u5efa-\u8fd0\u7ef4"},"3\u3001RabbitMQ\u96c6\u7fa4\u642d\u5efa-\u8fd0\u7ef4"),(0,r.kt)("p",null,"\u6458\u8981\uff1a\u5b9e\u9645\u751f\u4ea7\u5e94\u7528\u4e2d\u90fd\u4f1a\u91c7\u7528\u6d88\u606f\u961f\u5217\u7684\u96c6\u7fa4\u65b9\u6848\uff0c\u5982\u679c\u9009\u62e9RabbitMQ\u90a3\u4e48\u6709\u5fc5\u8981\u4e86\u89e3\u4e0b\u5b83\u7684\u96c6\u7fa4\u65b9\u6848\u539f\u7406"),(0,r.kt)("p",null,"\u4e00\u822c\u6765\u8bf4\uff0c\u5982\u679c\u53ea\u662f\u4e3a\u4e86\u5b66\u4e60RabbitMQ\u6216\u8005\u9a8c\u8bc1\u4e1a\u52a1\u5de5\u7a0b\u7684\u6b63\u786e\u6027\u90a3\u4e48\u5728\u672c\u5730\u73af\u5883\u6216\u8005\u6d4b\u8bd5\u73af\u5883\u4e0a\u4f7f\u7528\u5176\u5355\u5b9e\u4f8b\u90e8\u7f72\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u662f\u51fa\u4e8eMQ\u4e2d\u95f4\u4ef6\u672c\u8eab\u7684\u53ef\u9760\u6027\u3001\u5e76\u53d1\u6027\u3001\u541e\u5410\u91cf\u548c\u6d88\u606f\u5806\u79ef\u80fd\u529b\u7b49\u95ee\u9898\u7684\u8003\u8651\uff0c\u5728\u751f\u4ea7\u73af\u5883\u4e0a\u4e00\u822c\u90fd\u4f1a\u8003\u8651\u4f7f\u7528RabbitMQ\u7684\u96c6\u7fa4\u65b9\u6848\u3002"),(0,r.kt)("h4",{id:"1-\u96c6\u7fa4\u65b9\u6848\u7684\u539f\u7406"},"\uff081\uff09 \u96c6\u7fa4\u65b9\u6848\u7684\u539f\u7406"),(0,r.kt)("p",null,"RabbitMQ\u8fd9\u6b3e\u6d88\u606f\u961f\u5217\u4e2d\u95f4\u4ef6\u4ea7\u54c1\u672c\u8eab\u662f\u57fa\u4e8eErlang\u7f16\u5199\uff0cErlang\u8bed\u8a00\u5929\u751f\u5177\u5907\u5206\u5e03\u5f0f\u7279\u6027\uff08\u901a\u8fc7\u540c\u6b65Erlang\u96c6\u7fa4\u5404\u8282\u70b9\u7684magic cookie\u6765\u5b9e\u73b0\uff09\u3002\u56e0\u6b64\uff0cRabbitMQ\u5929\u7136\u652f\u6301Clustering\u3002\u8fd9\u4f7f\u5f97RabbitMQ\u672c\u8eab\u4e0d\u9700\u8981\u50cfActiveMQ\u3001Kafka\u90a3\u6837\u901a\u8fc7ZooKeeper\u5206\u522b\u6765\u5b9e\u73b0HA\u65b9\u6848\u548c\u4fdd\u5b58\u96c6\u7fa4\u7684\u5143\u6570\u636e\u3002\u96c6\u7fa4\u662f\u4fdd\u8bc1\u53ef\u9760\u6027\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u540c\u65f6\u53ef\u4ee5\u901a\u8fc7\u6c34\u5e73\u6269\u5c55\u4ee5\u8fbe\u5230\u589e\u52a0\u6d88\u606f\u541e\u5410\u91cf\u80fd\u529b\u7684\u76ee\u7684\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1566073768274-526c9994.png",alt:"1565245219265"}),"1565245219265"),(0,r.kt)("h4",{id:"2\u5355\u673a\u591a\u5b9e\u4f8b\u90e8\u7f72"},"\uff082\uff09\u5355\u673a\u591a\u5b9e\u4f8b\u90e8\u7f72"),(0,r.kt)("p",null,"\u7531\u4e8e\u67d0\u4e9b\u56e0\u7d20\u7684\u9650\u5236\uff0c\u6709\u65f6\u5019\u4f60\u4e0d\u5f97\u4e0d\u5728\u4e00\u53f0\u673a\u5668\u4e0a\u53bb\u642d\u5efa\u4e00\u4e2arabbitmq\u96c6\u7fa4\uff0c\u8fd9\u4e2a\u6709\u70b9\u7c7b\u4f3czookeeper\u7684\u5355\u673a\u7248\u3002\u771f\u5b9e\u751f\u6210\u73af\u5883\u8fd8\u662f\u8981\u914d\u6210\u591a\u673a\u96c6\u7fa4\u7684\u3002\u6709\u5173\u600e\u4e48\u914d\u7f6e\u591a\u673a\u96c6\u7fa4\u7684\u53ef\u4ee5\u53c2\u8003\u5176\u4ed6\u7684\u8d44\u6599\uff0c\u8fd9\u91cc\u4e3b\u8981\u8bba\u8ff0\u5982\u4f55\u5728\u5355\u673a\u4e2d\u914d\u7f6e\u591a\u4e2arabbitmq\u5b9e\u4f8b\u3002"),(0,r.kt)("p",null,"\u4e3b\u8981\u53c2\u8003\u5b98\u65b9\u6587\u6863\uff1a",(0,r.kt)("a",{parentName:"p",href:"https://www.rabbitmq.com/clustering.html"},"https://www.rabbitmq.com/clustering.htmlopen in new window")),(0,r.kt)("p",null,"\u9996\u5148\u786e\u4fddRabbitMQ\u8fd0\u884c\u6ca1\u6709\u95ee\u9898"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'[root@super ~]# rabbitmqctl status\nStatus of node rabbit@super ...\n[{pid,10232},\n {running_applications,\n     [{rabbitmq_management,"RabbitMQ Management Console","3.6.5"},\n      {rabbitmq_web_dispatch,"RabbitMQ Web Dispatcher","3.6.5"},\n      {webmachine,"webmachine","1.10.3"},\n      {mochiweb,"MochiMedia Web Server","2.13.1"},\n      {rabbitmq_management_agent,"RabbitMQ Management Agent","3.6.5"},\n      {rabbit,"RabbitMQ","3.6.5"},\n      {os_mon,"CPO  CXC 138 46","2.4"},\n      {syntax_tools,"Syntax tools","1.7"},\n      {inets,"INETS  CXC 138 49","6.2"},\n      {amqp_client,"RabbitMQ AMQP Client","3.6.5"},\n      {rabbit_common,[],"3.6.5"},\n      {ssl,"Erlang/OTP SSL application","7.3"},\n      {public_key,"Public key infrastructure","1.1.1"},\n      {asn1,"The Erlang ASN1 compiler version 4.0.2","4.0.2"},\n      {ranch,"Socket acceptor pool for TCP protocols.","1.2.1"},\n      {mnesia,"MNESIA  CXC 138 12","4.13.3"},\n      {compiler,"ERTS  CXC 138 10","6.0.3"},\n      {crypto,"CRYPTO","3.6.3"},\n      {xmerl,"XML parser","1.3.10"},\n      {sasl,"SASL  CXC 138 11","2.7"},\n      {stdlib,"ERTS  CXC 138 10","2.8"},\n      {kernel,"ERTS  CXC 138 10","4.2"}]},\n {os,{unix,linux}},\n {erlang_version,\n     "Erlang/OTP 18 [erts-7.3] [source] [64-bit] [async-threads:64] [hipe] [kernel-poll:true]\\n"},\n {memory,\n     [{total,56066752},\n      {connection_readers,0},\n      {connection_writers,0},\n      {connection_channels,0},\n      {connection_other,2680},\n      {queue_procs,268248},\n      {queue_slave_procs,0},\n      {plugins,1131936},\n      {other_proc,18144280},\n      {mnesia,125304},\n      {mgmt_db,921312},\n      {msg_index,69440},\n      {other_ets,1413664},\n      {binary,755736},\n      {code,27824046},\n      {atom,1000601},\n      {other_system,4409505}]},\n {alarms,[]},\n {listeners,[{clustering,25672,"::"},{amqp,5672,"::"}]},\n {vm_memory_high_watermark,0.4},\n {vm_memory_limit,411294105},\n {disk_free_limit,50000000},\n {disk_free,13270233088},\n {file_descriptors,\n     [{total_limit,924},{total_used,6},{sockets_limit,829},{sockets_used,0}]},\n {processes,[{limit,1048576},{used,262}]},\n {run_queue,0},\n {uptime,43651},\n {kernel,{net_ticktime,60}}]\n')),(0,r.kt)("p",null,"\u505c\u6b62rabbitmq\u670d\u52a1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"[root@super sbin]# service rabbitmq-server stop\nStopping rabbitmq-server: rabbitmq-server.\n")),(0,r.kt)("p",null,"\u542f\u52a8\u7b2c\u4e00\u4e2a\u8282\u70b9\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"[root@super sbin]# RABBITMQ_NODE_PORT=5673 RABBITMQ_NODENAME=rabbit1 rabbitmq-server start\n\n              RabbitMQ 3.6.5. Copyright (C) 2007-2016 Pivotal Software, Inc.\n  ##  ##      Licensed under the MPL.  See http://www.rabbitmq.com/\n  ##  ##\n  ##########  Logs: /var/log/rabbitmq/rabbit1.log\n  ######  ##        /var/log/rabbitmq/rabbit1-sasl.log\n  ##########\n              Starting broker...\n completed with 6 plugins.\n")),(0,r.kt)("p",null,"\u542f\u52a8\u7b2c\u4e8c\u4e2a\u8282\u70b9\uff1a"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"web\u7ba1\u7406\u63d2\u4ef6\u7aef\u53e3\u5360\u7528,\u6240\u4ee5\u8fd8\u8981\u6307\u5b9a\u5176web\u63d2\u4ef6\u5360\u7528\u7684\u7aef\u53e3\u53f7\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'[root@super ~]# RABBITMQ_NODE_PORT=5674 RABBITMQ_SERVER_START_ARGS="-rabbitmq_management listener [{port,15674}]" RABBITMQ_NODENAME=rabbit2 rabbitmq-server start\n\n              RabbitMQ 3.6.5. Copyright (C) 2007-2016 Pivotal Software, Inc.\n  ##  ##      Licensed under the MPL.  See http://www.rabbitmq.com/\n  ##  ##\n  ##########  Logs: /var/log/rabbitmq/rabbit2.log\n  ######  ##        /var/log/rabbitmq/rabbit2-sasl.log\n  ##########\n              Starting broker...\n completed with 6 plugins.\n')),(0,r.kt)("p",null,"\u7ed3\u675f\u547d\u4ee4\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"rabbitmqctl -n rabbit1 stop\nrabbitmqctl -n rabbit2 stop\n")),(0,r.kt)("p",null,"rabbit1\u64cd\u4f5c\u4f5c\u4e3a\u4e3b\u8282\u70b9\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"[root@super ~]# rabbitmqctl -n rabbit1 stop_app  \nStopping node rabbit1@super ...\n[root@super ~]# rabbitmqctl -n rabbit1 reset     \nResetting node rabbit1@super ...\n[root@super ~]# rabbitmqctl -n rabbit1 start_app\nStarting node rabbit1@super ...\n[root@super ~]# \n")),(0,r.kt)("p",null,"rabbit2\u64cd\u4f5c\u4e3a\u4ece\u8282\u70b9\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"[root@super ~]# rabbitmqctl -n rabbit2 stop_app\nStopping node rabbit2@super ...\n[root@super ~]# rabbitmqctl -n rabbit2 reset\nResetting node rabbit2@super ...\n[root@super ~]# rabbitmqctl -n rabbit2 join_cluster rabbit1@'super' ###''\u5185\u662f\u4e3b\u673a\u540d\u6362\u6210\u81ea\u5df1\u7684\nClustering node rabbit2@super with rabbit1@super ...\n[root@super ~]# rabbitmqctl -n rabbit2 start_app\nStarting node rabbit2@super ...\n")),(0,r.kt)("p",null,"\u67e5\u770b\u96c6\u7fa4\u72b6\u6001\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},'[root@super ~]# rabbitmqctl cluster_status -n rabbit1\nCluster status of node rabbit1@super ...\n[{nodes,[{disc,[rabbit1@super,rabbit2@super]}]},\n {running_nodes,[rabbit2@super,rabbit1@super]},\n {cluster_name,<<"rabbit1@super">>},\n {partitions,[]},\n {alarms,[{rabbit2@super,[]},{rabbit1@super,[]}]}]\n')),(0,r.kt)("p",null,"web\u76d1\u63a7\uff1a"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1566065096459-f6a3b079.png",alt:"1566065096459"}),"1566065096459"),(0,r.kt)("h4",{id:"3\u96c6\u7fa4\u7ba1\u7406"},"\uff083\uff09\u96c6\u7fa4\u7ba1\u7406"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"rabbitmqctl join_cluster {cluster_node} ","[\u2013ram]")," \u5c06\u8282\u70b9\u52a0\u5165\u6307\u5b9a\u96c6\u7fa4\u4e2d\u3002\u5728\u8fd9\u4e2a\u547d\u4ee4\u6267\u884c\u524d\u9700\u8981\u505c\u6b62RabbitMQ\u5e94\u7528\u5e76\u91cd\u7f6e\u8282\u70b9\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"rabbitmqctl cluster_status")," \u663e\u793a\u96c6\u7fa4\u7684\u72b6\u6001\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"rabbitmqctl change_cluster_node_type {disc|ram}")," \u4fee\u6539\u96c6\u7fa4\u8282\u70b9\u7684\u7c7b\u578b\u3002\u5728\u8fd9\u4e2a\u547d\u4ee4\u6267\u884c\u524d\u9700\u8981\u505c\u6b62RabbitMQ\u5e94\u7528\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"rabbitmqctl forget_cluster_node ","[\u2013offline]")," \u5c06\u8282\u70b9\u4ece\u96c6\u7fa4\u4e2d\u5220\u9664\uff0c\u5141\u8bb8\u79bb\u7ebf\u6267\u884c\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"rabbitmqctl update_cluster_nodes {clusternode}")),(0,r.kt)("p",null,"\u5728\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u5e94\u7528\u542f\u52a8\u524d\u54a8\u8be2clusternode\u8282\u70b9\u7684\u6700\u65b0\u4fe1\u606f\uff0c\u5e76\u66f4\u65b0\u76f8\u5e94\u7684\u96c6\u7fa4\u4fe1\u606f\u3002\u8fd9\u4e2a\u548cjoin_cluster\u4e0d\u540c\uff0c\u5b83\u4e0d\u52a0\u5165\u96c6\u7fa4\u3002\u8003\u8651\u8fd9\u6837\u4e00\u79cd\u60c5\u51b5\uff0c\u8282\u70b9A\u548c\u8282\u70b9B\u90fd\u5728\u96c6\u7fa4\u4e2d\uff0c\u5f53\u8282\u70b9A\u79bb\u7ebf\u4e86\uff0c\u8282\u70b9C\u53c8\u548c\u8282\u70b9B\u7ec4\u6210\u4e86\u4e00\u4e2a\u96c6\u7fa4\uff0c\u7136\u540e\u8282\u70b9B\u53c8\u79bb\u5f00\u4e86\u96c6\u7fa4\uff0c\u5f53A\u9192\u6765\u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u5c1d\u8bd5\u8054\u7cfb\u8282\u70b9B\uff0c\u4f46\u662f\u8fd9\u6837\u4f1a\u5931\u8d25\uff0c\u56e0\u4e3a\u8282\u70b9B\u5df2\u7ecf\u4e0d\u5728\u96c6\u7fa4\u4e2d\u4e86\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"rabbitmqctl cancel_sync_queue ","[-p vhost]"," {queue}")," \u53d6\u6d88\u961f\u5217queue\u540c\u6b65\u955c\u50cf\u7684\u64cd\u4f5c\u3002"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"rabbitmqctl set_cluster_name {name}")," \u8bbe\u7f6e\u96c6\u7fa4\u540d\u79f0\u3002\u96c6\u7fa4\u540d\u79f0\u5728\u5ba2\u6237\u7aef\u8fde\u63a5\u65f6\u4f1a\u901a\u62a5\u7ed9\u5ba2\u6237\u7aef\u3002Federation\u548cShovel\u63d2\u4ef6\u4e5f\u4f1a\u6709\u7528\u5230\u96c6\u7fa4\u540d\u79f0\u7684\u5730\u65b9\u3002\u96c6\u7fa4\u540d\u79f0\u9ed8\u8ba4\u662f\u96c6\u7fa4\u4e2d\u7b2c\u4e00\u4e2a\u8282\u70b9\u7684\u540d\u79f0\uff0c\u901a\u8fc7\u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u91cd\u65b0\u8bbe\u7f6e\u3002"),(0,r.kt)("h4",{id:"4rabbitmq\u955c\u50cf\u96c6\u7fa4\u914d\u7f6e"},"\uff084\uff09RabbitMQ\u955c\u50cf\u96c6\u7fa4\u914d\u7f6e"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"\u4e0a\u9762\u5df2\u7ecf\u5b8c\u6210RabbitMQ\u9ed8\u8ba4\u96c6\u7fa4\u6a21\u5f0f\uff0c\u4f46\u5e76\u4e0d\u4fdd\u8bc1\u961f\u5217\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u5c3d\u7ba1\u4ea4\u6362\u673a\u3001\u7ed1\u5b9a\u8fd9\u4e9b\u53ef\u4ee5\u590d\u5236\u5230\u96c6\u7fa4\u91cc\u7684\u4efb\u4f55\u4e00\u4e2a\u8282\u70b9\uff0c\u4f46\u662f\u961f\u5217\u5185\u5bb9\u4e0d\u4f1a\u590d\u5236\u3002\u867d\u7136\u8be5\u6a21\u5f0f\u89e3\u51b3\u4e00\u9879\u76ee\u7ec4\u8282\u70b9\u538b\u529b\uff0c\u4f46\u961f\u5217\u8282\u70b9\u5b95\u673a\u76f4\u63a5\u5bfc\u81f4\u8be5\u961f\u5217\u65e0\u6cd5\u5e94\u7528\uff0c\u53ea\u80fd\u7b49\u5f85\u91cd\u542f\uff0c\u6240\u4ee5\u8981\u60f3\u5728\u961f\u5217\u8282\u70b9\u5b95\u673a\u6216\u6545\u969c\u4e5f\u80fd\u6b63\u5e38\u5e94\u7528\uff0c\u5c31\u8981\u590d\u5236\u961f\u5217\u5185\u5bb9\u5230\u96c6\u7fa4\u91cc\u7684\u6bcf\u4e2a\u8282\u70b9\uff0c\u5fc5\u987b\u8981\u521b\u5efa\u955c\u50cf\u961f\u5217\u3002"),(0,r.kt)("p",{parentName:"blockquote"},"\u955c\u50cf\u961f\u5217\u662f\u57fa\u4e8e\u666e\u901a\u7684\u96c6\u7fa4\u6a21\u5f0f\u7684\uff0c\u7136\u540e\u518d\u6dfb\u52a0\u4e00\u4e9b\u7b56\u7565\uff0c\u6240\u4ee5\u4f60\u8fd8\u662f\u5f97\u5148\u914d\u7f6e\u666e\u901a\u96c6\u7fa4\uff0c\u7136\u540e\u624d\u80fd\u8bbe\u7f6e\u955c\u50cf\u961f\u5217\uff0c\u6211\u4eec\u5c31\u4ee5\u4e0a\u9762\u7684\u96c6\u7fa4\u63a5\u7740\u505a\u3002")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u8bbe\u7f6e\u7684\u955c\u50cf\u961f\u5217\u53ef\u4ee5\u901a\u8fc7\u5f00\u542f\u7684\u7f51\u9875\u7684\u7ba1\u7406\u7aefAdmin->Policies\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u3002")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},'rabbitmqctl set_policy my_ha "^" \'{"ha-mode":"all"}\'')),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://www.ydlclass.com/doc21xnv/assets/1566072300852-f79b7823.png",alt:"1566072300852"}),"1566072300852"),(0,r.kt)("blockquote",null,(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"Name:\u7b56\u7565\u540d\u79f0"),(0,r.kt)("li",{parentName:"ul"},"Pattern\uff1a\u5339\u914d\u7684\u89c4\u5219\uff0c\u5982\u679c\u662f\u5339\u914d\u6240\u6709\u7684\u961f\u5217\uff0c\u662f^."),(0,r.kt)("li",{parentName:"ul"},"Definition:\u4f7f\u7528ha-mode\u6a21\u5f0f\u4e2d\u7684all\uff0c\u4e5f\u5c31\u662f\u540c\u6b65\u6240\u6709\u5339\u914d\u7684\u961f\u5217\u3002\u95ee\u53f7\u94fe\u63a5\u5e2e\u52a9\u6587\u6863\u3002"))),(0,r.kt)("h4",{id:"5\u8d1f\u8f7d\u5747\u8861-haproxy"},"\uff085\uff09\u8d1f\u8f7d\u5747\u8861-HAProxy"),(0,r.kt)("p",null,"HAProxy\u63d0\u4f9b\u9ad8\u53ef\u7528\u6027\u3001\u8d1f\u8f7d\u5747\u8861\u4ee5\u53ca\u57fa\u4e8eTCP\u548cHTTP\u5e94\u7528\u7684\u4ee3\u7406\uff0c\u652f\u6301\u865a\u62df\u4e3b\u673a\uff0c\u5b83\u662f\u514d\u8d39\u3001\u5feb\u901f\u5e76\u4e14\u53ef\u9760\u7684\u4e00\u79cd\u89e3\u51b3\u65b9\u6848,\u5305\u62ecTwitter\uff0cReddit\uff0cStackOverflow\uff0cGitHub\u5728\u5185\u7684\u591a\u5bb6\u77e5\u540d\u4e92\u8054\u7f51\u516c\u53f8\u5728\u4f7f\u7528\u3002HAProxy\u5b9e\u73b0\u4e86\u4e00\u79cd\u4e8b\u4ef6\u9a71\u52a8\u3001\u5355\u4e00\u8fdb\u7a0b\u6a21\u578b\uff0c\u6b64\u6a21\u578b\u652f\u6301\u975e\u5e38\u5927\u7684\u5e76\u53d1\u8fde\u63a5\u6570\u3002"),(0,r.kt)("h5",{id:"a-\u5b89\u88c5haproxy"},"a\u3001 \u5b89\u88c5HAProxy"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"//\u4e0b\u8f7d\u4f9d\u8d56\u5305\nyum install gcc vim wget\n//\u4e0a\u4f20haproxy\u6e90\u7801\u5305\n//\u89e3\u538b\ntar -zxvf haproxy-1.6.5.tar.gz -C /usr/local\n//\u8fdb\u5165\u76ee\u5f55\u3001\u8fdb\u884c\u7f16\u8bd1\u3001\u5b89\u88c5\ncd /usr/local/haproxy-1.6.5\nmake TARGET=linux31 PREFIX=/usr/local/haproxy\nmake install PREFIX=/usr/local/haproxy\nmkdir /etc/haproxy\n//\u8d4b\u6743\ngroupadd -r -g 149 haproxy\nuseradd -g haproxy -r -s /sbin/nologin -u 149 haproxy\n//\u521b\u5efahaproxy\u914d\u7f6e\u6587\u4ef6\nmkdir /etc/haproxy\nvim /etc/haproxy/haproxy.cfg\n")),(0,r.kt)("h5",{id:"b\u914d\u7f6ehaproxy"},"b\u3001\u914d\u7f6eHAProxy"),(0,r.kt)("p",null,"\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff1a/etc/haproxy/haproxy.cfg"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"#logging options\nglobal\n    log 127.0.0.1 local0 info\n    maxconn 5120\n    chroot /usr/local/haproxy\n    uid 99\n    gid 99\n    daemon\n    quiet\n    nbproc 20\n    pidfile /var/run/haproxy.pid\n\ndefaults\n    log global\n    \n    mode tcp\n\n    option tcplog\n    option dontlognull\n    retries 3\n    option redispatch\n    maxconn 2000\n    contimeout 5s\n   \n     clitimeout 60s\n\n     srvtimeout 15s \n#front-end IP for consumers and producters\n\nlisten rabbitmq_cluster\n    bind 0.0.0.0:5672\n    \n    mode tcp\n    #balance url_param userid\n    #balance url_param session_id check_post 64\n    #balance hdr(User-Agent)\n    #balance hdr(host)\n    #balance hdr(Host) use_domain_only\n    #balance rdp-cookie\n    #balance leastconn\n    #balance source //ip\n    \n    balance roundrobin\n    \n        server node1 127.0.0.1:5673 check inter 5000 rise 2 fall 2\n        server node2 127.0.0.1:5674 check inter 5000 rise 2 fall 2\n\nlisten stats\n    bind 172.16.98.133:8100\n    mode http\n    option httplog\n    stats enable\n    stats uri /rabbitmq-stats\n    stats refresh 5s\n")),(0,r.kt)("p",null,"\u542f\u52a8HAproxy\u8d1f\u8f7d"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"/usr/local/haproxy/sbin/haproxy -f /etc/haproxy/haproxy.cfg\n//\u67e5\u770bhaproxy\u8fdb\u7a0b\u72b6\u6001\nps -ef | grep haproxy\n\n\u8bbf\u95ee\u5982\u4e0b\u5730\u5740\u5bf9mq\u8282\u70b9\u8fdb\u884c\u76d1\u63a7\nhttp://172.16.98.133:8100/rabbitmq-stats\n")),(0,r.kt)("p",null,"\u4ee3\u7801\u4e2d\u8bbf\u95eemq\u96c6\u7fa4\u5730\u5740\uff0c\u5219\u53d8\u4e3a\u8bbf\u95eehaproxy\u5730\u5740:5672"))}u.isMDXComponent=!0}}]);