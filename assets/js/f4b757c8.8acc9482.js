"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4983],{3905:(e,n,t)=>{t.d(n,{Zo:()=>m,kt:()=>k});var l=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,l,a=function(e,n){if(null==e)return{};var t,l,a={},s=Object.keys(e);for(l=0;l<s.length;l++)t=s[l],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(l=0;l<s.length;l++)t=s[l],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=l.createContext({}),u=function(e){var n=l.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},m=function(e){var n=u(e.components);return l.createElement(i.Provider,{value:n},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return l.createElement(l.Fragment,{},n)}},d=l.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,i=e.parentName,m=r(e,["components","mdxType","originalType","parentName"]),p=u(t),d=a,k=p["".concat(i,".").concat(d)]||p[d]||c[d]||s;return t?l.createElement(k,o(o({ref:n},m),{},{components:t})):l.createElement(k,o({ref:n},m))}));function k(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,o=new Array(s);o[0]=d;var r={};for(var i in n)hasOwnProperty.call(n,i)&&(r[i]=n[i]);r.originalType=e,r[p]="string"==typeof e?e:a,o[1]=r;for(var u=2;u<s;u++)o[u]=t[u];return l.createElement.apply(null,o)}return l.createElement.apply(null,t)}d.displayName="MDXCreateElement"},8773:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>u});var l=t(7462),a=(t(7294),t(3905));const s={},o="\u6570\u636e\u9a71\u52a8\u548cORM",r={unversionedId:"nodejs/\u6570\u636e\u9a71\u52a8\u548cORM",id:"nodejs/\u6570\u636e\u9a71\u52a8\u548cORM",title:"\u6570\u636e\u9a71\u52a8\u548cORM",description:"1.mysql\u9a71\u52a8\u7a0b\u5e8f",source:"@site/docs/nodejs/3.\u6570\u636e\u9a71\u52a8\u548cORM.md",sourceDirName:"nodejs",slug:"/nodejs/\u6570\u636e\u9a71\u52a8\u548cORM",permalink:"/docs/nodejs/\u6570\u636e\u9a71\u52a8\u548cORM",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/nodejs/3.\u6570\u636e\u9a71\u52a8\u548cORM.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"nodejs",previous:{title:"MySql",permalink:"/docs/nodejs/mysql"},next:{title:"Express",permalink:"/docs/nodejs/express"}},i={},u=[{value:"1.mysql\u9a71\u52a8\u7a0b\u5e8f",id:"1mysql\u9a71\u52a8\u7a0b\u5e8f",level:2},{value:"\u4ec0\u4e48\u662f\u9a71\u52a8\u7a0b\u5e8f",id:"\u4ec0\u4e48\u662f\u9a71\u52a8\u7a0b\u5e8f",level:3},{value:"mysql2\u7684\u4f7f\u7528",id:"mysql2\u7684\u4f7f\u7528",level:3},{value:"\u9632\u6b62sql\u6ce8\u5165",id:"\u9632\u6b62sql\u6ce8\u5165",level:3},{value:"2.sequelize\u7b80\u4ecb",id:"2sequelize\u7b80\u4ecb",level:2},{value:"ORM",id:"orm",level:3},{value:"Node\u4e2d\u7684ORM",id:"node\u4e2d\u7684orm",level:3},{value:"3.\u6a21\u578b\u5b9a\u4e49\u548c\u540c\u6b65",id:"3\u6a21\u578b\u5b9a\u4e49\u548c\u540c\u6b65",level:2},{value:"\u6848\u4f8b\uff1a\u5b66\u6821\u6570\u636e\u5e93",id:"\u6848\u4f8b\u5b66\u6821\u6570\u636e\u5e93",level:3},{value:"1.\u521b\u5efa\u8fde\u63a5",id:"1\u521b\u5efa\u8fde\u63a5",level:3},{value:"2.\u521b\u5efa\u6a21\u578b\u5bf9\u8c61",id:"2\u521b\u5efa\u6a21\u578b\u5bf9\u8c61",level:3},{value:"3.\u540c\u6b65\u6a21\u578b\u5bf9\u8c61",id:"3\u540c\u6b65\u6a21\u578b\u5bf9\u8c61",level:3},{value:"\u7ec3\u4e60",id:"\u7ec3\u4e60",level:3},{value:"4.\u6a21\u578b\u7684\u589e\u5220\u6539",id:"4\u6a21\u578b\u7684\u589e\u5220\u6539",level:2},{value:"\u589e",id:"\u589e",level:3},{value:"\u5220",id:"\u5220",level:3},{value:"\u6539",id:"\u6539",level:3},{value:"\u7efc\u5408",id:"\u7efc\u5408",level:3},{value:"5.\u6a21\u62df\u6570\u636e",id:"5\u6a21\u62df\u6570\u636e",level:2},{value:"\u4f7f\u7528",id:"\u4f7f\u7528",level:3},{value:"6.\u6570\u636e\u6293\u53d6\uff08\u722c\u866b\uff09",id:"6\u6570\u636e\u6293\u53d6\u722c\u866b",level:2},{value:"\u722c\u53d6",id:"\u722c\u53d6",level:3},{value:"7.\u6570\u636e\u67e5\u8be2",id:"7\u6570\u636e\u67e5\u8be2",level:2},{value:"8.MD5\u52a0\u5bc6",id:"8md5\u52a0\u5bc6",level:2},{value:"\u7279\u70b9",id:"\u7279\u70b9",level:3},{value:"9.moment",id:"9moment",level:2},{value:"\u6982\u5ff5",id:"\u6982\u5ff5",level:3},{value:"10.\u6570\u636e\u9a8c\u8bc1",id:"10\u6570\u636e\u9a8c\u8bc1",level:2},{value:"\u6570\u636e\u9a8c\u8bc1\u7684\u4f4d\u7f6e",id:"\u6570\u636e\u9a8c\u8bc1\u7684\u4f4d\u7f6e",level:3},{value:"\u76f8\u5173\u5e93",id:"\u76f8\u5173\u5e93",level:3},{value:"validator",id:"validator",level:4},{value:"validate.js",id:"validatejs",level:4},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:3},{value:"11.\u8bbf\u95ee\u5668\u548c\u865a\u62df\u5b57\u6bb5",id:"11\u8bbf\u95ee\u5668\u548c\u865a\u62df\u5b57\u6bb5",level:2},{value:"12. \u65e5\u5fd7\u8bb0\u5f55",id:"12-\u65e5\u5fd7\u8bb0\u5f55",level:2},{value:"log4js",id:"log4js",level:3},{value:"\u6982\u5ff5",id:"\u6982\u5ff5-1",level:3},{value:"\u7ec3\u4e60",id:"\u7ec3\u4e60-1",level:3},{value:"\u4f7f\u7528",id:"\u4f7f\u7528-1",level:3}],m={toc:u};function p(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,l.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u6570\u636e\u9a71\u52a8\u548corm"},"\u6570\u636e\u9a71\u52a8\u548cORM"),(0,a.kt)("h2",{id:"1mysql\u9a71\u52a8\u7a0b\u5e8f"},"1.mysql\u9a71\u52a8\u7a0b\u5e8f"),(0,a.kt)("h3",{id:"\u4ec0\u4e48\u662f\u9a71\u52a8\u7a0b\u5e8f"},"\u4ec0\u4e48\u662f\u9a71\u52a8\u7a0b\u5e8f"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u9a71\u52a8\u7a0b\u5e8f\u662f\u8fde\u63a5\u5185\u5b58\u548c\u5176\u4ed6\u5b58\u50a8\u4ecb\u8d28\u7684\u6865\u6881"),(0,a.kt)("li",{parentName:"ul"},"mysql\u9a71\u52a8\u7a0b\u5e8f\u662f\u8fde\u63a5\u5185\u5b58\u6570\u636e\u548cmysql\u6570\u636e\u7684\u6865\u6881"),(0,a.kt)("li",{parentName:"ul"},"mysql\u9a71\u52a8\u7a0b\u5e8f\u901a\u5e38\u4f7f\u7528",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"mysql"),(0,a.kt)("li",{parentName:"ul"},"mysql2\uff08\u4f18\u5316\u505a\u7684\u4f1a\u597d\u4e00\u4e9b\uff0c\u63a5\u53e3\u4e0a\u548cmysql\u57fa\u672c\u4e00\u6837\uff0c\u524d\u8eabmysql-native\uff09")))),(0,a.kt)("h3",{id:"mysql2\u7684\u4f7f\u7528"},"mysql2\u7684\u4f7f\u7528"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/sidorares/node-mysql2#readme"},"https://github.com/sidorares/node-mysql2#readme")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const mysql = require("mysql2");\n\n// \u521b\u5efa\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\nconst connection = mysql.createConnection({\n  host: "localhost",\n  user: "root",\n  password: "123456",\n  database: "companydb",\n});\n\n// simple query\n\nconnection.query("SELECT * FROM `company`;", function (err, results) {\n  //err\u9519\u8bef\n  //result\u67e5\u8be2\u7ed3\u679c\n  console.log(results); // results contains rows returned by server\n});\n\nconnection.query(\n  "insert into company(`name`,location,buildDate) values(\'abbc\', \'\u963f\u8428\u5fb7\', curdate());",\n  (err, result) => {\n    console.log(result);\n  }\n);\n\nconnection.query(\n  "update company set `name`=\'bcd\' where id=4",\n  (err, result) => {\n    console.log(result);\n  }\n);\n\nconnection.query(\n    "delete from company where id=4",\n    (err, result) => {\n      console.log(result);\n    }\n  );\n\n')),(0,a.kt)("p",null,"mysql2\u63d0\u4f9b\u4e86promise\u7684\u5199\u6cd5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const mysql = require("mysql2/promise");\n\nasync function test() {\n  // \u521b\u5efa\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\n  const connection = await mysql.createConnection({\n    host: "localhost",\n    user: "root",\n    password: "123456",\n    database: "companydb",\n  });\n//   console.log(connection);\n//\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u6211\u4eec\u53d6\u6570\u7ec4\u7684\u7b2c\u4e00\u9879\n  const [results] = await connection.query("SELECT * FROM `company`;");\n  console.log(results);\n  connection.end();\n}\ntest();\n\n')),(0,a.kt)("h3",{id:"\u9632\u6b62sql\u6ce8\u5165"},"\u9632\u6b62sql\u6ce8\u5165"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"sql\u6ce8\u5165",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u7528\u6237\u901a\u8fc7\u6ce8\u5165sql\u8bed\u53e5\u5230\u6700\u7ec8\u67e5\u8be2\u4e2d\uff0c\u5bfc\u81f4\u4e86\u6574\u4e2asql\u4e0e\u9884\u671f\u884c\u4e3a\u4e0d\u7b26"))),(0,a.kt)("li",{parentName:"ul"},"mysql\u652f\u6301\u53d8\u91cf",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u53d8\u91cf\u7684\u5185\u5bb9\u4e0d\u4f5c\u4e3a\u4efb\u4f55sql\u5173\u952e\u5b57")))),(0,a.kt)("p",null,"\u5177\u4f53\u7684\u6ce8\u5165\u53ef\u4ee5\u53c2\u8003\u6211\u7684csdn\uff1a"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://blog.csdn.net/qq_45775897?type=blog"},"https://blog.csdn.net/qq_45775897?type=blog")),(0,a.kt)("p",null,"\u6240\u4ee5\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528\u4e0a\u65b9\u7684\u4ee3\u7801\u5199\u6cd5\u3002"),(0,a.kt)("p",null,"\u6539\u7528execute\uff0c\u5bf9\u5e94\u7684\u4f20\u5165\u4f4d\u7f6e\u6539\u6210\uff1f\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const mysql = require("mysql2/promise");\nconst pool = mysql.createPool({\n  host: "localhost",\n  user: "root",\n  password: "123456",\n  database: "companydb",\n  multipleStatements: true,//\u8bbe\u7f6e\u5141\u8bb8\u8fd0\u884c\u591a\u6761sql\u8bed\u53e5\n});\n\nasync function test(id) {\n  // \u521b\u5efa\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\n  const sql = `select * from employee where id = ${id};`;\n  //\u6ce8\u610f\u4f20\u5165\u503c\u4f7f\u7528\u95ee\u53f7\n  // const sql = `select * from employee where \\`name\\` like concat(\'%\', ?, \'%\') ;`;\n  const [results] = await pool.query(sql);\n  //\u6539\u7528execute\uff0c\u5b9e\u73b0\u9884\u7f16\u8bd1\uff0c\u9632\u6b62sql\u7684\u6ce8\u5165\n  //const [results] = await pool.execute(sql, [id]);\n  console.log(results);\n}\n//sql\u6ce8\u5165\ntest(`\'\'; delete from company where id = 5`)\n//test("\u5f20");\n')),(0,a.kt)("p",null,"\u6bd4\u4e14\u4f7f\u7528\u8fde\u63a5\u6c60\uff0c\u9632\u6b62\u670d\u52a1\u5668\u5457\u5927\u91cf\u5360\u7528\u3002"),(0,a.kt)("p",null,"\u5f53\u7136mysql2\u8fd8\u662f\u6ca1\u6709\u90a3\u4e48\u597d\u7528\uff0c\u540e\u9762\u8fd8\u6709\u53e6\u5916\u7684\u65b9\u5f0f\uff08ORM\u6846\u67b6\uff09\u3002"),(0,a.kt)("h2",{id:"2sequelize\u7b80\u4ecb"},"2.sequelize\u7b80\u4ecb"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/demopark/sequelize-docs-Zh-CN"},"https://github.com/demopark/sequelize-docs-Zh-CN")),(0,a.kt)("h3",{id:"orm"},"ORM"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u200b\tObject Relational Mapping \u5bf9\u8c61\u5173\u7cfb\u6620\u5c04"),(0,a.kt)("li",{parentName:"ul"},"\u200b\t\u901a\u8fc7ORM\u6846\u67b6\uff0c\u53ef\u4ee5\u81ea\u52a8\u7684\u628a\u7a0b\u5e8f\u4e2d\u7684\u5bf9\u8c61\u548c\u6570\u636e\u5e93\u5173\u8054"),(0,a.kt)("li",{parentName:"ul"},"\u200b\tORM\u6846\u67b6\u4f1a\u9690\u85cf\u5177\u4f53\u7684\u6570\u636e\u5e93\u5e95\u5c42\u7ec6\u8282\uff0c\u8ba9\u5f00\u53d1\u8005\u4f7f\u7528\u540c\u6837\u7684\u6570\u636e\u64cd\u4f5c\u63a5\u53e3\uff0c\u5b8c\u6210\u5bf9\u4e0d\u540c\u6570\u636e\u5e93\u7684\u64cd\u4f5c",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("img",{parentName:"li",src:"https://october-x-image-host.oss-cn-hangzhou.aliyuncs.com/markdown-imgsORM%E5%8E%9F%E7%90%86%E5%9B%BE.jpg",alt:"ORM\u539f\u7406\u56fe"})))),(0,a.kt)("li",{parentName:"ul"},"\u200b\tORM\u7684\u4f18\u52bf",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u5f00\u53d1\u8005\u4e0d\u7528\u5173\u5fc3\u6570\u636e\u5e93\uff0c\u4ec5\u9700\u5173\u5fc3\u5bf9\u8c61"),(0,a.kt)("li",{parentName:"ul"},"\u53ef\u8f7b\u6613\u7684\u5b8c\u6210\u6570\u636e\u5e93\u7684\u79fb\u690d"),(0,a.kt)("li",{parentName:"ul"},"\u65e0\u987b\u62fc\u63a5\u590d\u6742\u7684sql\u8bed\u53e5\u5373\u53ef\u5b8c\u6210\u7cbe\u786e\u67e5\u8be2")))),(0,a.kt)("h3",{id:"node\u4e2d\u7684orm"},"Node\u4e2d\u7684ORM"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u200b\tSequelize",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"JS"),(0,a.kt)("li",{parentName:"ul"},"TS"),(0,a.kt)("li",{parentName:"ul"},"\u6210\u719f"))),(0,a.kt)("li",{parentName:"ul"},"\u200b\tTypeORM",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"TS"),(0,a.kt)("li",{parentName:"ul"},"\u4e0d\u6210\u719f")))),(0,a.kt)("h2",{id:"3\u6a21\u578b\u5b9a\u4e49\u548c\u540c\u6b65"},"3.\u6a21\u578b\u5b9a\u4e49\u548c\u540c\u6b65"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/demopark/sequelize-docs-Zh-CN"},"https://github.com/demopark/sequelize-docs-Zh-CN")),(0,a.kt)("h3",{id:"\u6848\u4f8b\u5b66\u6821\u6570\u636e\u5e93"},"\u6848\u4f8b\uff1a\u5b66\u6821\u6570\u636e\u5e93"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u7ba1\u7406\u5458",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"id"),(0,a.kt)("li",{parentName:"ul"},"\u8d26\u53f7"),(0,a.kt)("li",{parentName:"ul"},"\u5bc6\u7801"),(0,a.kt)("li",{parentName:"ul"},"\u59d3\u540d"))),(0,a.kt)("li",{parentName:"ul"},"\u73ed\u7ea7",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"id"),(0,a.kt)("li",{parentName:"ul"},"\u540d\u79f0"),(0,a.kt)("li",{parentName:"ul"},"\u5f00\u73ed\u65f6\u95f4"))),(0,a.kt)("li",{parentName:"ul"},"\u5b66\u751f",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"id"),(0,a.kt)("li",{parentName:"ul"},"\u59d3\u540d"),(0,a.kt)("li",{parentName:"ul"},"\u51fa\u751f\u65e5\u671f"),(0,a.kt)("li",{parentName:"ul"},"\u6027\u522b"),(0,a.kt)("li",{parentName:"ul"},"\u8054\u7cfb\u7535\u8bdd"),(0,a.kt)("li",{parentName:"ul"},"\u6240\u5c5e\u73ed\u7ea7"))),(0,a.kt)("li",{parentName:"ul"},"\u4e66\u7c4d",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"id"),(0,a.kt)("li",{parentName:"ul"},"\u540d\u79f0"),(0,a.kt)("li",{parentName:"ul"},"\u56fe\u7247"),(0,a.kt)("li",{parentName:"ul"},"\u51fa\u7248\u65f6\u95f4"),(0,a.kt)("li",{parentName:"ul"},"\u4f5c\u8005")))),(0,a.kt)("h3",{id:"1\u521b\u5efa\u8fde\u63a5"},"1.\u521b\u5efa\u8fde\u63a5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const { Sequelize } = require("sequelize");\n\nconst sequelize = new Sequelize("studentdb", "root", "chs021015", {\n  host: "localhost",\n  dialect: "mysql",/* \u9009\u62e9 \'mysql\' | \'mariadb\' | \'postgres\' | \'mssql\' \u5176\u4e00 */\n  logging: null//\u65e5\u5fd7\u8bbe\u7f6e\u4e3anull\uff0c\u8fd9\u6837\u63a7\u5236\u53f0\u4e0d\u8f93\u51fa\u65e5\u5fd7\n});\n\nmodule.exports = sequelize;\n\n')),(0,a.kt)("h3",{id:"2\u521b\u5efa\u6a21\u578b\u5bf9\u8c61"},"2.\u521b\u5efa\u6a21\u578b\u5bf9\u8c61"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const sequelize = require("./db");\nconst { DataTypes } = require("sequelize");\n//\u521b\u5efa\u4e00\u4e2a\u6a21\u578b\u5bf9\u8c61\n//id\u4e00\u822c\u662f\u4e0d\u914d\u7f6e\uff0c\u4f1a\u81ea\u52a8\u751f\u6210\nconst Admin = sequelize.define(\n  "Admin",\n  {\n    loginId: {\n      type: DataTypes.STRING,\n      allowNull: false,\n    },\n    loginPwd: {\n      type: DataTypes.STRING,\n      allowNull: false,\n    },\n  },\n  {\n    createdAt: false,\n    //createdAt: \'createTime\'//\u8bbe\u7f6e\u522b\u540d\n    updatedAt: false,\n    paranoid: true //\u4ece\u6b64\u4ee5\u540e\uff0c\u8be5\u8868\u7684\u6570\u636e\u4e0d\u4f1a\u771f\u6b63\u7684\u5220\u9664\uff0c\u800c\u662f\u589e\u52a0\u4e00\u5217deletedAt\uff0c\u8bb0\u5f55\u5220\u9664\u7684\u65f6\u95f4\n  }\n);\n//\u540c\u6b65\u6a21\u578b\u5bf9\u8c61\nsequelize.sync({ alter: true }).then(() => {\n  console.log("\u6240\u6709\u6a21\u578b\u540c\u6b65\u5b8c\u6210");\n});\n')),(0,a.kt)("h3",{id:"3\u540c\u6b65\u6a21\u578b\u5bf9\u8c61"},"3.\u540c\u6b65\u6a21\u578b\u5bf9\u8c61"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"User.sync()")," - \u5982\u679c\u8868\u4e0d\u5b58\u5728,\u5219\u521b\u5efa\u8be5\u8868(\u5982\u679c\u5df2\u7ecf\u5b58\u5728,\u5219\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"User.sync({ force: true })")," - \u5c06\u521b\u5efa\u8868,\u5982\u679c\u8868\u5df2\u7ecf\u5b58\u5728,\u5219\u5c06\u5176\u9996\u5148\u5220\u9664"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"User.sync({ alter: true })")," - \u8fd9\u5c06\u68c0\u67e5\u6570\u636e\u5e93\u4e2d\u8868\u7684\u5f53\u524d\u72b6\u6001(\u5b83\u5177\u6709\u54ea\u4e9b\u5217,\u5b83\u4eec\u7684\u6570\u636e\u7c7b\u578b\u7b49),\u7136\u540e\u5728\u8868\u4e2d\u8fdb\u884c\u5fc5\u8981\u7684\u66f4\u6539\u4ee5\u4f7f\u5176\u4e0e\u6a21\u578b\u5339\u914d.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},'//\u540c\u6b65\u6a21\u578b\u5bf9\u8c61\nsequelize.sync({ alter: true }).then(() => {\n  console.log("\u6240\u6709\u6a21\u578b\u540c\u6b65\u5b8c\u6210");\n});\n')),(0,a.kt)("h3",{id:"\u7ec3\u4e60"},"\u7ec3\u4e60"),(0,a.kt)("p",null,"db.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const { Sequelize } = require("sequelize");\n\nconst sequelize = new Sequelize("studentdb", "root", "chs021015", {\n  host: "localhost",\n  dialect: "mysql",/* \u9009\u62e9 \'mysql\' | \'mariadb\' | \'postgres\' | \'mssql\' \u5176\u4e00 */\n  logging: null\n});\n\nmodule.exports = sequelize;\n\n')),(0,a.kt)("p",null,"Admin.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const sequelize = require("./db");\nconst { DataTypes } = require("sequelize");\n//\u521b\u5efa\u4e00\u4e2a\u6a21\u578b\u5bf9\u8c61\n//id\u4e00\u822c\u662f\u4e0d\u914d\u7f6e\uff0c\u4f1a\u81ea\u52a8\u751f\u6210\nconst Admin = sequelize.define(\n  "Admin",\n  {\n    loginId: {\n      type: DataTypes.STRING,\n      allowNull: false,\n    },\n    loginPwd: {\n      type: DataTypes.STRING,\n      allowNull: false,\n    },\n  },\n  {\n    createdAt: false,\n    //createdAt: \'createTime\'//\u8bbe\u7f6e\u522b\u540d\n    updatedAt: false,\n    paranoid: true //\u4ece\u6b64\u4ee5\u540e\uff0c\u8be5\u8868\u7684\u6570\u636e\u4e0d\u4f1a\u771f\u6b63\u7684\u5220\u9664\uff0c\u800c\u662f\u589e\u52a0\u4e00\u5217deletedAt\uff0c\u8bb0\u5f55\u5220\u9664\u7684\u65f6\u95f4\n  }\n);\n\n\nmodule.exports = Admin;\n\n')),(0,a.kt)("p",null,"Book.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const sequelize = require("./db");\nconst { DataTypes } = require("sequelize");\n\nmodule.exports = sequelize.define(\n  "Book",\n  {\n    name: {\n      type: DataTypes.STRING,\n      allowNull: false,\n    },\n    imgurl: {\n      type: DataTypes.STRING\n    },\n    publishDate: {\n      type: DataTypes.STRING,\n      allowNull: false,\n    },\n    author: {\n      type: DataTypes.STRING,\n      allowNull: false,\n    }\n  },\n  {\n    paranoid: true,\n  }\n);\n\n')),(0,a.kt)("p",null,"Class.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const sequelize = require("./db");\nconst { DataTypes } = require("sequelize");\nconst Student = require("./Student");\nconst Class = sequelize.define(\n  "Class",\n  {\n    name: {\n      type: DataTypes.STRING,\n      allowNull: false,\n    },\n    openDate: {\n      type: DataTypes.DATE,\n      allowNull: false,\n    },\n  },\n  {\n    createdAt: false,\n    updatedAt: false,\n    paranoid: true,\n  }\n);\n\nClass.hasMany(Student);\n\nmodule.exports = Class;\n\n')),(0,a.kt)("p",null,"Student.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const sequelize = require("./db");\nconst { DataTypes } = require("sequelize");\n\nmodule.exports = sequelize.define(\n  "Student",\n  {\n    name: {\n      type: DataTypes.STRING,\n      allowNull: false,\n    },\n    birthdady: {\n      type: DataTypes.DATE,\n      allowNull: false,\n    },\n    sex: {\n      type: DataTypes.BOOLEAN,\n      allowNull: false,\n    },\n    mobile: {\n      type: DataTypes.STRING(11),\n      allowNull: false,\n    }\n  },\n  {\n    createdAt: false,\n    updatedAt: false,\n    paranoid: true,\n  }\n);\n\n')),(0,a.kt)("p",null,"sync.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'// \u540c\u6b65\u6240\u6709\u6a21\u578b\nrequire("./Admin");\nrequire("./Book");\nrequire("./Class");\nrequire("./Student");\nconst sequelize = require("./db");\nsequelize.sync({ alter: true }).then(() => {\n  console.log("\u6240\u6709\u6a21\u578b\u540c\u6b65\u5b8c\u6210");\n});\n\n')),(0,a.kt)("p",null,"index.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'require("./models/sync");\n\n')),(0,a.kt)("h2",{id:"4\u6a21\u578b\u7684\u589e\u5220\u6539"},"4.\u6a21\u578b\u7684\u589e\u5220\u6539"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://october-x-image-host.oss-cn-hangzhou.aliyuncs.com/markdown-imgs%E4%B8%89%E5%B1%82%E6%9E%B6%E6%9E%84.jpg",alt:"\u4e09\u5c42\u67b6\u6784"})),(0,a.kt)("p",null,"models\u4e2d\u7684\u4ee3\u7801\uff0c\u89c1\u4e0a\u4e00\u8282\u7ec3\u4e60\u3002"),(0,a.kt)("p",null,"\u4e00\u4e2a\u5b8c\u6574\u7684\u7cfb\u7edf\uff0c\u6700\u91cd\u8981\u7684\u9a8c\u8bc1\uff0c\u4e00\u5b9a\u5728\u670d\u52a1\u7aef"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u5ba2\u6237\u7aef\uff08\u6d4f\u89c8\u5668\u3001app\u3001pad\u3001\u5c0f\u7a0b\u5e8f\uff09\u9a8c\u8bc1\uff1a\u7528\u6237\u4f53\u9a8c"),(0,a.kt)("li",{parentName:"ol"},"\u670d\u52a1\u5668\u7aef\u903b\u8f91\u9a8c\u8bc1\uff08\u4e1a\u52a1\u903b\u8f91\u5c42\u7684\u9a8c\u8bc1\uff09\uff1a\u4e3a\u4e86\u4e1a\u52a1\u903b\u8f91\u7684\u5b8c\u6574\u6027\u3001\u5b89\u5168\u6027"),(0,a.kt)("li",{parentName:"ol"},"\u6570\u636e\u5e93\u9a8c\u8bc1\uff1a\u4e3a\u4e86\u4fdd\u8bc1\u6570\u636e\u5b8c\u6574\u6027")),(0,a.kt)("h3",{id:"\u589e"},"\u589e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'// \u589e\u52a0\nconst Admin = require("./models/Admin");\n// const ins = Admin.build({\n//   loginId: "abc",\n//   loginPwd: "123",\n// }); //\u540c\u6b65\u65b9\u6cd5\uff0c\u6784\u5efa\u4e00\u4e2a\u6a21\u578b\u5b9e\u4f8b\n// ins.loginId = "bcd";\n// ins.save().then(() => {\n//   console.log("\u65b0\u5efa\u7ba1\u7406\u5458\u6210\u529f");\n// });\n \n\n//\u76f8\u5f53\u4e8e\u5148\u8fd0\u884cbuild\u518d\u8fd0\u884csave\nAdmin.create({\n  loginId: "admin",\n  loginPwd: "123456",\n}).then((ins) => {\n  console.log(ins.id, ins.loginId, ins.loginPwd);\n});\n\n')),(0,a.kt)("h3",{id:"\u5220"},"\u5220"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"exports.deleteAdmin = async function (adminId) {\n  // \u65b9\u5f0f1\n  // \u53ef\u4ee5\u505a\u4e00\u4e9b\u4e1a\u52a1\u76f8\u5173\u7684\u64cd\u4f5c\n  //   // 1.\u5f97\u5230\u5b9e\u4f8b\n  //   const ins = await Admin.findByPk(adminId);\n  //   //   console.log(ins);\n  //   // 2.\u5220\u9664\u5b9e\u4f8b\n  //   if (ins) {\n  //     await ins.destroy();\n  //   }\n  // \u65b9\u5f0f2\n  const result = await Admin.destroy({\n    where: {\n      id: adminId,\n    },\n  });\n  return result;\n};\n")),(0,a.kt)("h3",{id:"\u6539"},"\u6539"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"exports.updateAdmin = async function (id, adminObj) {\n  // \u65b9\u5f0f1\n  // \u53ef\u4ee5\u505a\u4e00\u4e9b\u4e1a\u52a1\u76f8\u5173\u7684\u64cd\u4f5c\n  // // 1. \u5f97\u5230\u5b9e\u4f8b\n  // const ins = await Admin.findByPk(id);\n  // ins.loginId = adminObj.loginId;\n  // // 2. \u4fdd\u5b58\n  // ins.save();\n\n  // \u65b9\u5f0f2\n  const result = await Admin.update(adminObj, {\n    where: {\n      id,\n    },\n  });\n  return result;\n};\n")),(0,a.kt)("h3",{id:"\u7efc\u5408"},"\u7efc\u5408"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'// \u7ba1\u7406\u5458\u521d\u59cb\u5316\n// \u5224\u65ad\u6570\u636e\u5e93\u4e2d\u662f\u5426\u6709\u7ba1\u7406\u5458\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u81ea\u52a8\u6dfb\u52a0\u4e00\u4e2a\u9ed8\u8ba4\u7ba1\u7406\u5458\nconst Admin = require("../models/Admin");\nexports.addAdmin = async function (adminObj) {\n  // \u5e94\u8be5\u5224\u65adadminObj\u7684\u5404\u79cd\u5c5e\u6027\u662f\u5426\u5408\u7406\uff0c\u4ee5\u53ca\u8d26\u53f7\u662f\u5426\u5df2\u5b58\u5728\n  const ins = await Admin.create(adminObj);\n  return ins.toJSON();//\u8fd4\u56de\u4e00\u4e2ajson\u683c\u5f0f\u7684\u5bf9\u8c61\n};\n\nexports.deleteAdmin = async function (adminId) {\n  // \u65b9\u5f0f1\n  // \u53ef\u4ee5\u505a\u4e00\u4e9b\u4e1a\u52a1\u76f8\u5173\u7684\u64cd\u4f5c\n  //   // 1.\u5f97\u5230\u5b9e\u4f8b\n  //   const ins = await Admin.findByPk(adminId);\n  //   //   console.log(ins);\n  //   // 2.\u5220\u9664\u5b9e\u4f8b\n  //   if (ins) {\n  //     await ins.destroy();\n  //   }\n  // \u65b9\u5f0f2\n  const result = await Admin.destroy({\n    where: {\n      id: adminId,\n    },\n  });\n  return result;\n};\n\nexports.updateAdmin = async function (id, adminObj) {\n  // \u65b9\u5f0f1\n  // \u53ef\u4ee5\u505a\u4e00\u4e9b\u4e1a\u52a1\u76f8\u5173\u7684\u64cd\u4f5c\n  // // 1. \u5f97\u5230\u5b9e\u4f8b\n  // const ins = await Admin.findByPk(id);\n  // ins.loginId = adminObj.loginId;\n  // // 2. \u4fdd\u5b58\n  // ins.save();\n\n  // \u65b9\u5f0f2\n  const result = await Admin.update(adminObj, {\n    where: {\n      id,\n    },\n  });\n  return result;\n};\n\n')),(0,a.kt)("p",null,"\u65b9\u5f0f1\uff1a\u4e2d\u9700\u8981\u6267\u884c\u4e24\u6761sql\u8bed\u53e5\uff0c\u5148\u8981\u901a\u8fc7\u67e5\u8be2\u8bed\u53e5\u62ff\u5230\u793a\u4f8b\uff0c\u800c\u540e\u518d\u6267\u884c\u5220\u9664\u8bed\u53e5\u3002"),(0,a.kt)("p",null,"\u65b9\u5f0f2\uff1a\u53ea\u751f\u6210\u4e00\u6761update\u8bed\u53e5\uff0c\u53bb\u66f4\u65b0deleteAt\u3002"),(0,a.kt)("h2",{id:"5\u6a21\u62df\u6570\u636e"},"5.\u6a21\u62df\u6570\u636e"),(0,a.kt)("p",null,"\u4f7f\u7528mock\u6a21\u62df\u4e00\u4e9b\u6570\u636e"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://mockjs.com/"},"http://mockjs.com/")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tex"},"npm i mockjs\n")),(0,a.kt)("h3",{id:"\u4f7f\u7528"},"\u4f7f\u7528"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const Mock = require("mockjs");\nconst result = Mock.mock({\n  "datas|16": [\n    {\n      "id|+1": 1,\n      name: "\u7f51\u7edc @id \u73ed",\n      openDate: "@date",\n    },\n  ],\n}).datas;\n\nconst Class = require("../models/Class");\nClass.bulkCreate(result);\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const Mock = require("mockjs");\nconst result = Mock.mock({\n  "datas|500-700": [\n    {\n      name: "@cname",\n      birthdady: "@date",\n      "sex|1-2": true,\n      mobile: /1\\d{10}/,\n      //   location: "@city(true)",\n      "ClassId|1-16": 0,\n    },\n  ],\n}).datas;\nconsole.log(result);\nconst Student = require("../models/Student");\nStudent.bulkCreate(result);\n')),(0,a.kt)("p",null,"\u8fd9\u6837\u8bbe\u7f6eClassId\u4f1a\u662fnull\uff0c\u662f\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u5173\u8054\uff0c\u6211\u4eec\u6700\u597d\u5355\u72ec\u5173\u8054\uff0c\u8fd9\u91cc\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6",(0,a.kt)("inlineCode",{parentName:"p"},"relation.js")),(0,a.kt)("p",null,"\u6570\u636e\u5173\u8054\u53c2\u8003\uff1a"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/core-concepts/assocs.md"},"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/core-concepts/assocs.md")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'// \u8bbe\u7f6e\u6a21\u578b\u5173\u7cfb\nconst Class = require("./Class");\nconst Student = require("./Student");\nClass.hasMany(Student);\nStudent.belongsTo(Class);\n')),(0,a.kt)("p",null,"index.js\u4e2d\u8c03\u7528"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'require("./models/relation");\nrequire("./mock/mockStudent");\n')),(0,a.kt)("h2",{id:"6\u6570\u636e\u6293\u53d6\u722c\u866b"},"6.\u6570\u636e\u6293\u53d6\uff08\u722c\u866b\uff09"),(0,a.kt)("p",null,"\u6293\u53d6\u8c46\u74e3\u8bfb\u4e66\u4e2d\u7684\u4e66\u7c4d\u4fe1\u606f"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://book.douban.com/latest"},"https://book.douban.com/latest")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u6d89\u53ca\u5230\u7684\u5e93")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"axios\uff1a",(0,a.kt)("a",{parentName:"li",href:"https://github.com/axios/axios"},"https://github.com/axios/axios"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u53d1\u9001\u4e00\u4e2ahttp\u8bf7\u6c42\uff0c\u5f97\u5230\u670d\u52a1\u5668\u7684\u54cd\u5e94\u7ed3\u679c"),(0,a.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u901a\u7528"))),(0,a.kt)("li",{parentName:"ul"},"cheerio\uff1a",(0,a.kt)("a",{parentName:"li",href:"https://github.com/cheeriojs/cheerio#readme"},"https://github.com/cheeriojs/cheerio#readme"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Jquery\u7684\u6838\u5fc3\u5e93"),(0,a.kt)("li",{parentName:"ul"},"\u4e0edom\u65e0\u5173")))),(0,a.kt)("h3",{id:"\u722c\u53d6"},"\u722c\u53d6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'// \u6293\u53d6\u8c46\u74e3\u8bfb\u4e66\u4e2d\u7684\u6570\u636e\u4fe1\u606f\nconst axios = require("axios").default;\nconst cheerio = require("cheerio");\nconst Book = require("../models/Book");\n/**\n * \u83b7\u53d6\u8c46\u74e3\u8bfb\u4e66\u7f51\u9875\u7684\u6e90\u4ee3\u7801\n */\nasync function getBooksHTML () {\n  const resp = await axios.get("https://book.douban.com/latest");\n  //console.log(resp.data)//\u62ff\u5230\u7684\u662f\u4e00\u4e2ahtml\u7f51\u9875\n  return resp.data;\n}\n\n/**\n * \u4ece\u8c46\u74e3\u8bfb\u4e66\u4e2d\u5f97\u5230\u4e00\u4e2a\u5b8c\u6574\u7684\u7f51\u9875\uff0c\u5e76\u4ece\u7f51\u9875\u4e2d\u5206\u6790\u51fa\u4e66\u7c4d\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u7136\u540e\u5f97\u5230\u4e00\u4e2a\u4e66\u7c4d\u7684\u8be6\u60c5\u9875\u94fe\u63a5\u6570\u7ec4\n */\nasync function getBookLinks () {\n  const html = await getBooksHTML();\n  const $ = cheerio.load(html);\n  const achorElements = $("#content .grid-16-8 li a.fleft");//\u62ff\u5230\u6240\u6709\u8be5\u7c7b\u578b\u7684a\u5143\u7d20\n  //jquery\u7684map\u6709\u4e00\u4e9b\u533a\u522b\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u4e0b\u6807\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u5143\u7d20 \n  const links = achorElements\n    .map((i, ele) => {\n      const href = ele.attribs["href"];\n      return href;\n    })\n    .get();\n  console.log(links)\n  return links;\n}\n\n/**\n * \u6839\u636e\u4e66\u7c4d\u8be6\u60c5\u9875\u7684\u5730\u5740\uff0c\u5f97\u5230\u8be5\u4e66\u7c4d\u7684\u8be6\u7ec6\u4fe1\u606f\n * @param {*} detailUrl\n */\nasync function getBookDetail (detailUrl) {\n  //\u5206\u6790\u8be6\u60c5\u9875\uff0c\u6293\u53d6\u6570\u636e\n  const resp = await axios.get(detailUrl);\n  const $ = cheerio.load(resp.data);\n  //\u4e66\u7c4d\u540d\u79f0\n  const name = $("h1").text().trim();\n  //\u4e66\u7c4d\u5c01\u9762\u5730\u5740\n  const imgurl = $("#mainpic .nbg img").attr("src");\n  //\u4e66\u7c4d\u4fe1\u606f\n  const spans = $("#info span.pl");\n  //\u4f5c\u8005\n  const authorSpan = spans.filter((i, ele) => {\n    return $(ele).text().includes("\u4f5c\u8005");\n  });\n  const author = authorSpan.next("a").text();//\u627e\u5230\u4e0b\u4e00\u4e2aa\u5143\u7d20\n  //\u51fa\u7248\u5e74\u4efd\n  const publishSpan = spans.filter((i, ele) => {\n    return $(ele).text().includes("\u51fa\u7248\u5e74");\n  });\n  const publishDate = publishSpan[0].nextSibling.nodeValue.trim();\n\n  return {\n    name,\n    imgurl,\n    publishDate,\n    author,\n  };\n}\n\n/**\n * \u83b7\u53d6\u6240\u6709\u7684\u4e66\u7c4d\u4fe1\u606f\n */\nasync function fetchAll () {\n  const links = await getBookLinks(); //\u5f97\u5230\u4e66\u7c4d\u7684\u8be6\u60c5\u9875\u5730\u5740\n  const proms = links.map((link) => {\n    return getBookDetail(link);\n  });\n  return Promise.all(proms);\n}\n\n/**\n * \u5f97\u5230\u4e66\u7c4d\u4fe1\u606f\uff0c\u7136\u540e\u4fdd\u5b58\u5230\u6570\u636e\u5e93\n */\nasync function saveToDB () {\n  const books = await fetchAll();\n  console.log(books)\n  await Book.bulkCreate(books);\n  console.log("\u6293\u53d6\u6570\u636e\u5e76\u4fdd\u5b58\u5230\u4e86\u6570\u636e\u5e93");\n}\n\nsaveToDB();\n\n')),(0,a.kt)("h2",{id:"7\u6570\u636e\u67e5\u8be2"},"7.\u6570\u636e\u67e5\u8be2"),(0,a.kt)("p",null,"\u67e5\u8be2\u5355\u4e2a\u6570\u636e\uff1afindOne"),(0,a.kt)("p",null,"\u6309\u7167\u4e3b\u952e\u67e5\u8be2\u5355\u4e2a\u6570\u636e\uff1afindByPK"),(0,a.kt)("p",null,"\u67e5\u8be2\u591a\u4e2a\u6570\u636e\uff1afindAll"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"//\u767b\u5f55\u548c\u67e5\u8be2\u7528\u6237\nexports.login = async function (loginId, loginPwd) {\n  const result = await Admin.findOne({\n    where: {\n      loginId,\n      loginPwd,\n    },\n  });\n  if (result && result.loginId === loginId && result.loginPwd === loginPwd) {\n    return result.toJSON();\n  }\n  return null;\n};\n\nexports.getAdminById = async function (id) {\n  const result = await Admin.findByPk(id);\n  if (result) {\n    return result.toJSON();\n  }\n  return null;\n};\n\nexports.getAdmins = async function () {\n  const result = await Admin.findAll();\n  return JSON.parse(JSON.stringify(result));\n};\n")),(0,a.kt)("p",null,"\u67e5\u8be2\u6570\u91cf\uff1acount"),(0,a.kt)("p",null,"\u5305\u542b\u5173\u7cfb\uff1ainclude"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/advanced-association-concepts/eager-loading.md"},"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/advanced-association-concepts/eager-loading.md")),(0,a.kt)("p",null,"\u53c2\u8003\u6587\u6863\u7684\u6a21\u578b\u67e5\u8be2\uff08\u57fa\u7840\uff09\uff1a"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/core-concepts/model-querying-basics.md#%E9%99%90%E5%88%B6%E5%92%8C%E5%88%86%E9%A1%B5"},"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/core-concepts/model-querying-basics.md#%E9%99%90%E5%88%B6%E5%92%8C%E5%88%86%E9%A1%B5")),(0,a.kt)("p",null,"\u67e5\u627e\u5668\uff1a"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/core-concepts/model-querying-finders.md#findandcountall"},"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/core-concepts/model-querying-finders.md#findandcountall")),(0,a.kt)("p",null,"\u64cd\u4f5c\u7b26\uff1a"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/core-concepts/model-querying-basics.md#%E6%93%8D%E4%BD%9C%E7%AC%A6"},"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/core-concepts/model-querying-basics.md#%E6%93%8D%E4%BD%9C%E7%AC%A6")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'//\u522b\u6f0f\u4e86\nconst { Op } = require("sequelize");\nconst Class = require("../models/Class");\nexports.getStudents = async function (\n  page = 1,\n  limit = 10,\n  sex = -1,\n  name = ""\n) {\n  // const results = await Student.findAll({\n  //   offset: (page - 1) * limit,\n  //   limit: +limit,\n  // });\n  // const total = await Student.count()\n  // const datas = JSON.parse(JSON.stringify(results));\n  // return {\n  //   total,\n  //   datas\n  // }\n  const where = {};\n  if (sex !== -1) {\n    where.sex = !!sex;\n  }\n  if (name) {\n    where.name = {\n      [Op.like]: `%${name}%`,\n    };\n  }\n\n  const result = await Student.findAndCountAll({\n    attributes: ["id", "name", "sex", "birthdady"],\n    where,\n    include: [Class],\n    offset: (page - 1) * limit,\n    limit: +limit,\n  });\n  return {\n    total: result.count,\n    datas: JSON.parse(JSON.stringify(result.rows)),\n  };\n};\n')),(0,a.kt)("h2",{id:"8md5\u52a0\u5bc6"},"8.MD5\u52a0\u5bc6"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/md5"},"https://www.npmjs.com/package/md5")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tex"},"npm i md5\n")),(0,a.kt)("h3",{id:"\u7279\u70b9"},"\u7279\u70b9"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"hash\u52a0\u5bc6\u7b97\u6cd5\u7684\u4e00\u79cd"),(0,a.kt)("li",{parentName:"ol"},"\u53ef\u4ee5\u5c06\u4efb\u4f55\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u52a0\u5bc6\u6210\u4e00\u4e2a\u56fa\u5b9a\u957f\u5ea6\u7684\u5b57\u7b26\u4e32"),(0,a.kt)("li",{parentName:"ol"},"\u5355\u5411\u52a0\u5bc6\uff1a\u53ea\u80fd\u52a0\u5bc6\u65e0\u6cd5\u89e3\u5bc6"),(0,a.kt)("li",{parentName:"ol"},"\u540c\u6837\u7684\u6e90\u5b57\u7b26\u4e32\u52a0\u5bc6\u540e\u5f97\u5230\u7684\u7ed3\u679c\u56fa\u5b9a")),(0,a.kt)("p",null,"\u4f7f\u7528\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u6bd4\u5982\u6211\u4eec\u8981\u628a\u524d\u9762\u4f8b\u5b50\u4e2d\u7684\u5bc6\u7801\u8fdb\u884cmd5\u52a0\u5bc6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const md5 = require("md5");\nconst Admin = require("../models/Admin");\nexports.addAdmin = async function (adminObj) {\n  //\u8fdb\u884cMD5\u52a0\u5bc6\n  adminObj.loginPwd = md5(adminObj.loginPwd);\n  const ins = await Admin.create(adminObj);\n  return ins.toJSON();\n};\n')),(0,a.kt)("h2",{id:"9moment"},"9.moment"),(0,a.kt)("p",null,"\u5b98\u7f51\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://momentjs.com/"},"https://momentjs.com/")),(0,a.kt)("p",null,"\u4e2d\u6587\u6c11\u95f4\u7f51\uff1a",(0,a.kt)("a",{parentName:"p",href:"http://momentjs.cn/"},"http://momentjs.cn/")),(0,a.kt)("h3",{id:"\u6982\u5ff5"},"\u6982\u5ff5"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"utc\u548c\u5317\u4eac\u65f6\u95f4",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"utc\uff1a\u4e16\u754c\u534f\u8c03\u65f6"),(0,a.kt)("li",{parentName:"ul"},"\u4ee5\u82f1\u56fd\u683c\u6797\u5a01\u6cbb\u65f6\u95f4\u4e3a\u6807\u51c6"),(0,a.kt)("li",{parentName:"ul"},"utc\u65f6\u95f4\u548c\u5317\u4eac\u65f6\u95f4\u76f8\u5dee8\u5c0f\u65f6"),(0,a.kt)("li",{parentName:"ul"},"utc\u7684\u51cc\u6668\u76f8\u5f53\u4e8e\u5317\u4eac\u65f6\u95f4\u7684\u4e0a\u53488\u70b9"))),(0,a.kt)("li",{parentName:"ul"},"\u65f6\u95f4\u6233 timestamp",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u67d0\u4e2autc\u65f6\u95f4\u5230utc1970 - 1 - 1\u51cc\u6668\u7ecf\u8fc7\u7684\u6beb\u79d2\u6570",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4e5f\u53ef\u4ee5\u662f\u79d2\u6570\uff0c\u7528\u5c0f\u6570\u90e8\u5206\u8bb0\u5f55\u6beb\u79d2"))),(0,a.kt)("li",{parentName:"ul"},"\u6ce8\u610f\u70b9",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u65f6\u95f4\u6233\u8868\u793a\u7684\u662futc\u65f6\u95f4\u7684\u5dee\u5f02"))))),(0,a.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u670d\u52a1\u5668\u7684\u5f71\u54cd",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u90e8\u7f72\u5230\u4e16\u754c\u7684\u4efb\u4f55\u4f4d\u7f6e"),(0,a.kt)("li",{parentName:"ul"},"\u670d\u52a1\u5668\u5185\u90e8\u5e94\u8be5\u7edf\u4e00\u4f7f\u7528utc\u65f6\u95f4\u6216\u65f6\u95f4\u6233\uff0c\u5305\u62ec\u6570\u636e\u5e93"))),(0,a.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u5ba2\u6237\u7aef\u7684\u5f71\u54cd",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aef\u8981\u7ed9\u4e0d\u540c\u5730\u533a\u7684\u5ba2\u6237\u53cb\u597d\u7684\u663e\u793a\u65f6\u95f4"),(0,a.kt)("li",{parentName:"ul"},"\u5ba2\u6237\u7aef\u5e94\u8be5\u628a\u65f6\u95f4\u6233\u6216utc\u65f6\u95f4\u8f6c\u6362\u4e3a\u672c\u5730\u65f6\u95f4\u663e\u793a")))),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://october-x-image-host.oss-cn-hangzhou.aliyuncs.com/markdown-imgs%E6%97%B6%E9%97%B4%E5%A4%84%E7%90%86%E6%A8%A1%E5%BC%8F.jpg",alt:"\u65f6\u95f4\u5904\u7406\u6a21\u5f0f"})),(0,a.kt)("p",null,"\u5efa\u8bae\u4f7f\u7528utc\u65f6\u95f4"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const moment = require("moment");\nmoment.locale("zh-cn");\n// \u5f97\u5230\u5f53\u524d\u65f6\u95f4\uff0cmoment\u5bf9\u8c61\nconsole.log(moment)//\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u91cc\u9762\u6709\u5f88\u591a\u65b9\u6cd5\nconsole.log(moment().toString());//Fri Nov 11 2022 18:42:52 GMT+0800 \u672c\u5730\u65f6\u95f4\nconsole.log(moment.utc().toString());//Fri Nov 11 2022 10:42:52 GMT+0000 UTC\u65f6\u95f4\n\n//\u5f97\u5230\u5f53\u524d\u65f6\u95f4\u6233\nconsole.log(moment().valueOf(), +moment());\nconsole.log(moment.utc().valueOf(), +moment.utc());//\u4e24\u4e2a\u7ed3\u679c\u662f\u4e00\u6837\u7684\uff0c\u548c\u4e0a\u4e00\u53e5\u7ed3\u679c\u4e5f\u662f\u4e00\u6837\u7684\u3002\u7528\u52a0\u53f7\u8f6c\u6570\u5b57\uff0c\u8981\u8c03\u7528valueof\u65b9\u6cd5\n\n//\u6839\u636e\u6307\u5b9a\u7684\u65f6\u95f4\u683c\u5f0f\u5f97\u5230\u65f6\u95f4\uff0c\u65f6\u95f4\u683c\u5f0f\uff1axxxx-xx-xx xxxx/xx/xx  \u65f6\u95f4\u6233\n//\u65f6\u95f4\u6233\u76f8\u540c\uff0c\u8f93\u51fa\u76f8\u540c\nconsole.log(moment(0).toString(), +moment(0));//Thu Jan 01 1970 08:00:00 GMT+0800 0\nconsole.log(moment.utc(0).toString(), +moment.utc(0));//Thu Jan 01 1970 08:00:00 GMT+0800 0\n//\u65f6\u95f4\u76f8\u540c\uff0c\u663e\u793a\u662f\u4e00\u6837\u7684\uff0c\u65f6\u95f4\u6233\u76f8\u5dee8\u5c0f\u65f6\nconst value = "1970-01-01 00:00:00";\nconsole.log(moment(value).toString(), +moment(value));//Thu Jan 01 1970 00:00:00 GMT+0800 -28800000\nconsole.log(moment.utc(value).toString(), +moment.utc(value));//Thu Jan 01 1970 00:00:00 GMT+0000 0\n\n//\u4f7f\u7528\u65e5\u671f\u4ee4\u724c\u8f6c\u6362\n//\u4ee4\u724c\u662f\u4e00\u4e2a\u683c\u5f0f\u5316\u7684\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982\uff1a "YYYY-MM-DD HH:mm:ss"\nconst formats = ["YYYY-MM-DD HH:mm:ss", "YYYY-M-D H:m:s", "x"];\n//\u7b2c\u4e09\u4e2a\u53c2\u6570\u4e3a\u662f\u5426\u4e25\u683c\u68c0\u67e5\nconsole.log(moment.utc("1970-01-01 00:00:00", formats, true).toString());//Thu Jan 01 1970 00:00:00 GMT+0000\nconsole.log(moment.utc("1970-1-1 0:0:0", formats, true).toString());//Thu Jan 01 1970 00:00:00 GMT+0000\nconsole.log(moment.utc(0, formats, true).toString());//Thu Jan 01 1970 00:00:00 GMT+0000\nconst invalidMoment = moment.utc(\n  "Thu Jan 01 1970 00:00:00 GMT+0000",\n  formats,\n  true\n);\n//\u5224\u65ad\u662f\u5426\u662f\u6709\u6548\u7684\u65e5\u671f\nconsole.log(invalidMoment.isValid()); // false\nconsole.log(invalidMoment.toString());//Invalid date\nconsole.log(+invalidMoment);//NaN\n\n// \u663e\u793a\uff08\u53d1\u751f\u5728\u5ba2\u6237\u7aef\uff09\n// const m = moment.utc("2015-1-5 23:00:01", formats, true);\n// console.log(m.local().format("YYYY\u5e74MM\u6708DD\u65e5 HH\u70b9mm\u5206ss\u79d2"));//2015\u5e7401\u670806\u65e5 07\u70b900\u520601\u79d2\n\n// const m = moment("2015-1-5 23:00:01", formats, true);\n// const toServer = m.utc().format("YYYY-MM-DD HH:mm:ss");\n// console.log(toServer);//2015-01-05 15:00:01\n\nconst m = moment.utc("2020-4-14 9:00:01", formats, true);\nconsole.log(m.local().fromNow());//3\u5e74\u524d\n\n')),(0,a.kt)("h2",{id:"10\u6570\u636e\u9a8c\u8bc1"},"10.\u6570\u636e\u9a8c\u8bc1"),(0,a.kt)("h3",{id:"\u6570\u636e\u9a8c\u8bc1\u7684\u4f4d\u7f6e"},"\u6570\u636e\u9a8c\u8bc1\u7684\u4f4d\u7f6e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u524d\u7aef\uff08\u5ba2\u6237\u7aef\uff09\uff1a\u4e3a\u4e86\u7528\u6237\u4f53\u9a8c"),(0,a.kt)("li",{parentName:"ul"},"\u8def\u7531\u5c42\uff1a\u9a8c\u8bc1\u63a5\u53e3\u683c\u5f0f\u662f\u5426\u6b63\u5e38"),(0,a.kt)("li",{parentName:"ul"},"\u4e1a\u52a1\u903b\u8f91\u5c42\uff1a\u4fdd\u8bc1\u4e1a\u52a1\u5b8c\u6574\u6027"),(0,a.kt)("li",{parentName:"ul"},"\u6570\u636e\u5e93\u9a8c\u8bc1\uff08\u7ea6\u675f\uff09\uff1a\u4fdd\u8bc1\u6570\u636e\u5b8c\u6574\u6027")),(0,a.kt)("h3",{id:"\u76f8\u5173\u5e93"},"\u76f8\u5173\u5e93"),(0,a.kt)("h4",{id:"validator"},"validator"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/validatorjs/validator.js"},"https://github.com/validatorjs/validator.js")),(0,a.kt)("p",null,"\u7528\u4e8e\u9a8c\u8bc1\u67d0\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u6ee1\u8db3\u67d0\u4e2a\u89c4\u5219"),(0,a.kt)("h4",{id:"validatejs"},"validate.js"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"http://validatejs.org/"},"http://validatejs.org/")),(0,a.kt)("p",null,"\u7528\u4e8e\u9a8c\u8bc1\u67d0\u4e2a\u5bf9\u8c61\u7684\u6811\u5f62\u662f\u5426\u6ee1\u8db3\u67d0\u4e9b\u89c4\u5219"),(0,a.kt)("h3",{id:"\u793a\u4f8b"},"\u793a\u4f8b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const Student = require("../models/Student");\nconst { Op } = require("sequelize");\nconst Class = require("../models/Class");\nconst validate = require("validate.js");\nconst moment = require("moment");\nconst { pick } = require("../util/propertyHelper");\nexports.addStudent = async function (stuObj) {\n  stuObj = pick(stuObj, "name", "birthday", "sex", "mobile", "ClassId");\n  console.log(stuObj)\n  //\u9a8c\u8bc1\u73ed\u7ea7id\n  validate.validators.classExits = async function (value) {\n    const c = await Class.findByPk(value);\n    if (c) {\n      return;\n    }\n    return "is not exist";\n  };\n\n  const rule = {\n    //\u9a8c\u8bc1\u89c4\u5219\n    name: {\n      presence: {\n        allowEmpty: false,//\u4e0d\u5141\u8bb8\u4e3a\u7a7a\n      },\n      type: "string",\n      length: {\n        minimum: 1,\n        maximum: 10,\n      },\n    },\n    birthday: {\n      presence: {\n        allowEmpty: false,\n      },\n      datetime: {\n        dateOnly: true,\n        earliest: +moment.utc().subtract(100, "y"),//\u6700\u65e9\u7684\u65f6\u95f4\uff0c\u8bbe\u7f6e\u4e3a100\u5e74\u524d\n        latest: +moment.utc().subtract(5, "y"),//\u6700\u665a\u7684\u65f6\u95f4\uff0c\u8bbe\u7f6e\u4e3a5\u5e74\u524d\n      },\n    },\n    sex: {\n      presence: true,\n      type: "boolean",\n    },\n    mobile: {\n      presence: {\n        allowEmpty: false,\n      },\n      format: /1\\d{10}/,\n    },\n    ClassId: {\n      presence: true,\n      numericality: {\n        onlyInteger: true,\n        strict: false,\n      },\n      classExits: true,\n    },\n  };\n  await validate.async(stuObj, rule);\n  const ins = await Student.create(stuObj);\n  return ins.toJSON();\n};\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"util/propertyHelper.js")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'exports.pick = function (obj, ...props) {\n  //\u6311\u9009\u6307\u5b9a\u7684\u5c5e\u6027\uff0c\u591a\u4f20\u7684\u5c5e\u6027\u8fc7\u6ee4\u6389\n  if (!obj || typeof obj !== "object") {\n    return obj;\n  }\n  const newObj = {};\n  for (const key in obj) {\n    if (props.includes(key)) {\n      newObj[key] = obj[key];\n    }\n  }\n  return newObj;\n};\n\n')),(0,a.kt)("p",null,"init.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const validate = require("validate.js");\nconst moment = require("moment");\n\nvalidate.extend(validate.validators.datetime, {\n  /**\n   * \u8be5\u51fd\u6570\u4f1a\u81ea\u52a8\u7528\u4e8e\u65e5\u671f\u683c\u5f0f\u8f6c\u6362\n   * \u5b83\u4f1a\u5728\u9a8c\u8bc1\u65f6\u81ea\u52a8\u89e6\u53d1\uff0c\u5b83\u9700\u8981\u5c06\u4efb\u4f55\u6570\u636e\u8f6c\u6362\u4e3a\u65f6\u95f4\u6233\u8fd4\u56de\n   * \u5982\u679c\u65e0\u6cd5\u8f6c\u6362\uff0c\u8fd4\u56deNaN\n   * @param {*} value \u4f20\u5165\u8981\u8f6c\u6362\u7684\u503c\n   * @param {*} options \u9488\u5bf9\u67d0\u4e2a\u5c5e\u6027\u7684\u9a8c\u8bc1\u914d\u7f6e\n   */\n  parse(value, options) {\n    let formats = ["YYYY-MM-DD HH:mm:ss", "YYYY-M-D H:m:s", "x"];\n    if (options.dateOnly) {//\u4e0d\u9700\u8981\u5c0f\u65f6\u5206\u949f\u79d2\n      formats = ["YYYY-MM-DD", "YYYY-M-D", "x"];\n    }\n    return +moment.utc(value, formats, true);//\u8f6c\u6210\u65f6\u95f4\u6233\n  },\n  /**\n   * \u7528\u6237\u663e\u793a\u9519\u8bef\u6d88\u606f\u65f6\uff0c\u4f7f\u7528\u7684\u663e\u793a\u5b57\u7b26\u4e32\n   */\n  format(value, options) {\n    //value\u662f\u65f6\u95f4\u6233\n    let format = "YYYY-MM-DD";\n    if (!options.dateOnly) {\n      format += " HH:mm:ss";\n    }\n    return moment.utc(value).format(format);\n  },\n});\n\n')),(0,a.kt)("p",null,"index.js"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'require("./services/init");\nconst stuServ = require("./services/studentService");\nstuServ\n  .addStudent({\n    name: "adfd",\n    birthday: "2020-3-5",\n    sex: true,\n    mobile: "15454545444",\n    ClassId: 3,\n    deletedAt: "2010-1-1",\n    a: 3,\n    b: 4,\n  })\n  .catch((err) => {\n    console.log(err);\n  });\n')),(0,a.kt)("h2",{id:"11\u8bbf\u95ee\u5668\u548c\u865a\u62df\u5b57\u6bb5"},"11.\u8bbf\u95ee\u5668\u548c\u865a\u62df\u5b57\u6bb5"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/core-concepts/getters-setters-virtuals.md#%E8%99%9A%E6%8B%9F%E5%AD%97%E6%AE%B5"},"https://github.com/demopark/sequelize-docs-Zh-CN/blob/master/core-concepts/getters-setters-virtuals.md#%E8%99%9A%E6%8B%9F%E5%AD%97%E6%AE%B5")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'module.exports = sequelize.define(\n  "Student",\n  {\n    name: {\n      type: DataTypes.STRING,\n      allowNull: false,\n    },\n    birthday: {\n      type: DataTypes.DATE,\n      allowNull: false,\n      //\u8bbf\u95ee\u5668\n      get() {\n        return this.getDataValue("birthday").getTime();//\u8fd4\u56de\u65f6\u95f4\u6233\n      },\n    },\n    //\u865a\u62df\u5b57\u6bb5\n    age: {\n      type: DataTypes.VIRTUAL,\n      get() {\n        const now = moment.utc();\n        const birth = moment.utc(this.birthday);\n        return now.diff(birth, "y"); //\u5f97\u5230\u4e24\u4e2a\u65e5\u671f\u7684\u5e74\u4efd\u7684\u5dee\u5f02\n      },\n    },\n    sex: {\n      type: DataTypes.BOOLEAN,\n      allowNull: false,\n    },\n    mobile: {\n      type: DataTypes.STRING(11),\n      allowNull: false,\n    },\n  },\n  {\n    createdAt: false,\n    updatedAt: false,\n    paranoid: true,\n  }\n);\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'//service\u4e2d\u52a0\u4e0aage\nconst result = await Student.findAndCountAll({\n    attributes: ["id", "name", "sex", "birthday", "age"],\n    where,\n    include: [Class],\n    offset: (page - 1) * limit,\n    limit: +limit,\n  });\n')),(0,a.kt)("h2",{id:"12-\u65e5\u5fd7\u8bb0\u5f55"},"12. \u65e5\u5fd7\u8bb0\u5f55"),(0,a.kt)("h3",{id:"log4js"},"log4js"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://log4js-node.github.io/log4js-node/"},"https://log4js-node.github.io/log4js-node/")),(0,a.kt)("h3",{id:"\u6982\u5ff5-1"},"\u6982\u5ff5"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"level\uff1a\u65e5\u5fd7\u7ea7\u522b",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4f8b\u5982\u8c03\u8bd5\u65e5\u5fd7\u3001\u4fe1\u606f\u65e5\u5fd7\u3001\u9519\u8bef\u65e5\u5fd7\u7b49\u7b49"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("img",{src:"https://october-x-image-host.oss-cn-hangzhou.aliyuncs.com/markdown-imgslog%E7%AD%89%E7%BA%A7.jpg",alt:"log\u7b49\u7ea7",width:"500"})))),(0,a.kt)("li",{parentName:"ul"},"category\uff1a\u65e5\u5fd7\u5206\u7c7b",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u4f8b\u5982\uff1asql\u65e5\u5fd7\u3001\u8bf7\u6c42\u65e5\u5fd7\u7b49\u7b49"))),(0,a.kt)("li",{parentName:"ul"},"appender\uff1a\u65e5\u5fd7\u51fa\u53e3",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u5e94\u8be5\u628a\u65e5\u5fd7\u5199\u5230\u54ea\uff1f"),(0,a.kt)("li",{parentName:"ul"},"\u65e5\u5fd7\u7684\u4e66\u5199\u683c\u5f0f\u662f\u4ec0\u4e48\uff08layouts\uff09")))),(0,a.kt)("p",null,"\u5206\u7c7b1\uff1a"),(0,a.kt)("p",null,"\u540d\u79f0\uff1asql\uff0c\u4f7f\u7528\u51fa\u53e3sql"),(0,a.kt)("p",null,"\u51fa\u53e3\uff1a\u51fa\u53e3\u540d\u79f0\uff1asql\uff0c\u5199\u5165\u5230\u6587\u4ef6"),(0,a.kt)("h3",{id:"\u7ec3\u4e60-1"},"\u7ec3\u4e60"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const log4js = require("log4js");\nconst path = require("path");\n\nlog4js.configure({\n  appenders: {\n    sql: {\n      //\u5b9a\u4e49\u4e00\u4e2asql\u65e5\u5fd7\u51fa\u53e3\n      type: "dateFile",//\u8bbe\u7f6e\u4e3a\u65e5\u671f\u6587\u4ef6\uff0c\u540e\u7f00\u52a0\u4e0a\u65e5\u671f\uff0c\u4e0b\u9762\u8981\u8bbe\u7f6e\u4fdd\u7559\u6587\u4ef6\u540e\u7f00\n      filename: path.resolve(__dirname, "logs", "sql", "logging.log"),\n\n      //\u6587\u4ef6\u5206\u5272\n      maxLogSize: 1024 * 1024, //\u914d\u7f6e\u6587\u4ef6\u7684\u6700\u5927\u5b57\u8282\u6570\n      keepFileExt: true,//\u4fdd\u7559\u6587\u4ef6\u540e\u7f00\n\n      //\u8bbe\u7f6e\u65e5\u5fd7\u7684\u4fdd\u7559\u5929\u6570\n      // dayskeep:1,\n\n      layout: {\n        type: "pattern",\n        pattern: "%c [%d{yyyy-MM-dd hh:mm:ss}] [%p]: %m%n",\n      },\n    },\n    //\u9ed8\u8ba4\u65e5\u5fd7\u653e\u5728\u63a7\u5236\u53f0\u8f93\u51fa\n    default: {\n      type: "stdout",\n    },\n  },\n  categories: {\n    sql: {\n      appenders: ["sql"], //\u8be5\u5206\u7c7b\u4f7f\u7528\u51fa\u53e3sql\u7684\u914d\u7f6e\u5199\u5165\u65e5\u5fd7\n      level: "all",\n    },\n    default: {\n      appenders: ["default"],\n      level: "all",\n    },\n  },\n});\n\nprocess.on("exit", () => {\n  log4js.shutdown();//\u4f1a\u628a\u6ca1\u6709\u8bb0\u5f55\u5b8c\u65e5\u5fd7\u7684\uff0c\u8bb0\u5f55\u5b8c\n});\n\nconst sqlLogger = log4js.getLogger("sql");\n//\u9ed8\u8ba4\u65e5\u5fd7\nconst defaultLogger = log4js.getLogger();\n\nexports.sqlLogger = sqlLogger;\nexports.logger = defaultLogger;\n')),(0,a.kt)("h3",{id:"\u4f7f\u7528-1"},"\u4f7f\u7528"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const { Sequelize } = require("sequelize");\nconst { sqlLogger } = require("../logger");\nconst sequelize = new Sequelize("myschooldb", "root", "ybybdwyJ42.", {\n  host: "localhost",\n  dialect: "mysql",\n  logging: (msg) => {\n    sqlLogger.debug(msg);\n  },\n});\n\nmodule.exports = sequelize;\n\n')))}p.isMDXComponent=!0}}]);