"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6512],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>k});var l=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,l,o=function(e,n){if(null==e)return{};var t,l,o={},r=Object.keys(e);for(l=0;l<r.length;l++)t=r[l],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(l=0;l<r.length;l++)t=r[l],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var p=l.createContext({}),i=function(e){var n=l.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},c=function(e){var n=i(e.components);return l.createElement(p.Provider,{value:n},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return l.createElement(l.Fragment,{},n)}},d=l.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,p=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),m=i(t),d=o,k=m["".concat(p,".").concat(d)]||m[d]||u[d]||r;return t?l.createElement(k,s(s({ref:n},c),{},{components:t})):l.createElement(k,s({ref:n},c))}));function k(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,s=new Array(r);s[0]=d;var a={};for(var p in n)hasOwnProperty.call(n,p)&&(a[p]=n[p]);a.originalType=e,a[m]="string"==typeof e?e:o,s[1]=a;for(var i=2;i<r;i++)s[i]=t[i];return l.createElement.apply(null,s)}return l.createElement.apply(null,t)}d.displayName="MDXCreateElement"},1835:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>a,toc:()=>i});var l=t(7462),o=(t(7294),t(3905));const r={sidebar_position:3},s="Promise\u7684\u7528\u6cd5&\u539f\u7406&\u624b\u5199\u5b9e\u73b0",a={unversionedId:"js/Promise\u7684\u7528\u6cd5&\u539f\u7406&\u624b\u5199\u5b9e\u73b0",id:"js/Promise\u7684\u7528\u6cd5&\u539f\u7406&\u624b\u5199\u5b9e\u73b0",title:"Promise\u7684\u7528\u6cd5&\u539f\u7406&\u624b\u5199\u5b9e\u73b0",description:"---",source:"@site/docs/js/Promise\u7684\u7528\u6cd5&\u539f\u7406&\u624b\u5199\u5b9e\u73b0.md",sourceDirName:"js",slug:"/js/Promise\u7684\u7528\u6cd5&\u539f\u7406&\u624b\u5199\u5b9e\u73b0",permalink:"/docs/js/Promise\u7684\u7528\u6cd5&\u539f\u7406&\u624b\u5199\u5b9e\u73b0",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/js/Promise\u7684\u7528\u6cd5&\u539f\u7406&\u624b\u5199\u5b9e\u73b0.md",tags:[],version:"current",frontMatter:{},sidebar:"js",previous:{title:"ES6",permalink:"/docs/js/ES6"}},p={},i=[{value:"1. promise \u5165\u95e8\u7b80\u4ecb",id:"1-promise-\u5165\u95e8\u7b80\u4ecb",level:2},{value:"1.1 JS \u4e2d\u5206\u540c\u6b65Api \u548c \u5f02\u6b65Api\u3002",id:"11-js-\u4e2d\u5206\u540c\u6b65api-\u548c-\u5f02\u6b65api",level:3},{value:"1.2 \u540c\u6b65API, \u5f02\u6b65API\u7684\u533a\u522b\uff08 \u83b7\u53d6\u8fd4\u56de\u503c \uff09",id:"12-\u540c\u6b65api-\u5f02\u6b65api\u7684\u533a\u522b-\u83b7\u53d6\u8fd4\u56de\u503c-",level:3},{value:"1.3 \u56de\u8c03\u51fd\u6570",id:"13-\u56de\u8c03\u51fd\u6570",level:3},{value:"1.4\u4ee3\u7801\u6267\u884c\u987a\u5e8f\u5206\u6790",id:"14\u4ee3\u7801\u6267\u884c\u987a\u5e8f\u5206\u6790",level:3},{value:"1.5 JS \u5e38\u89c1\u5f02\u6b65\u7f16\u7a0b",id:"15-js-\u5e38\u89c1\u5f02\u6b65\u7f16\u7a0b",level:3},{value:"1.6 Promise \u51fa\u73b0\u7684\u9700\u6c42",id:"16-promise-\u51fa\u73b0\u7684\u9700\u6c42",level:3},{value:"2. Promise \u5e38\u89c1\u5e38\u89c1\u7ec3\u4e60\uff0c\u5bf9Promise \u6709\u66f4\u597d\u7684\u719f\u6089\u611f",id:"2-promise-\u5e38\u89c1\u5e38\u89c1\u7ec3\u4e60\u5bf9promise-\u6709\u66f4\u597d\u7684\u719f\u6089\u611f",level:2},{value:"2.1 promise \u5b9e\u8df5\u7ec3\u4e60-fs\u8bfb\u53d6\u6587\u4ef6",id:"21-promise-\u5b9e\u8df5\u7ec3\u4e60-fs\u8bfb\u53d6\u6587\u4ef6",level:3},{value:"2.2 promise \u5b9e\u8df5\u7ec3\u4e60-AJAX\u8bf7\u6c42",id:"22-promise-\u5b9e\u8df5\u7ec3\u4e60-ajax\u8bf7\u6c42",level:3},{value:"2.3 util.promisify \u65b9\u6cd5\u8fdb\u884c promise \u98ce\u683c\u8f6c\u5316",id:"23-utilpromisify-\u65b9\u6cd5\u8fdb\u884c-promise-\u98ce\u683c\u8f6c\u5316",level:3},{value:"2.4 promise \u5c01\u88c5\u7ec3\u4e60-AJAX\u8bf7\u6c42",id:"24-promise-\u5c01\u88c5\u7ec3\u4e60-ajax\u8bf7\u6c42",level:3},{value:"3. promise \u7684\u8be6\u7ec6\u4ecb\u7ecd",id:"3-promise-\u7684\u8be6\u7ec6\u4ecb\u7ecd",level:2},{value:"3.1 promise \u7684\u72b6\u6001",id:"31-promise-\u7684\u72b6\u6001",level:3},{value:"3.2. promise \u5bf9\u8c61\u7684\u503c",id:"32-promise-\u5bf9\u8c61\u7684\u503c",level:3},{value:"3.3 promise \u7684\u57fa\u672c\u6d41\u7a0b",id:"33-promise-\u7684\u57fa\u672c\u6d41\u7a0b",level:3},{value:"3.4 promise Api \u7684\u8be6\u7ec6\u4ecb\u7ecd",id:"34-promise-api-\u7684\u8be6\u7ec6\u4ecb\u7ecd",level:3},{value:"3.4.1 Promise \u6784\u9020\u51fd\u6570\uff1aPromise(executor)",id:"341-promise-\u6784\u9020\u51fd\u6570promiseexecutor",level:4},{value:"3.4.2 Promise.prototype.then \u65b9\u6cd5 (onResolved, onRejected) =&gt; {}",id:"342-promiseprototypethen-\u65b9\u6cd5-onresolved-onrejected--",level:4},{value:"3.4.3 Promise.catch \u65b9\u6cd5\uff1a(reason) =&gt; {}",id:"343-promisecatch-\u65b9\u6cd5reason--",level:4},{value:"3.4.4 Promise.resolve \u65b9\u6cd5\uff1a(value) =&gt; {}",id:"344-promiseresolve-\u65b9\u6cd5value--",level:4},{value:"3.4.5 Promise.reject \u65b9\u6cd5\uff1a(reason) =&gt; {}",id:"345-promisereject-\u65b9\u6cd5reason--",level:4},{value:"3.4.6 Promise.all \u65b9\u6cd5\uff1a(promises) =&gt; {}",id:"346-promiseall-\u65b9\u6cd5promises--",level:4},{value:"3.4.7 Promise.race \u65b9\u6cd5\uff1a(promises) =&gt; {}",id:"347-promiserace-\u65b9\u6cd5promises--",level:4},{value:"4. promise \u7684\u51e0\u4e2a\u5173\u952e\u95ee\u9898",id:"4-promise-\u7684\u51e0\u4e2a\u5173\u952e\u95ee\u9898",level:2},{value:"5. \u624b\u5199 Promise",id:"5-\u624b\u5199-promise",level:2},{value:"5.1 \u5b9a\u4e49\u6574\u4f53\u7ed3\u6784",id:"51-\u5b9a\u4e49\u6574\u4f53\u7ed3\u6784",level:3},{value:"5.2 \u5c01\u88c5 resolve \u548c reject \u7ed3\u6784",id:"52-\u5c01\u88c5-resolve-\u548c-reject-\u7ed3\u6784",level:3},{value:"5.3 resolve \u548c reject \u4ee3\u7801\u7684\u5b9e\u73b0",id:"53-resolve-\u548c-reject-\u4ee3\u7801\u7684\u5b9e\u73b0",level:3},{value:"5.4 throw \u629b\u51fa\u5f02\u5e38\u6539\u53d8\u72b6\u6001",id:"54-throw-\u629b\u51fa\u5f02\u5e38\u6539\u53d8\u72b6\u6001",level:3},{value:"5.5 promise \u5bf9\u8c61\u72b6\u6001\u53ea\u80fd\u4fee\u6539\u4e00\u6b21",id:"55-promise-\u5bf9\u8c61\u72b6\u6001\u53ea\u80fd\u4fee\u6539\u4e00\u6b21",level:3},{value:"5.6 then\u65b9\u6cd5\u6267\u884c\u56de\u8c03",id:"56-then\u65b9\u6cd5\u6267\u884c\u56de\u8c03",level:3},{value:"5.7 \u5f02\u6b65\u4efb\u52a1\u56de\u8c03\u7684\u6267\u884c",id:"57-\u5f02\u6b65\u4efb\u52a1\u56de\u8c03\u7684\u6267\u884c",level:3},{value:"5.8 \u6307\u5b9a\u591a\u4e2a\u56de\u8c03\u7684\u5b9e\u73b0",id:"58-\u6307\u5b9a\u591a\u4e2a\u56de\u8c03\u7684\u5b9e\u73b0",level:3},{value:"5.9 \u540c\u6b65\u4fee\u6539\u72b6\u6001 then \u65b9\u6cd5\u7ed3\u679c\u8fd4\u56de",id:"59-\u540c\u6b65\u4fee\u6539\u72b6\u6001-then-\u65b9\u6cd5\u7ed3\u679c\u8fd4\u56de",level:3},{value:"5.10 \u5f02\u6b65\u4fee\u6539\u72b6\u6001 then \u65b9\u6cd5\u8fd4\u56de",id:"510-\u5f02\u6b65\u4fee\u6539\u72b6\u6001-then-\u65b9\u6cd5\u8fd4\u56de",level:3},{value:"5.11 catch\u65b9\u6cd5-\u5f02\u5e38\u7a7f\u900f\u4e0e\u503c\u4f20\u9012",id:"511-catch\u65b9\u6cd5-\u5f02\u5e38\u7a7f\u900f\u4e0e\u503c\u4f20\u9012",level:3},{value:"5.12 resolve \u65b9\u6cd5\u5c01\u88c5",id:"512-resolve-\u65b9\u6cd5\u5c01\u88c5",level:3},{value:"5.13 all \u65b9\u6cd5\u5c01\u88c5",id:"513-all-\u65b9\u6cd5\u5c01\u88c5",level:3},{value:"5.14 then \u65b9\u6cd5 \u56de\u8c03\u7684\u5f02\u6b65\u6267\u884c",id:"514-then-\u65b9\u6cd5-\u56de\u8c03\u7684\u5f02\u6b65\u6267\u884c",level:3},{value:"\u603b\u7ed3\u5206\u6790\uff1a",id:"\u603b\u7ed3\u5206\u6790",level:3},{value:"\u672c\u8d28\uff1a",id:"\u672c\u8d28",level:3},{value:"6. Promisification",id:"6-promisification",level:2},{value:"7. \u7b80\u4ecb async await",id:"7-\u7b80\u4ecb-async-await",level:2},{value:"7.1 async",id:"71-async",level:3},{value:"7.2 await",id:"72-await",level:3},{value:"7.3 \u5b9e\u9645\u6848\u4f8b1",id:"73-\u5b9e\u9645\u6848\u4f8b1",level:3},{value:"7.4 \u5b9e\u9645\u6848\u4f8b2",id:"74-\u5b9e\u9645\u6848\u4f8b2",level:3}],c={toc:i};function m(e){let{components:n,...t}=e;return(0,o.kt)("wrapper",(0,l.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"promise\u7684\u7528\u6cd5\u539f\u7406\u624b\u5199\u5b9e\u73b0"},"Promise\u7684\u7528\u6cd5&\u539f\u7406&\u624b\u5199\u5b9e\u73b0"),(0,o.kt)("h2",{id:"1-promise-\u5165\u95e8\u7b80\u4ecb"},"1. promise \u5165\u95e8\u7b80\u4ecb"),(0,o.kt)("p",null,"Promise \u662f\u7528\u6765\u89e3\u51b3\u5f02\u6b65\u7f16\u7a0b\u7684\u95ee\u9898\u3002"),(0,o.kt)("h3",{id:"11-js-\u4e2d\u5206\u540c\u6b65api-\u548c-\u5f02\u6b65api"},"1.1 JS \u4e2d\u5206\u540c\u6b65Api \u548c \u5f02\u6b65Api\u3002"),(0,o.kt)("p",null,"\u540c\u6b65API\uff1a\u53ea\u6709\u5f53\u524dAPI\u6267\u884c\u5b8c\u6210\u540e\uff0c\u624d\u80fd\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u4e2aAPI"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"for (let i = 0; i < 10000; i++) {\n    console.log(i);\n}\nconsole.log('\u540c\u6b65\u4ee3\u7801\u6267\u884c');\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u53ea\u6709\u4e0a\u9762\u4e00\u4e07\u884c\u6570\u503c\u6253\u5370\u5b8c\uff0c\u624d\u4f1a\u6253\u5370\u2019\u540c\u6b65\u4ee3\u7801\u6267\u884c\u2019")),(0,o.kt)("p",null,"\u5f02\u6b65API\uff1a\u5f53\u524dAPI\u7684\u6267\u884c\u4e0d\u4f1a\u963b\u585e\u540e\u7eed\u4ee3\u7801\u7684\u6267\u884c"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"console.log('before');\nsetTimeout(\n   () => { console.log('last');\n}, 2000);\nconsole.log('after');\n")),(0,o.kt)("p",null,"setTimeout\u5b9a\u65f6\u5668\u8981\u57282s\u79d2\u540e\u624d\u6267\u884c\uff0cjs\u5f15\u64ce\u4e0d\u4f1a\u5361\u5728\u5b9a\u65f6\u5668\u8fd9\uff0c\u4f1a\u5148\u6267\u884c\u540c\u6b65\u4ee3\u7801\uff0c\u7b49\u540c\u6b65\u4ee3\u7801\u6267\u884c\u5b8c\u518d\u6267\u884c\u5f02\u6b65\u4ee3\u7801\u5b9a\u65f6\u5668(\u5728\u8fd9\u53ea\u9700\u8981\u5148\u8bb0\u4f4f\u5b9a\u65f6\u5668\u662f\u5f02\u6b65\u4ee3\u7801)"),(0,o.kt)("h3",{id:"12-\u540c\u6b65api-\u5f02\u6b65api\u7684\u533a\u522b-\u83b7\u53d6\u8fd4\u56de\u503c-"},"1.2 \u540c\u6b65API, \u5f02\u6b65API\u7684\u533a\u522b\uff08 \u83b7\u53d6\u8fd4\u56de\u503c \uff09"),(0,o.kt)("p",null,"\u540c\u6b65API\u53ef\u4ee5\u4ece\u8fd4\u56de\u503c\u4e2d\u62ff\u5230API\u6267\u884c\u7684\u7ed3\u679c, \u4f46\u662f\u5f02\u6b65API\u662f\u4e0d\u53ef\u4ee5\u7684"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u540c\u6b65\uff1a")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// \u540c\u6b65\nfunction sum (n1, n2) { \n    return n1 + n2;\n} \nconst result = sum(10, 20); // result \u503c\u4e3a 30\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u5f02\u6b65\uff1a")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function getMsg () { \n    setTimeout(function () { \n        return { msg: 'Hello Node.js' }\n    }, 2000);\n}\nconst msg = getMsg(); // msg \u7684\u503c\u662f undefined\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u6240\u4ee5\u5f02\u6b65\u51fd\u6570\u6ca1\u6cd5\u7528\u8fd4\u56de\u503c\u83b7\u53d6\u503c")),(0,o.kt)("h3",{id:"13-\u56de\u8c03\u51fd\u6570"},"1.3 \u56de\u8c03\u51fd\u6570"),(0,o.kt)("p",null,"\u81ea\u5df1\u5b9a\u4e49\u51fd\u6570\u8ba9\u522b\u4eba\u53bb\u8c03\u7528\u3002"),(0,o.kt)("p",null,"\u4f7f\u7528\u56de\u8c03\u51fd\u6570\u53ef\u4ee5\u83b7\u53d6\u5f02\u6b65API\u6267\u884c\u7ed3\u679c"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function getMsg (callback) {\n    setTimeout(() => {\n        let a = '\u5f02\u6b65\u51fd\u6570\u7ed3\u679c'\n        callback(a)\n    }, 2000)\n}\n\ngetMsg((result) => {\n    console.log(result); // \u5f02\u6b65\u51fd\u6570\u7ed3\u679c\n})\n")),(0,o.kt)("h3",{id:"14\u4ee3\u7801\u6267\u884c\u987a\u5e8f\u5206\u6790"},"1.4\u4ee3\u7801\u6267\u884c\u987a\u5e8f\u5206\u6790"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"console.log('\u4ee3\u7801\u5f00\u59cb\u6267\u884c');\nsetTimeout(() => {\n    console.log('2\u79d2\u540e\u6267\u884c\u7684\u4ee3\u7801');\n}, 2000);\nsetTimeout(() => {\n    console.log('0\u79d2\u540e\u6267\u884c\u7684\u4ee3\u7801');\n}, 0)\nconsole.log('\u4ee3\u7801\u7ed3\u675f\u6267\u884c')\n")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/7d47cf1c17b14613a4bb8daf40469766.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAaGFuZ2FvMjMz,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u5f02\u6b65\u4ee3\u7801\u6267\u884c\u533a\u7684\u5f02\u6b65\u51fd\u6570\u6267\u884c\u5b8c\u6210\uff0c\u5c06\u8981\u6267\u884c\u4e13\u5c5e\u7684\u56de\u8c03\u51fd\u6570\u65f6\uff0c\u5c31\u4f1a\u5c06\u56de\u8c03\u51fd\u6570\u653e\u5165\u56de\u8c03\u51fd\u6570\u961f\u5217\uff0c\u7b49\u540c\u6b65\u4ee3\u7801\u6267\u884c\u533a\u7684\u4ee3\u7801\u6267\u884c\u5b8c\u6210\u540e\uff0c\u5c31\u628a\u56de\u8c03\u51fd\u6570\u961f\u5217\u7684\u56de\u8c03\u51fd\u6570\u52a0\u5165\u540c\u6b65\u4ee3\u7801\u6267\u884c\u533a\u3002")),(0,o.kt)("h3",{id:"15-js-\u5e38\u89c1\u5f02\u6b65\u7f16\u7a0b"},"1.5 JS \u5e38\u89c1\u5f02\u6b65\u7f16\u7a0b"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"fs \u6587\u4ef6\u64cd\u4f5c"),(0,o.kt)("li",{parentName:"ul"},"\u6570\u636e\u5e93\u64cd\u4f5c"),(0,o.kt)("li",{parentName:"ul"},"AJAX \u7f51\u7edc\u8bf7\u6c42"),(0,o.kt)("li",{parentName:"ul"},"\u5b9a\u65f6\u5668 \uff08setTimeout\uff09")),(0,o.kt)("h3",{id:"16-promise-\u51fa\u73b0\u7684\u9700\u6c42"},"1.6 Promise \u51fa\u73b0\u7684\u9700\u6c42"),(0,o.kt)("p",null,"\u6211\u4eec\u5148\u6765\u4e2a\u573a\u666f\uff1a"),(0,o.kt)("p",null,"\u73b0\u5728\u9700\u8981\u7528 fs \u6587\u4ef6\u64cd\u4f5c \u8bfb\u53d6\u6587\u4ef6\uff0c\u4f46\u8bfb\u53d6\u6587\u4ef6\u7684\u987a\u5e8f\u5fc5\u987b\u662f\u5148\u8bfbA\uff0c\u518d\u8bfbB\uff0c\u518d\u8bfbC\u3002"),(0,o.kt)("p",null,"\u56e0\u4e3a fs \u6587\u4ef6\u64cd\u4f5c\u662f\u5f02\u6b65\u7684\uff0c\u6ca1\u529e\u6cd5\u5199\u6210\u540c\u6b65\u4ee3\u7801\u90a3\u6837\uff0c\u6309\u987a\u5e8f\u5982\u4e0b"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u5047\u8bbe fs \u6587\u4ef6\u64cd\u4f5c \u662f \u540c\u6b65\u7684")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const fs = require('fs')\n\nfs.readFile('a.txt');\nfs.readFile('b.txt');\nfs.readFile('c.txt');\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u4f46 fs\u6587\u4ef6\u64cd\u4f5c \u662f\u5f02\u6b65\u7f16\u7a0b\uff0c \u8981\u6309\u7167\u987a\u5e8f\u8bfb\u53d6\u7684\u8bdd\u5c31\u4e0d\u80fd\u5199\u6210\u540c\u6b65\u4ee3\u7801\u7684\u5f62\u5f0f\uff0c\u53ea\u80fd\u8fd9\u6837\u5199\uff1a")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const fs = require('fs')\n\nfs.readFile('a.txt', (err, data) => {\n    console.log('\u7b2c\u4e00\u4e2a\u6267\u884c', data);\n    fs.readFile('b.txt', (err, data) => {\n        console.log('\u7b2c\u4e8c\u4e2a\u6267\u884c', data);\n        fs.readFile('c.txt', (err, data) => {\n            console.log(data);\n        })\n    })\n})\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u8fde\u7eed\u5d4c\u5957\u7740\u7684\u56de\u8c03\u51fd\u6570\u53ef\u8bfb\u6027\u975e\u5e38\u5dee\uff0c\u4e5f\u79f0\u4e3a\u56de\u8c03\u5730\u72f1")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Promise\u51fa\u73b0\u7684\u76ee\u7684\u662f\u89e3\u51b3Node.js\u5f02\u6b65\u7f16\u7a0b\u4e2d\u56de\u8c03\u5730\u72f1\u7684\u95ee\u9898\u3002")),(0,o.kt)("p",null,"\u5148\u6765\u4e00\u4e2aPromise \u6848\u4f8b\uff0c\u6709\u4e2a\u611f\u6027\u7684\u8ba4\u8bc6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// resolve \u89e3\u51b3\n// reject \u62d2\u7edd\n// promise \u7684\u6267\u884c\u6d41\u7a0b\u5982\u4e0b\uff1a\n// promise \u63a5\u6536\u7684\u53c2\u6570\u662f\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u56de\u8c03\u51fd\u6570\u6709\u4e24\u4e2a\u53c2\u6570\uff0cresolve\u548c reject\uff0c\u5728\u8fd9\u4e2a\u56de\u8c03\u51fd\u6570\u5185\u90e8\u5305\u88f9\u4e00\u4e2a\u5f02\u6b65\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u5f02\u6b65\u64cd\u4f5c\u6210\u529f\u5c31\u8c03\u7528resolve\u51fd\u6570\uff0c\u5931\u8d25\u5c31\u8c03\u7528 reject\n// promise \u53ef\u4ee5\u8fdb\u884c\u94fe\u5f0f\u8c03\u7528\uff0cpromise.then() \u662f\u5bf9\u8c61\u6210\u529f\u7684\u56de\u8c03\uff0c promise.catch() \u662f\u5bf9\u8c61\u5931\u8d25\u7684\u56de\u8c03\nlet promise = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        if (true) {\n            resolve({name: 'aaaaa'}) // \u5c06 promise \u5bf9\u8c61\u7684\u72b6\u6001\u8bbe\u7f6e\u4e3a \u6210\u529f\n        } else {\n            reject('\u5931\u8d25\u4e86') // \u5c06 promise \u5bf9\u8c61\u7684\u72b6\u6001\u8bbe\u7f6e\u4e3a \u5931\u8d25\n        }\n    }, 2000);\n});\n\npromise.then(result => {\n    console.log(result);\n}).catch( err => {\n    console.log(err);\n})\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u5148\u5c55\u793a promise \u89e3\u51b3\u56de\u8c03\u5730\u72f1\u7684\u95ee\u9898\uff0c\u540e\u9762\u4f1a\u8be6\u7ec6\u4ecb\u7ecdpromise\u3002")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Promise\u89e3\u51b3 \u6309\u987a\u5e8f\u8bfb\u53d6A\u6587\u4ef6\uff0cB\u6587\u4ef6\uff0cC\u6587\u4ef6 \u7684\u56de\u8c03\u5730\u72f1\u95ee\u9898"),"\uff1a"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u5148\u6709\u4e2a\u611f\u6027\u7684\u8ba4\u8bc6")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const fs = require('fs')\n\nlet p1 = new Promise((resolve, reject) => {\n    fs.readFile('a.txt', 'utf-8', (err, data) => {\n        resolve(data)\n    })\n})\n\nlet p2 = new Promise((resolve, reject) => {\n    fs.readFile('b.txt', 'utf-8', (err, data) => {\n        resolve(data)\n    })\n})\n\nlet p3 = new Promise((resolve, reject) => {\n    fs.readFile('c.txt', 'utf-8', (err, data) => {\n        resolve(data)\n    })\n})\n\np1.then(r1 => {\n    console.log(r1);\n    return p2;\n}).then(r2 => {\n    console.log(r2);\n    return p3;\n}).then(r3 => {\n    console.log(r3);\n})\n")),(0,o.kt)("h2",{id:"2-promise-\u5e38\u89c1\u5e38\u89c1\u7ec3\u4e60\u5bf9promise-\u6709\u66f4\u597d\u7684\u719f\u6089\u611f"},"2. Promise \u5e38\u89c1\u5e38\u89c1\u7ec3\u4e60\uff0c\u5bf9Promise \u6709\u66f4\u597d\u7684\u719f\u6089\u611f"),(0,o.kt)("h3",{id:"21-promise-\u5b9e\u8df5\u7ec3\u4e60-fs\u8bfb\u53d6\u6587\u4ef6"},"2.1 promise \u5b9e\u8df5\u7ec3\u4e60-fs\u8bfb\u53d6\u6587\u4ef6"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// \u4e0d\u4f7f\u7528 promise\nconst fs = require('fs');\n\nfs.readFile('./test.txt', (err, data) => {\n    // \u51fa\u9519\uff0c\u629b\u51fa\u9519\u8bef\n    if (err) throw err;\n    console.log(data.toString());\n})\n\n// \u4f7f\u7528 Promise \u5305\u88f9\nlet promise = new Promise((resolve, reject) => {\n    fs.readFile('./test.txt', (err, data) => {\n        if (err) reject(err);\n        resolve(data.toString());\n    })\n})\n\n// \u8c03\u7528 promise \u5c01\u88c5\u7684\u5f02\u6b65\u51fd\u6570\npromise.then(result => {\n    console.log(result);\n})\n")),(0,o.kt)("h3",{id:"22-promise-\u5b9e\u8df5\u7ec3\u4e60-ajax\u8bf7\u6c42"},"2.2 promise \u5b9e\u8df5\u7ec3\u4e60-AJAX\u8bf7\u6c42"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// \u539f\u751f\nconst btn = document.querySelector('#btn');\nbtn.addEventListener(\"click\", () => {\n    // \u521b\u5efa\u5bf9\u8c61\n    const xhr = new XMLHttpRequest();\n    // \u521d\u59cb\u5316\n    xhr.open('GET', 'https://api.apiopen.top/getJoke');\n    // \u53d1\u9001\n    xhr.send();\n    // \u5904\u7406\u54cd\u5e94\u7ed3\u679c\n    xhr.onreadystatechange = function () {\n        if (xhr.readyState === 4) {\n            // \u5224\u65ad\u54cd\u5e94\u72b6\u6001\u7801\n            if (xhr.status >= 200 && xhr.status < 300) {\n                // \u63a7\u5236\u53f0\u8f93\u51fa\u54cd\u5e94\u4f53\n                console.log(xhr.response);\n            } else {\n                // \u63a7\u5236\u53f0\u8f93\u51fa\u72b6\u6001\u7801\n                console.log(xhr.status);\n            }\n        }\n    }\n})\n\n// promise \u5c01\u88c5\nbtn.addEventListener(\"click\", () => {\n    // \u521b\u5efa Promise\n    const promise = new Promise((resolve, reject) => {\n        // \u521b\u5efa\u5bf9\u8c61\n        const xhr = new XMLHttpRequest();\n        // \u521d\u59cb\u5316\n        xhr.open('GET', 'https://api.apiopen.top/getJoke');\n        // \u53d1\u9001\n        xhr.send();\n        // \u5904\u7406\u54cd\u5e94\u7ed3\u679c\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4) {\n                // \u5224\u65ad\u54cd\u5e94\u72b6\u6001\u7801\n                if (xhr.status >= 200 && xhr.status < 300) {\n                    // \u63a7\u5236\u53f0\u8f93\u51fa\u54cd\u5e94\u4f53\n                    resolve(xhr.response);\n                } else {\n                    // \u63a7\u5236\u53f0\u8f93\u51fa\u72b6\u6001\u7801\n                    reject(xhr.status);\n                }\n            }\n        }\n    })\n\n    promise.then(result => {\n        console.log(result);\n    }).catch(err => {\n        console.log(err);\n    })\n})\n")),(0,o.kt)("h3",{id:"23-utilpromisify-\u65b9\u6cd5\u8fdb\u884c-promise-\u98ce\u683c\u8f6c\u5316"},"2.3 util.promisify \u65b9\u6cd5\u8fdb\u884c promise \u98ce\u683c\u8f6c\u5316"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u8fd9\u4e2a\u662f\u7528\u5728node.js \u7684\u73af\u5883\u4e0b\uff0c\u6211\u5728\u7528node.js \u5199\u540e\u7aef\u65f6\u7528\u5230\u8fc7\u8fd9\u79cd\u65b9\u6cd5")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const util = require('util');\n\nconst fs = require('fs');\n// \u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u51fd\u6570\n// \u8fd9\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u7ed3\u679c\u662fpromise \u5bf9\u8c61\nlet mineReadFile = util.promisify(fs.readFile);\n\nmineReadFile('./test.txt').then(result => {\n    console.log(result);\n}).catch(err => {\n    console.log(err);\n})\n")),(0,o.kt)("h3",{id:"24-promise-\u5c01\u88c5\u7ec3\u4e60-ajax\u8bf7\u6c42"},"2.4 promise \u5c01\u88c5\u7ec3\u4e60-AJAX\u8bf7\u6c42"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"/** \n         * \u5c01\u88c5\u4e00\u4e2a\u51fd\u6570 sendAJAX \u53d1\u9001 GET AJAX \u8bf7\u6c42\n         * \u53c2\u6570 URL\n         * \u8fd4\u56de\u7ed3\u679c Promise \u5bf9\u8c61\n         **/\n\nfunction sendAJAX(url) {\n    return new Promise((resolve, reject) => {\n        const xhr = new XMLHttpRequest();\n        xhr.open('GET', url);\n        xhr.send();\n        // \u5904\u7406\u7ed3\u679c\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4) {\n                if (xhr.status >= 200 && xhr.status < 300) {\n                    resolve(xhr.response);\n                } else {\n                    reject(xhr.status)\n                }\n            }\n        }\n    })\n}\n\nsendAJAX('https://api.apiopen.top/getJoke').then(result => {\n    console.log(result);\n}).catch(err => {\n    console.log(err);\n})\n")),(0,o.kt)("h2",{id:"3-promise-\u7684\u8be6\u7ec6\u4ecb\u7ecd"},"3. promise \u7684\u8be6\u7ec6\u4ecb\u7ecd"),(0,o.kt)("p",null,"\u5728\u4e86\u89e3 promise \u7684\u57fa\u672c\u6d41\u7a0b\u524d\uff0c\u5148\u8981\u77e5\u9053 promise\u7684\u4e00\u4e9b\u57fa\u672c\u5c5e\u6027"),(0,o.kt)("h3",{id:"31-promise-\u7684\u72b6\u6001"},"3.1 promise \u7684\u72b6\u6001"),(0,o.kt)("p",null,"promise \u7684\u72b6\u6001\u65f6 promise\u5b9e\u4f8b\u5bf9\u8c61\u4e2d\u7684\u4e00\u4e2a\u5c5e\u6027   ",(0,o.kt)("strong",{parentName:"p"},"[PromiseState]"),"   "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"pending \u8fdb\u884c\u4e2d"),(0,o.kt)("li",{parentName:"ul"},"resolved / fulfilled \u6210\u529f"),(0,o.kt)("li",{parentName:"ul"},"rejected \u5931\u8d25")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u72b6\u6001\u53ea\u80fd\u7531 ",(0,o.kt)("inlineCode",{parentName:"p"},"Pending")," \u53d8\u4e3a ",(0,o.kt)("inlineCode",{parentName:"p"},"Fulfilled")," \u6216\u7531 ",(0,o.kt)("inlineCode",{parentName:"p"},"Pending")," \u53d8\u4e3a ",(0,o.kt)("inlineCode",{parentName:"p"},"Rejected")," \uff0c\u4e14\u72b6\u6001\u6539\u53d8\u4e4b\u540e\u4e0d\u4f1a\u5728\u53d1\u751f\u53d8\u5316\uff0c\u4f1a\u4e00\u76f4\u4fdd\u6301\u8fd9\u4e2a\u72b6\u6001\u3002")),(0,o.kt)("h3",{id:"32-promise-\u5bf9\u8c61\u7684\u503c"},"3.2. promise \u5bf9\u8c61\u7684\u503c"),(0,o.kt)("p",null,"\u5b9e\u4f8b\u5bf9\u8c61\u4e2d\u7684\u53e6\u4e00\u4e2a\u5c5e\u6027   ",(0,o.kt)("strong",{parentName:"p"},"[PromiseResult]")),(0,o.kt)("p",null,"\u4fdd\u5b58\u7740\u5f02\u6b65\u4efb\u52a1 ","[\u6210\u529f/\u5931\u8d25]"," \u7684\u7ed3\u679c"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"resolve"),(0,o.kt)("li",{parentName:"ul"},"reject")),(0,o.kt)("h3",{id:"33-promise-\u7684\u57fa\u672c\u6d41\u7a0b"},"3.3 promise \u7684\u57fa\u672c\u6d41\u7a0b"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/8a0ee32c800f4e7c83a11426a44c049a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("h3",{id:"34-promise-api-\u7684\u8be6\u7ec6\u4ecb\u7ecd"},"3.4 promise Api \u7684\u8be6\u7ec6\u4ecb\u7ecd"),(0,o.kt)("h4",{id:"341-promise-\u6784\u9020\u51fd\u6570promiseexecutor"},"3.4.1 Promise \u6784\u9020\u51fd\u6570\uff1aPromise(executor)"),(0,o.kt)("p",null,"(1) executor \u51fd\u6570\uff1a\u6267\u884c\u5668  (resolve, reject) => {}"),(0,o.kt)("p",null,"(2) resolve \u51fd\u6570\uff1a\u5185\u90e8\u5b9a\u4e49\u6210\u529f\u65f6\u6211\u4eec\u8c03\u7528\u7684\u51fd\u6570  value => {}"),(0,o.kt)("p",null,"(3) reject \u51fd\u6570\uff1a\u5185\u90e8\u5b9a\u4e49\u5931\u8d25\u65f6\u6211\u4eec\u8c03\u7528\u7684\u51fd\u6570 reason => {}"),(0,o.kt)("p",null,"\u8bf4\u660e\uff1aexecutor \u4f1a\u5728 Promise \u5185\u90e8\u7acb\u5373\u540c\u6b65\u8c03\u7528\uff0c\u5f02\u6b65\u64cd\u4f5c\u5728\u6267\u884c\u5668\u4e2d\u6267\u884c"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u4ee3\u7801")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"<script>\n    let p = new Promise((resolve, reject) => {\n        // \u540c\u6b65\u8c03\u7528\n        console.log(111);\n    });\n    console.log(222);\n<\/script>\n")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/51dfeb6b247d4e268a796bbe5b39688f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_16,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("h4",{id:"342-promiseprototypethen-\u65b9\u6cd5-onresolved-onrejected--"},"3.4.2 Promise.prototype.then \u65b9\u6cd5 (onResolved, onRejected) => {}"),(0,o.kt)("p",null,"(1) onResolved \u51fd\u6570\uff1a\u6210\u529f\u7684\u56de\u8c03\u51fd\u6570 (value) => {}"),(0,o.kt)("p",null,"(2) onRejected \u51fd\u6570\uff1a\u5931\u8d25\u7684\u56de\u8c03\u51fd\u6570 (reason) => {}"),(0,o.kt)("p",null,"\u8bf4\u660e\uff1a\u6307\u5b9a\u7528\u4e8e\u5f97\u5230\u6210\u529f value \u7684\u6210\u529f\u56de\u8c03\u548c\u7528\u4e8e\u5f97\u5230\u5931\u8d25 reason \u7684\u5931\u8d25\u56de\u8c03\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684 promise \u5bf9\u8c61"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"promise.then(value => {\n    console.log(value);\n}, reason => {\n    console.log(reason);\n})\n")),(0,o.kt)("h4",{id:"343-promisecatch-\u65b9\u6cd5reason--"},"3.4.3 Promise.catch \u65b9\u6cd5\uff1a(reason) => {}"),(0,o.kt)("p",null,"(1) reason\uff1a\u5931\u8d25\u7684\u6570\u636e\u6216Promise\u5bf9\u8c61"),(0,o.kt)("p",null,"\u8bf4\u660e\uff1a\u8fd4\u56de\u4e00\u4e2a \u5931\u8d25\u7684 promise \u5bf9\u8c61"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"sendAJAX('https://api.apiopen.top/getJoke').catch(reason => {\n             console.log(reason);\n         })\n")),(0,o.kt)("h4",{id:"344-promiseresolve-\u65b9\u6cd5value--"},"3.4.4 Promise.resolve \u65b9\u6cd5\uff1a(value) => {}"),(0,o.kt)("p",null,"(1) value\uff1a\u6210\u529f\u7684\u6570\u636e\u6216 promise \u5bf9\u8c61"),(0,o.kt)("p",null,"\u8bf4\u660e\uff1a\u8fd4\u56de\u4e00\u4e2a\u6210\u529f/\u5931\u8d25\u7684 promise \u5bf9\u8c61"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// \u5982\u679c\u4f20\u5165\u7684\u53c2\u6570\u4e3a \u975e promise\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u5219\u8fd4\u56de\u7684\u7ed3\u679c\u4e3a\u6210\u529f\u7684promise\u5bf9\u8c61\nlet p1 = Promise.resolve(521);\n// \u5982\u679c\u4f20\u5165\u7684\u53c2\u6570\u4e3a promise \u5bf9\u8c61\uff0c\u5219\u53c2\u6570\u7684\u7ed3\u679c\u51b3\u5b9a\u4e86 resolve \u7684\u7ed3\u679c\nlet p2 = Promise.resolve(new Promise((resolve, reject) => {\n    resolve('ok');\n}))\nconsole.log(p2);\n")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/83b2be5c16c54c22af007a92751a4592.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("h4",{id:"345-promisereject-\u65b9\u6cd5reason--"},"3.4.5 Promise.reject \u65b9\u6cd5\uff1a(reason) => {}"),(0,o.kt)("p",null,"(1) reason\uff1a\u5931\u8d25\u7684\u539f\u56e0"),(0,o.kt)("p",null,"\u8bf4\u660e\uff1a\u8fd4\u56de\u4e00\u4e2a\u5931\u8d25\u7684 promise \u5bf9\u8c61"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p1 = Promise.reject(521)\nlet p2 = Promise.reject(new Promise((resolve, reject) => {\n    resolve('ok')\n}))\n")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/b3c6e35f67694bfd91e4e66f9712c386.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("h4",{id:"346-promiseall-\u65b9\u6cd5promises--"},"3.4.6 Promise.all \u65b9\u6cd5\uff1a(promises) => {}"),(0,o.kt)("p",null,"(1) promises\uff1a\u5305\u542b n \u4e2a promise \u7684\u6570\u7ec4"),(0,o.kt)("p",null,"\u8bf4\u660e\uff1a\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684 promise\uff0c\u53ea\u6709\u6240\u6709\u7684 promise \u90fd\u6210\u529f\u624d\u6210\u529f\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u5931\u8d25\u4e86\u5c31\u76f4\u63a5\u5931\u8d25"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u4e0d\u6f14\u793a\u4e86\uff0c\u5199\u7684\u592a\u7d2f\u4e86\uff0c\u770b\u5b57\u9762\u610f\u601d\u5c31\u77e5\u9053\u8fd9\u4e2a\u51fd\u6570\u7684\u4f5c\u7528\u4e86\u3002")),(0,o.kt)("h4",{id:"347-promiserace-\u65b9\u6cd5promises--"},"3.4.7 Promise.race \u65b9\u6cd5\uff1a(promises) => {}"),(0,o.kt)("p",null,"(1) promises\uff1a\u5305\u542b n \u4e2a promise \u7684\u6570\u7ec4"),(0,o.kt)("p",null,"\u8bf4\u660e\uff1a\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684 promise\uff0c\u7b2c\u4e00\u4e2a\u5b8c\u6210\u7684 promise \u7684\u7ed3\u679c\u72b6\u6001\u5c31\u662f\u6700\u7ec8\u7684\u7ed3\u679c\u72b6\u6001"),(0,o.kt)("h2",{id:"4-promise-\u7684\u51e0\u4e2a\u5173\u952e\u95ee\u9898"},"4. promise \u7684\u51e0\u4e2a\u5173\u952e\u95ee\u9898"),(0,o.kt)("p",null,"\u4e00\uff1a\u5982\u4f55\u6539\u53d8 promise \u7684\u72b6\u6001"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p = new Promise((resolve, reject) => {\n    // 1. resolve \u51fd\u6570\n    resolve('ok') // pending ---\x3e fulfilled\n    // 2. reject \u51fd\u6570\n    reject('err') // pending ---\x3e rejected\n    // 3. \u629b\u51fa\u9519\u8bef\n    throw '\u51fa\u95ee\u9898\u4e86';\n})\n")),(0,o.kt)("p",null,"\u4e8c\uff1a\u4e00\u4e2a promise \u6307\u5b9a\u591a\u4e2a\u6210\u529f/\u5931\u8d25\u56de\u8c03\u51fd\u6570\uff0c\u90fd\u4f1a\u8c03\u7528\u5417\uff1f"),(0,o.kt)("p",null,"\u5f53 promise \u6539\u53d8\u4e3a\u5bf9\u5e94\u72b6\u6001\u65f6\u90fd\u4f1a\u8c03\u7528"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let promise = new Promise((resolve, reject) => {\n    resolve('Ok');\n})\n\n// \u6307\u5b9a\u56de\u8c03\u51fd\u6570\npromise.then(res => {\n    console.log(res);\n})\n\npromise.then(res => {\n    alert(res);\n})\n")),(0,o.kt)("p",null,"\u4e09\uff1a\u6539\u53d8 promise \u72b6\u6001 \u548c \u6307\u5b9a\u56de\u8c03\u51fd\u6570\u8c01\u5148\u8c01\u540e\uff1f"),(0,o.kt)("p",null,"(1)\uff1a\u90fd\u6709\u53ef\u80fd\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u662f\u5148\u6307\u5b9a\u56de\u8c03\u518d\u6539\u53d8\u72b6\u6001\uff0c\u4f46\u4e5f\u53ef\u4ee5\u5148\u6539\u53d8\u72b6\u6001\u518d\u6307\u5b9a\u56de\u8c03"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u6b63\u5e38\u60c5\u51b5"),(0,o.kt)("p",{parentName:"blockquote"},"promise \u6267\u884c\u5668\u5185\u90e8\u662f \u5f02\u6b65\u64cd\u4f5c\uff0c\u6240\u4ee5\u662f\u5148\u6307\u5b9a\u56de\u8c03\uff0c\u518d\u6539\u53d8\u72b6\u6001")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let promise = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        // \u518d\u6539\u53d8\u72b6\u6001\n        resolve('Ok')\n    }, 1000)\n})\n\n// \u5148\u6307\u5b9a\u56de\u8c03\npromise.then(res => {\n    // \u4f46 res \u7ed3\u679c\u7684\u83b7\u5f97\uff0c\u5fc5\u987b\u8981\u7b49\u5f02\u6b65\u6267\u884c\u7ed3\u675f\uff0c\u72b6\u6001\u6539\u53d8\u624d\u80fd\u83b7\u53d6\u5230\n    console.log(res);\n})\n")),(0,o.kt)("p",null,"(2)\uff1a\u5982\u4f55\u5148\u6539\u72b6\u6001\u518d\u6307\u5b9a\u56de\u8c03\uff1f"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u5728\u6267\u884c\u5668\u4e2d\u76f4\u63a5\u8c03\u7528 resolve() / reject()"),(0,o.kt)("li",{parentName:"ul"},"\u5ef6\u8fdf\u66f4\u957f\u65f6\u95f4\u624d\u8c03\u7528 then()")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let promise = new Promise((resolve, reject) => {\n    // \u540c\u6b65\u64cd\u4f5c\uff0c\u76f4\u63a5\u5148\u6539\u53d8\u72b6\u6001\n    resolve('Ok');\n})\n\n// \u518d\u6307\u5b9a\u56de\u8c03\npromise.then(res => {\n    console.log(res);\n})\n")),(0,o.kt)("p",null,"\u56db\uff1apromise.then() \u8fd4\u56de\u7684\u65b0 promise \u7684\u7ed3\u679c\u72b6\u6001\u7531\u4ec0\u4e48\u51b3\u5b9a"),(0,o.kt)("p",null,"(1) \u7b80\u5355\u8868\u8fbe\uff1a\u7531 then() \u6307\u5b9a\u7684\u56de\u8c03\u51fd\u6570\u6267\u884c"),(0,o.kt)("p",null,"(2) \u8be6\u7ec6\u8868\u8fbe\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u5982\u679c\u629b\u51fa\u5f02\u5e38\uff0c\u65b0 promise \u53d8\u4e3a rejected\uff0creason \u4e3a \u629b\u51fa\u7684\u5f02\u5e38"),(0,o.kt)("li",{parentName:"ul"},"\u5982\u679c\u8fd4\u56de\u7684\u662f\u975e promise \u7684\u4efb\u610f\u503c\uff0c\u65b0 promise \u53d8\u4e3a resolved\uff0c value\u4e3a\u8fd4\u56de\u7684\u503c"),(0,o.kt)("li",{parentName:"ul"},"\u5982\u679c\u8fd4\u56de\u7684\u662f\u53e6\u4e00\u4e2a\u65b0 promise\uff0c\u6b64 promise \u7684\u7ed3\u679c\u5c31\u4f1a\u6210\u4e3a \u65b0 promise \u7684\u7ed3\u679c")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let promise = new Promise((resolve, reject) => {\n    resolve('Ok');\n})\n\npromise.then(res => {\n    console.log(res);\n    // 1. \u629b\u51fa\u9519\u8bef\n    // throw '\u51fa\u4e86\u95ee\u9898'\n    // 2. \u8fd4\u56de\u7ed3\u679c\u975e promise \u5bf9\u8c61\n    return 123;\n    // 3. \u8fd4\u56de\u7ed3\u679c\u662fpromise \u5bf9\u8c61\n    return new Promise((resolve, reject) => {\n        resolve('DDD');\n    })\n})\n")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/2ba660a3bb7647f68c3a39b8d0d1d5fa.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_14,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/08f70349655c4d689d2560161bf0065f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_16,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/a7769cd51adc4a9aa1e02cbc99912004.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_16,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u4e94\uff1apromise \u5982\u4f55\u4e32\u8fde\u591a\u4e2a\u64cd\u4f5c\u4efb\u52a1\uff1f"),(0,o.kt)("p",null,"(1) promise \u7684 then() \u5185\u90e8\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684 promise\uff0c\u53ef\u4ee5 .then() \u8fdb\u884c\u94fe\u5f0f\u8c03\u7528"),(0,o.kt)("p",null,"(2) \u901a\u8fc7 then \u7684\u94fe\u5f0f\u8c03\u7528\u4e32\u8fde \u591a\u4e2a\u540c\u6b65/\u5f02\u6b65\u4efb\u52a1"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u5c31\u6700\u5f00\u59cb\u63d0\u51fa\u6309\u987a\u5e8f\u8bfb\u53d6a.txt , b.txt, c.txt \u7ec8\u4e8e\u53ef\u4ee5\u89e3\u91ca\u4e86\u3002"),(0,o.kt)("p",{parentName:"blockquote"},"\u5982\u4f55\u7528promise \u89e3\u51b3\u56de\u8c03\u5730\u72f1")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const fs = require('fs')\n\nlet p1 = new Promise((resolve, reject) => {\n    fs.readFile('a.txt', 'utf-8', (err, data) => {\n        resolve(data)\n    })\n})\n\nlet p2 = new Promise((resolve, reject) => {\n    fs.readFile('b.txt', 'utf-8', (err, data) => {\n        resolve(data)\n    })\n})\n\nlet p3 = new Promise((resolve, reject) => {\n    fs.readFile('c.txt', 'utf-8', (err, data) => {\n        resolve(data)\n    })\n})\n\np1.then(r1 => {\n    console.log(r1);\n    return p2;\n}).then(r2 => {\n    console.log(r2);\n    return p3;\n}).then(r3 => {\n    console.log(r3);\n})\n")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/3290a0e8706d40de9f4d61f5a7e9af90.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u516d\uff1apromise \u5f02\u5e38\u7a7f\u900f"),(0,o.kt)("p",null,"(1) \u5f53\u4f7f\u7528 promise \u7684 then \u94fe\u5f0f\u8c03\u7528\u65f6\uff0c\u53ef\u4ee5\u5728\u6700\u540e\u6307\u5b9a\u5931\u8d25\u7684\u56de\u8c03"),(0,o.kt)("p",null,"(2) \u524d\u9762\u4efb\u4f55\u64cd\u4f5c\u51fa\u4e86\u5f02\u5e38\uff0c\u90fd\u4f1a\u4f20\u5230\u6700\u540e\u5931\u8d25\u7684\u56de\u8c03\u4e2d\u5904\u7406"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let promise = new Promise((resolve, reject) => {\n    reject('Err');\n})\n\nlet p = promise.then(res => {\n    // console.log(111);    \n    throw '\u5931\u8d25\u4e86';\n}).then(value => {\n    console.log(222);\n}).then(value => {\n    console.log(333);\n}).catch(reason => {\n    console.log(reason);\n})\n")),(0,o.kt)("p",null,"\u4e03\uff1a\u4e2d\u65ad promise \u94fe\uff1f"),(0,o.kt)("p",null,"(1) \u5f53\u4f7f\u7528 promise \u7684 then \u94fe\u5f0f\u8c03\u7528\u65f6\uff0c\u5728\u4e2d\u95f4\u4e2d\u65ad\uff0c\u4e0d\u518d\u8c03\u7528\u540e\u9762\u7684\u56de\u8c03\u51fd\u6570"),(0,o.kt)("p",null,"(2) \u529e\u6cd5\uff1a\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u8fd4\u56de\u4e00\u4e2a pendding \u72b6\u6001\u7684 promise \u5bf9\u8c61"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let promise = new Promise((resolve, reject) => {\n    resolve('Ok');\n})\n\nlet p = promise.then(res => {\n    console.log(111);    \n    // \u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u65b9\u5f0f\n    // \u56de\u8c03\u51fd\u6570\u6267\u884c\u7684\u524d\u63d0\u662f  \u5728\u72b6\u6001\u6539\u5b8c\u4e4b\u540e\u624d\u80fd\u6267\u884c\u3002\n    // \u8fd9\u91cc\u8fd4\u56de\u7684promise \u72b6\u6001\u662f pendding\n    return new Promise(() => {});\n}).then(value => {\n    console.log(222);\n}).then(value => {\n    console.log(333);\n}).catch(reason => {\n    console.log(reason);\n})\n")),(0,o.kt)("h2",{id:"5-\u624b\u5199-promise"},"5. \u624b\u5199 Promise"),(0,o.kt)("h3",{id:"51-\u5b9a\u4e49\u6574\u4f53\u7ed3\u6784"},"5.1 \u5b9a\u4e49\u6574\u4f53\u7ed3\u6784"),(0,o.kt)("p",null,"\u521b\u5efa\u4e24\u4e2a\u6587\u4ef6 index.html\uff0cpromise.js"),(0,o.kt)("p",null,"\u5728 promise.js \u5199\u6700\u57fa\u672c\u7684 promise \u7ed3\u6784"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function Promise(executor) {\n\n}\n\n// \u6dfb\u52a0 then \u65b9\u6cd5\nPromise.prototype.then = function(onResolved, onRejected) {\n    \n}\n")),(0,o.kt)("p",null,"index.html  \u91cc\u5f15\u5165 \u6211\u4eec\u521a\u5199\u7684 promise.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta http-equiv="X-UA-Compatible" content="IE=edge">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Document</title>\n    \x3c!-- \u5f15\u5165 promise --\x3e\n    <script src="./promise.js"><\/script>\n</head>\n<body>\n    <script>\n        let p = new Promise((resolve, reject) => {\n            resolve(\'Ok\');\n        })\n\n        p.then(res => {\n            console.log(res);\n        }, reason => {\n            console.log(reason);\n        })\n    <\/script>\n</body>\n</html>\n')),(0,o.kt)("h3",{id:"52-\u5c01\u88c5-resolve-\u548c-reject-\u7ed3\u6784"},"5.2 \u5c01\u88c5 resolve \u548c reject \u7ed3\u6784"),(0,o.kt)("p",null,"promise.js \u91cc\u7684 \u4ee3\u7801"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function Promise(executor) {\n\n    // resolve \u51fd\u6570\n    function resolve(data) {\n\n    }\n\n    // reject \u51fd\u6570\n    function reject(data) {\n        \n    }\n\n    // \u540c\u6b65\u8c03\u7528 [\u6267\u884c\u5668\u51fd\u6570]\n    executor(resolve, reject);\n\n}\n")),(0,o.kt)("h3",{id:"53-resolve-\u548c-reject-\u4ee3\u7801\u7684\u5b9e\u73b0"},"5.3 resolve \u548c reject \u4ee3\u7801\u7684\u5b9e\u73b0"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function Promise(executor) {\n\n    // \u6dfb\u52a0\u5c5e\u6027\n    this.PromiseState = 'pending';\n    this.PromiseResult = null;\n    // \u4fdd\u5b58\u5b9e\u4f8b\u5bf9\u8c61\u7684 this \u7684\u503c\n    const that = this;\n    // resolve \u51fd\u6570\n    function resolve(data) {\n        // 1. \u4fee\u6539\u5bf9\u8c61\u7684\u72b6\u6001 (promiseState)\n        that.PromiseState = 'fulfilled';\n        // 2. \u8bbe\u7f6e\u5bf9\u8c61\u7ed3\u679c\u503c (promiseResult)\n        that.PromiseResult = data;\n    }\n\n    // reject \u51fd\u6570\n    function reject(data) {\n        // 1. \u4fee\u6539\u5bf9\u8c61\u7684\u72b6\u6001 (promiseState)\n        that.PromiseState = 'rejected';\n        // 2. \u8bbe\u7f6e\u5bf9\u8c61\u7ed3\u679c\u503c (promiseResult)\n        that.PromiseResult = data;\n    }\n\n    // \u540c\u6b65\u8c03\u7528 [\u6267\u884c\u5668\u51fd\u6570]\n    executor(resolve, reject);\n\n}\n\n// \u6dfb\u52a0 then \u65b9\u6cd5\nPromise.prototype.then = function(onResolved, onRejected) {\n\n}\n")),(0,o.kt)("h3",{id:"54-throw-\u629b\u51fa\u5f02\u5e38\u6539\u53d8\u72b6\u6001"},"5.4 throw \u629b\u51fa\u5f02\u5e38\u6539\u53d8\u72b6\u6001"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"try {\n    // \u540c\u6b65\u8c03\u7528 [\u6267\u884c\u5668\u51fd\u6570]\n    executor(resolve, reject);\n} catch (error) {\n    // \u4fee\u6539 promise \u5bf9\u8c61\u72b6\u6001\u4e3a  \u5931\u8d25\n    reject(error)\n}\n")),(0,o.kt)("h3",{id:"55-promise-\u5bf9\u8c61\u72b6\u6001\u53ea\u80fd\u4fee\u6539\u4e00\u6b21"},"5.5 promise \u5bf9\u8c61\u72b6\u6001\u53ea\u80fd\u4fee\u6539\u4e00\u6b21"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// resolve \u51fd\u6570\nfunction resolve(data) {\n    // \u6765\u4e2aif\u5224\u65ad\u4e00\u4e0b\u5c31\u884c\n    if (that.PromiseState !== 'pending') return;\n    // 1. \u4fee\u6539\u5bf9\u8c61\u7684\u72b6\u6001 (promiseState)\n    that.PromiseState = 'fulfilled';\n    // 2. \u8bbe\u7f6e\u5bf9\u8c61\u7ed3\u679c\u503c (promiseResult)\n    that.PromiseResult = data;\n}\n\n// reject \u51fd\u6570\nfunction reject(data) {\n    // \u5224\u65ad\u72b6\u6001\n    if (that.PromiseState !== 'pending') return;\n    // 1. \u4fee\u6539\u5bf9\u8c61\u7684\u72b6\u6001 (promiseState)\n    that.PromiseState = 'rejected';\n    // 2. \u8bbe\u7f6e\u5bf9\u8c61\u7ed3\u679c\u503c (promiseResult)\n    that.PromiseResult = data;\n}\n")),(0,o.kt)("h3",{id:"56-then\u65b9\u6cd5\u6267\u884c\u56de\u8c03"},"5.6 then\u65b9\u6cd5\u6267\u884c\u56de\u8c03"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// \u6dfb\u52a0 then \u65b9\u6cd5\nPromise.prototype.then = function(onResolved, onRejected) {\n    // \u8c03\u7528\u56de\u8c03\u51fd\u6570 PromiseState\n    if (this.PromiseState === 'fulfilled') {\n        onResolved(this.PromiseResult);\n    }\n    if (this.PromiseState === 'rejected') {\n        onRejected(this.PromiseResult);\n    }\n}\n")),(0,o.kt)("h3",{id:"57-\u5f02\u6b65\u4efb\u52a1\u56de\u8c03\u7684\u6267\u884c"},"5.7 \u5f02\u6b65\u4efb\u52a1\u56de\u8c03\u7684\u6267\u884c"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u8fd9\u90e8\u5206\u6211\u611f\u89c9\u5c31\u662fpromise \u6700\u6838\u5fc3\u5173\u952e\u7684\u5730\u65b9\u4e86\u3002")),(0,o.kt)("p",null,"\u5728\u524d\u9762\u7684\u6267\u884c\u5668\u51fd\u6570\u4e2d\uff0c\u4e00\u76f4\u662f\u540c\u6b65\u6267\u884c\u7684\uff0c\u6240\u4ee5\u5728 then \u65b9\u6cd5\u4e2d\u80fd\u76f4\u63a5\u83b7\u53d6\u5230 PromiseState \u548c PromiseResult\u7684\u503c\u3002\u4f46\u73b0\u5728\u8981\u5728 executor \u6267\u884c\u5668\u4e2d\u8fdb\u884c\u5f02\u6b65\u51fd\u6570\u8c03\u7528\u4e86\uff0c\u800c then \u65b9\u6cd5\u4e2d\u56de\u8c03\u51fd\u6570\u5c31\u4e0d\u80fd\u76f4\u63a5\u83b7\u5f97 PromiseState \u548c PromiseResult\u3002\u8981\u7b49\u5f02\u6b65\u51fd\u6570\u6267\u884c\u7ed3\u675f\u540e\u624d\u80fd\u5f97\u5230\u3002\u800c\u5982\u4f55\u5904\u7406\u624d\u80fd\u4f7f\u5f97 then \u65b9\u6cd5 \u5f97\u5230 executor \u6267\u884c\u5668\u4e2d \u5f02\u6b65\u51fd\u6570\u4ea7\u751f\u7684\u503c\uff1f"),(0,o.kt)("p",null,"\u5b98\u65b9\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\uff1a"),(0,o.kt)("p",null,"\u5728 then \u65b9\u6cd5\u4e2d\u5224\u65ad promise \u7684\u72b6\u6001\uff0c\u5982\u679c\u662f pending\uff0c\u8bf4\u660e\u5f02\u6b65\u51fd\u6570\u8fd8\u6ca1\u6267\u884c\u7ed3\u675f\uff0c\u8fd9\u65f6\u4e0d\u80fd\u76f4\u63a5\u8c03\u7528 then \u65b9\u6cd5\u4e2d\u7684\u56de\u8c03\u51fd\u6570\uff0c\u5148\u628a\u56de\u8c03\u51fd\u6570\u4fdd\u5b58\u4e0b\u6765\u3002\u5982\u4f55\u4fdd\u5b58\uff1f\u5728 promise \u6784\u9020\u51fd\u6570\u4e2d\u7528\u4e00\u4e2a\u5c5e\u6027\u4fdd\u5b58\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function Promise(executor) {\n    // \u58f0\u660e\u4e00\u4e2a\u5c5e\u6027\uff0c\u7528\u6765\u4fdd\u5b58 then \u4e2d\u7684\u56de\u8c03\u51fd\u6570\n    this.callback = {}\n}\n")),(0,o.kt)("p",null,"\u7136\u540e\u5728 pending \u72b6\u6001\u65f6\uff0c\u4fdd\u5b58\u56de\u8c03\u51fd\u6570"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u5176\u5b9e\u8fd9\u65f6\u5019 then \u65b9\u6cd5\u5df2\u7ecf\u7ed3\u675f\u4e86\uff0c\u6ca1\u6709\u628a\u56de\u8c03\u51fd\u6570\u8fdb\u884c\u8c03\u7528\uff0c\u6240\u4ee5\u5c31\u5148\u628a\u56de\u8c03\u51fd\u6570\u5b58\u5230 p \u8fd9\u4e2a\u5bf9\u8c61\u7684 callback \u4e0a\u3002\u5728\u5f02\u6b65\u4efb\u52a1\u7ed3\u675f\u540e\uff0c\u4ea4\u7ed9window \u6258\u7ba1\u7684 resolve \u5f00\u59cb\u6267\u884c\uff0c\u8fd9\u4e2a window \u6258\u7ba1\u7684\u51fd\u6570\u4f7f\u7528\u4e86 p \u5bf9\u8c61\u4e2d\u5b58\u7740\u7684 callback \u51fd\u6570\u3002")),(0,o.kt)("p",null,"index.html"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"<script>\n    let p = new Promise((resolve, reject) => {\n            // this \u7684\u5224\u65ad\u662f\u6839\u636e . \u53f7\u524d\u9762\u7684\u5bf9\u8c61\u51b3\u5b9a\u7684\n            // \u8fd9\u91cc\u76f4\u63a5\u662f\u51fd\u6570\uff0cresolve\u5185\u90e8 this \u6307\u5411 window\n            // resolve('Ok');\n            setTimeout(() => {\n                // resolve('Ok');\n                reject('err')\n            }, 1000)\n        })\n\n\n        p.then(res => {\n            console.log(res);\n        }, reason => {\n            console.log(reason);\n        })\n\n        console.log(p);\n<\/script>\n")),(0,o.kt)("p",null,"promise.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// \u6dfb\u52a0 then \u65b9\u6cd5\nPromise.prototype.then = function(onResolved, onRejected) {\n    // \u5224\u65ad pending \u72b6\u6001\n    if (this.PromiseState === 'pending') {\n        // \u4fdd\u5b58\u56de\u8c03\u51fd\u6570\n        this.callback = {\n            onResolved: onResolved,\n            onRejected: onRejected\n        }\n    }\n}\n")),(0,o.kt)("p",null,"\u5728 \u5f02\u6b65\u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u8c03\u7528\u56de\u8c03\u51fd\u6570"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// resolve \u51fd\u6570\nfunction resolve(data) {\n    // \u5224\u65ad\u72b6\u6001\n    if (that.PromiseState !== 'pending') return;\n    // 1. \u4fee\u6539\u5bf9\u8c61\u7684\u72b6\u6001 (promiseState)\n    that.PromiseState = 'fulfilled';\n    // 2. \u8bbe\u7f6e\u5bf9\u8c61\u7ed3\u679c\u503c (promiseResult)\n    that.PromiseResult = data;\n    // \u8c03\u7528\u6210\u529f\u7684\u56de\u8c03\u51fd\u6570\n    if (that.callback.onResolved) {\n        that.callback.onResolved(data);\n    }\n}\n\n// reject \u51fd\u6570\nfunction reject(data) {\n    // \u5224\u65ad\u72b6\u6001\n    if (that.PromiseState !== 'pending') return;\n    // 1. \u4fee\u6539\u5bf9\u8c61\u7684\u72b6\u6001 (promiseState)\n    that.PromiseState = 'rejected';\n    // 2. \u8bbe\u7f6e\u5bf9\u8c61\u7ed3\u679c\u503c (promiseResult)\n    that.PromiseResult = data;\n    // \u8c03\u7528\u6210\u529f\u7684\u56de\u8c03\u51fd\u6570\n    if (that.callback.onRejected) {\n        that.callback.onRejected(data);\n    }\n}\n")),(0,o.kt)("h3",{id:"58-\u6307\u5b9a\u591a\u4e2a\u56de\u8c03\u7684\u5b9e\u73b0"},"5.8 \u6307\u5b9a\u591a\u4e2a\u56de\u8c03\u7684\u5b9e\u73b0"),(0,o.kt)("p",null,"\u95ee\u9898\uff1a"),(0,o.kt)("p",null,"\u6211\u4eec\u5e0c\u671b\u8fd9\u4e24\u4e2a\u56de\u8c03\u90fd\u80fd\u6267\u884c\uff0c\u4f46\u4fdd\u5b58\u7b2c\u4e8c\u4e2a\u56de\u8c03\u65f6\u4f1a\u5c06\u7b2c\u4e00\u4e2a\u56de\u8c03\u8986\u76d6\u6389\uff0c\u6240\u4ee5\u539f\u6765\u7684\u4fdd\u5b58\u65b9\u6cd5\u4e0d\u884c\uff0c\u9700\u8981\u4fee\u6539\u3002"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u4fee\u6539\u524d")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p = new Promise((resolve, reject) => {\n    // this \u7684\u5224\u65ad\u662f\u6839\u636e . \u53f7\u524d\u9762\u7684\u5bf9\u8c61\u51b3\u5b9a\u7684\n    // \u8fd9\u91cc\u76f4\u63a5\u662f\u51fd\u6570\uff0cresolve\u5185\u90e8 this \u6307\u5411 window\n    // resolve('Ok');\n    setTimeout(() => {\n        // resolve('Ok');\n        reject('err')\n    }, 1000)\n})\n\n\np.then(res => {\n    console.log(res);\n}, reason => {\n    console.log(reason);\n})\n\n// \u4fdd\u5b58\u7b2c\u4e8c\u4e2a\u56de\u8c03\uff0c\u4f1a\u5c06\u4e4b\u524d\u4fdd\u5b58\u5728 p \u5bf9\u8c61\u4e2d callback \u7684\u5185\u5bb9\u8986\u76d6\u6389\n// \u6240\u4ee5\u524d\u9762\u7684\u4fdd\u5b58\u65b9\u6cd5\u4e0d\u884c\uff0c\u9700\u8981\u4fee\u6539\np.then(res => {\n    alert(res);\n}, reason => {\n    alert(reason);\n})\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u4fee\u6539\u540e")),(0,o.kt)("p",null,"\u6539\u7528\u6570\u7ec4\u5b58 callback\uff0c\u518d\u904d\u5386\u628a\u6bcf\u4e2a \u56de\u8c03\u51fd\u6570\u90fd\u8c03\u7528\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// \u58f0\u660e\u4e00\u4e2a\u5c5e\u6027\uff0c\u7528\u6765\u4fdd\u5b58 then \u4e2d\u7684\u56de\u8c03\u51fd\u6570\nthis.callback = []\n\n// resolve \u51fd\u6570\nfunction resolve(data) {\n    // \u5224\u65ad\u72b6\u6001\n    if (that.PromiseState !== 'pending') return;\n    // 1. \u4fee\u6539\u5bf9\u8c61\u7684\u72b6\u6001 (promiseState)\n    that.PromiseState = 'fulfilled';\n    // 2. \u8bbe\u7f6e\u5bf9\u8c61\u7ed3\u679c\u503c (promiseResult)\n    that.PromiseResult = data;\n    // \u904d\u5386\u8c03\u7528\u6210\u529f\u7684\u56de\u8c03\u51fd\u6570\n    that.callback.forEach(item => {\n        item.onResolved(data);\n    });\n}\n\n// reject \u51fd\u6570\nfunction reject(data) {\n    // \u5224\u65ad\u72b6\u6001\n    if (that.PromiseState !== 'pending') return;\n    // 1. \u4fee\u6539\u5bf9\u8c61\u7684\u72b6\u6001 (promiseState)\n    that.PromiseState = 'rejected';\n    // 2. \u8bbe\u7f6e\u5bf9\u8c61\u7ed3\u679c\u503c (promiseResult)\n    that.PromiseResult = data;\n    // \u904d\u5386\u8c03\u7528\u5931\u8d25\u7684\u56de\u8c03\u51fd\u6570\n    that.callback.forEach(item => {\n        item.onRejected(data);\n    });\n}\n\n// \u6dfb\u52a0 then \u65b9\u6cd5\nPromise.prototype.then = function(onResolved, onRejected) {\n    // \u8c03\u7528\u56de\u8c03\u51fd\u6570 PromiseState\n    if (this.PromiseState === 'fulfilled') {\n        onResolved(this.PromiseResult);\n    }\n    if (this.PromiseState === 'rejected') {\n        onRejected(this.PromiseResult);\n    }\n    // \u5224\u65ad pending \u72b6\u6001\n    if (this.PromiseState === 'pending') {\n        // \u4fdd\u5b58\u56de\u8c03\u51fd\u6570\n        this.callback.push({\n            onResolved: onResolved,\n            onRejected: onRejected\n        });\n    }\n}\n")),(0,o.kt)("h3",{id:"59-\u540c\u6b65\u4fee\u6539\u72b6\u6001-then-\u65b9\u6cd5\u7ed3\u679c\u8fd4\u56de"},"5.9 \u540c\u6b65\u4fee\u6539\u72b6\u6001 then \u65b9\u6cd5\u7ed3\u679c\u8fd4\u56de"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u8fd9\u4e00\u5757\u90e8\u5206\u76f8\u5f53\u590d\u6742\uff0c\u9700\u8981\u6162\u6162\u6765\u7406\u4e00\u4e0b\uff0c\u540e\u9762\u5f02\u6b65\u7684\u90e8\u5206\u4f1a\u66f4\u53d1\u6742\uff08\u9ebb\u4e86\uff09")),(0,o.kt)("p",null,"\u524d\u9762\u7684\u77e5\u8bc6\u524d\u63d0\uff1a"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/2001a707fa34421685909dfe972f5747.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u6211\u4eec\u5728\u524d\u9762\u7684 promise \u4e2d\u5b66\u5230 p.then() \u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2a promise \u5bf9\u8c61\uff0c \u8fd4\u56de\u7684\u5177\u4f53\u5185\u5bb9\u6839 \u56de\u8c03\u51fd\u6570\u7684 return \u5185\u5bb9\u76f8\u5173\u3002"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u73b0\u5728\u8fd9\u4e00\u90e8\u5206\u662f\u5148\u6309\u540c\u6b65\u7684\u6765\uff0c\u4e0b\u4e00\u7ae0\u5185\u5bb9\u662f\u5f02\u6b65")),(0,o.kt)("p",null,"\u5148\u5199\u6574\u4f53\u9aa8\u67b6\u4ee3\u7801\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p = new Promise((resolve, reject) => {\n    resolve('Ok')\n})\n\n\nlet outerResult = p.then(value => {\n    return 521;\n}, reason => {\n    console.log(reason);\n})\n\nconsole.log(outerResult);\n")),(0,o.kt)("p",null,"\u6211\u4eec\u5148\u8fd4\u56de \u975e promise \u7684\u503c\uff0c\u8fd4\u56de 521\u3002"),(0,o.kt)("p",null,"\u5728 promise.js \u4e2d then() \u65b9\u6cd5 \u8fd4\u56de \u4e00\u4e2a promise \u5bf9\u8c61"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u8fd9\u662f\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u662f \u975e promise \u7684\u60c5\u51b5")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Promise.prototype.then = function (onResolved, onRejected) {\n    // \u8fd4\u56de promise\n    return new Promise((resolve, reject) => {\n        // \u8c03\u7528\u56de\u8c03\u51fd\u6570 PromiseState\n        if (this.PromiseState === 'fulfilled') {\n            // \u6240\u4ee5\u8fd9\u4e2aresult\u5c31\u662f\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u7684\u7ed3\u679c\n            let result = onResolved(this.PromiseResult);\n            // \u5982\u679c\u8fd4\u56de\u7684\u662f promise \u5bf9\u8c61\n            if (result instanceof Promise) {\n                // \u8fd9\u91cc\u5148\u4e0d\u5904\u7406\n            } else { // \u8fd4\u56de\u7684\u662f\u5e38\u89c4\u503c\u5c31\u662f\u6210\u529f\n                // \u8981\u5c06 outerResult \u8fd9\u4e2a promise \u76ee\u524d\u7684\u72b6\u6001 pending \u6539\u6210fulfilled\n                // \u901a\u8fc7 resolve \u5c31\u53ef\u4ee5\n                resolve(result);\n            }\n        }\n    })\n}\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u7ed3\u679c")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/fb97980ae7484150af01cbaf3a265c5b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"tips:"),(0,o.kt)("p",{parentName:"blockquote"},"\u6211\u628a p.then() \u8fd4\u56de \u7684 promise \u5bf9\u8c61\u547d\u540d\u4e3a outerResult\uff0c\u5728 p.then() \u5185\u7684\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u7684 promise \u5bf9\u8c61\u547d\u540d\u4e3a result")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u8fd9\u662f\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u662f promise \u7684\u60c5\u51b5\uff0c\u5e76\u4e14\u8fd9\u4e2a promise \u662f\u6210\u529f\u7684\u72b6\u6001")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let outerResult = p.then(value => {\n    let result = new Promise((resolve, reject) => {\n        resolve('Hello');\n    })\n    return result;\n}, reason => {\n    console.log(reason);\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Promise.prototype.then = function (onResolved, onRejected) {\n    // \u8fd4\u56de promise\n    return new Promise((resolve, reject) => {\n        // \u8c03\u7528\u56de\u8c03\u51fd\u6570 PromiseState\n        if (this.PromiseState === 'fulfilled') {\n            // \u83b7\u53d6\u56de\u8c03\u51fd\u6570\u7684\u7ed3\u679c\n            let result = onResolved(this.PromiseResult);\n            // \u5982\u679c\u8fd4\u56de\u7684\u662f promise \u5bf9\u8c61\n            if (result instanceof Promise) {\n                // result \u6267\u884c\u7684\u662f\u6210\u529f\uff0c\u5c31\u8981\u7ed9\u5916\u5c42\u7684 outerResult \u6210\u529f\u7684\u6548\u679c\n                result.then(value => {\n                    // \u8fd9\u91cc resolve \u8c03\u7528\u8005\u662f outerResult\n                    // result \u7684\u7ed3\u679c\u5c31\u662f outerResult\u7684\u7ed3\u679c\n                    resolve(value);\n                }, reason => {\n                    reject(reason)\n                })\n            } else { // \u8fd4\u56de\u7684\u662f\u5e38\u89c4\u503c\u5c31\u662f\u6210\u529f\n                // \u901a\u8fc7 resolve \u5c31\u53ef\u4ee5\n                resolve(result);\n            }\n        }\n    })\n}\n")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/46e3a832f5174038bfb26c10a1b05a0d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u5b8c\u6574\u4ee3\u7801")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Promise.prototype.then = function (onResolved, onRejected) {\n    // \u8fd4\u56de promise\n    return new Promise((resolve, reject) => {\n        // \u8c03\u7528\u56de\u8c03\u51fd\u6570 PromiseState\n        if (this.PromiseState === 'fulfilled') {\n            try {\n                // \u83b7\u53d6\u56de\u8c03\u51fd\u6570\u7684\u7ed3\u679c\n                let result = onResolved(this.PromiseResult);\n                // \u5982\u679c\u8fd4\u56de\u7684\u662f promise \u5bf9\u8c61\n                if (result instanceof Promise) {\n                    // result \u6267\u884c\u7684\u662f\u6210\u529f\uff0c\u5c31\u8981\u7ed9\u5916\u5c42\u7684 outerResult \u6210\u529f\u7684\u6548\u679c\n                    result.then(value => {\n                        // \u4f7f outerResult \u7684 \u72b6\u6001 \u548c result \u7684\u72b6\u6001\u4e00\u81f4\n                        resolve(value);\n                    }, reason => {\n                        reject(reason)\n                    })\n                } else { // \u8fd4\u56de\u7684\u662f\u5e38\u89c4\u503c\u5c31\u662f\u6210\u529f\n                    // \u8981\u5c06\u8fd9\u4e2a \u5927 \u7684 promise \u76ee\u524d\u7684\u72b6\u6001 pending \u6539\u6210fulfilled\n                    // \u901a\u8fc7 resolve \u5c31\u53ef\u4ee5\n                    resolve(result);\n                }\n            } catch (error) {\n                reject(error);\n            }\n\n        }\n        if (this.PromiseState === 'rejected') {\n            onRejected(this.PromiseResult);\n        }\n        // \u5224\u65ad pending \u72b6\u6001\n        if (this.PromiseState === 'pending') {\n            // \u4fdd\u5b58\u56de\u8c03\u51fd\u6570\n            this.callback.push({\n                onResolved: onResolved,\n                onRejected: onRejected\n            });\n        }\n    })\n}\n")),(0,o.kt)("h3",{id:"510-\u5f02\u6b65\u4fee\u6539\u72b6\u6001-then-\u65b9\u6cd5\u8fd4\u56de"},"5.10 \u5f02\u6b65\u4fee\u6539\u72b6\u6001 then \u65b9\u6cd5\u8fd4\u56de"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u8fd9\u4e00\u90e8\u5206\u5c31\u66f4\u590d\u6742\u4e86\u3002\u3002\u3002")),(0,o.kt)("p",null,"\u56e0\u4e3a executor \u5185\u90e8\u662f\u5f02\u6b65\u51fd\u6570\u6267\u884c\uff0c\u6240\u4ee5\u5728\u6267\u884c\u5230  p.then() \u65f6\uff0cp \u7684\u72b6\u6001\u662f pending \uff0c\u76f4\u63a5\u8fdb\u5165 .then() \u65b9\u6cd5\u7684\u6700\u540e\u4e00\u4e2a\u5224\u65ad\u3002\u8bf4\u7684\u592a\u62bd\u8c61\u4e86\uff0c\u6765\u770b\u4e0b\u5b9e\u9645\u4ee3\u7801\u3002"),(0,o.kt)("p",null,"index.html "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        resolve('Err');\n    }, 1000)\n})\n\n\nlet outerResult = p.then(value => {\n    console.log(value);\n    // return 521;\n}, reason => {\n    console.log(reason);\n})\n\nconsole.log(outerResult);\n")),(0,o.kt)("p",null,"promise.js"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/79465ecec0b54f8c9a76d65aa9888947.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u4e4b\u524d\u5199\u7684\u4ee3\u7801\uff0c\u5728\u78b0\u5230 executor \u91cc\u662f\u5f02\u6b65\u51fd\u6570\u65f6\uff0c\u64cd\u4f5c\u662f\u5148\u628a\u56de\u8c03\u51fd\u6570\u4fdd\u5b58\u8d77\u6765\uff0c\u7b49\u5f02\u6b65\u51fd\u6570\u6267\u884c\u7ed3\u675f\uff0c\u8c03\u7528 resolve \u6216 reject \u65f6\uff0c\u518d\u8c03\u7528 \u56de\u8c03\u51fd\u6570\u3002"),(0,o.kt)("p",null,"\u73b0\u5728\u56e0\u4e3a .then() \u65b9\u6cd5\u6267\u884c\u540e\u8981\u8fd4\u56de\u4e00\u4e2a promise \u5bf9\u8c61\uff0c\u5982\u679c\u76f4\u63a5\u7b80\u5355\u7684\u4fdd\u5b58\u56de\u8c03\u51fd\u6570\uff0c\u8fd4\u56de\u7684 promise \u5bf9\u8c61\u7684\u72b6\u6001\u4e00\u76f4\u662f pending\uff0cPromiseResult \u8fd9\u4e2a\u5c5e\u6027\u4e5f\u4e00\u76f4\u662f null\u3002"),(0,o.kt)("p",null,"\u6240\u4ee5\u8981\u5bf9\u4fdd\u5b58\u56de\u8c03\u51fd\u6570\u8fdb\u884c\u9b54\u6539\uff0c\u8ba9\u540e\u9762\u6267\u884c\u8fd9\u4e2a\u56de\u8c03\u51fd\u6570\u65f6\uff0c\u80fd\u4fee\u6539 outerResult \u7684\u4e24\u4e2a\u5c5e\u6027\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Promise.prototype.then = function (onResolved, onRejected) {\n    // \u8fd4\u56de promise\n    return new Promise((resolve, reject) => {\n        // \u5224\u65ad pending \u72b6\u6001\n        if (this.PromiseState === 'pending') {\n            // \u4fdd\u5b58\u56de\u8c03\u51fd\u6570\n            this.callback.push({\n                onResolved: function (data) {\n                    // console.log('success');\n                    // \u6267\u884c\u6210\u529f\u7684\u56de\u8c03\u51fd\u6570\n                    // \u83b7\u53d6\u56de\u8c03\u51fd\u6570\u8fd4\u56de\u7ed3\u679c\n                    try {\n                        let res = onResolved(data);\n                        if (res instanceof Promise) {\n                            // \u6839\u636e \u56de\u8c03\u51fd\u6570\u8fd4\u56de\u7684 promise \u51b3\u5b9a\n                            res.then(value => {\n                                // \u8fd9\u4e2a \u56de\u8c03\u51fd\u6570 \u8fd4\u56de\u7684 promise \u5185\u90e8\u8c03\u7528\u7684\u662f resolve\n                                resolve(value);\n                            }, reason => {\n                                reject(reason);\n                            })\n                        } else {\n                            // \u4e0d\u662f promise \u8fd4\u56de\u7684\u5c31\u662f\u6b63\u786e\n                            // \u6539\u53d8outerResult\u7684\u72b6\u6001\n                            resolve(res);\n                        }\n                    } catch (error) {\n                        reject(error)\n                    }\n\n                },\n                onRejected: function (data) {\n                    try {\n                        // \u6539\u53d8 promise \u7684\u72b6\u6001\u4e3a rejected\n                        let res = onRejected(data);\n                        if (res instanceof Promise) {\n                            // \u6839\u636e \u56de\u8c03\u51fd\u6570\u8fd4\u56de\u7684 promise \u51b3\u5b9a\n                            res.then(value => {\n                                // \u8fd9\u4e2a \u56de\u8c03\u51fd\u6570 \u8fd4\u56de\u7684 promise \u5185\u90e8\u8c03\u7528\u7684\u662f reject\n                                resolve(value);\n                            }, reason => {\n                                reject(reason);\n                            })\n                        } else {\n                            // \u6539\u53d8outerResult\u7684\u72b6\u6001\n                            reject(res);\n                        }\n                    } catch (error) {\n                        reject(error)\n                    }\n                }\n            });\n        }\n    })\n}\n")),(0,o.kt)("h3",{id:"511-catch\u65b9\u6cd5-\u5f02\u5e38\u7a7f\u900f\u4e0e\u503c\u4f20\u9012"},"5.11 catch\u65b9\u6cd5-\u5f02\u5e38\u7a7f\u900f\u4e0e\u503c\u4f20\u9012"),(0,o.kt)("p",null,"catch \u65b9\u6cd5\u662f\u83b7\u53d6\u5931\u8d25\u7684\u503c\uff0c\u56e0\u4e3a\u524d\u9762 then() \u65b9\u6cd5 \u5df2\u7ecf\u5199\u7684\u5f88\u5b8c\u5584\u4e86\uff0c\u6240\u4ee5 catch \u53ea\u8981\u8c03\u7528\u4e00\u4e0b then() \u5c31\u597d"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"index.html")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        reject('Err');\n    }, 1000)\n})\n\n\nlet res = p.catch(reason => {\n    console.log(reason);\n    return 321;\n})\n\nconsole.log(res);\n")),(0,o.kt)("p",null," ",(0,o.kt)("strong",{parentName:"p"},"promise.js")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Promise.prototype.catch = function (onRejected) {\n    return this.then(undefined, onRejected);\n}\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u63a5\u4e0b\u6765\u5c31\u662f\u8981\u5b8c\u6210 catch \u65b9\u6cd5\u7684\u5f02\u5e38\u7a7f\u900f\u6548\u679c")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/cb7ab8ede4414a3eb7bf0c4004f02274.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u6211\u6309\u7167\u987a\u5e8f\u5199\u4e0b\u6765\uff1a"),(0,o.kt)("p",null,"index.html"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        reject('Err');\n    }, 1000)\n})\n\n\nlet res = p.then(value => {\n    console.log(111);\n}).then(value => {\n    console.log(222);\n}).then(value => {\n    console.log(333);\n}).catch(reason => {\n    console.log(reason);\n})\n")),(0,o.kt)("p",null,"\u8fd9\u65f6\u5019\u4f1a\u51fa\u73b0\u8fd9\u4e2a\u95ee\u9898\uff1a"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/25c8de14761c4cbc90e55995738da26f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u8bf4 onRejected \u65b9\u6cd5\u4e0d\u5b58\u5728\uff0c\u8fd9\u662f\u4ec0\u4e48\u60c5\u51b5\uff1f"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u89e3\u91ca\uff1a"),(0,o.kt)("p",{parentName:"blockquote"},"executor \u6267\u884c\u5668\u5728\u6267\u884c\u5b83\u5185\u90e8\u5f02\u6b65\u4ee3\u7801\u524d\uff0c\u540c\u6b65\u4ee3\u7801\u5df2\u7ecf\u6267\u884c\u7ed3\u675f\u4e86\uff0c\u4e5f\u5c31\u662f p.then() \u6267\u884c\u5b8c\u6bd5\uff0c\u628a then \u5185\u7684\u56de\u8c03\u65b9\u6cd5\u5b58\u5230\u4e86 p \u7684\u81ea\u8eab\u5c5e\u6027\u4e0a\u3002\u800c then \u7684\u56de\u8c03\u53c2\u6570\u6709\u4e24\u4e2a\uff1aonResolved\uff0conRejected\u3002\u5728\u8fd9\u4e2a\u6848\u4f8b\u4e2d\u53ea\u4f20\u4e86\u4e00\u4e2a onResolve\uff0c\u6ca1\u6709onRejected\uff0c\u6240\u4ee5 \u4fdd\u5b58\u5728 p \u672c\u8eab\u4e0a\u7684\u56de\u8c03\u51fd\u6570 onRejected \u5c31\u4e3a\u7a7a\u3002")),(0,o.kt)("p",null,"\u6240\u4ee5\u6211\u4eec\u8981\u4e3b\u52a8\u7ed9 then \u65b9\u6cd5\u5185\u52a0\u4e0a\u4e00\u4e2a onRejected \u56de\u8c03\u51fd\u6570\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Promise.prototype.then = function (onResolved, onRejected) {\n\n    // \u5224\u65ad\u56de\u8c03\u51fd\u6570\u7684\u53c2\u6570\n    // then \u65b9\u6cd5\u4e2d\u5e76\u6ca1\u6709 onRejected \u8fd9\u4e2a\u56de\u8c03\u65b9\u6cd5\n    if (typeof onRejected !== 'function') {\n        // \u624b\u52a8\u7ed9 then \u6dfb\u52a0\u8fd9\u4e2a\u56de\u8c03\u51fd\u6570 \n        onRejected = reason => {\n            // \u629b\u5f02\u5e38\n            throw reason;\n        }\n    }\n}\n")),(0,o.kt)("p",null,"\u8fd9\u65f6\u5019\u5728\u6700\u540e\u7684 catch \u5c31\u80fd\u63a5\u53d7\u5230\u8fd9\u4e2a\u5f02\u5e38\u4e86"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/9984a29fc1a94311a82bd83440c43cf3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u503c\u4f20\u9012"),"\u7684\u8bdd\u5c31\u662f then \u65b9\u6cd5\u8fde onResolved \u56de\u8c03\u51fd\u6570\u90fd\u4e0d\u4f20\u9012\u4e86\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        reject('Err');\n    }, 1000)\n})\n\n\nlet res = p.then().then(value => {\n    console.log(222);\n}).then(value => {\n    console.log(333);\n}).catch(reason => {\n    console.log(reason);\n})\n")),(0,o.kt)("p",null,"\u8fd9\u65f6\u5019\u5904\u7406\u65b9\u6cd5\u548c\u4e0a\u9762\u7684\u7c7b\u4f3c\uff0c\u52a0\u4e00\u4e2a onResolved \u56de\u8c03\u5c31\u884c"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// then \u65b9\u6cd5\u4e2d\u5e76\u6ca1\u6709 onResolved \u8fd9\u4e2a\u56de\u8c03\u65b9\u6cd5\nif (typeof onResolved !== 'function') {\n    // \u624b\u52a8\u7ed9 then \u6dfb\u52a0\u8fd9\u4e2a\u56de\u8c03\u51fd\u6570 \n    onResolved = value => {\n        return value;\n    }\n}\n")),(0,o.kt)("h3",{id:"512-resolve-\u65b9\u6cd5\u5c01\u88c5"},"5.12 resolve \u65b9\u6cd5\u5c01\u88c5"),(0,o.kt)("p",null,"\u6bd4\u8f83\u7b80\u5355\u76f4\u63a5\u4eae\u4ee3\u7801"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Promise.resolve = function (value) {\n    // \u8fd4\u56de promise \u5bf9\u8c61\n    return new Promise((resolve, reject) => {\n        if (value instanceof Promise) {\n            value.then(v => {\n                resolve(v);\n            }, r => {\n                reject(r);\n            })\n        } else {\n            resolve(value);\n        }\n    })\n}\n")),(0,o.kt)("h3",{id:"513-all-\u65b9\u6cd5\u5c01\u88c5"},"5.13 all \u65b9\u6cd5\u5c01\u88c5"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/39cd23ae1a95413ebd0771d568398131.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"index.html"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p1 = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        resolve('Ok')\n    }, 1000)\n})\n\nlet p2 = new Promise((resolve, reject) => {\n    resolve('success')\n});\n\nlet p3 = new Promise((resolve, reject) => {\n    resolve('dddd')\n});\n\nlet res = Promise.all([p1, p2, p3])\nconsole.log(res);\n")),(0,o.kt)("p",null,"promise.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Promise.all = function (promises) {\n    return new Promise((resolve, reject) => {\n        // \u58f0\u660e\u53d8\u91cf\n        let count = 0;\n        let arr = [];\n        // \u904d\u5386\n        for (let i = 0; i < promises.length; i++) {\n            promises[i].then(v => {\n                // \u5bf9\u8c61\u7684\u72b6\u6001\u662f\u6210\u529f\n                count++;\n                // \u5c06\u5f53\u524d promise \u5bf9\u8c61\u6210\u529f\u7684\u7ed3\u679c \u5b58\u5230\u6570\u7ec4\u4e2d\n                arr[i] = v;\n                // \u5224\u65ad\u5982\u679c\u5168\u90fd\u6210\u529f\uff0c\u5c31\u8fd4\u56de\u6210\u529f\n                if (count === promises.length) {\n                    // \u4fee\u6539\u72b6\u6001\n                    resolve(arr);\n                }\n            }, r => {\n                reject(r);\n            })\n        }\n    })\n}\n")),(0,o.kt)("h3",{id:"514-then-\u65b9\u6cd5-\u56de\u8c03\u7684\u5f02\u6b65\u6267\u884c"},"5.14 then \u65b9\u6cd5 \u56de\u8c03\u7684\u5f02\u6b65\u6267\u884c"),(0,o.kt)("p",null,"\u5148\u770b\u573a\u666f\uff1a"),(0,o.kt)("p",null,"index.html"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p1 = new Promise((resolve, reject) => {\n    // setTimeout(() => {\n    //     resolve('Ok')\n    // }, 1000)\n    resolve('OK')\n    console.log(111);\n})\n\np1.then(value => {\n    console.log(222);\n})\n\nconsole.log(333);\n")),(0,o.kt)("p",null,"\u8981\u6c42\u6211\u4eec\u7684 then \u5185\u90e8\u7684\u56de\u8c03\u65b9\u6cd5\u5e94\u8be5\u662f\u5f02\u6b65\u6267\u884c\u3002"),(0,o.kt)("p",null,"\u6253\u5370\u7ed3\u679c\uff1a\u5374\u662f\u540c\u6b65\u6267\u884c"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/b2a72d5ae75b430ea883ba8c8f99f263.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_16,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u7528\u4e00\u4e2a\u6bd4\u8f83\u7c97\u7cd9\u7684\u65b9\u6cd5\u89e3\u51b3\uff0c\u7ed9\u6240\u6709\u7684\u56de\u8c03\u51fd\u6570\u52a0\u4e0a\u5b9a\u65f6\u5668\uff1a"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/7a8e6cf8f89744419028266d61be5c00.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("h3",{id:"\u603b\u7ed3\u5206\u6790"},"\u603b\u7ed3\u5206\u6790\uff1a"),(0,o.kt)("p",null,"\u8fd9\u4e2a\u5c1a\u7845\u8c37\u7684\u89c6\u9891\u4e00\u76f4\u6ca1\u8bb2\u94fe\u5f0f\u8c03\u7528\u7684\u8fc7\u7a0b\uff0c\u6211\u89c9\u5f97\u662f\u4e00\u4e2a\u5f88\u5927\u7684\u9057\u61be\uff0c\u6211\u8fd9\u4e00\u5757\u8fd8\u662f\u633a\u8ff7\u7cca\u7684\uff0c\u6211\u5c1d\u8bd5\u7740\u81ea\u5df1\u6765\u5206\u6790\u4e00\u4e0b\u3002"),(0,o.kt)("p",null,"\u9996\u5148\u6211\u4eec\u9700\u8981\u77e5\u9053 then \u672c\u8eab\u662f\u540c\u6b65\uff0c\u53ea\u662f\u5b83\u5185\u90e8\u7684\u56de\u8c03\u51fd\u6570\u662f\u5f02\u6b65\u7684\u3002\u53ef\u4ee5\u7528\u4ee3\u7801\u6765\u6d4b\u8bd5\u4e00\u4e0b"),(0,o.kt)("p",null,"index.html"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p1 = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        resolve('Ok')\n    }, 1000)\n})\n\nlet p2 = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        resolve('success')\n    }, 2000)\n});\n\nlet p3 = new Promise((resolve, reject) => {\n    resolve('dddd')\n});\n\np1.then(value => {\n    console.log(value);\n    console.log(111);\n    return p2;\n}).then(value => {\n    console.log(value);\n    console.log(222);\n    return p3;\n}).then(value => {\n    console.log(value);\n    console.log(333);\n})\n\nconsole.log('\u6211\u5f97\u5728\u56de\u8c03\u4e4b\u524d\u6267\u884c');\n")),(0,o.kt)("p",null,"promise.js"),(0,o.kt)("p",null,"\u4fee\u6539 then \u51fd\u6570\u5185\u5bb9\uff0c\u5728\u8c03\u7528 then \u65f6\u4e00\u4e0a\u6765\u5c31\u6253\u5370\u4e00\u4e0b\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Promise.prototype.then = function (onResolved, onRejected) {\n    console.log('then\u672c\u8eab\u662f\u540c\u6b65\u7684');\n}\n")),(0,o.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u770b\u4e00\u4e0b\u6253\u5370\u7ed3\u679c\uff1a"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/e45d129b890c476c983dfceeb6ae4b09.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u53ef\u4ee5\u5f97\u51fa\u7ed3\u8bba\uff0cthen \u7684\u94fe\u5f0f\u8c03\u7528\u4f1a\u5728\u4e00\u5f00\u59cb\u5c31\u4e00\u4e0b\u5b50\u6267\u884c\u4e0b\u53bb\u3002then \u5185\u90e8\u7684\u56de\u8c03\u51fd\u6570\u662f\u6309\u7167\u6211\u4eec\u5199\u7684\u987a\u5e8f\u6267\u884c\u4e0b\u53bb\uff0c\u4e3a\u5565\u4f1a\u8fd9\u6837\u5462\uff0c\u6211\u4eec\u4e00\u884c\u4e00\u4e2a\u4ee3\u7801\u9010\u6b65\u89e3\u6790\u4e00\u4e0b\u3002"),(0,o.kt)("p",null,"\u5148\u5206\u6790\u4e00\u4e0a\u6765\u5b9a\u4e49\u51fa\u6765\u7684\u4e09\u4e2a promise \u5bf9\u8c61"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p1 = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        resolve('Ok')\n    }, 1000)\n})\n\nlet p2 = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        resolve('success')\n    }, 2000)\n});\n\nlet p3 = new Promise((resolve, reject) => {\n    resolve('dddd')\n});\n")),(0,o.kt)("p",null,"\u7b2c\u4e00\u6b65\uff1a\u5b9a\u4e49 P1 \u662f\u4e00\u4e2a promise \u5bf9\u8c61\uff0cP1 \u7684 PromiseState \u662f pending\uff0cPromiseResult \u662f null\uff0cthis.callback = []\u3002\u7136\u540e\u5f00\u59cb\u8c03\u7528 executor(resolve, reject) \u6267\u884c\u5668\uff0c \u4f46\u6267\u884c\u5668\u5185\u90e8\u4e00\u8fdb\u53bb\u5c31\u662f\u4e00\u4e2a\u5b9a\u65f6\u5668\uff0c\u5b9a\u65f6\u5668\u662f\u5f02\u6b65\u51fd\u6570\u8c03\u7528\uff0c\u8fdb\u5f02\u6b65\u961f\u5217\uff0c\u7136\u540e\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\u5c31\u5230 P2\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/34670437a88542c9995758ddffb78ee2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u7b2c\u4e8c\u6b65\uff1a\u5b9a\u4e49 P2\uff0cP2 \u4e0e P1 \u7c7b\u4f3c\uff0c PromiseState \u548c PromiseResult \u90fd\u4e00\u6837\uff0cexecutor \u6267\u884c\u5668\u5185\u90e8\u4e5f\u662f\u4e00\u4e2a\u5b9a\u65f6\u5668\uff0c\u8fdb\u5f02\u6b65\u961f\u5217"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/a892923ff35d4bf08f7318a739f752f5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u7b2c\u4e09\u6b65\uff1a\u5b9a\u4e49 P3\uff0c\u56e0\u4e3a P3 executor \u6267\u884c\u5668 \u5185\u90e8\u6ca1\u6709\u5f02\u6b65\u51fd\u6570\uff0c\u6240\u4ee5\u76f4\u63a5\u6309\u7167\u540c\u6b65\u4ee3\u7801\u6267\u884c\uff0c\u800c\u4e14\u8c03\u7528\u7684\u662f resolve\uff0c\u6240\u4ee5\u8fd4\u56de\u7684\u662f\u6210\u529f PromiseState \u4e3a fulfilled,  PromiseResult \u4e3a Ok \uff0ccallback \u662f \u5f02\u6b65\u51fd\u6570\uff0c\u867d\u7136\u91cc\u9762\u8fd8\u6ca1\u6709\u503c\uff0c\u8fd8\u662f\u8981\u653e\u5230\u5f02\u6b65\u961f\u5217\u4e2d\u3002"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u5f00\u59cb\u6bd4\u8f83\u523a\u6fc0\u7684 then \u65b9\u6cd5\u8c03\u7528\u4e86\u3002")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/7e4ecba1e2c04b089679c334b5e09756.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u7b2c\u56db\u6b65\uff1aP1 \u8c03\u7528 then \u65b9\u6cd5\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u8fd9\u6837\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u4e4b\u524d\u5728 then \u7684\u7b2c\u4e00\u884c\u6dfb\u52a0\u4e86 ",(0,o.kt)("inlineCode",{parentName:"p"},"console.log('then\u672c\u8eab\u662f\u540c\u6b65\u7684');")," \uff0c\u6240\u4ee5\u63a7\u5236\u53f0\u6253\u5370 then\u672c\u8eab\u5c31\u662f\u540c\u6b65\u7684\u3002 \u63a5\u7740\u56e0\u4e3a P1 \u7684 PromiseState \u662f pending \uff0c\u6240\u4ee5\u4f1a\u5c06 then \u4e2d\u7684\u56de\u8c03\u51fd\u6570\u4fdd\u5b58\u5230 P1 \u7684 callback \u5c5e\u6027\u4e0a\u3002\u8fd9\u65f6 P1.then() \u65b9\u6cd5\u6267\u884c\u7ed3\u675f\uff0c\u8fd4\u56de\u4e00\u4e2a Promise \u5bf9\u8c61\uff0c\u6211\u628a\u8be5\u8fd4\u56de\u7684 Promise \u5bf9\u8c61\u547d\u540d\u4e3a X\u3002\u8be5Promise \u5bf9\u8c61\u6b63\u5904\u4e8e pending \u72b6\u6001\u4e2d\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/e48b3774abab4b8dbc8984e11ade1acb.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/9b0bcc323e03401fa77e8c24ede26d43.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u7b2c\u4e94\u6b65\uff1a\u94fe\u5f0f\u8c03\u7528 then\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/fa1855011b3b460781a923087863d955.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_19,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u8fd9\u4e2a\u5c31\u76f8\u5f53\u4e8e X \u5728\u8c03\u7528 then"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/82945cd3af5244d4b6dcbc8e4232b2ec.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_18,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"X \u6b64\u65f6 \u662f pending \u72b6\u6001\uff0c\u8c03\u7528 then \u5c31\u662f \u5148\u6253\u5370\u4e0b ",(0,o.kt)("strong",{parentName:"p"},"then\u672c\u8eab\u662f\u540c\u6b65\u7684")," \u8fd9\u53e5\u8bdd\uff0c\u7136\u540e\u5c31\u662f \u628a then \u5185\u90e8\u7684\u56de\u8c03\u51fd\u6570\u4fdd\u5b58 X \u7684 callback \u4e0a\u3002\u8fd9\u65f6\uff0c X.then() \u6267\u884c\u7ed3\u675f\uff0c X.then() \u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\uff0c\u6211\u79f0\u4e4b\u4e3a Y \uff0c\u8fd9\u4e2a Y \u5bf9\u8c61\u72b6\u6001\u6b64\u65f6\u4e5f\u662f pending\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/61db1ac287b3429ead895e8d1f4d2d86.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u7b2c\u516d\u6b65\uff1a\u6700\u540e\u4e00\u4e2a\u94fe\u5f0f\u8c03\u7528"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"p1.then(value => {\n    console.log(value);\n    console.log(111);\n    return p2;\n}).then(value => {\n    console.log(value);\n    console.log(222);\n    return p3;\n}).then(value => {\n    console.log(value);\n    console.log(333);\n})\n")),(0,o.kt)("p",null,"\u5206\u89e3\u540e\u76f8\u5f53\u4e8e\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let X = p1.then(value => {\n    console.log(value);\n    console.log(111);\n    return p2;\n})\nlet Y = X.then(value => {\n    console.log(value);\n    console.log(222);\n    return p3;\n})\nlet Z = Y.then(value => {\n    console.log(value);\n    console.log(333);\n})\n")),(0,o.kt)("p",null,"\u5c31\u548c\u4e0a\u9762\u4e00\u6837\uff0cY \u6b64\u65f6\u662f pending \u72b6\u6001\uff0c\u6240\u4ee5\u8c03\u7528 then \u65b9\u6cd5\uff0c\u76f4\u63a5\u5c06\u56de\u8c03\u51fd\u6570\u4fdd\u5b58\u5230 Y \u7684 callback \u5c5e\u6027\u4e0a\uff0c\u8fd4\u56de\u4e00\u4e2a\u65b0 Promise \uff0c\u72b6\u6001\u662f pending\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/0288674e12b94b74a2bd72c4c8b0aaf8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u8fd9\u662f\u540c\u6b65\u4ee3\u7801\u6267\u884c\u5b8c\uff0c\u63a7\u5236\u53f0\u6253\u5370\u7684\u7ed3\u679c\uff1a"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/4d0f2722ed814ad9af0d4124ebee4d46.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u5230\u6b64\u4e3a\u6b62\uff0c\u6240\u6709\u540c\u6b65\u4ee3\u7801\u6267\u884c\u5b8c\u6bd5\uff0c\u5f00\u59cb\u6267\u884c\u5f02\u6b65\u4ee3\u7801\uff0c\u8fd9\u4e00\u90e8\u5206\u53c8\u662f\u8001\u5927\u96be\u3002\u3002\u3002")),(0,o.kt)("p",null,"\u7b2c\u4e03\u6b65\uff1a\u5f00\u59cb\u6267\u884c\u5f02\u6b65\u961f\u5217\u7684\u4ee3\u7801"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/66f4d690ba854548ae0c46aa0b366de7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_10,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u5f02\u6b65\u961f\u5217\u91cc\u6709\u4e09\u4e2a\u5f02\u6b65\u51fd\u6570\uff0c \u5176\u5b9e setTimeout-\u56de\u8c03-P3 \u8fd9\u4e2a\u5f02\u6b65\u51fd\u6570\u5e76\u6ca1\u6709\u4f5c\u7528\uff0c\u56e0\u4e3a P3 \u7684 callback \u662f\u7a7a\u7684\u3002\u6709\u4f5c\u7528\u7684\u5c31 setTimeout-P1 \u548c setTimeout-P2\u3002"),(0,o.kt)("p",null,"\u56e0\u4e3a\u53ea\u6709 P1.then() \u8c03\u7528\u4e86\uff0c\u5b58\u6709\u5c5e\u4e8e\u81ea\u5df1\u7684\u56de\u8c03\u51fd\u6570\uff0c\u522b\u7684 P2\uff0cP3 \u90fd\u6ca1\u6709 .then() \u62e5\u6709\u81ea\u5df1\u7684\u56de\u8c03\u51fd\u6570\u3002\u6240\u4ee5\u5c31\u7b97 P2 \u6216 P3 \u7684\u6267\u884c\u5668\u91cc\u7684 \u5f02\u6b65\u51fd\u6570\u5148\u5b8c\u6210\uff0c\u4ed6\u4eec\u7684 callback \u4e5f\u662f\u7a7a\u7684\uff0c\u6ca1\u6709\u56de\u8c03\u51fd\u6570\u53ef\u4ee5\u8c03\u7528\u3002"),(0,o.kt)("p",null,"\u63a5\u4e0b\u6765\u76f4\u63a5\u8bb2\u89e3\u4e0b\u8fd9\u4e2a\u8c03\u7528\u8fc7\u7a0b\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"let p1 = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        resolve('Ok')\n    }, 1000)\n})\n\nlet p2 = new Promise((resolve, reject) => {\n    setTimeout(() => {\n        resolve('success')\n    }, 2000)\n});\n\nlet p3 = new Promise((resolve, reject) => {\n    resolve('dddd')\n});\n\nlet X = p1.then(value => {\n    console.log(value);\n    console.log(111);\n    return p2;\n})\nlet Y = X.then(value => {\n    console.log(value);\n    console.log(222);\n    return p3;\n})\nlet Z = Y.then(value => {\n    console.log(value);\n    console.log(333);\n})\nconsole.log('X', X);\nconsole.log('Y', Y);\nconsole.log('Z', Z);\nconsole.log('P1', p1);\nconsole.log('P2', p2);\nconsole.log('P3', p3);\n")),(0,o.kt)("p",null,"\u8fd8\u6ca1\u6267\u884c\u524d\u6240\u6709\u5bf9\u8c61\u7684\u72b6\u6001"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/3b879976566d4f0ab0ca67de94267178.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u6267\u884c\u7684\u6b65\u9aa4\u8fc7\u7a0b\u3002"),(0,o.kt)("p",null,"\u7b2c\u4e00\u6b65\uff1a\u5148\u6267\u884c\u5b8c P1 \u7684 resolve \u65b9\u6cd5\uff08P1 \u5f02\u6b65\u51fd\u6570\u5728\u6267\u884c\u65f6\u4f1a\u8bb0\u4f4f P1 \u7684\u73af\u5883\uff09\uff0c\u5c06 P1 \u7684\u5c5e\u6027\u90fd\u6210\u529f\u66f4\u6539\u4e3a fulfilled \u548c Ok\uff0c\u7136\u540e\u5f00\u59cb\u6267\u884c P1 callback \u91cc\u4fdd\u5b58\u7684\u56de\u8c03\u51fd\u6570\u3002"),(0,o.kt)("p",null,"\u8fd9\u4e2a\u56de\u8c03\u51fd\u6570\u662f"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/920f32f3b55b40468aa6cfdf6860a5a0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u8fd9\u4e2a\u56de\u8c03\u65f6\u88ab\u4fee\u9970\u8fc7\u7684\uff0c\u4fee\u9970\u540e\uff1a"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/216cc77b3a654661840dd7c0a42e6137.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u6267\u884c\u540e\u7ed3\u679c\u662f\uff0c\u6253\u5370 value\uff0c\u6253\u5370 111\uff0c\u5c06 P2 \u8fd4\u56de\u7ed9 res"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/c622580fe1ea43fe8ec9cb727f2b2acf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/0d2a06f60cb2405b8763cbf774cb7069.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"P1.then() \u6267\u884c\u7ed3\u675f\u65f6\u8fd4\u56de\u4e86\u4e00\u4e2a Promise \u5bf9\u8c61\u7ed9 X\u3002\u800c res \u6267\u884c\u7684\u73af\u5883\u662fPromise X \u7684\u73af\u5883"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/0e92d26f542c454baa0f583841e437bf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"resolve \u6267\u884c\u5c31\u662f\u4fee\u6539 X \u7684\u72b6\u6001\uff0cX \u66f4\u6539\u4e3a fulfilled\uff0c\u5185\u5bb9\u4e3a success \uff0c\u7136\u540e\u8981\u6267\u884c X \u7684 callback \u91cc\u7684\u56de\u8c03\u51fd\u6570\u3002X callback\u91cc\u7684\u56de\u8c03\u51fd\u6570\u662f X.then() \u65f6\u4fdd\u5b58\u7684\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/aa578d9cccb5470d8dadb1f27f472a5e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_16,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("p",null,"\u7136\u540e\u5c31\u548c\u4e0a\u9762\u7684\u8fc7\u7a0b\u4e00\u6837\u3002"),(0,o.kt)("p",null,"\u6700\u7ec8\u7ed3\u679c\uff1a\u4e00\u5207\u90fd\u987a\u5229\u6267\u884c\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/de4e982e19d544dd8938b6ca329b119d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5qC86Zu354uQ5oCd,size_14,color_FFFFFF,t_70,g_se,x_16",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,o.kt)("h3",{id:"\u672c\u8d28"},"\u672c\u8d28\uff1a"),(0,o.kt)("p",null,"\u5c1a\u7845\u8c37\u7684 promise \u7684\u5b9e\u73b0\u7814\u7a76\u540e\u53d1\u73b0\u5c31\u662f\u5728\u8f93\u51fa\u7ed3\u679c\u4e0a\u6a21\u62df\u4e86\u771f\u5b9e promise \u7684\u5b9e\u73b0\u8fc7\u7a0b\u3002\u4f46\u5b9e\u73b0\u8fc7\u7a0b\u4e0d\u662f\u771f\u7684 promise\u3002\u5982\u679c\u5b58\u5728\u8fd9\u4e48\u4e00\u4e2a\u573a\u666f\uff0cp2 \u7684\u6267\u884c\u9700\u8981\u7528\u5230 p1 \u5b8c\u6210\u540e\u7684\u7ed3\u679c\uff0c\u90a3\u5c1a\u7845\u8c37\u6a21\u62df\u7684 promise \u662f\u65e0\u6cd5\u5b8c\u6210\u7684\u3002\u56e0\u4e3a \u5c1a\u7845\u8c37\u7684 promise \u53ea\u662f\u628a p1\uff0cp2\uff0cp3\u7684\u7ed3\u679c\u6309\u987a\u5e8f\u6253\u5370\u51fa\u6765\u800c\u5df2\uff0c\u5b9e\u9645\u4e0a\u4e09\u8005\u7684\u5f02\u6b65\u65b9\u6cd5\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u662f\u65e0\u5173\u7684\u3002"),(0,o.kt)("h2",{id:"6-promisification"},"6. Promisification"),(0,o.kt)("p",null,"\u6307\u5c06\u4e00\u4e2a\u63a5\u53d7\u56de\u8c03\u7684\u51fd\u6570\u8f6c\u6362\u4e3a\u4e00\u4e2a\u8fd4\u56de promise \u7684\u51fd\u6570\u3002"),(0,o.kt)("p",null,"\u7531\u4e8e\u8bb8\u591a\u51fd\u6570\u548c\u5e93\u90fd\u662f\u57fa\u4e8e\u56de\u8c03\u7684\uff0c\u56e0\u6b64\uff0c\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\u7ecf\u5e38\u4f1a\u9700\u8981\u8fdb\u884c\u8fd9\u79cd\u8f6c\u6362\u3002\u56e0\u4e3a\u4f7f\u7528 promise \u66f4\u52a0\u65b9\u4fbf\uff0c\u6240\u4ee5\u5c06\u57fa\u4e8e\u56de\u8c03\u7684\u51fd\u6570\u548c\u5e93 promisify \u662f\u6709\u610f\u4e49\u7684\u3002\uff08\u8bd1\u6ce8\uff1apromisify \u5373\u6307 promise \u5316\uff09"),(0,o.kt)("p",null,"\u5177\u4f53\u6848\u4f8b\u53ef\u4ee5\u770b ",(0,o.kt)("strong",{parentName:"p"},"2.3")," ",(0,o.kt)("strong",{parentName:"p"},"2.4")," \u7684\u7ec3\u4e60"),(0,o.kt)("h2",{id:"7-\u7b80\u4ecb-async-await"},"7. \u7b80\u4ecb async await"),(0,o.kt)("h3",{id:"71-async"},"7.1 async"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u51fd\u6570\u7684\u8fd4\u56de\u503c\u4e3a promise \u5bf9\u8c61\u3002"),(0,o.kt)("li",{parentName:"ul"},"promise \u5bf9\u8c61\u7684\u7ed3\u679c\u7531 async \u51fd\u6570\u6267\u884c\u7684\u8fd4\u56de\u503c\u51b3\u5b9a")),(0,o.kt)("h3",{id:"72-await"},"7.2 await"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"await \u53f3\u4fa7\u7684\u8868\u8fbe\u5f0f\u4e00\u822c\u4e3a promise \u5bf9\u8c61\uff0c\u4f46\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u7684\u503c"),(0,o.kt)("li",{parentName:"ul"},"\u5982\u679c\u8868\u8fbe\u5f0f promise \u5bf9\u8c61\u3002await \u8fd4\u56de\u7684\u662f promise \u6210\u529f\u7684\u503c"),(0,o.kt)("li",{parentName:"ul"},"\u5982\u679c\u8868\u8fbe\u5f0f\u662f\u5176\u5b83\u503c\uff0c\u76f4\u63a5\u5c06\u6b64\u503c\u4f5c\u4e3aawait \u7684\u503c")),(0,o.kt)("h3",{id:"73-\u5b9e\u9645\u6848\u4f8b1"},"7.3 \u5b9e\u9645\u6848\u4f8b1"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const fs = require('fs')\nconst util = require('util')\n// promisify \u5904\u7406\u5b8c\u8fd4\u56de\u7684\u662f\u4e00\u4e2a promise \u5bf9\u8c61\nconst mineReadFile = util.promisify(fs.readFile);\n\n\nasync function main() {\n    // \u8bfb\u53d6\u7b2c\u4e00\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\n    let data1 = await mineReadFile('./a.txt');\n    let data2 = await mineReadFile('./b.txt');\n    let data3 = await mineReadFile('./c.txt');\n}\n")),(0,o.kt)("h3",{id:"74-\u5b9e\u9645\u6848\u4f8b2"},"7.4 \u5b9e\u9645\u6848\u4f8b2"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function sendAJAX(url) {\n    return new Promise((resolve, reject) => {\n        const xhr = new XMLHttpRequest();\n        xhr.open('GET', url);\n        xhr.send();\n        // \u5904\u7406\u7ed3\u679c\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4) {\n                if (xhr.status >= 200 && xhr.status < 300) {\n                    resolve(xhr.response);\n                } else {\n                    reject(xhr.status)\n                }\n            }\n        }\n    })\n}\n\nlet btn = document.querySelector('#btn');\nbtn.addEventListener('click',async function () {\n    // \u83b7\u53d6\u4fe1\u606f\n    let message = await sendAJAX('https://api.apiopen.top/getJoke');\n\n    console.log(message);\n})\n")))}m.isMDXComponent=!0}}]);